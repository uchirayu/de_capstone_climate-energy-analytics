[0m16:58:23.072360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be72190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be727d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb26150>]}


============================== 16:58:23.076408 | 9abec5c8-9df5-4d02-87c8-5c6afa739caa ==============================
[0m16:58:23.076408 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:58:23.076878 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'use_colors': 'True', 'target_path': 'None', 'static_parser': 'True', 'profiles_dir': '/usr/app/dbt', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m16:58:23.077242 [info ] [MainThread]: dbt version: 1.7.9
[0m16:58:23.077544 [info ] [MainThread]: python version: 3.11.14
[0m16:58:23.077863 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:58:23.078137 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m16:58:23.283544 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m16:58:23.284015 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m16:58:23.284308 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m16:58:23.284715 [info ] [MainThread]: adapter type: athena
[0m16:58:23.285003 [info ] [MainThread]: adapter version: 1.7.2
[0m16:58:23.321085 [info ] [MainThread]: Configuration:
[0m16:58:23.321541 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:58:23.321884 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:58:23.322192 [info ] [MainThread]: Required dependencies:
[0m16:58:23.322529 [debug] [MainThread]: Executing "git --help"
[0m16:58:23.324236 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:58:23.324606 [debug] [MainThread]: STDERR: "b''"
[0m16:58:23.324830 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:58:23.325071 [info ] [MainThread]: Connection:
[0m16:58:23.325511 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-query-results/dbt/
[0m16:58:23.325758 [info ] [MainThread]:   work_group: None
[0m16:58:23.326059 [info ] [MainThread]:   region_name: us-east-1
[0m16:58:23.326370 [info ] [MainThread]:   database: climate_energy
[0m16:58:23.326984 [info ] [MainThread]:   schema: silver
[0m16:58:23.327340 [info ] [MainThread]:   poll_interval: 1.0
[0m16:58:23.327641 [info ] [MainThread]:   aws_profile_name: None
[0m16:58:23.327916 [info ] [MainThread]:   aws_access_key_id: None
[0m16:58:23.328190 [info ] [MainThread]:   aws_secret_access_key: None
[0m16:58:23.328477 [info ] [MainThread]:   aws_session_token: None
[0m16:58:23.328732 [info ] [MainThread]:   endpoint_url: None
[0m16:58:23.329038 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m16:58:23.329267 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m16:58:23.329556 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m16:58:23.329821 [info ] [MainThread]:   debug_query_state: False
[0m16:58:23.330091 [info ] [MainThread]:   seed_s3_upload_args: None
[0m16:58:23.330349 [info ] [MainThread]:   lf_tags_database: None
[0m16:58:23.330608 [info ] [MainThread]:   spark_work_group: None
[0m16:58:23.331049 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:58:23.331607 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m16:58:23.331934 [debug] [MainThread]: Using athena connection "debug"
[0m16:58:23.332147 [debug] [MainThread]: On debug: select 1 as id
[0m16:58:23.332322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:24.490638 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 02cb713d-720b-4e75-93c4-3e2830e5fdcd
[0m16:58:26.252656 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m16:58:26.256148 [debug] [MainThread]: On debug: Close
[0m16:58:26.257131 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:58:26.258247 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:58:26.260848 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:58:26.263731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7abc4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aab4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab58910>]}
[0m16:58:26.264610 [debug] [MainThread]: Flushing usage events
[0m17:00:36.859206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2643d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a265a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2642d0>]}


============================== 17:00:36.863530 | 69a182ab-b7a3-4003-9bd5-ec8ce4084f5d ==============================
[0m17:00:36.863530 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:00:36.864362 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/app/dbt/logs', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'profiles_dir': '/usr/app/dbt', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager'}
[0m17:00:36.864663 [info ] [MainThread]: dbt version: 1.7.9
[0m17:00:36.864960 [info ] [MainThread]: python version: 3.11.14
[0m17:00:36.865255 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:00:36.865527 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m17:00:37.064654 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m17:00:37.065108 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m17:00:37.065411 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m17:00:37.065835 [info ] [MainThread]: adapter type: athena
[0m17:00:37.066127 [info ] [MainThread]: adapter version: 1.7.2
[0m17:00:37.101735 [info ] [MainThread]: Configuration:
[0m17:00:37.102193 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:00:37.102570 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:00:37.102928 [info ] [MainThread]: Required dependencies:
[0m17:00:37.103206 [debug] [MainThread]: Executing "git --help"
[0m17:00:37.104902 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:00:37.105176 [debug] [MainThread]: STDERR: "b''"
[0m17:00:37.105351 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:00:37.105562 [info ] [MainThread]: Connection:
[0m17:00:37.105925 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-query-results/dbt/
[0m17:00:37.106226 [info ] [MainThread]:   work_group: None
[0m17:00:37.106426 [info ] [MainThread]:   region_name: us-east-1
[0m17:00:37.106660 [info ] [MainThread]:   database: climate_energy
[0m17:00:37.106966 [info ] [MainThread]:   schema: silver
[0m17:00:37.107377 [info ] [MainThread]:   poll_interval: 1.0
[0m17:00:37.107986 [info ] [MainThread]:   aws_profile_name: None
[0m17:00:37.108243 [info ] [MainThread]:   aws_access_key_id: None
[0m17:00:37.108781 [info ] [MainThread]:   aws_secret_access_key: None
[0m17:00:37.109010 [info ] [MainThread]:   aws_session_token: None
[0m17:00:37.109273 [info ] [MainThread]:   endpoint_url: None
[0m17:00:37.109549 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m17:00:37.109882 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m17:00:37.110131 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m17:00:37.110434 [info ] [MainThread]:   debug_query_state: False
[0m17:00:37.110704 [info ] [MainThread]:   seed_s3_upload_args: None
[0m17:00:37.110983 [info ] [MainThread]:   lf_tags_database: None
[0m17:00:37.111332 [info ] [MainThread]:   spark_work_group: None
[0m17:00:37.111624 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:00:37.112274 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m17:00:37.112518 [debug] [MainThread]: Using athena connection "debug"
[0m17:00:37.112706 [debug] [MainThread]: On debug: select 1 as id
[0m17:00:37.112900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:37.823860 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 5e920e11-04f9-4c68-aa5f-8337516a2a91
[0m17:00:39.562360 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m17:00:39.566498 [debug] [MainThread]: On debug: Close
[0m17:00:39.567513 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:00:39.568410 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:00:39.570795 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:00:39.573716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a29a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b0dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892b6f10>]}
[0m17:00:39.574533 [debug] [MainThread]: Flushing usage events
[0m17:02:47.621066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96353b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96353ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963488d0>]}


============================== 17:02:47.625529 | dd74c8e7-abc3-421b-bef0-a7658522a294 ==============================
[0m17:02:47.625529 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:02:47.626037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:02:47.626370 [info ] [MainThread]: dbt version: 1.7.9
[0m17:02:47.626657 [info ] [MainThread]: python version: 3.11.14
[0m17:02:47.626972 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:02:47.627288 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m17:02:47.891233 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m17:02:47.891765 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m17:02:47.892094 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m17:02:47.892580 [info ] [MainThread]: adapter type: athena
[0m17:02:47.892852 [info ] [MainThread]: adapter version: 1.7.2
[0m17:02:47.928692 [info ] [MainThread]: Configuration:
[0m17:02:47.929123 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:02:47.929558 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:02:47.929961 [info ] [MainThread]: Required dependencies:
[0m17:02:47.930462 [debug] [MainThread]: Executing "git --help"
[0m17:02:47.932526 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:02:47.932817 [debug] [MainThread]: STDERR: "b''"
[0m17:02:47.933004 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:02:47.933238 [info ] [MainThread]: Connection:
[0m17:02:47.933566 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-query-results/dbt/
[0m17:02:47.933781 [info ] [MainThread]:   work_group: None
[0m17:02:47.933979 [info ] [MainThread]:   region_name: us-east-1
[0m17:02:47.934171 [info ] [MainThread]:   database: climate_energy
[0m17:02:47.934353 [info ] [MainThread]:   schema: silver
[0m17:02:47.934564 [info ] [MainThread]:   poll_interval: 1.0
[0m17:02:47.935077 [info ] [MainThread]:   aws_profile_name: None
[0m17:02:47.935349 [info ] [MainThread]:   aws_access_key_id: None
[0m17:02:47.935709 [info ] [MainThread]:   aws_secret_access_key: None
[0m17:02:47.935977 [info ] [MainThread]:   aws_session_token: None
[0m17:02:47.936270 [info ] [MainThread]:   endpoint_url: None
[0m17:02:47.936626 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m17:02:47.936953 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m17:02:47.937200 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m17:02:47.937618 [info ] [MainThread]:   debug_query_state: False
[0m17:02:47.937865 [info ] [MainThread]:   seed_s3_upload_args: None
[0m17:02:47.938127 [info ] [MainThread]:   lf_tags_database: None
[0m17:02:47.938407 [info ] [MainThread]:   spark_work_group: None
[0m17:02:47.938809 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:02:47.939295 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m17:02:47.939516 [debug] [MainThread]: Using athena connection "debug"
[0m17:02:47.939704 [debug] [MainThread]: On debug: select 1 as id
[0m17:02:47.939870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:02:48.857137 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 4e23fa07-38a5-430f-bd05-8709070aa8e9
[0m17:02:50.610648 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m17:02:50.612322 [debug] [MainThread]: On debug: Close
[0m17:02:50.612818 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:02:50.613274 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:02:50.614629 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.0136735, "process_user_time": 1.346052, "process_kernel_time": 0.229244, "process_mem_max_rss": "144344", "process_out_blocks": "2213", "process_in_blocks": "0"}
[0m17:02:50.615057 [debug] [MainThread]: Command `dbt debug` succeeded at 17:02:50.614956 after 3.01 seconds
[0m17:02:50.615396 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:02:50.616947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96355b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff963888d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff953e7e90>]}
[0m17:02:50.617373 [debug] [MainThread]: Flushing usage events
[0m17:03:06.379343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d1c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91704f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91d4d9d0>]}


============================== 17:03:06.381185 | 663cad39-964f-4c24-a989-af0cf409f954 ==============================
[0m17:03:06.381185 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:03:06.381631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:03:06.609599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '663cad39-964f-4c24-a989-af0cf409f954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fc28510>]}
[0m17:03:06.686732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '663cad39-964f-4c24-a989-af0cf409f954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b735d0>]}
[0m17:03:06.687690 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:03:06.695748 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:03:06.697048 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:03:06.697551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '663cad39-964f-4c24-a989-af0cf409f954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fad7590>]}
[0m17:03:07.377214 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_energy.noaa_bronze' (models/bronze/noaa_bronze.sql) depends on a source named 'climate_bronze.noaa_weather' which was not found
[0m17:03:07.378283 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0194013, "process_user_time": 1.823574, "process_kernel_time": 0.163051, "process_mem_max_rss": "134528", "process_in_blocks": "120", "process_out_blocks": "5", "command_success": false}
[0m17:03:07.378630 [debug] [MainThread]: Command `dbt run` failed at 17:03:07.378555 after 1.02 seconds
[0m17:03:07.378877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9171bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5cced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8faa6090>]}
[0m17:03:07.379132 [debug] [MainThread]: Flushing usage events
[0m17:03:26.834556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb535f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb535f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb535f750>]}


============================== 17:03:26.836871 | 24c9d1fa-3aa9-47d5-b8e5-8b6a5b53427f ==============================
[0m17:03:26.836871 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:03:26.837319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:03:27.073935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24c9d1fa-3aa9-47d5-b8e5-8b6a5b53427f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb452ae10>]}
[0m17:03:27.115594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24c9d1fa-3aa9-47d5-b8e5-8b6a5b53427f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4299a50>]}
[0m17:03:27.116333 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:03:27.120238 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:03:27.120982 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:03:27.121235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24c9d1fa-3aa9-47d5-b8e5-8b6a5b53427f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45060d0>]}
[0m17:03:27.703635 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_energy.noaa_bronze' (models/bronze/noaa_bronze.sql) depends on a source named 'climate_bronze.noaa_weather' which was not found
[0m17:03:27.704555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8920331, "process_user_time": 1.702983, "process_kernel_time": 0.165192, "process_mem_max_rss": "134572", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m17:03:27.704975 [debug] [MainThread]: Command `dbt run` failed at 17:03:27.704865 after 0.89 seconds
[0m17:03:27.705358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb577ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb433cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba6f9650>]}
[0m17:03:27.705753 [debug] [MainThread]: Flushing usage events
[0m17:05:00.385361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9231b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93775990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9230f3d0>]}


============================== 17:05:00.387290 | a113b7b6-1718-4a2f-9e9b-4bf2074c47b9 ==============================
[0m17:05:00.387290 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:05:00.387686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:00.614338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a113b7b6-1718-4a2f-9e9b-4bf2074c47b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912cdc50>]}
[0m17:05:00.653999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a113b7b6-1718-4a2f-9e9b-4bf2074c47b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91328fd0>]}
[0m17:05:00.654459 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:05:00.658353 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:05:00.659073 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:05:00.659360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a113b7b6-1718-4a2f-9e9b-4bf2074c47b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9118e250>]}
[0m17:05:01.265259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a113b7b6-1718-4a2f-9e9b-4bf2074c47b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f20c10>]}
[0m17:05:01.273206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a113b7b6-1718-4a2f-9e9b-4bf2074c47b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9071bdd0>]}
[0m17:05:01.273518 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:05:01.273914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a113b7b6-1718-4a2f-9e9b-4bf2074c47b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f22dd0>]}
[0m17:05:01.275279 [info ] [MainThread]: 
[0m17:05:01.275993 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:05:01.277241 [debug] [ThreadPool]: Acquiring new athena connection 'list_climate_energy'
[0m17:05:01.277538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:02.066177 [debug] [ThreadPool]: On list_climate_energy: Close
[0m17:05:02.068862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_climate_energy, now create_climate_energy_silver)
[0m17:05:02.070570 [debug] [ThreadPool]: Creating schema "database: "climate_energy"
schema: "silver"
"
[0m17:05:02.085854 [debug] [ThreadPool]: Using athena connection "create_climate_energy_silver"
[0m17:05:02.086864 [debug] [ThreadPool]: On create_climate_energy_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_energy", "target_name": "dev", "connection_name": "create_climate_energy_silver"} */
create schema if not exists `climate_energy`.`silver`
  
[0m17:05:02.087485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:54.520155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a861a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ac8a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa172d0>]}


============================== 17:07:54.522215 | 26370a63-72e7-4483-9cac-6c9b181956e8 ==============================
[0m17:07:54.522215 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:07:54.522684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:07:54.693638 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "climate_energy", target "dev" invalid: Runtime Error
    Got duplicate keys: (catalog) all map to "database"
[0m17:07:54.694898 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.19622275, "process_user_time": 1.058168, "process_kernel_time": 0.162025, "process_mem_max_rss": "123524", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m17:07:54.695194 [debug] [MainThread]: Command `dbt run` failed at 17:07:54.695134 after 0.20 seconds
[0m17:07:54.695457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fc85510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa1ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7aa1dd10>]}
[0m17:07:54.695747 [debug] [MainThread]: Flushing usage events
[0m17:08:10.821662 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_energy", "target_name": "dev", "connection_name": "create_climate_energy_silver"} */
create schema if not exists `climate_energy`.`silver`
  
[0m17:08:10.827307 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Error running SQL: macro create_schema
[0m17:08:10.829561 [debug] [ThreadPool]: On create_climate_energy_silver: Close
[0m17:08:10.838257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:10.839223 [debug] [MainThread]: Connection 'create_climate_energy_silver' was properly closed.
[0m17:08:10.840713 [info ] [MainThread]: 
[0m17:08:10.841886 [info ] [MainThread]: Finished running  in 0 hours 3 minutes and 9.56 seconds (189.56s).
[0m17:08:10.844106 [error] [MainThread]: Encountered an error:

[0m17:08:10.848916 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 434, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 450, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 592, in create_schemas
    for create_future in as_completed(create_futures):
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/usr/local/lib/python3.11/threading.py", line 629, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m17:08:10.853600 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 190.5042, "process_user_time": 2.405545, "process_kernel_time": 0.249411, "process_mem_max_rss": "165200", "process_out_blocks": "1930", "command_success": false, "process_in_blocks": "0"}
[0m17:08:10.855427 [debug] [MainThread]: Command `dbt run` failed at 17:08:10.855049 after 190.51 seconds
[0m17:08:10.857548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97551890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97551610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923178d0>]}
[0m17:08:10.858699 [debug] [MainThread]: Flushing usage events
[0m17:09:23.672367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa74cc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa74bac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa74cff90>]}


============================== 17:09:23.674289 | d25d8e8c-3b31-4aff-881d-1edd42354bdf ==============================
[0m17:09:23.674289 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:09:23.675216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:23.909108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd25d8e8c-3b31-4aff-881d-1edd42354bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa631e110>]}
[0m17:09:23.949836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd25d8e8c-3b31-4aff-881d-1edd42354bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6442150>]}
[0m17:09:23.950421 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:09:23.955186 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:09:23.979229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:23.979629 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:23.983165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd25d8e8c-3b31-4aff-881d-1edd42354bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63f9650>]}
[0m17:09:23.991285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd25d8e8c-3b31-4aff-881d-1edd42354bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6227a10>]}
[0m17:09:23.991570 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:09:23.991850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd25d8e8c-3b31-4aff-881d-1edd42354bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa631c110>]}
[0m17:09:23.993176 [info ] [MainThread]: 
[0m17:09:23.993727 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:09:23.994690 [debug] [ThreadPool]: Acquiring new athena connection 'list_climate_energy'
[0m17:09:23.995420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:24.651447 [debug] [ThreadPool]: On list_climate_energy: Close
[0m17:09:24.655436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_climate_energy, now create_climate_energy_silver)
[0m17:09:24.657117 [debug] [ThreadPool]: Creating schema "database: "climate_energy"
schema: "silver"
"
[0m17:09:24.672191 [debug] [ThreadPool]: Using athena connection "create_climate_energy_silver"
[0m17:09:24.672870 [debug] [ThreadPool]: On create_climate_energy_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_energy", "target_name": "dev", "connection_name": "create_climate_energy_silver"} */
create schema if not exists `climate_energy`.`silver`
  
[0m17:09:24.673439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:15.107277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f5b810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993f9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9910ae90>]}


============================== 17:12:15.109716 | 2735fa4f-7928-42c6-823e-c0aa95c30401 ==============================
[0m17:12:15.109716 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:12:15.110093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:12:15.367350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2735fa4f-7928-42c6-823e-c0aa95c30401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981648d0>]}
[0m17:12:15.409561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2735fa4f-7928-42c6-823e-c0aa95c30401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e9c350>]}
[0m17:12:15.410131 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:12:15.414637 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:12:15.436604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:15.436944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:15.440260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2735fa4f-7928-42c6-823e-c0aa95c30401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9816f1d0>]}
[0m17:12:15.448485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2735fa4f-7928-42c6-823e-c0aa95c30401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97fb7810>]}
[0m17:12:15.448804 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:12:15.449092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2735fa4f-7928-42c6-823e-c0aa95c30401', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980c9ad0>]}
[0m17:12:15.450392 [info ] [MainThread]: 
[0m17:12:15.450948 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:12:15.451914 [debug] [ThreadPool]: Acquiring new athena connection 'list_climate_energy'
[0m17:12:15.452220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:16.088273 [debug] [ThreadPool]: On list_climate_energy: Close
[0m17:12:16.092066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_climate_energy, now create_climate_energy_silver)
[0m17:12:16.093646 [debug] [ThreadPool]: Creating schema "database: "climate_energy"
schema: "silver"
"
[0m17:12:16.108611 [debug] [ThreadPool]: Using athena connection "create_climate_energy_silver"
[0m17:12:16.109231 [debug] [ThreadPool]: On create_climate_energy_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_energy", "target_name": "dev", "connection_name": "create_climate_energy_silver"} */
create schema if not exists `climate_energy`.`silver`
  
[0m17:12:16.109821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:33.276078 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_energy", "target_name": "dev", "connection_name": "create_climate_energy_silver"} */
create schema if not exists `climate_energy`.`silver`
  
[0m17:12:33.280582 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Error running SQL: macro create_schema
[0m17:12:33.282196 [debug] [ThreadPool]: On create_climate_energy_silver: Close
[0m17:12:33.287833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:33.288506 [debug] [MainThread]: Connection 'create_climate_energy_silver' was properly closed.
[0m17:12:33.289744 [info ] [MainThread]: 
[0m17:12:33.290655 [info ] [MainThread]: Finished running  in 0 hours 3 minutes and 9.30 seconds (189.30s).
[0m17:12:33.292269 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: Catalog 'climate_energy' does not exist
[0m17:12:33.295255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 189.64867, "process_user_time": 1.634525, "process_kernel_time": 0.212849, "process_mem_max_rss": "152508", "process_out_blocks": "987", "command_success": false, "process_in_blocks": "0"}
[0m17:12:33.296310 [debug] [MainThread]: Command `dbt run` failed at 17:12:33.296122 after 189.65 seconds
[0m17:12:33.297290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa730ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa730e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6f9610>]}
[0m17:12:33.298099 [debug] [MainThread]: Flushing usage events
[0m17:14:08.054609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:08.063242 [debug] [MainThread]: Connection 'create_climate_energy_silver' was left open.
[0m17:14:08.065861 [debug] [MainThread]: On create_climate_energy_silver: Close
[0m17:14:08.068108 [info ] [MainThread]: 
[0m17:14:08.069709 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 52.62 seconds (112.62s).
[0m17:14:08.074435 [error] [MainThread]: Encountered an error:

[0m17:14:08.083779 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 592, in create_schemas
    for create_future in as_completed(create_futures):
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/usr/local/lib/python3.11/threading.py", line 629, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 434, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 450, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 563, in create_schemas
    with dbt.utils.executor(self.config) as tpe:
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 647, in __exit__
    self.shutdown(wait=True)
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 235, in shutdown
    t.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:14:08.093423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 113.0094, "process_user_time": 1.512432, "process_kernel_time": 0.234618, "process_mem_max_rss": "152536", "process_out_blocks": "992", "command_success": false, "process_in_blocks": "0"}
[0m17:14:08.095035 [debug] [MainThread]: Command `dbt run` failed at 17:14:08.094773 after 113.01 seconds
[0m17:14:08.096255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965f1bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99112810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99111f50>]}
[0m17:14:08.097400 [debug] [MainThread]: Flushing usage events
[0m17:14:12.420477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7813dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8230610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7b011d0>]}


============================== 17:14:12.422396 | 0536a6ba-54f5-4315-9296-41c866269e4e ==============================
[0m17:14:12.422396 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:14:12.422901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:14:12.654834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0536a6ba-54f5-4315-9296-41c866269e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68b37d0>]}
[0m17:14:12.694092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0536a6ba-54f5-4315-9296-41c866269e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6891050>]}
[0m17:14:12.694539 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:14:12.699902 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:14:12.708100 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:14:12.708449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0536a6ba-54f5-4315-9296-41c866269e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb654f8d0>]}
[0m17:14:13.346094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0536a6ba-54f5-4315-9296-41c866269e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb63b5dd0>]}
[0m17:14:13.353287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0536a6ba-54f5-4315-9296-41c866269e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb63ed690>]}
[0m17:14:13.353569 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:14:13.353967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0536a6ba-54f5-4315-9296-41c866269e4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb673a3d0>]}
[0m17:14:13.355303 [info ] [MainThread]: 
[0m17:14:13.356061 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:14:13.357420 [debug] [ThreadPool]: Acquiring new athena connection 'list_climate_bronze'
[0m17:14:13.357722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:14.010445 [debug] [ThreadPool]: On list_climate_bronze: Close
[0m17:14:14.014104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_climate_bronze, now create_climate_bronze_silver)
[0m17:14:14.015581 [debug] [ThreadPool]: Creating schema "database: "climate_bronze"
schema: "silver"
"
[0m17:14:14.029329 [debug] [ThreadPool]: Using athena connection "create_climate_bronze_silver"
[0m17:14:14.030048 [debug] [ThreadPool]: On create_climate_bronze_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_energy", "target_name": "dev", "connection_name": "create_climate_bronze_silver"} */
create schema if not exists `climate_bronze`.`silver`
  
[0m17:14:14.030583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:17.290184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0982690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa070fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa070ef10>]}


============================== 17:17:17.292078 | c737affc-7546-48c5-8eb7-75561a5659ac ==============================
[0m17:17:17.292078 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:17:17.292673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:17:17.526194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c737affc-7546-48c5-8eb7-75561a5659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f72bd50>]}
[0m17:17:17.567978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c737affc-7546-48c5-8eb7-75561a5659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa058b250>]}
[0m17:17:17.568574 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:17:17.573904 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:17:17.594836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:17.595624 [debug] [MainThread]: Partial parsing: updated file: climate_energy://models/sources/bronze_sources.yml
[0m17:17:17.775783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c737affc-7546-48c5-8eb7-75561a5659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f324890>]}
[0m17:17:17.782536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c737affc-7546-48c5-8eb7-75561a5659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3d3d90>]}
[0m17:17:17.782835 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:17:17.783081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c737affc-7546-48c5-8eb7-75561a5659ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f489c50>]}
[0m17:17:17.784464 [info ] [MainThread]: 
[0m17:17:17.785371 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:17:17.786572 [debug] [ThreadPool]: Acquiring new athena connection 'list_climate_bronze'
[0m17:17:17.786909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:18.585996 [debug] [ThreadPool]: On list_climate_bronze: Close
[0m17:17:18.589727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_climate_bronze, now create_climate_bronze_silver)
[0m17:17:18.591488 [debug] [ThreadPool]: Creating schema "database: "climate_bronze"
schema: "silver"
"
[0m17:17:18.606002 [debug] [ThreadPool]: Using athena connection "create_climate_bronze_silver"
[0m17:17:18.606678 [debug] [ThreadPool]: On create_climate_bronze_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_energy", "target_name": "dev", "connection_name": "create_climate_bronze_silver"} */
create schema if not exists `climate_bronze`.`silver`
  
[0m17:17:18.607240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:22.686633 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_energy", "target_name": "dev", "connection_name": "create_climate_bronze_silver"} */
create schema if not exists `climate_bronze`.`silver`
  
[0m17:17:22.692496 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Error running SQL: macro create_schema
[0m17:17:22.694102 [debug] [ThreadPool]: On create_climate_bronze_silver: Close
[0m17:17:22.704312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:22.705455 [debug] [MainThread]: Connection 'create_climate_bronze_silver' was properly closed.
[0m17:17:22.708796 [info ] [MainThread]: 
[0m17:17:22.711129 [info ] [MainThread]: Finished running  in 0 hours 3 minutes and 9.35 seconds (189.35s).
[0m17:17:22.719319 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: Catalog 'climate_bronze' does not exist
[0m17:17:22.728585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 190.3327, "process_user_time": 2.197321, "process_kernel_time": 0.239925, "process_mem_max_rss": "164204", "process_out_blocks": "1926", "command_success": false, "process_in_blocks": "0"}
[0m17:17:22.731854 [debug] [MainThread]: Command `dbt run` failed at 17:17:22.730548 after 190.34 seconds
[0m17:17:22.735377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8bed4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7670590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb644ded0>]}
[0m17:17:22.736543 [debug] [MainThread]: Flushing usage events
[0m17:20:27.289651 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_energy", "target_name": "dev", "connection_name": "create_climate_bronze_silver"} */
create schema if not exists `climate_bronze`.`silver`
  
[0m17:20:27.295667 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Error running SQL: macro create_schema
[0m17:20:27.297450 [debug] [ThreadPool]: On create_climate_bronze_silver: Close
[0m17:20:27.316165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:27.317116 [debug] [MainThread]: Connection 'create_climate_bronze_silver' was properly closed.
[0m17:20:27.318716 [info ] [MainThread]: 
[0m17:20:27.319990 [info ] [MainThread]: Finished running  in 0 hours 3 minutes and 9.53 seconds (189.53s).
[0m17:20:27.322396 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: Catalog 'climate_bronze' does not exist
[0m17:20:27.331767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 190.06783, "process_user_time": 1.895467, "process_kernel_time": 0.247058, "process_mem_max_rss": "165708", "process_out_blocks": "1926", "command_success": false, "process_in_blocks": "0"}
[0m17:20:27.333446 [debug] [MainThread]: Command `dbt run` failed at 17:20:27.333173 after 190.07 seconds
[0m17:20:27.340574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5951610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5ce750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb57b90>]}
[0m17:20:27.342227 [debug] [MainThread]: Flushing usage events
[0m17:25:06.688943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9121aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9121bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9120f250>]}


============================== 17:25:06.691610 | e4b968bf-a6e9-493c-805a-60927b21917c ==============================
[0m17:25:06.691610 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:25:06.692440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:25:06.940629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4b968bf-a6e9-493c-805a-60927b21917c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901ef490>]}
[0m17:25:06.980386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4b968bf-a6e9-493c-805a-60927b21917c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901dbb10>]}
[0m17:25:06.980878 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:25:06.986011 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:25:06.997094 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:25:06.997554 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:25:06.997963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4b968bf-a6e9-493c-805a-60927b21917c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91067a10>]}
[0m17:25:07.667624 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_bronze.noaa_bronze' (models/bronze/noaa_bronze.sql) depends on a source named 'climate_bronze.noaa_weather' which was not found
[0m17:25:07.668660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0061027, "process_user_time": 1.879369, "process_kernel_time": 0.166539, "process_mem_max_rss": "134316", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m17:25:07.669056 [debug] [MainThread]: Command `dbt run` failed at 17:25:07.668978 after 1.01 seconds
[0m17:25:07.669303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91067d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd397d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91482610>]}
[0m17:25:07.669535 [debug] [MainThread]: Flushing usage events
[0m17:25:39.374999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f061f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f063b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f060ed0>]}


============================== 17:25:39.377084 | fb6ac02d-55ff-4905-8e69-04fa5fd7a903 ==============================
[0m17:25:39.377084 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:25:39.377603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:25:39.611816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb6ac02d-55ff-4905-8e69-04fa5fd7a903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e25dc50>]}
[0m17:25:39.651562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb6ac02d-55ff-4905-8e69-04fa5fd7a903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f071c50>]}
[0m17:25:39.652043 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:25:39.657061 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:25:39.663978 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:25:39.664362 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:25:39.664692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb6ac02d-55ff-4905-8e69-04fa5fd7a903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7df4f3d0>]}
[0m17:25:40.306576 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_bronze.sensor_bronze' (models/bronze/sensor_bronze.sql) depends on a source named 'climate_bronze.sensor_readings' which was not found
[0m17:25:40.307516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9547726, "process_user_time": 1.76647, "process_kernel_time": 0.161951, "process_mem_max_rss": "134296", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m17:25:40.307844 [debug] [MainThread]: Command `dbt run` failed at 17:25:40.307774 after 0.96 seconds
[0m17:25:40.308120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f501710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e147450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff844b9350>]}
[0m17:25:40.308396 [debug] [MainThread]: Flushing usage events
[0m17:26:36.730632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60cda50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7112110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60b9fd0>]}


============================== 17:26:36.732808 | 1d3730da-619c-4d27-b0d9-e3e811f59481 ==============================
[0m17:26:36.732808 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:26:36.733298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:26:36.973298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d3730da-619c-4d27-b0d9-e3e811f59481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa507dc50>]}
[0m17:26:37.012911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d3730da-619c-4d27-b0d9-e3e811f59481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e25c50>]}
[0m17:26:37.013374 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:26:37.018404 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:26:37.025186 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:26:37.025501 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:26:37.025969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1d3730da-619c-4d27-b0d9-e3e811f59481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e48610>]}
[0m17:26:37.671535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d3730da-619c-4d27-b0d9-e3e811f59481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4cae550>]}
[0m17:26:37.678661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d3730da-619c-4d27-b0d9-e3e811f59481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ea2f90>]}
[0m17:26:37.679227 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:26:37.679746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d3730da-619c-4d27-b0d9-e3e811f59481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa50b8f50>]}
[0m17:26:37.681159 [info ] [MainThread]: 
[0m17:26:37.681922 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:26:37.683070 [debug] [ThreadPool]: Acquiring new athena connection 'list_climate_bronze'
[0m17:26:37.683399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:38.344138 [debug] [ThreadPool]: On list_climate_bronze: Close
[0m17:26:38.347945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_climate_bronze, now create_climate_bronze_silver)
[0m17:26:38.349459 [debug] [ThreadPool]: Creating schema "database: "climate_bronze"
schema: "silver"
"
[0m17:26:38.363460 [debug] [ThreadPool]: Using athena connection "create_climate_bronze_silver"
[0m17:26:38.364099 [debug] [ThreadPool]: On create_climate_bronze_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "connection_name": "create_climate_bronze_silver"} */
create schema if not exists `climate_bronze`.`silver`
  
[0m17:26:38.364625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:08.510487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4651810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4653d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46516d0>]}


============================== 17:29:08.515532 | 1f86f7dd-458b-4c7e-9af8-8365107a363d ==============================
[0m17:29:08.515532 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:29:08.516230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:29:08.516537 [info ] [MainThread]: dbt version: 1.7.9
[0m17:29:08.516883 [info ] [MainThread]: python version: 3.11.14
[0m17:29:08.517210 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:29:08.517499 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m17:29:08.742036 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m17:29:08.742515 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m17:29:08.742826 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m17:29:08.743273 [info ] [MainThread]: adapter type: athena
[0m17:29:08.743536 [info ] [MainThread]: adapter version: 1.7.2
[0m17:29:08.780027 [info ] [MainThread]: Configuration:
[0m17:29:08.780479 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:29:08.780848 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:29:08.781144 [info ] [MainThread]: Required dependencies:
[0m17:29:08.781445 [debug] [MainThread]: Executing "git --help"
[0m17:29:08.789910 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:29:08.790388 [debug] [MainThread]: STDERR: "b''"
[0m17:29:08.790626 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:29:08.790952 [info ] [MainThread]: Connection:
[0m17:29:08.791376 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m17:29:08.791637 [info ] [MainThread]:   work_group: None
[0m17:29:08.791955 [info ] [MainThread]:   region_name: us-east-1
[0m17:29:08.792273 [info ] [MainThread]:   database: climate_bronze
[0m17:29:08.792657 [info ] [MainThread]:   schema: silver
[0m17:29:08.792947 [info ] [MainThread]:   poll_interval: 1.0
[0m17:29:08.793269 [info ] [MainThread]:   aws_profile_name: None
[0m17:29:08.793560 [info ] [MainThread]:   aws_access_key_id: None
[0m17:29:08.793795 [info ] [MainThread]:   aws_secret_access_key: None
[0m17:29:08.794142 [info ] [MainThread]:   aws_session_token: None
[0m17:29:08.794477 [info ] [MainThread]:   endpoint_url: None
[0m17:29:08.794718 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m17:29:08.795044 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m17:29:08.795301 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m17:29:08.795559 [info ] [MainThread]:   debug_query_state: False
[0m17:29:08.796038 [info ] [MainThread]:   seed_s3_upload_args: None
[0m17:29:08.796327 [info ] [MainThread]:   lf_tags_database: None
[0m17:29:08.796593 [info ] [MainThread]:   spark_work_group: None
[0m17:29:08.796898 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:29:08.797438 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m17:29:08.797655 [debug] [MainThread]: Using athena connection "debug"
[0m17:29:08.797819 [debug] [MainThread]: On debug: select 1 as id
[0m17:29:08.798005 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:29:09.520482 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 0886876e-7207-4c0d-a33c-5514cd960c43
[0m17:29:11.300061 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m17:29:11.304734 [debug] [MainThread]: On debug: Close
[0m17:29:11.306490 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:29:11.307772 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:29:11.310587 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.8219063, "process_user_time": 1.276743, "process_kernel_time": 0.296404, "process_mem_max_rss": "144512", "process_out_blocks": "2213", "process_in_blocks": "0"}
[0m17:29:11.311748 [debug] [MainThread]: Command `dbt debug` succeeded at 17:29:11.311507 after 2.82 seconds
[0m17:29:11.312531 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:29:11.315483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3618bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa385b150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa385b890>]}
[0m17:29:11.316393 [debug] [MainThread]: Flushing usage events
[0m17:29:17.295473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95863390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95c04450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95862310>]}


============================== 17:29:17.297105 | 324ac202-f555-452d-905c-1e1709c6b5c3 ==============================
[0m17:29:17.297105 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:29:17.297503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:29:17.522512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '324ac202-f555-452d-905c-1e1709c6b5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a25c50>]}
[0m17:29:17.562920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '324ac202-f555-452d-905c-1e1709c6b5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95891590>]}
[0m17:29:17.563382 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:29:17.569455 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:29:17.596877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m17:29:17.597372 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/openmeteo_bronze.sql
[0m17:29:17.597672 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/sensor_bronze.sql
[0m17:29:17.597914 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/openweather_bronze.sql
[0m17:29:17.598159 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/noaa_bronze.sql
[0m17:29:17.598376 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/eia_bronze.sql
[0m17:29:17.666900 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_bronze.openmeteo_bronze' (models/bronze/openmeteo_bronze.sql) depends on a source named 'climate_bronze.openmeteo_historical' which was not found
[0m17:29:17.667747 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3924743, "process_user_time": 1.224985, "process_kernel_time": 0.1199, "process_mem_max_rss": "131372", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m17:29:17.668050 [debug] [MainThread]: Command `dbt run` failed at 17:29:17.667990 after 0.39 seconds
[0m17:29:17.668308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d05590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a27f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9467ad50>]}
[0m17:29:17.668575 [debug] [MainThread]: Flushing usage events
[0m17:30:27.798711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c60b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c63dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c62a50>]}


============================== 17:30:27.800532 | 3dff0626-b37a-4897-a96d-9e35a06cfa4e ==============================
[0m17:30:27.800532 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:30:27.800934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:30:28.028570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dff0626-b37a-4897-a96d-9e35a06cfa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6ee5290>]}
[0m17:30:28.070181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dff0626-b37a-4897-a96d-9e35a06cfa4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c98cd0>]}
[0m17:30:28.070772 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:30:28.075892 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:30:28.097153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m17:30:28.097716 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/sensor_bronze.sql
[0m17:30:28.098008 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/noaa_bronze.sql
[0m17:30:28.098243 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/eia_bronze.sql
[0m17:30:28.098452 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/openweather_bronze.sql
[0m17:30:28.166403 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_bronze.sensor_bronze' (models/bronze/sensor_bronze.sql) depends on a source named 'climate_bronze.sensor_readings' which was not found
[0m17:30:28.167259 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38880435, "process_user_time": 1.240229, "process_kernel_time": 0.16216, "process_mem_max_rss": "131380", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m17:30:28.167616 [debug] [MainThread]: Command `dbt run` failed at 17:30:28.167551 after 0.39 seconds
[0m17:30:28.167862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a8ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd0d9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6bee310>]}
[0m17:30:28.168156 [debug] [MainThread]: Flushing usage events
[0m17:30:44.534117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af63510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b405750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af636d0>]}


============================== 17:30:44.535816 | 0ebea5d3-d0a4-4783-a97b-7b465d503948 ==============================
[0m17:30:44.535816 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:30:44.536327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:30:44.763300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ebea5d3-d0a4-4783-a97b-7b465d503948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89fe4150>]}
[0m17:30:44.802712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ebea5d3-d0a4-4783-a97b-7b465d503948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a19d250>]}
[0m17:30:44.803196 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:30:44.807413 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:30:44.827896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:30:44.828286 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/noaa_bronze.sql
[0m17:30:44.828551 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/eia_bronze.sql
[0m17:30:44.828832 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/sensor_bronze.sql
[0m17:30:44.892486 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_bronze.noaa_bronze' (models/bronze/noaa_bronze.sql) depends on a source named 'climate_bronze.noaa_weather' which was not found
[0m17:30:44.893295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3789812, "process_user_time": 1.215793, "process_kernel_time": 0.145975, "process_mem_max_rss": "131120", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m17:30:44.893597 [debug] [MainThread]: Command `dbt run` failed at 17:30:44.893540 after 0.38 seconds
[0m17:30:44.893868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90395510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a151310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b11f990>]}
[0m17:30:44.894230 [debug] [MainThread]: Flushing usage events
[0m17:31:03.416368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1f2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad509250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1f2350>]}


============================== 17:31:03.418094 | bd6794ba-29e8-4317-9c13-931b7c2f7f7c ==============================
[0m17:31:03.418094 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:31:03.418479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:03.646546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd6794ba-29e8-4317-9c13-931b7c2f7f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac20afd0>]}
[0m17:31:03.686895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd6794ba-29e8-4317-9c13-931b7c2f7f7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac1f11d0>]}
[0m17:31:03.687434 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:31:03.691617 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:31:03.711615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:31:03.712028 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/sensor_bronze.sql
[0m17:31:03.712264 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/noaa_bronze.sql
[0m17:31:03.777210 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_bronze.sensor_bronze' (models/bronze/sensor_bronze.sql) depends on a source named 'climate_bronze.sensor_readings' which was not found
[0m17:31:03.778036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3822879, "process_user_time": 1.237367, "process_kernel_time": 0.102195, "process_mem_max_rss": "131088", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m17:31:03.778352 [debug] [MainThread]: Command `dbt run` failed at 17:31:03.778289 after 0.38 seconds
[0m17:31:03.778587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2409510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac096c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac11ad50>]}
[0m17:31:03.778835 [debug] [MainThread]: Flushing usage events
[0m17:31:21.812168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df63610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e117210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df63950>]}


============================== 17:31:21.814112 | d2f649cb-43a4-43b5-b8ea-7e05097af10c ==============================
[0m17:31:21.814112 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:31:21.814587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:31:22.044318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2f649cb-43a4-43b5-b8ea-7e05097af10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cff6b50>]}
[0m17:31:22.084953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2f649cb-43a4-43b5-b8ea-7e05097af10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df63650>]}
[0m17:31:22.085538 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:31:22.089793 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:31:22.112288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:31:22.112776 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/bronze/noaa_bronze.sql
[0m17:31:22.174510 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_bronze.noaa_bronze' (models/bronze/noaa_bronze.sql) depends on a source named 'climate_bronze.noaa_weather' which was not found
[0m17:31:22.175323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3846409, "process_user_time": 1.265548, "process_kernel_time": 0.154555, "process_mem_max_rss": "131232", "process_out_blocks": "4", "command_success": false, "process_in_blocks": "0"}
[0m17:31:22.175663 [debug] [MainThread]: Command `dbt run` failed at 17:31:22.175593 after 0.39 seconds
[0m17:31:22.175907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3375510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccd9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd4ad50>]}
[0m17:31:22.176139 [debug] [MainThread]: Flushing usage events
[0m17:31:43.241843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac34290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1ed250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b101250>]}


============================== 17:31:43.243602 | 507d7a17-b562-4f16-8784-68bee61d4e78 ==============================
[0m17:31:43.243602 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:31:43.244142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:31:43.482597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '507d7a17-b562-4f16-8784-68bee61d4e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d3d090>]}
[0m17:31:43.523935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '507d7a17-b562-4f16-8784-68bee61d4e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae1e850>]}
[0m17:31:43.524511 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:31:43.528774 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:31:43.549813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:31:43.550324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:31:43.555175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '507d7a17-b562-4f16-8784-68bee61d4e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d24cd0>]}
[0m17:31:43.563835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '507d7a17-b562-4f16-8784-68bee61d4e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99bd1ed0>]}
[0m17:31:43.564138 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:31:43.564415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '507d7a17-b562-4f16-8784-68bee61d4e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e49390>]}
[0m17:31:43.565737 [info ] [MainThread]: 
[0m17:31:43.566331 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:31:43.567238 [debug] [ThreadPool]: Acquiring new athena connection 'list_climate_bronze'
[0m17:31:43.567521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:44.250434 [debug] [ThreadPool]: On list_climate_bronze: Close
[0m17:31:44.254062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_climate_bronze, now create_climate_bronze_silver)
[0m17:31:44.256166 [debug] [ThreadPool]: Creating schema "database: "climate_bronze"
schema: "silver"
"
[0m17:31:44.270613 [debug] [ThreadPool]: Using athena connection "create_climate_bronze_silver"
[0m17:31:44.271291 [debug] [ThreadPool]: On create_climate_bronze_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "connection_name": "create_climate_bronze_silver"} */
create schema if not exists `climate_bronze`.`silver`
  
[0m17:31:44.271887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:09.249112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f17850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f17650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f17c50>]}


============================== 17:34:09.251076 | 57a5b3ea-4f33-4380-b18b-0f7b01fd6b74 ==============================
[0m17:34:09.251076 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:34:09.251512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:09.251900 [info ] [MainThread]: dbt version: 1.7.9
[0m17:34:09.252235 [info ] [MainThread]: python version: 3.11.14
[0m17:34:09.252530 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:34:09.252817 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m17:34:09.452313 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m17:34:09.452829 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m17:34:09.453213 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m17:34:09.453607 [info ] [MainThread]: adapter type: athena
[0m17:34:09.453871 [info ] [MainThread]: adapter version: 1.7.2
[0m17:34:09.490664 [info ] [MainThread]: Configuration:
[0m17:34:09.491148 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:34:09.491456 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:34:09.491753 [info ] [MainThread]: Required dependencies:
[0m17:34:09.492080 [debug] [MainThread]: Executing "git --help"
[0m17:34:09.493895 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:34:09.494172 [debug] [MainThread]: STDERR: "b''"
[0m17:34:09.494353 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:34:09.494584 [info ] [MainThread]: Connection:
[0m17:34:09.494946 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m17:34:09.495261 [info ] [MainThread]:   work_group: None
[0m17:34:09.495531 [info ] [MainThread]:   region_name: us-east-1
[0m17:34:09.495837 [info ] [MainThread]:   database: AwsDataCatalog
[0m17:34:09.496138 [info ] [MainThread]:   schema: climate_bronze
[0m17:34:09.496500 [info ] [MainThread]:   poll_interval: 1.0
[0m17:34:09.496887 [info ] [MainThread]:   aws_profile_name: None
[0m17:34:09.497282 [info ] [MainThread]:   aws_access_key_id: None
[0m17:34:09.497534 [info ] [MainThread]:   aws_secret_access_key: None
[0m17:34:09.497939 [info ] [MainThread]:   aws_session_token: None
[0m17:34:09.498201 [info ] [MainThread]:   endpoint_url: None
[0m17:34:09.498507 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m17:34:09.498816 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m17:34:09.499142 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m17:34:09.499425 [info ] [MainThread]:   debug_query_state: False
[0m17:34:09.499711 [info ] [MainThread]:   seed_s3_upload_args: None
[0m17:34:09.500061 [info ] [MainThread]:   lf_tags_database: None
[0m17:34:09.500347 [info ] [MainThread]:   spark_work_group: None
[0m17:34:09.500684 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:34:09.501204 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m17:34:09.501427 [debug] [MainThread]: Using athena connection "debug"
[0m17:34:09.501603 [debug] [MainThread]: On debug: select 1 as id
[0m17:34:09.501773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:10.104741 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID f56f54e7-a667-413c-8d56-e5a23257b6c3
[0m17:34:11.828012 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m17:34:11.831257 [debug] [MainThread]: On debug: Close
[0m17:34:11.832166 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:34:11.832978 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:34:11.834907 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.608099, "process_user_time": 1.218092, "process_kernel_time": 0.230775, "process_mem_max_rss": "143884", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m17:34:11.835752 [debug] [MainThread]: Command `dbt debug` succeeded at 17:34:11.835613 after 2.61 seconds
[0m17:34:11.836314 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:34:11.838268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8490f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f3cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82cabd10>]}
[0m17:34:11.838882 [debug] [MainThread]: Flushing usage events
[0m17:34:24.023911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4cb6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4cb6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4cb6d50>]}


============================== 17:34:24.025890 | b586543e-fe8e-4a95-85ba-77dfd2975cc2 ==============================
[0m17:34:24.025890 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:34:24.026424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:34:24.255183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b63f10>]}
[0m17:34:24.295011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3cb9310>]}
[0m17:34:24.295488 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:34:24.301764 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:34:24.310280 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:34:24.310790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3be0dd0>]}
[0m17:34:24.944043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a61b10>]}
[0m17:34:24.951210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa386e810>]}
[0m17:34:24.951486 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:34:24.951766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38af1d0>]}
[0m17:34:24.953132 [info ] [MainThread]: 
[0m17:34:24.953863 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:34:24.954931 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:34:24.955271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:25.615946 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:34:25.621212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_climate_bronze)
[0m17:34:25.622387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:27.040093 [debug] [ThreadPool]: On list_AwsDataCatalog_climate_bronze: Close
[0m17:34:27.044716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09a2090>]}
[0m17:34:27.046219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:34:27.047193 [info ] [MainThread]: 
[0m17:34:27.052130 [debug] [Thread-1 (]: Began running node model.climate_bronze.eia_bronze
[0m17:34:27.053000 [info ] [Thread-1 (]: 1 of 10 START sql view model climate_bronze.eia_bronze ......................... [RUN]
[0m17:34:27.054335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_climate_bronze, now model.climate_bronze.eia_bronze)
[0m17:34:27.055049 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.eia_bronze
[0m17:34:27.063689 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.eia_bronze"
[0m17:34:27.068094 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_bronze (compile): 17:34:27.055571 => 17:34:27.067848
[0m17:34:27.068641 [debug] [Thread-1 (]: Began executing node model.climate_bronze.eia_bronze
[0m17:34:27.092489 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.eia_bronze"
[0m17:34:27.094945 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.eia_bronze"
[0m17:34:27.095274 [debug] [Thread-1 (]: On model.climate_bronze.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."eia_energy"

[0m17:34:27.095595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:27.666334 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID fa3c368a-7a12-43a3-9664-0caca2cf2c14
[0m17:34:29.351285 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:34:30.653146 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m17:34:30.660630 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m17:34:30.669817 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_bronze (execute): 17:34:27.068992 => 17:34:30.669664
[0m17:34:30.672309 [debug] [Thread-1 (]: On model.climate_bronze.eia_bronze: Close
[0m17:34:30.676542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d96bd0>]}
[0m17:34:30.678399 [info ] [Thread-1 (]: 1 of 10 OK created sql view model climate_bronze.eia_bronze .................... [[32mOK -1[0m in 3.62s]
[0m17:34:30.681450 [debug] [Thread-1 (]: Finished running node model.climate_bronze.eia_bronze
[0m17:34:30.683271 [debug] [Thread-1 (]: Began running node model.climate_bronze.noaa_bronze
[0m17:34:30.729779 [info ] [Thread-1 (]: 2 of 10 START sql view model climate_bronze.noaa_bronze ........................ [RUN]
[0m17:34:30.738937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.eia_bronze, now model.climate_bronze.noaa_bronze)
[0m17:34:30.742149 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.noaa_bronze
[0m17:34:30.751355 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.noaa_bronze"
[0m17:34:30.755431 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_bronze (compile): 17:34:30.744144 => 17:34:30.755062
[0m17:34:30.756069 [debug] [Thread-1 (]: Began executing node model.climate_bronze.noaa_bronze
[0m17:34:30.761374 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.noaa_bronze"
[0m17:34:30.762998 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.noaa_bronze"
[0m17:34:30.763458 [debug] [Thread-1 (]: On model.climate_bronze.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."climate_bronze"."noaa_weather"

[0m17:34:30.763778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:31.493725 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 45b92584-12c3-4181-a337-d583d592bc21
[0m17:34:39.008317 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f54bbee7-b8e7-4ec7-8f4f-8eff085188f9
[0m17:34:52.502967 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID fafcd792-7841-4c63-bd3a-2848e4bb4e67
[0m17:34:52.873053 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "connection_name": "create_climate_bronze_silver"} */
create schema if not exists `climate_bronze`.`silver`
  
[0m17:34:52.876399 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Error running SQL: macro create_schema
[0m17:34:52.878220 [debug] [ThreadPool]: On create_climate_bronze_silver: Close
[0m17:34:52.885032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:52.885759 [debug] [MainThread]: Connection 'create_climate_bronze_silver' was properly closed.
[0m17:34:52.887073 [info ] [MainThread]: 
[0m17:34:52.888152 [info ] [MainThread]: Finished running  in 0 hours 3 minutes and 9.32 seconds (189.32s).
[0m17:34:52.890050 [error] [MainThread]: Encountered an error:
Runtime Error
  Runtime Error
    An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: Catalog 'climate_bronze' does not exist
[0m17:34:52.892867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 189.6778, "process_user_time": 1.579905, "process_kernel_time": 0.239744, "process_mem_max_rss": "152524", "process_out_blocks": "988", "command_success": false, "process_in_blocks": "0"}
[0m17:34:52.893865 [debug] [MainThread]: Command `dbt run` failed at 17:34:52.893713 after 189.68 seconds
[0m17:34:52.894974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b101290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e22d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0099350>]}
[0m17:34:52.895803 [debug] [MainThread]: Flushing usage events
[0m17:35:17.979942 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 277f8d9c-75c4-4c85-a9c2-999ca457546d
[0m17:36:07.907061 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 014feead-a992-4cd1-8e27-eb8acf64841e
[0m17:37:45.876486 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9ee716fc-0b3a-442f-b3ba-62bbca3fdca7
[0m17:37:47.268084 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."climate_bronze"."noaa_weather"

[0m17:37:47.271171 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_bronze (execute): 17:34:30.756355 => 17:37:47.270383
[0m17:37:47.272746 [debug] [Thread-1 (]: On model.climate_bronze.noaa_bronze: Close
[0m17:37:47.292999 [debug] [Thread-1 (]: Runtime Error in model noaa_bronze (models/bronze/noaa_bronze.sql)
  line 9:3: Column 'datatype' cannot be resolved
[0m17:37:47.294774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3cca410>]}
[0m17:37:47.296829 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model climate_bronze.noaa_bronze ............... [[31mERROR[0m in 196.56s]
[0m17:37:47.297969 [debug] [Thread-1 (]: Finished running node model.climate_bronze.noaa_bronze
[0m17:37:47.298791 [debug] [Thread-1 (]: Began running node model.climate_bronze.openmeteo_bronze
[0m17:37:47.302099 [info ] [Thread-1 (]: 3 of 10 START sql view model climate_bronze.openmeteo_bronze ................... [RUN]
[0m17:37:47.303158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.noaa_bronze, now model.climate_bronze.openmeteo_bronze)
[0m17:37:47.303649 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openmeteo_bronze
[0m17:37:47.310960 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openmeteo_bronze"
[0m17:37:47.312611 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_bronze (compile): 17:37:47.304002 => 17:37:47.312464
[0m17:37:47.312901 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openmeteo_bronze
[0m17:37:47.316343 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openmeteo_bronze"
[0m17:37:47.317434 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_bronze"
[0m17:37:47.317888 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."openmeteo_historical"

[0m17:37:47.318255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:47.929617 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8162018d-e49a-47bc-8b57-c157843018c8
[0m17:37:49.631135 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:37:51.030829 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m17:37:51.032784 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m17:37:51.034650 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_bronze (execute): 17:37:47.313099 => 17:37:51.034399
[0m17:37:51.035162 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_bronze: Close
[0m17:37:51.036086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3811a10>]}
[0m17:37:51.036862 [info ] [Thread-1 (]: 3 of 10 OK created sql view model climate_bronze.openmeteo_bronze .............. [[32mOK -1[0m in 3.73s]
[0m17:37:51.037773 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openmeteo_bronze
[0m17:37:51.038352 [debug] [Thread-1 (]: Began running node model.climate_bronze.openweather_bronze
[0m17:37:51.039103 [info ] [Thread-1 (]: 4 of 10 START sql view model climate_bronze.openweather_bronze ................. [RUN]
[0m17:37:51.041047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openmeteo_bronze, now model.climate_bronze.openweather_bronze)
[0m17:37:51.041558 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openweather_bronze
[0m17:37:51.044668 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openweather_bronze"
[0m17:37:51.045977 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_bronze (compile): 17:37:51.041872 => 17:37:51.045801
[0m17:37:51.046336 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openweather_bronze
[0m17:37:51.049158 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openweather_bronze"
[0m17:37:51.050180 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_bronze"
[0m17:37:51.050587 [debug] [Thread-1 (]: On model.climate_bronze.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."openweather_monthly"

[0m17:37:51.050943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:51.766163 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b33cc5f0-a9c2-4ff9-8653-b4981d55ec9d
[0m17:37:53.465278 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:37:54.721149 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m17:37:54.726592 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m17:37:54.729510 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_bronze (execute): 17:37:51.046597 => 17:37:54.729125
[0m17:37:54.730568 [debug] [Thread-1 (]: On model.climate_bronze.openweather_bronze: Close
[0m17:37:54.732190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf94650>]}
[0m17:37:54.733385 [info ] [Thread-1 (]: 4 of 10 OK created sql view model climate_bronze.openweather_bronze ............ [[32mOK -1[0m in 3.69s]
[0m17:37:54.734810 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openweather_bronze
[0m17:37:54.735711 [debug] [Thread-1 (]: Began running node model.climate_bronze.sensor_bronze
[0m17:37:54.736914 [info ] [Thread-1 (]: 5 of 10 START sql view model climate_bronze.sensor_bronze ...................... [RUN]
[0m17:37:54.739668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openweather_bronze, now model.climate_bronze.sensor_bronze)
[0m17:37:54.740332 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.sensor_bronze
[0m17:37:54.744552 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.sensor_bronze"
[0m17:37:54.746431 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_bronze (compile): 17:37:54.740798 => 17:37:54.746153
[0m17:37:54.747006 [debug] [Thread-1 (]: Began executing node model.climate_bronze.sensor_bronze
[0m17:37:54.751026 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.sensor_bronze"
[0m17:37:54.752583 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_bronze"
[0m17:37:54.753112 [debug] [Thread-1 (]: On model.climate_bronze.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."sensor_readings"

[0m17:37:54.753636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:55.354533 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6cbca755-bac7-410a-95d5-133ad6919e47
[0m17:37:57.087171 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:37:58.449981 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m17:37:58.454487 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m17:37:58.458072 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_bronze (execute): 17:37:54.747404 => 17:37:58.457681
[0m17:37:58.458939 [debug] [Thread-1 (]: On model.climate_bronze.sensor_bronze: Close
[0m17:37:58.460757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0dfc310>]}
[0m17:37:58.462167 [info ] [Thread-1 (]: 5 of 10 OK created sql view model climate_bronze.sensor_bronze ................. [[32mOK -1[0m in 3.72s]
[0m17:37:58.463648 [debug] [Thread-1 (]: Finished running node model.climate_bronze.sensor_bronze
[0m17:37:58.464499 [debug] [Thread-1 (]: Began running node model.climate_bronze.eia_silver
[0m17:37:58.465521 [info ] [Thread-1 (]: 6 of 10 START sql table model climate_bronze.eia_silver ........................ [RUN]
[0m17:37:58.468439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.sensor_bronze, now model.climate_bronze.eia_silver)
[0m17:37:58.469115 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.eia_silver
[0m17:37:58.474260 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.eia_silver"
[0m17:37:58.479248 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_silver (compile): 17:37:58.469721 => 17:37:58.478968
[0m17:37:58.479938 [debug] [Thread-1 (]: Began executing node model.climate_bronze.eia_silver
[0m17:37:58.535030 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:37:58.536169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:59.213462 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:37:59.216068 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.eia_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/eia_silver/17f2230d-b369-4c6a-9d11-695045d54887',
      format='parquet'
    )
    as
      select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."eia_bronze"
qualify row_number() over (
  partition by state, observation_date
  order by ingestion_timestamp desc
) = 1
[0m17:41:07.426846 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_silver (execute): 17:37:58.480335 => 17:41:07.419726
[0m17:41:07.433868 [debug] [Thread-1 (]: On model.climate_bronze.eia_silver: Close
[0m17:41:07.441632 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 17:9: mismatched input 'row_number'. Expecting: '(', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', 'WITH', <EOF>
[0m17:41:07.451658 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/pyathena/common.py", line 651, in _execute
    query_id = retry_api_call(
               ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pyathena/util.py", line 196, in retry_api_call
    return retry(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/botocore/client.py", line 602, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/botocore/client.py", line 1078, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 17:9: mismatched input 'row_number'. Expecting: '(', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', 'WITH', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 158, in inner
    query_id = self._execute(
               ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pyathena/common.py", line 659, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 17:9: mismatched input 'row_number'. Expecting: '(', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', 'WITH', <EOF>

[0m17:41:07.455177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09afe10>]}
[0m17:41:07.464363 [error] [Thread-1 (]: 6 of 10 ERROR creating sql table model climate_bronze.eia_silver ............... [[31mERROR[0m in 188.99s]
[0m17:41:07.466541 [debug] [Thread-1 (]: Finished running node model.climate_bronze.eia_silver
[0m17:41:07.467786 [debug] [Thread-1 (]: Began running node model.climate_bronze.noaa_silver
[0m17:41:07.474056 [info ] [Thread-1 (]: 7 of 10 SKIP relation climate_bronze.noaa_silver ............................... [[33mSKIP[0m]
[0m17:41:07.475460 [debug] [Thread-1 (]: Finished running node model.climate_bronze.noaa_silver
[0m17:41:07.478554 [debug] [Thread-1 (]: Began running node model.climate_bronze.openmeteo_silver
[0m17:41:07.479382 [info ] [Thread-1 (]: 8 of 10 START sql table model climate_bronze.openmeteo_silver .................. [RUN]
[0m17:41:07.480606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.eia_silver, now model.climate_bronze.openmeteo_silver)
[0m17:41:07.481084 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openmeteo_silver
[0m17:41:07.514810 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openmeteo_silver"
[0m17:41:07.530369 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_silver (compile): 17:41:07.481322 => 17:41:07.529519
[0m17:41:07.538491 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openmeteo_silver
[0m17:41:07.542220 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:41:07.543040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:08.375554 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:41:08.377336 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/openmeteo_silver/d07a13c6-eef5-4482-8ddb-bc75dda39b52',
      format='parquet'
    )
    as
      select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."openmeteo_bronze"
[0m17:41:08.946176 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 084e2959-926d-43bf-bf9b-698a46c32e13
[0m17:41:10.612497 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":41054}
[0m17:41:10.619794 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_silver"
[0m17:41:10.620466 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: alter table `AwsDataCatalog`.`climate_bronze`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m17:41:10.901706 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 03d2df9b-ff15-45ac-87e8-f5c2b7740627
[0m17:41:12.577457 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:41:12.584899 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openmeteo_silver"
[0m17:41:12.590400 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_silver"
[0m17:41:12.591155 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":41054}';
[0m17:41:12.810862 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 429cd8cd-fa44-4de2-b23a-88d89e946dcc
[0m17:41:14.505224 [debug] [Thread-1 (]: SQL status: OK 4447 in 2.0 seconds
[0m17:41:14.516148 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_silver (execute): 17:41:07.538831 => 17:41:14.513923
[0m17:41:14.517530 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: Close
[0m17:41:14.520523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b37d690>]}
[0m17:41:14.523041 [info ] [Thread-1 (]: 8 of 10 OK created sql table model climate_bronze.openmeteo_silver ............. [[32mOK 4447[0m in 7.04s]
[0m17:41:14.524836 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openmeteo_silver
[0m17:41:14.526044 [debug] [Thread-1 (]: Began running node model.climate_bronze.openweather_silver
[0m17:41:14.527610 [info ] [Thread-1 (]: 9 of 10 START sql table model climate_bronze.openweather_silver ................ [RUN]
[0m17:41:14.532578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openmeteo_silver, now model.climate_bronze.openweather_silver)
[0m17:41:14.533611 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openweather_silver
[0m17:41:14.541992 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openweather_silver"
[0m17:41:14.543975 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_silver (compile): 17:41:14.534019 => 17:41:14.543752
[0m17:41:14.544418 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openweather_silver
[0m17:41:14.548277 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:41:14.548881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:15.158277 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:41:15.159889 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/openweather_silver/f5c32c72-5277-4400-af5c-324a42c86bff',
      format='parquet'
    )
    as
      select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."openweather_bronze"
[0m17:41:15.765945 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 893a1109-914c-4a1e-b29e-50c277643f5c
[0m17:41:18.587259 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1589}
[0m17:41:18.590329 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_silver"
[0m17:41:18.591752 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: alter table `AwsDataCatalog`.`climate_bronze`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m17:41:18.855351 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 923e6aa5-cbc2-4b3c-a834-7ae10ed98db7
[0m17:41:20.515130 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:41:20.520509 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openweather_silver"
[0m17:41:20.524227 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_silver"
[0m17:41:20.525324 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1589}';
[0m17:41:20.721429 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ad561497-41f7-4a73-9ca8-3d73b9b7cb7a
[0m17:41:22.460122 [debug] [Thread-1 (]: SQL status: OK 63 in 2.0 seconds
[0m17:41:22.469242 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_silver (execute): 17:41:14.544707 => 17:41:22.468825
[0m17:41:22.470653 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: Close
[0m17:41:22.472532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9adcd9d0>]}
[0m17:41:22.473785 [info ] [Thread-1 (]: 9 of 10 OK created sql table model climate_bronze.openweather_silver ........... [[32mOK 63[0m in 7.94s]
[0m17:41:22.475331 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openweather_silver
[0m17:41:22.476391 [debug] [Thread-1 (]: Began running node model.climate_bronze.sensor_silver
[0m17:41:22.477378 [info ] [Thread-1 (]: 10 of 10 START sql table model climate_bronze.sensor_silver .................... [RUN]
[0m17:41:22.480637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openweather_silver, now model.climate_bronze.sensor_silver)
[0m17:41:22.481298 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.sensor_silver
[0m17:41:22.486050 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.sensor_silver"
[0m17:41:22.488132 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_silver (compile): 17:41:22.481798 => 17:41:22.487866
[0m17:41:22.488707 [debug] [Thread-1 (]: Began executing node model.climate_bronze.sensor_silver
[0m17:41:22.492970 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:41:22.493692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:23.197726 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:41:23.200163 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/sensor_silver/a9e1a4ec-c412-4333-9c5e-b81eda3ff921',
      format='parquet'
    )
    as
      select
    location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."sensor_bronze"
[0m17:41:23.771418 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 658f4505-5948-47af-9807-c380c28ae6d0
[0m17:41:25.462910 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":1145,"data_scanned_in_bytes":13364}
[0m17:41:25.466092 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_silver"
[0m17:41:25.467452 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: alter table `AwsDataCatalog`.`climate_bronze`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m17:41:25.743093 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0cb96b98-a7b4-4318-9ed7-9d98bfae736a
[0m17:41:27.440940 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:41:27.446672 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.sensor_silver"
[0m17:41:27.450137 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_silver"
[0m17:41:27.450974 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_silver"} */
SELECT '{"rowcount":1145,"data_scanned_in_bytes":13364}';
[0m17:41:27.679616 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4801093d-ee8f-42f4-a904-57a09e21ed0d
[0m17:41:29.410622 [debug] [Thread-1 (]: SQL status: OK 1145 in 2.0 seconds
[0m17:41:29.418356 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_silver (execute): 17:41:22.489057 => 17:41:29.417274
[0m17:41:29.419804 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: Close
[0m17:41:29.422371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b586543e-fe8e-4a95-85ba-77dfd2975cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ae0510>]}
[0m17:41:29.424335 [info ] [Thread-1 (]: 10 of 10 OK created sql table model climate_bronze.sensor_silver ............... [[32mOK 1145[0m in 6.94s]
[0m17:41:29.426060 [debug] [Thread-1 (]: Finished running node model.climate_bronze.sensor_silver
[0m17:41:29.431113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:29.431800 [debug] [MainThread]: Connection 'model.climate_bronze.sensor_silver' was properly closed.
[0m17:41:29.434369 [info ] [MainThread]: 
[0m17:41:29.435239 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 7 minutes and 4.48 seconds (424.48s).
[0m17:41:29.437671 [debug] [MainThread]: Command end result
[0m17:41:29.458284 [info ] [MainThread]: 
[0m17:41:29.459265 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:41:29.462273 [info ] [MainThread]: 
[0m17:41:29.462819 [error] [MainThread]:   Runtime Error in model noaa_bronze (models/bronze/noaa_bronze.sql)
  line 9:3: Column 'datatype' cannot be resolved
[0m17:41:29.463858 [info ] [MainThread]: 
[0m17:41:29.464336 [error] [MainThread]:   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 17:9: mismatched input 'row_number'. Expecting: '(', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', 'WITH', <EOF>
[0m17:41:29.465097 [info ] [MainThread]: 
[0m17:41:29.465628 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=1 TOTAL=10
[0m17:41:29.468109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 425.47736, "process_user_time": 5.395076, "process_kernel_time": 0.648698, "process_mem_max_rss": "194160", "process_out_blocks": "2981", "command_success": false, "process_in_blocks": "0"}
[0m17:41:29.468765 [debug] [MainThread]: Command `dbt run` failed at 17:41:29.468642 after 425.48 seconds
[0m17:41:29.469303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ef94d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ef9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa040e790>]}
[0m17:41:29.469702 [debug] [MainThread]: Flushing usage events
[0m17:41:47.539140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824ba490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827d1410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827d16d0>]}


============================== 17:41:47.542030 | c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0 ==============================
[0m17:41:47.542030 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:41:47.542472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'True', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:41:47.776182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814ccfd0>]}
[0m17:41:47.818903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8221e850>]}
[0m17:41:47.819705 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:41:47.824809 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:41:47.848418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:41:47.848825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:41:47.852431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812e52d0>]}
[0m17:41:47.864820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81342a10>]}
[0m17:41:47.865258 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:41:47.865687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff814cdf10>]}
[0m17:41:47.867157 [info ] [MainThread]: 
[0m17:41:47.867990 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:41:47.869223 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:41:47.869620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:48.521662 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:41:48.526880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_climate_bronze)
[0m17:41:48.528194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:49.934863 [debug] [ThreadPool]: On list_AwsDataCatalog_climate_bronze: Close
[0m17:41:49.940966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8139b950>]}
[0m17:41:49.944056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:49.944780 [info ] [MainThread]: 
[0m17:41:49.947393 [debug] [Thread-1 (]: Began running node model.climate_bronze.eia_bronze
[0m17:41:49.948116 [info ] [Thread-1 (]: 1 of 10 START sql view model climate_bronze.eia_bronze ......................... [RUN]
[0m17:41:49.949143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_climate_bronze, now model.climate_bronze.eia_bronze)
[0m17:41:49.949646 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.eia_bronze
[0m17:41:49.961225 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.eia_bronze"
[0m17:41:49.969809 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_bronze (compile): 17:41:49.949975 => 17:41:49.969498
[0m17:41:49.972276 [debug] [Thread-1 (]: Began executing node model.climate_bronze.eia_bronze
[0m17:41:50.002156 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.eia_bronze"
[0m17:41:50.004321 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.eia_bronze"
[0m17:41:50.004762 [debug] [Thread-1 (]: On model.climate_bronze.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."eia_energy"

[0m17:41:50.005124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:50.638395 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4222b8c2-17ef-435d-bde0-f3222b947418
[0m17:41:52.418593 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:41:53.826909 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m17:41:53.834165 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m17:41:53.844652 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_bronze (execute): 17:41:49.974006 => 17:41:53.844335
[0m17:41:53.845737 [debug] [Thread-1 (]: On model.climate_bronze.eia_bronze: Close
[0m17:41:53.847500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb1c0d0>]}
[0m17:41:53.848784 [info ] [Thread-1 (]: 1 of 10 OK created sql view model climate_bronze.eia_bronze .................... [[32mOK -1[0m in 3.90s]
[0m17:41:53.850022 [debug] [Thread-1 (]: Finished running node model.climate_bronze.eia_bronze
[0m17:41:53.851011 [debug] [Thread-1 (]: Began running node model.climate_bronze.noaa_bronze
[0m17:41:53.852745 [info ] [Thread-1 (]: 2 of 10 START sql view model climate_bronze.noaa_bronze ........................ [RUN]
[0m17:41:53.855961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.eia_bronze, now model.climate_bronze.noaa_bronze)
[0m17:41:53.856814 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.noaa_bronze
[0m17:41:53.861795 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.noaa_bronze"
[0m17:41:53.864846 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_bronze (compile): 17:41:53.857470 => 17:41:53.864536
[0m17:41:53.865560 [debug] [Thread-1 (]: Began executing node model.climate_bronze.noaa_bronze
[0m17:41:53.869296 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.noaa_bronze"
[0m17:41:53.872505 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.noaa_bronze"
[0m17:41:53.873177 [debug] [Thread-1 (]: On model.climate_bronze.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."climate_bronze"."noaa_weather"

[0m17:41:53.874092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:54.504244 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 418d3734-889f-4329-b0d1-69c30ce169f6
[0m17:42:02.079845 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 70a4474d-fd68-41bf-a9b4-31fa20e801e0
[0m17:42:15.596288 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4901363e-4cb2-46bd-ab3a-8b4ae479b0f2
[0m17:42:41.118726 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6eba3c45-b293-4fde-8e44-1da034cb7ff3
[0m17:43:31.098879 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9bd8e789-2a47-4a97-afb5-f9621d2230d5
[0m17:53:23.693298 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 704f3637-b001-4b09-86bb-39eb4778ccbe
[0m17:53:25.017558 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."climate_bronze"."noaa_weather"

[0m17:53:25.021184 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_bronze (execute): 17:41:53.866091 => 17:53:25.020093
[0m17:53:25.023357 [debug] [Thread-1 (]: On model.climate_bronze.noaa_bronze: Close
[0m17:53:25.040671 [debug] [Thread-1 (]: Runtime Error in model noaa_bronze (models/bronze/noaa_bronze.sql)
  line 9:3: Column 'datatype' cannot be resolved
[0m17:53:25.043322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff810b1410>]}
[0m17:53:25.046766 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model climate_bronze.noaa_bronze ............... [[31mERROR[0m in 691.19s]
[0m17:53:25.047696 [debug] [Thread-1 (]: Finished running node model.climate_bronze.noaa_bronze
[0m17:53:25.049129 [debug] [Thread-1 (]: Began running node model.climate_bronze.openmeteo_bronze
[0m17:53:25.053523 [info ] [Thread-1 (]: 3 of 10 START sql view model climate_bronze.openmeteo_bronze ................... [RUN]
[0m17:53:25.054656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.noaa_bronze, now model.climate_bronze.openmeteo_bronze)
[0m17:53:25.055314 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openmeteo_bronze
[0m17:53:25.065859 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openmeteo_bronze"
[0m17:53:25.068506 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_bronze (compile): 17:53:25.055711 => 17:53:25.068352
[0m17:53:25.068840 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openmeteo_bronze
[0m17:53:25.072179 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openmeteo_bronze"
[0m17:53:25.073496 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_bronze"
[0m17:53:25.073864 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."openmeteo_historical"

[0m17:53:25.074278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:25.723346 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e5a5c5da-85d1-4bbc-b88b-ba934b5febf6
[0m17:53:27.584337 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m17:53:29.232058 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m17:53:29.237417 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m17:53:29.240236 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_bronze (execute): 17:53:25.069133 => 17:53:29.239908
[0m17:53:29.241129 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_bronze: Close
[0m17:53:29.242649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80215890>]}
[0m17:53:29.243919 [info ] [Thread-1 (]: 3 of 10 OK created sql view model climate_bronze.openmeteo_bronze .............. [[32mOK -1[0m in 4.19s]
[0m17:53:29.245002 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openmeteo_bronze
[0m17:53:29.245901 [debug] [Thread-1 (]: Began running node model.climate_bronze.openweather_bronze
[0m17:53:29.247072 [info ] [Thread-1 (]: 4 of 10 START sql view model climate_bronze.openweather_bronze ................. [RUN]
[0m17:53:29.249706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openmeteo_bronze, now model.climate_bronze.openweather_bronze)
[0m17:53:29.250371 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openweather_bronze
[0m17:53:29.254736 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openweather_bronze"
[0m17:53:29.256899 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_bronze (compile): 17:53:29.250883 => 17:53:29.256603
[0m17:53:29.257619 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openweather_bronze
[0m17:53:29.261599 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openweather_bronze"
[0m17:53:29.263029 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_bronze"
[0m17:53:29.263712 [debug] [Thread-1 (]: On model.climate_bronze.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."openweather_monthly"

[0m17:53:29.264346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:29.849261 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID db349e29-1d49-4cfe-9e78-13ff5e1e618f
[0m17:53:31.509124 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:53:32.715410 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m17:53:32.719083 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m17:53:32.724131 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_bronze (execute): 17:53:29.258180 => 17:53:32.723773
[0m17:53:32.724730 [debug] [Thread-1 (]: On model.climate_bronze.openweather_bronze: Close
[0m17:53:32.726329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7840a250>]}
[0m17:53:32.727749 [info ] [Thread-1 (]: 4 of 10 OK created sql view model climate_bronze.openweather_bronze ............ [[32mOK -1[0m in 3.48s]
[0m17:53:32.728324 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openweather_bronze
[0m17:53:32.728897 [debug] [Thread-1 (]: Began running node model.climate_bronze.sensor_bronze
[0m17:53:32.730070 [info ] [Thread-1 (]: 5 of 10 START sql view model climate_bronze.sensor_bronze ...................... [RUN]
[0m17:53:32.731740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openweather_bronze, now model.climate_bronze.sensor_bronze)
[0m17:53:32.732181 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.sensor_bronze
[0m17:53:32.742711 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.sensor_bronze"
[0m17:53:32.744045 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_bronze (compile): 17:53:32.732452 => 17:53:32.743914
[0m17:53:32.744338 [debug] [Thread-1 (]: Began executing node model.climate_bronze.sensor_bronze
[0m17:53:32.746505 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.sensor_bronze"
[0m17:53:32.747257 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_bronze"
[0m17:53:32.747604 [debug] [Thread-1 (]: On model.climate_bronze.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."sensor_readings"

[0m17:53:32.748216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:33.462144 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0dc640fc-ae7b-4561-8e98-74d8bc15e17a
[0m17:53:35.147011 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:53:36.406477 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m17:53:36.410340 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m17:53:36.411618 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_bronze (execute): 17:53:32.744539 => 17:53:36.411476
[0m17:53:36.412009 [debug] [Thread-1 (]: On model.climate_bronze.sensor_bronze: Close
[0m17:53:36.412606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80290950>]}
[0m17:53:36.413062 [info ] [Thread-1 (]: 5 of 10 OK created sql view model climate_bronze.sensor_bronze ................. [[32mOK -1[0m in 3.68s]
[0m17:53:36.413444 [debug] [Thread-1 (]: Finished running node model.climate_bronze.sensor_bronze
[0m17:53:36.413796 [debug] [Thread-1 (]: Began running node model.climate_bronze.eia_silver
[0m17:53:36.414328 [info ] [Thread-1 (]: 6 of 10 START sql table model climate_bronze.eia_silver ........................ [RUN]
[0m17:53:36.415627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.sensor_bronze, now model.climate_bronze.eia_silver)
[0m17:53:36.415966 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.eia_silver
[0m17:53:36.417919 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.eia_silver"
[0m17:53:36.418882 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_silver (compile): 17:53:36.416181 => 17:53:36.418766
[0m17:53:36.419140 [debug] [Thread-1 (]: Began executing node model.climate_bronze.eia_silver
[0m17:53:36.452027 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:53:36.452744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:37.128140 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:53:37.129930 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.eia_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/eia_silver/06253fa3-f264-4a12-9147-bf5fc16cc697',
      format='parquet'
    )
    as
      select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."eia_bronze"
qualify row_number() over (
  partition by state, observation_date
  order by ingestion_timestamp desc
) = 1
[0m17:56:45.368189 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_silver (execute): 17:53:36.419312 => 17:56:45.362008
[0m17:56:45.378465 [debug] [Thread-1 (]: On model.climate_bronze.eia_silver: Close
[0m17:56:45.383190 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 17:9: mismatched input 'row_number'. Expecting: '(', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', 'WITH', <EOF>
[0m17:56:45.390206 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/pyathena/common.py", line 651, in _execute
    query_id = retry_api_call(
               ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pyathena/util.py", line 196, in retry_api_call
    return retry(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/botocore/client.py", line 602, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/botocore/client.py", line 1078, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 17:9: mismatched input 'row_number'. Expecting: '(', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', 'WITH', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 158, in inner
    query_id = self._execute(
               ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pyathena/common.py", line 659, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 17:9: mismatched input 'row_number'. Expecting: '(', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', 'WITH', <EOF>

[0m17:56:45.393697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78436290>]}
[0m17:56:45.399710 [error] [Thread-1 (]: 6 of 10 ERROR creating sql table model climate_bronze.eia_silver ............... [[31mERROR[0m in 188.98s]
[0m17:56:45.400914 [debug] [Thread-1 (]: Finished running node model.climate_bronze.eia_silver
[0m17:56:45.402185 [debug] [Thread-1 (]: Began running node model.climate_bronze.noaa_silver
[0m17:56:45.404465 [info ] [Thread-1 (]: 7 of 10 SKIP relation climate_bronze.noaa_silver ............................... [[33mSKIP[0m]
[0m17:56:45.405077 [debug] [Thread-1 (]: Finished running node model.climate_bronze.noaa_silver
[0m17:56:45.405757 [debug] [Thread-1 (]: Began running node model.climate_bronze.openmeteo_silver
[0m17:56:45.406466 [info ] [Thread-1 (]: 8 of 10 START sql table model climate_bronze.openmeteo_silver .................. [RUN]
[0m17:56:45.407645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.eia_silver, now model.climate_bronze.openmeteo_silver)
[0m17:56:45.408285 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openmeteo_silver
[0m17:56:45.418995 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openmeteo_silver"
[0m17:56:45.422006 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_silver (compile): 17:56:45.408696 => 17:56:45.421794
[0m17:56:45.422543 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openmeteo_silver
[0m17:56:45.432357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:46.806499 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m17:56:46.807987 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:56:46.810710 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:56:48.031107 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m17:56:48.032655 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:56:48.034562 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."climate_bronze"."openmeteo_silver" is stored in s3://climate-energy-raw-data/climate_bronze/openmeteo_silver/d07a13c6-eef5-4482-8ddb-bc75dda39b52
[0m17:56:48.837631 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/climate_bronze/openmeteo_silver/d07a13c6-eef5-4482-8ddb-bc75dda39b52', bucket='climate-energy-raw-data', prefix='climate_bronze/openmeteo_silver/d07a13c6-eef5-4482-8ddb-bc75dda39b52/'
[0m17:56:51.099698 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."climate_bronze"."openmeteo_silver"
[0m17:56:51.114467 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:56:51.646747 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:56:51.649611 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/openmeteo_silver/84bb1d5d-5b45-4b67-bfbc-003ee4b7e6fe',
      format='parquet'
    )
    as
      select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."openmeteo_bronze"
[0m17:56:52.233167 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a7d5da16-bc4e-41e5-965f-f67e6e592a8f
[0m17:56:54.022907 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":41054}
[0m17:56:54.033915 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_silver"
[0m17:56:54.034520 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: alter table `AwsDataCatalog`.`climate_bronze`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m17:56:54.302787 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e94fc120-318d-4a1a-889e-fb1ba3c26194
[0m17:56:55.995057 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:56:56.005959 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openmeteo_silver"
[0m17:56:56.013099 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_silver"
[0m17:56:56.014222 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":41054}';
[0m17:56:56.220384 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4b8d87f3-f404-45fc-8ae7-c3ebf53af09e
[0m17:56:57.908226 [debug] [Thread-1 (]: SQL status: OK 4447 in 2.0 seconds
[0m17:56:57.915483 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_silver (execute): 17:56:45.422937 => 17:56:57.915001
[0m17:56:57.916400 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: Close
[0m17:56:57.918440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78a3bc50>]}
[0m17:56:57.920204 [info ] [Thread-1 (]: 8 of 10 OK created sql table model climate_bronze.openmeteo_silver ............. [[32mOK 4447[0m in 12.51s]
[0m17:56:57.921093 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openmeteo_silver
[0m17:56:57.921873 [debug] [Thread-1 (]: Began running node model.climate_bronze.openweather_silver
[0m17:56:57.922858 [info ] [Thread-1 (]: 9 of 10 START sql table model climate_bronze.openweather_silver ................ [RUN]
[0m17:56:57.926133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openmeteo_silver, now model.climate_bronze.openweather_silver)
[0m17:56:57.926748 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openweather_silver
[0m17:56:57.932741 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openweather_silver"
[0m17:56:57.934389 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_silver (compile): 17:56:57.927070 => 17:56:57.934182
[0m17:56:57.934887 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openweather_silver
[0m17:56:57.938684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:59.343996 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m17:56:59.344563 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:56:59.345617 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:57:00.545618 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m17:57:00.547423 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:57:00.548433 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."climate_bronze"."openweather_silver" is stored in s3://climate-energy-raw-data/climate_bronze/openweather_silver/f5c32c72-5277-4400-af5c-324a42c86bff
[0m17:57:01.138964 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/climate_bronze/openweather_silver/f5c32c72-5277-4400-af5c-324a42c86bff', bucket='climate-energy-raw-data', prefix='climate_bronze/openweather_silver/f5c32c72-5277-4400-af5c-324a42c86bff/'
[0m17:57:03.456190 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."climate_bronze"."openweather_silver"
[0m17:57:03.462769 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:57:04.071416 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:57:04.073487 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/openweather_silver/76bb7813-1c5d-4338-966a-33a55a75f417',
      format='parquet'
    )
    as
      select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."openweather_bronze"
[0m17:57:04.639950 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e25daa7d-b59d-45f0-a41b-28b9c1003b63
[0m17:57:06.309006 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1589}
[0m17:57:06.312207 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_silver"
[0m17:57:06.313221 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: alter table `AwsDataCatalog`.`climate_bronze`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m17:57:06.574902 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 84f6e6f5-655c-44da-a0f9-bfa97cb7b4bb
[0m17:57:08.229171 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:57:08.236394 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openweather_silver"
[0m17:57:08.241133 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_silver"
[0m17:57:08.242444 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1589}';
[0m17:57:08.445057 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0d89925e-4139-48fe-a440-297c3e5cd39f
[0m17:57:10.257370 [debug] [Thread-1 (]: SQL status: OK 63 in 2.0 seconds
[0m17:57:10.265777 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_silver (execute): 17:56:57.935248 => 17:57:10.265260
[0m17:57:10.267980 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: Close
[0m17:57:10.270366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78c50250>]}
[0m17:57:10.272420 [info ] [Thread-1 (]: 9 of 10 OK created sql table model climate_bronze.openweather_silver ........... [[32mOK 63[0m in 12.35s]
[0m17:57:10.273172 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openweather_silver
[0m17:57:10.273771 [debug] [Thread-1 (]: Began running node model.climate_bronze.sensor_silver
[0m17:57:10.274720 [info ] [Thread-1 (]: 10 of 10 START sql table model climate_bronze.sensor_silver .................... [RUN]
[0m17:57:10.277336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openweather_silver, now model.climate_bronze.sensor_silver)
[0m17:57:10.278027 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.sensor_silver
[0m17:57:10.285204 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.sensor_silver"
[0m17:57:10.286711 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_silver (compile): 17:57:10.278518 => 17:57:10.286530
[0m17:57:10.287106 [debug] [Thread-1 (]: Began executing node model.climate_bronze.sensor_silver
[0m17:57:10.290095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:11.886984 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m17:57:11.888237 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:57:11.889360 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:57:13.118245 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m17:57:13.120071 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:57:13.120942 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."climate_bronze"."sensor_silver" is stored in s3://climate-energy-raw-data/climate_bronze/sensor_silver/a9e1a4ec-c412-4333-9c5e-b81eda3ff921
[0m17:57:14.357087 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/climate_bronze/sensor_silver/a9e1a4ec-c412-4333-9c5e-b81eda3ff921', bucket='climate-energy-raw-data', prefix='climate_bronze/sensor_silver/a9e1a4ec-c412-4333-9c5e-b81eda3ff921/'
[0m17:57:17.174436 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."climate_bronze"."sensor_silver"
[0m17:57:17.180126 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:57:18.364799 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:57:18.370142 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/sensor_silver/35619bb9-eb0c-4342-a0fe-1028fea8b0ec',
      format='parquet'
    )
    as
      select
    location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."sensor_bronze"
[0m17:57:19.015837 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b4d0449a-be39-4838-9419-04a2ed289a5d
[0m17:57:21.788327 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":1145,"data_scanned_in_bytes":13364}
[0m17:57:21.791565 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_silver"
[0m17:57:21.792736 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: alter table `AwsDataCatalog`.`climate_bronze`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m17:57:22.042398 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7776f42b-c23c-444f-aced-e561c40eb131
[0m17:57:23.707026 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:57:23.715057 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.sensor_silver"
[0m17:57:23.719397 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_silver"
[0m17:57:23.720183 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_silver"} */
SELECT '{"rowcount":1145,"data_scanned_in_bytes":13364}';
[0m17:57:23.967732 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID dd8e30d8-5a83-421d-97de-9fa624f9166b
[0m17:57:25.681109 [debug] [Thread-1 (]: SQL status: OK 1145 in 2.0 seconds
[0m17:57:25.689435 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_silver (execute): 17:57:10.287419 => 17:57:25.688468
[0m17:57:25.691130 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: Close
[0m17:57:25.694960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2da5ba0-c1b6-4916-8cc9-dca67d7cf1c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff785ef110>]}
[0m17:57:25.698325 [info ] [Thread-1 (]: 10 of 10 OK created sql table model climate_bronze.sensor_silver ............... [[32mOK 1145[0m in 15.42s]
[0m17:57:25.699740 [debug] [Thread-1 (]: Finished running node model.climate_bronze.sensor_silver
[0m17:57:25.708798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:25.709819 [debug] [MainThread]: Connection 'model.climate_bronze.sensor_silver' was properly closed.
[0m17:57:25.712442 [info ] [MainThread]: 
[0m17:57:25.713416 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 15 minutes and 37.84 seconds (937.84s).
[0m17:57:25.716227 [debug] [MainThread]: Command end result
[0m17:57:25.739202 [info ] [MainThread]: 
[0m17:57:25.739795 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:57:25.740219 [info ] [MainThread]: 
[0m17:57:25.740580 [error] [MainThread]:   Runtime Error in model noaa_bronze (models/bronze/noaa_bronze.sql)
  line 9:3: Column 'datatype' cannot be resolved
[0m17:57:25.740909 [info ] [MainThread]: 
[0m17:57:25.741240 [error] [MainThread]:   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 17:9: mismatched input 'row_number'. Expecting: '(', ',', 'CROSS', 'EXCEPT', 'FETCH', 'FULL', 'GROUP', 'HAVING', 'INNER', 'INTERSECT', 'JOIN', 'LEFT', 'LIMIT', 'MATCH_RECOGNIZE', 'NATURAL', 'OFFSET', 'ORDER', 'RIGHT', 'TABLESAMPLE', 'UNION', 'WHERE', 'WINDOW', 'WITH', <EOF>
[0m17:57:25.741575 [info ] [MainThread]: 
[0m17:57:25.742050 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=1 TOTAL=10
[0m17:57:25.745880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 443.67957, "process_user_time": 6.53453, "process_kernel_time": 0.996703, "process_mem_max_rss": "195864", "process_out_blocks": "2048", "command_success": false, "process_in_blocks": "0"}
[0m17:57:25.747480 [debug] [MainThread]: Command `dbt run` failed at 17:57:25.747317 after 443.68 seconds
[0m17:57:25.748407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824b3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8020e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876f9650>]}
[0m17:57:25.748985 [debug] [MainThread]: Flushing usage events
[0m18:02:24.265196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a85e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bdf0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac044d0>]}


============================== 18:02:24.267006 | cfb32c73-5e7e-4fdb-b644-d3470cecc663 ==============================
[0m18:02:24.267006 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:02:24.267807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:02:24.268121 [info ] [MainThread]: dbt version: 1.7.9
[0m18:02:24.268429 [info ] [MainThread]: python version: 3.11.14
[0m18:02:24.268724 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m18:02:24.269027 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m18:02:24.467894 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:02:24.468347 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:02:24.468694 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:02:24.469227 [info ] [MainThread]: adapter type: athena
[0m18:02:24.469555 [info ] [MainThread]: adapter version: 1.7.2
[0m18:02:24.504871 [info ] [MainThread]: Configuration:
[0m18:02:24.505296 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:02:24.505585 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:02:24.505901 [info ] [MainThread]: Required dependencies:
[0m18:02:24.506221 [debug] [MainThread]: Executing "git --help"
[0m18:02:24.512405 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:02:24.512793 [debug] [MainThread]: STDERR: "b''"
[0m18:02:24.512975 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:02:24.513200 [info ] [MainThread]: Connection:
[0m18:02:24.513546 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m18:02:24.513835 [info ] [MainThread]:   work_group: None
[0m18:02:24.514069 [info ] [MainThread]:   region_name: us-east-1
[0m18:02:24.514357 [info ] [MainThread]:   database: AwsDataCatalog
[0m18:02:24.514585 [info ] [MainThread]:   schema: climate_bronze
[0m18:02:24.514899 [info ] [MainThread]:   poll_interval: 1.0
[0m18:02:24.515163 [info ] [MainThread]:   aws_profile_name: None
[0m18:02:24.515417 [info ] [MainThread]:   aws_access_key_id: None
[0m18:02:24.515669 [info ] [MainThread]:   aws_secret_access_key: None
[0m18:02:24.515909 [info ] [MainThread]:   aws_session_token: None
[0m18:02:24.516150 [info ] [MainThread]:   endpoint_url: None
[0m18:02:24.516345 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m18:02:24.516612 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m18:02:24.516883 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m18:02:24.517128 [info ] [MainThread]:   debug_query_state: False
[0m18:02:24.517359 [info ] [MainThread]:   seed_s3_upload_args: None
[0m18:02:24.517596 [info ] [MainThread]:   lf_tags_database: None
[0m18:02:24.517810 [info ] [MainThread]:   spark_work_group: None
[0m18:02:24.518105 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m18:02:24.518962 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m18:02:24.519195 [debug] [MainThread]: Using athena connection "debug"
[0m18:02:24.519365 [debug] [MainThread]: On debug: select 1 as id
[0m18:02:24.519532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:25.145798 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 7cba821c-83da-4caf-b016-b29a1b679b11
[0m18:02:26.883783 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m18:02:26.888152 [debug] [MainThread]: On debug: Close
[0m18:02:26.889484 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:02:26.890689 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:02:26.892639 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.6475565, "process_user_time": 1.24475, "process_kernel_time": 0.19227, "process_mem_max_rss": "143948", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m18:02:26.893652 [debug] [MainThread]: Command `dbt debug` succeeded at 18:02:26.893361 after 2.65 seconds
[0m18:02:26.894409 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:02:26.896984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a870150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a84e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a85ea50>]}
[0m18:02:26.897950 [debug] [MainThread]: Flushing usage events
[0m18:02:32.528793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba62e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe86ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc178d0>]}


============================== 18:02:32.530350 | 46356fea-199a-46cb-a1ed-6a3c531891c6 ==============================
[0m18:02:32.530350 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:02:32.530746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:02:32.750755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab794d0>]}
[0m18:02:32.789412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaacd52d0>]}
[0m18:02:32.789869 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m18:02:32.795805 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:02:32.816812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:02:32.817267 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/silver/eia_silver.sql
[0m18:02:32.951516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa304b50>]}
[0m18:02:32.960851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7eba50>]}
[0m18:02:32.961264 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m18:02:32.961542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa34d510>]}
[0m18:02:32.962963 [info ] [MainThread]: 
[0m18:02:32.963503 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m18:02:32.964457 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m18:02:32.964741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:33.673007 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m18:02:33.677294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_climate_bronze)
[0m18:02:33.678180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:35.785381 [debug] [ThreadPool]: On list_AwsDataCatalog_climate_bronze: Close
[0m18:02:35.791257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa40810>]}
[0m18:02:35.792753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:35.793606 [info ] [MainThread]: 
[0m18:02:35.797495 [debug] [Thread-1 (]: Began running node model.climate_bronze.eia_bronze
[0m18:02:35.798193 [info ] [Thread-1 (]: 1 of 10 START sql view model climate_bronze.eia_bronze ......................... [RUN]
[0m18:02:35.799881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_climate_bronze, now model.climate_bronze.eia_bronze)
[0m18:02:35.800412 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.eia_bronze
[0m18:02:35.810121 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.eia_bronze"
[0m18:02:35.812298 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_bronze (compile): 18:02:35.800767 => 18:02:35.812052
[0m18:02:35.812865 [debug] [Thread-1 (]: Began executing node model.climate_bronze.eia_bronze
[0m18:02:35.837271 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.eia_bronze"
[0m18:02:35.838510 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.eia_bronze"
[0m18:02:35.838852 [debug] [Thread-1 (]: On model.climate_bronze.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."eia_energy"

[0m18:02:35.839141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:36.445512 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID aa2a5445-3374-4f70-9442-8a77b07c0f5d
[0m18:02:38.203993 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:02:40.105893 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m18:02:40.110862 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:02:40.123625 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_bronze (execute): 18:02:35.813257 => 18:02:40.123189
[0m18:02:40.124452 [debug] [Thread-1 (]: On model.climate_bronze.eia_bronze: Close
[0m18:02:40.126096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35c5dd0>]}
[0m18:02:40.127663 [info ] [Thread-1 (]: 1 of 10 OK created sql view model climate_bronze.eia_bronze .................... [[32mOK -1[0m in 4.33s]
[0m18:02:40.129063 [debug] [Thread-1 (]: Finished running node model.climate_bronze.eia_bronze
[0m18:02:40.129889 [debug] [Thread-1 (]: Began running node model.climate_bronze.noaa_bronze
[0m18:02:40.131253 [info ] [Thread-1 (]: 2 of 10 START sql view model climate_bronze.noaa_bronze ........................ [RUN]
[0m18:02:40.133796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.eia_bronze, now model.climate_bronze.noaa_bronze)
[0m18:02:40.134404 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.noaa_bronze
[0m18:02:40.138581 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.noaa_bronze"
[0m18:02:40.140463 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_bronze (compile): 18:02:40.134777 => 18:02:40.140242
[0m18:02:40.140955 [debug] [Thread-1 (]: Began executing node model.climate_bronze.noaa_bronze
[0m18:02:40.144235 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.noaa_bronze"
[0m18:02:40.145477 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.noaa_bronze"
[0m18:02:40.145886 [debug] [Thread-1 (]: On model.climate_bronze.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."climate_bronze"."noaa_weather"

[0m18:02:40.146315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:40.792771 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 51834e40-07c4-4bb3-ab7d-21cd76757574
[0m18:02:42.476194 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:02:44.386911 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m18:02:44.389842 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:02:44.392524 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_bronze (execute): 18:02:40.141295 => 18:02:44.392187
[0m18:02:44.393539 [debug] [Thread-1 (]: On model.climate_bronze.noaa_bronze: Close
[0m18:02:44.395652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83a8b90>]}
[0m18:02:44.397058 [info ] [Thread-1 (]: 2 of 10 OK created sql view model climate_bronze.noaa_bronze ................... [[32mOK -1[0m in 4.26s]
[0m18:02:44.398335 [debug] [Thread-1 (]: Finished running node model.climate_bronze.noaa_bronze
[0m18:02:44.399305 [debug] [Thread-1 (]: Began running node model.climate_bronze.openmeteo_bronze
[0m18:02:44.400326 [info ] [Thread-1 (]: 3 of 10 START sql view model climate_bronze.openmeteo_bronze ................... [RUN]
[0m18:02:44.403185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.noaa_bronze, now model.climate_bronze.openmeteo_bronze)
[0m18:02:44.404058 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openmeteo_bronze
[0m18:02:44.408767 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openmeteo_bronze"
[0m18:02:44.411516 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_bronze (compile): 18:02:44.404909 => 18:02:44.410960
[0m18:02:44.412593 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openmeteo_bronze
[0m18:02:44.416701 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openmeteo_bronze"
[0m18:02:44.418224 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_bronze"
[0m18:02:44.418652 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."openmeteo_historical"

[0m18:02:44.419102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:45.102938 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 26c5eef8-68e3-4912-8e63-9c4af0d4aac0
[0m18:02:46.788588 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:02:48.678768 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m18:02:48.681059 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:02:48.682485 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_bronze (execute): 18:02:44.413145 => 18:02:48.682336
[0m18:02:48.682812 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_bronze: Close
[0m18:02:48.683658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80b8b90>]}
[0m18:02:48.684240 [info ] [Thread-1 (]: 3 of 10 OK created sql view model climate_bronze.openmeteo_bronze .............. [[32mOK -1[0m in 4.28s]
[0m18:02:48.684857 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openmeteo_bronze
[0m18:02:48.685264 [debug] [Thread-1 (]: Began running node model.climate_bronze.openweather_bronze
[0m18:02:48.685841 [info ] [Thread-1 (]: 4 of 10 START sql view model climate_bronze.openweather_bronze ................. [RUN]
[0m18:02:48.687346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openmeteo_bronze, now model.climate_bronze.openweather_bronze)
[0m18:02:48.687618 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openweather_bronze
[0m18:02:48.690040 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openweather_bronze"
[0m18:02:48.691485 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_bronze (compile): 18:02:48.687829 => 18:02:48.691359
[0m18:02:48.691761 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openweather_bronze
[0m18:02:48.693811 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openweather_bronze"
[0m18:02:48.695089 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_bronze"
[0m18:02:48.695350 [debug] [Thread-1 (]: On model.climate_bronze.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."openweather_monthly"

[0m18:02:48.695785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:49.277633 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3051eb53-a94e-40c9-9da8-1ac30cf04cb8
[0m18:02:51.001936 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:02:52.888763 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m18:02:52.892907 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:02:52.895555 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_bronze (execute): 18:02:48.691946 => 18:02:52.895268
[0m18:02:52.896390 [debug] [Thread-1 (]: On model.climate_bronze.openweather_bronze: Close
[0m18:02:52.897817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3f1e5d0>]}
[0m18:02:52.898947 [info ] [Thread-1 (]: 4 of 10 OK created sql view model climate_bronze.openweather_bronze ............ [[32mOK -1[0m in 4.21s]
[0m18:02:52.900228 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openweather_bronze
[0m18:02:52.901194 [debug] [Thread-1 (]: Began running node model.climate_bronze.sensor_bronze
[0m18:02:52.902285 [info ] [Thread-1 (]: 5 of 10 START sql view model climate_bronze.sensor_bronze ...................... [RUN]
[0m18:02:52.904834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openweather_bronze, now model.climate_bronze.sensor_bronze)
[0m18:02:52.905465 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.sensor_bronze
[0m18:02:52.909304 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.sensor_bronze"
[0m18:02:52.911832 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_bronze (compile): 18:02:52.905958 => 18:02:52.911535
[0m18:02:52.912435 [debug] [Thread-1 (]: Began executing node model.climate_bronze.sensor_bronze
[0m18:02:52.916097 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.sensor_bronze"
[0m18:02:52.917578 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_bronze"
[0m18:02:52.918117 [debug] [Thread-1 (]: On model.climate_bronze.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."sensor_readings"

[0m18:02:52.918611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:53.493347 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 725f20fc-3a56-47fe-bb88-2fa8de657f0a
[0m18:02:55.152107 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:02:57.037018 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m18:02:57.040916 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:02:57.043473 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_bronze (execute): 18:02:52.912931 => 18:02:57.043174
[0m18:02:57.044248 [debug] [Thread-1 (]: On model.climate_bronze.sensor_bronze: Close
[0m18:02:57.045597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a5a7d0>]}
[0m18:02:57.046712 [info ] [Thread-1 (]: 5 of 10 OK created sql view model climate_bronze.sensor_bronze ................. [[32mOK -1[0m in 4.14s]
[0m18:02:57.048043 [debug] [Thread-1 (]: Finished running node model.climate_bronze.sensor_bronze
[0m18:02:57.048922 [debug] [Thread-1 (]: Began running node model.climate_bronze.eia_silver
[0m18:02:57.050024 [info ] [Thread-1 (]: 6 of 10 START sql table model climate_bronze.eia_silver ........................ [RUN]
[0m18:02:57.052877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.sensor_bronze, now model.climate_bronze.eia_silver)
[0m18:02:57.053535 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.eia_silver
[0m18:02:57.057716 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.eia_silver"
[0m18:02:57.059653 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_silver (compile): 18:02:57.053996 => 18:02:57.059399
[0m18:02:57.060237 [debug] [Thread-1 (]: Began executing node model.climate_bronze.eia_silver
[0m18:02:57.108378 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:02:57.108927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:58.406993 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:02:58.408653 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.eia_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/eia_silver/968356bd-ce7f-45f6-987c-755a21abcaf4',
      format='parquet'
    )
    as
      -- select
--     state,
--     sector,
--     cast(dt_timestamp as date) as observation_date,
--     price,
--     event_timestamp as ingestion_timestamp
-- from "AwsDataCatalog"."climate_bronze"."eia_bronze"
-- qualify row_number() over (
--   partition by state, observation_date
--   order by ingestion_timestamp desc
-- ) = 1

with ranked as (
    select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
        row_number() over (
            partition by region, event_time
            order by ingestion_timestamp desc
        ) as rn
    from "AwsDataCatalog"."climate_bronze"."eia_bronze"
)

select
    select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from ranked
where rn = 1
[0m18:04:45.214171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafb23f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafb22390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafb23d50>]}


============================== 18:04:45.216085 | b9c56ea6-8137-4842-8e7b-0025eaadbc54 ==============================
[0m18:04:45.216085 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:04:45.216530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:04:45.451700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea5f9d0>]}
[0m18:04:45.490982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb89cd0>]}
[0m18:04:45.491486 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m18:04:45.496500 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:04:45.517109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:45.517638 [debug] [MainThread]: Partial parsing: updated file: climate_bronze://models/silver/eia_silver.sql
[0m18:04:45.661141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3068d0>]}
[0m18:04:45.674493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae82e910>]}
[0m18:04:45.674803 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m18:04:45.675079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea33a50>]}
[0m18:04:45.676430 [info ] [MainThread]: 
[0m18:04:45.677023 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m18:04:45.678802 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m18:04:45.679100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:46.396412 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m18:04:46.401864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_climate_bronze)
[0m18:04:46.402974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:51.440472 [debug] [ThreadPool]: On list_AwsDataCatalog_climate_bronze: Close
[0m18:04:51.446873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf5b110>]}
[0m18:04:51.448508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:51.449356 [info ] [MainThread]: 
[0m18:04:51.452452 [debug] [Thread-1 (]: Began running node model.climate_bronze.eia_bronze
[0m18:04:51.453238 [info ] [Thread-1 (]: 1 of 10 START sql view model climate_bronze.eia_bronze ......................... [RUN]
[0m18:04:51.454547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_climate_bronze, now model.climate_bronze.eia_bronze)
[0m18:04:51.455167 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.eia_bronze
[0m18:04:51.464786 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.eia_bronze"
[0m18:04:51.467495 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_bronze (compile): 18:04:51.455642 => 18:04:51.467228
[0m18:04:51.468012 [debug] [Thread-1 (]: Began executing node model.climate_bronze.eia_bronze
[0m18:04:51.491723 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.eia_bronze"
[0m18:04:51.493358 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.eia_bronze"
[0m18:04:51.493804 [debug] [Thread-1 (]: On model.climate_bronze.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."eia_energy"

[0m18:04:51.494200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:52.115839 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cd99bac9-8654-474f-8589-cab0a38f020d
[0m18:04:53.902276 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:04:55.160520 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m18:04:55.165371 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:04:55.175063 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_bronze (execute): 18:04:51.468416 => 18:04:55.174737
[0m18:04:55.175867 [debug] [Thread-1 (]: On model.climate_bronze.eia_bronze: Close
[0m18:04:55.177054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c1bf90>]}
[0m18:04:55.177935 [info ] [Thread-1 (]: 1 of 10 OK created sql view model climate_bronze.eia_bronze .................... [[32mOK -1[0m in 3.72s]
[0m18:04:55.179040 [debug] [Thread-1 (]: Finished running node model.climate_bronze.eia_bronze
[0m18:04:55.179766 [debug] [Thread-1 (]: Began running node model.climate_bronze.noaa_bronze
[0m18:04:55.180713 [info ] [Thread-1 (]: 2 of 10 START sql view model climate_bronze.noaa_bronze ........................ [RUN]
[0m18:04:55.183242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.eia_bronze, now model.climate_bronze.noaa_bronze)
[0m18:04:55.183889 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.noaa_bronze
[0m18:04:55.187182 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.noaa_bronze"
[0m18:04:55.188638 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_bronze (compile): 18:04:55.184308 => 18:04:55.188400
[0m18:04:55.189146 [debug] [Thread-1 (]: Began executing node model.climate_bronze.noaa_bronze
[0m18:04:55.192400 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.noaa_bronze"
[0m18:04:55.193592 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.noaa_bronze"
[0m18:04:55.194047 [debug] [Thread-1 (]: On model.climate_bronze.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."climate_bronze"."noaa_weather"

[0m18:04:55.194533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:55.806590 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b0c0a655-bec3-4092-9960-1baf7ba1960e
[0m18:04:57.487087 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:04:58.735609 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m18:04:58.736781 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:04:58.737772 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_bronze (execute): 18:04:55.189498 => 18:04:58.737631
[0m18:04:58.738016 [debug] [Thread-1 (]: On model.climate_bronze.noaa_bronze: Close
[0m18:04:58.738528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadfdba10>]}
[0m18:04:58.738949 [info ] [Thread-1 (]: 2 of 10 OK created sql view model climate_bronze.noaa_bronze ................... [[32mOK -1[0m in 3.56s]
[0m18:04:58.739686 [debug] [Thread-1 (]: Finished running node model.climate_bronze.noaa_bronze
[0m18:04:58.740070 [debug] [Thread-1 (]: Began running node model.climate_bronze.openmeteo_bronze
[0m18:04:58.740460 [info ] [Thread-1 (]: 3 of 10 START sql view model climate_bronze.openmeteo_bronze ................... [RUN]
[0m18:04:58.741696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.noaa_bronze, now model.climate_bronze.openmeteo_bronze)
[0m18:04:58.741948 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openmeteo_bronze
[0m18:04:58.743791 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openmeteo_bronze"
[0m18:04:58.745118 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_bronze (compile): 18:04:58.742092 => 18:04:58.745007
[0m18:04:58.745367 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openmeteo_bronze
[0m18:04:58.746983 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openmeteo_bronze"
[0m18:04:58.747543 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_bronze"
[0m18:04:58.747758 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."openmeteo_historical"

[0m18:04:58.747991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:59.505225 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7b9938b5-7c6f-487d-8b3b-d9f48b606e77
[0m18:05:01.182910 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:05:02.469257 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m18:05:02.472942 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:05:02.475633 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_bronze (execute): 18:04:58.745515 => 18:05:02.475269
[0m18:05:02.476646 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_bronze: Close
[0m18:05:02.478161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7225110>]}
[0m18:05:02.479489 [info ] [Thread-1 (]: 3 of 10 OK created sql view model climate_bronze.openmeteo_bronze .............. [[32mOK -1[0m in 3.74s]
[0m18:05:02.480780 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openmeteo_bronze
[0m18:05:02.481676 [debug] [Thread-1 (]: Began running node model.climate_bronze.openweather_bronze
[0m18:05:02.482808 [info ] [Thread-1 (]: 4 of 10 START sql view model climate_bronze.openweather_bronze ................. [RUN]
[0m18:05:02.485678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openmeteo_bronze, now model.climate_bronze.openweather_bronze)
[0m18:05:02.486352 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openweather_bronze
[0m18:05:02.490440 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openweather_bronze"
[0m18:05:02.492358 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_bronze (compile): 18:05:02.486816 => 18:05:02.492088
[0m18:05:02.492972 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openweather_bronze
[0m18:05:02.496483 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openweather_bronze"
[0m18:05:02.497774 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_bronze"
[0m18:05:02.498317 [debug] [Thread-1 (]: On model.climate_bronze.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."openweather_monthly"

[0m18:05:02.498911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:03.111792 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c7ce5dc8-acb8-410d-9453-2cb23b88caab
[0m18:05:04.902140 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:05:06.195204 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m18:05:06.199805 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:05:06.205229 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_bronze (execute): 18:05:02.493373 => 18:05:06.204719
[0m18:05:06.206228 [debug] [Thread-1 (]: On model.climate_bronze.openweather_bronze: Close
[0m18:05:06.208517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c1b690>]}
[0m18:05:06.210003 [info ] [Thread-1 (]: 4 of 10 OK created sql view model climate_bronze.openweather_bronze ............ [[32mOK -1[0m in 3.72s]
[0m18:05:06.211315 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openweather_bronze
[0m18:05:06.212234 [debug] [Thread-1 (]: Began running node model.climate_bronze.sensor_bronze
[0m18:05:06.213663 [info ] [Thread-1 (]: 5 of 10 START sql view model climate_bronze.sensor_bronze ...................... [RUN]
[0m18:05:06.216590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openweather_bronze, now model.climate_bronze.sensor_bronze)
[0m18:05:06.217266 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.sensor_bronze
[0m18:05:06.222745 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.sensor_bronze"
[0m18:05:06.224352 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_bronze (compile): 18:05:06.217819 => 18:05:06.224131
[0m18:05:06.224822 [debug] [Thread-1 (]: Began executing node model.climate_bronze.sensor_bronze
[0m18:05:06.228640 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.sensor_bronze"
[0m18:05:06.230392 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_bronze"
[0m18:05:06.231029 [debug] [Thread-1 (]: On model.climate_bronze.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."climate_bronze"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."climate_bronze"."sensor_readings"

[0m18:05:06.231569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:06.846755 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 68953585-b6c8-4221-8ee6-496f5a2171bf
[0m18:05:08.543217 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:05:09.881178 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m18:05:09.884895 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:05:09.888389 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_bronze (execute): 18:05:06.225092 => 18:05:09.888030
[0m18:05:09.889298 [debug] [Thread-1 (]: On model.climate_bronze.sensor_bronze: Close
[0m18:05:09.890651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea22bd0>]}
[0m18:05:09.891757 [info ] [Thread-1 (]: 5 of 10 OK created sql view model climate_bronze.sensor_bronze ................. [[32mOK -1[0m in 3.68s]
[0m18:05:09.892841 [debug] [Thread-1 (]: Finished running node model.climate_bronze.sensor_bronze
[0m18:05:09.893842 [debug] [Thread-1 (]: Began running node model.climate_bronze.eia_silver
[0m18:05:09.895014 [info ] [Thread-1 (]: 6 of 10 START sql table model climate_bronze.eia_silver ........................ [RUN]
[0m18:05:09.898162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.sensor_bronze, now model.climate_bronze.eia_silver)
[0m18:05:09.899358 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.eia_silver
[0m18:05:09.904536 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.eia_silver"
[0m18:05:09.906310 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_silver (compile): 18:05:09.900154 => 18:05:09.906062
[0m18:05:09.906895 [debug] [Thread-1 (]: Began executing node model.climate_bronze.eia_silver
[0m18:05:09.956979 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:05:09.957598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:10.686593 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:05:10.688633 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.eia_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/eia_silver/0fa88789-1dae-4133-ac7b-e2c618c68952',
      format='parquet'
    )
    as
      with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."climate_bronze"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m18:05:11.265331 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6e23b683-2937-4d09-9635-5531354d9ad1
[0m18:05:14.127065 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1650}
[0m18:05:14.134259 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.eia_silver"
[0m18:05:14.135304 [debug] [Thread-1 (]: On model.climate_bronze.eia_silver: alter table `AwsDataCatalog`.`climate_bronze`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m18:05:14.405131 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ebea91ed-1afe-4e32-b0bd-b716a9e731ed
[0m18:05:16.061071 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:05:16.066033 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.eia_silver"
[0m18:05:16.071637 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.eia_silver"
[0m18:05:16.072464 [debug] [Thread-1 (]: On model.climate_bronze.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1650}';
[0m18:05:16.278601 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d9f22cdb-711d-4acd-ba53-bf0d3dc1237d
[0m18:05:18.002856 [debug] [Thread-1 (]: SQL status: OK 2 in 2.0 seconds
[0m18:05:18.009386 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_silver (execute): 18:05:09.907261 => 18:05:18.008963
[0m18:05:18.010571 [debug] [Thread-1 (]: On model.climate_bronze.eia_silver: Close
[0m18:05:18.012067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa785c410>]}
[0m18:05:18.013247 [info ] [Thread-1 (]: 6 of 10 OK created sql table model climate_bronze.eia_silver ................... [[32mOK 2[0m in 8.12s]
[0m18:05:18.014863 [debug] [Thread-1 (]: Finished running node model.climate_bronze.eia_silver
[0m18:05:18.015791 [debug] [Thread-1 (]: Began running node model.climate_bronze.noaa_silver
[0m18:05:18.016770 [info ] [Thread-1 (]: 7 of 10 START sql table model climate_bronze.noaa_silver ....................... [RUN]
[0m18:05:18.020051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.eia_silver, now model.climate_bronze.noaa_silver)
[0m18:05:18.020757 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.noaa_silver
[0m18:05:18.024412 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.noaa_silver"
[0m18:05:18.026286 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_silver (compile): 18:05:18.021180 => 18:05:18.026034
[0m18:05:18.026870 [debug] [Thread-1 (]: Began executing node model.climate_bronze.noaa_silver
[0m18:05:18.030796 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:05:18.031597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:18.697566 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:05:18.699982 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.noaa_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/noaa_silver/c46ea130-d257-4215-9e96-b41ce641456b',
      format='parquet'
    )
    as
      select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m18:05:19.271769 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ffa97524-cea7-4750-9030-9f40c2c4fd48
[0m18:05:22.096341 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":673}
[0m18:05:22.101214 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.noaa_silver"
[0m18:05:22.102457 [debug] [Thread-1 (]: On model.climate_bronze.noaa_silver: alter table `AwsDataCatalog`.`climate_bronze`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m18:05:22.367055 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 60921a59-c4bd-4ee2-8e7b-4f7ecdece216
[0m18:05:24.045101 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:05:24.049948 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.noaa_silver"
[0m18:05:24.053985 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.noaa_silver"
[0m18:05:24.055036 [debug] [Thread-1 (]: On model.climate_bronze.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":673}';
[0m18:05:24.257795 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c3b1d5d0-5347-49ad-8c79-d8b2279b899a
[0m18:05:25.955944 [debug] [Thread-1 (]: SQL status: OK 31 in 2.0 seconds
[0m18:05:25.962706 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_silver (execute): 18:05:18.027291 => 18:05:25.962117
[0m18:05:25.963646 [debug] [Thread-1 (]: On model.climate_bronze.noaa_silver: Close
[0m18:05:25.965516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f9bb90>]}
[0m18:05:25.966917 [info ] [Thread-1 (]: 7 of 10 OK created sql table model climate_bronze.noaa_silver .................. [[32mOK 31[0m in 7.95s]
[0m18:05:25.968297 [debug] [Thread-1 (]: Finished running node model.climate_bronze.noaa_silver
[0m18:05:25.969277 [debug] [Thread-1 (]: Began running node model.climate_bronze.openmeteo_silver
[0m18:05:25.970512 [info ] [Thread-1 (]: 8 of 10 START sql table model climate_bronze.openmeteo_silver .................. [RUN]
[0m18:05:25.973682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.noaa_silver, now model.climate_bronze.openmeteo_silver)
[0m18:05:25.974515 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openmeteo_silver
[0m18:05:25.980300 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openmeteo_silver"
[0m18:05:25.983288 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_silver (compile): 18:05:25.974984 => 18:05:25.983004
[0m18:05:25.983935 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openmeteo_silver
[0m18:05:25.993984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:27.268250 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m18:05:27.269881 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:05:27.273688 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:05:28.440393 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m18:05:28.443197 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:05:28.444175 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."climate_bronze"."openmeteo_silver" is stored in s3://climate-energy-raw-data/climate_bronze/openmeteo_silver/84bb1d5d-5b45-4b67-bfbc-003ee4b7e6fe
[0m18:05:29.218340 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/climate_bronze/openmeteo_silver/84bb1d5d-5b45-4b67-bfbc-003ee4b7e6fe', bucket='climate-energy-raw-data', prefix='climate_bronze/openmeteo_silver/84bb1d5d-5b45-4b67-bfbc-003ee4b7e6fe/'
[0m18:05:31.461034 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."climate_bronze"."openmeteo_silver"
[0m18:05:31.465414 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:05:31.982464 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:05:31.984353 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/openmeteo_silver/0701a242-2862-4775-9a84-6401a6ebc1bb',
      format='parquet'
    )
    as
      select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."openmeteo_bronze"
[0m18:05:32.542707 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8e5ba45a-d19b-4ba2-a4f8-b7de63cb8134
[0m18:05:35.328711 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":41054}
[0m18:05:35.331411 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_silver"
[0m18:05:35.332591 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: alter table `AwsDataCatalog`.`climate_bronze`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m18:05:35.593187 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 01392561-1d0e-472b-bf19-d5c701c1937b
[0m18:05:37.374075 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:05:37.379576 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openmeteo_silver"
[0m18:05:37.383265 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_silver"
[0m18:05:37.384103 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":41054}';
[0m18:05:37.584219 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2892b32c-2081-4dea-aa39-ea51d8ff0b47
[0m18:05:39.290857 [debug] [Thread-1 (]: SQL status: OK 4447 in 2.0 seconds
[0m18:05:39.301593 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_silver (execute): 18:05:25.984322 => 18:05:39.300960
[0m18:05:39.303164 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: Close
[0m18:05:39.305865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb30310>]}
[0m18:05:39.307715 [info ] [Thread-1 (]: 8 of 10 OK created sql table model climate_bronze.openmeteo_silver ............. [[32mOK 4447[0m in 13.33s]
[0m18:05:39.309079 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openmeteo_silver
[0m18:05:39.309958 [debug] [Thread-1 (]: Began running node model.climate_bronze.openweather_silver
[0m18:05:39.311193 [info ] [Thread-1 (]: 9 of 10 START sql table model climate_bronze.openweather_silver ................ [RUN]
[0m18:05:39.314269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openmeteo_silver, now model.climate_bronze.openweather_silver)
[0m18:05:39.315104 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openweather_silver
[0m18:05:39.321368 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openweather_silver"
[0m18:05:39.323235 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_silver (compile): 18:05:39.315596 => 18:05:39.322995
[0m18:05:39.323725 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openweather_silver
[0m18:05:39.327490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:40.573714 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m18:05:40.575293 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:05:40.576472 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:05:41.761747 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m18:05:41.763648 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:05:41.764556 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."climate_bronze"."openweather_silver" is stored in s3://climate-energy-raw-data/climate_bronze/openweather_silver/76bb7813-1c5d-4338-966a-33a55a75f417
[0m18:05:42.344884 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/climate_bronze/openweather_silver/76bb7813-1c5d-4338-966a-33a55a75f417', bucket='climate-energy-raw-data', prefix='climate_bronze/openweather_silver/76bb7813-1c5d-4338-966a-33a55a75f417/'
[0m18:05:44.470045 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."climate_bronze"."openweather_silver"
[0m18:05:44.476960 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:05:45.638658 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:05:45.640662 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/openweather_silver/36ce0ed9-d0d7-4f28-b2ba-9bfc9af7cf90',
      format='parquet'
    )
    as
      select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."openweather_bronze"
[0m18:05:46.201731 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 16798d52-37f4-4ef1-8064-6d4ae791eb52
[0m18:05:48.970941 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1589}
[0m18:05:48.973966 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_silver"
[0m18:05:48.975140 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: alter table `AwsDataCatalog`.`climate_bronze`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m18:05:49.239156 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4034baa4-5d7f-486e-b5ea-d7285448b09a
[0m18:05:50.913422 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:05:50.918324 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openweather_silver"
[0m18:05:50.921591 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_silver"
[0m18:05:50.922596 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1589}';
[0m18:05:51.114871 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 037dd583-fc27-4fd3-ab00-921cf4ae3800
[0m18:05:52.911730 [debug] [Thread-1 (]: SQL status: OK 63 in 2.0 seconds
[0m18:05:52.917689 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_silver (execute): 18:05:39.324076 => 18:05:52.917386
[0m18:05:52.918672 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: Close
[0m18:05:52.920226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa700aad0>]}
[0m18:05:52.921429 [info ] [Thread-1 (]: 9 of 10 OK created sql table model climate_bronze.openweather_silver ........... [[32mOK 63[0m in 13.61s]
[0m18:05:52.922756 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openweather_silver
[0m18:05:52.923620 [debug] [Thread-1 (]: Began running node model.climate_bronze.sensor_silver
[0m18:05:52.924592 [info ] [Thread-1 (]: 10 of 10 START sql table model climate_bronze.sensor_silver .................... [RUN]
[0m18:05:52.927796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openweather_silver, now model.climate_bronze.sensor_silver)
[0m18:05:52.928595 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.sensor_silver
[0m18:05:52.932241 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.sensor_silver"
[0m18:05:52.934841 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_silver (compile): 18:05:52.929135 => 18:05:52.934563
[0m18:05:52.935469 [debug] [Thread-1 (]: Began executing node model.climate_bronze.sensor_silver
[0m18:05:52.939292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:54.164043 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m18:05:54.165305 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:05:54.166389 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:05:55.344806 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m18:05:55.346354 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:05:55.347186 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."climate_bronze"."sensor_silver" is stored in s3://climate-energy-raw-data/climate_bronze/sensor_silver/35619bb9-eb0c-4342-a0fe-1028fea8b0ec
[0m18:05:56.560523 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/climate_bronze/sensor_silver/35619bb9-eb0c-4342-a0fe-1028fea8b0ec', bucket='climate-energy-raw-data', prefix='climate_bronze/sensor_silver/35619bb9-eb0c-4342-a0fe-1028fea8b0ec/'
[0m18:05:59.389294 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."climate_bronze"."sensor_silver"
[0m18:05:59.397369 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:06:00.553530 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:06:00.555723 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/sensor_silver/7e413460-c7b4-4fb4-b711-fb0d75d4e8d4',
      format='parquet'
    )
    as
      select
    location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."sensor_bronze"
[0m18:06:01.118349 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 28fb1feb-2df9-4729-bb0d-bf9b954ddf9c
[0m18:06:02.774700 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":1145,"data_scanned_in_bytes":13364}
[0m18:06:02.777229 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_silver"
[0m18:06:02.777999 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: alter table `AwsDataCatalog`.`climate_bronze`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m18:06:03.063165 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0537f504-c675-47ca-b12a-8d6aa2d06553
[0m18:06:04.745263 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:06:04.749892 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.sensor_silver"
[0m18:06:04.754212 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_silver"
[0m18:06:04.755108 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_silver"} */
SELECT '{"rowcount":1145,"data_scanned_in_bytes":13364}';
[0m18:06:04.946116 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9c75e677-575b-4ba5-b6b7-c4c0c73fb655
[0m18:06:06.656373 [debug] [Thread-1 (]: Timing info for model.climate_bronze.eia_silver (execute): 18:02:57.060629 => 18:06:06.652958
[0m18:06:06.659540 [debug] [Thread-1 (]: On model.climate_bronze.eia_silver: Close
[0m18:06:06.660958 [debug] [Thread-1 (]: SQL status: OK 1145 in 2.0 seconds
[0m18:06:06.664642 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 29:9: mismatched input 'row_number'. Expecting: '(', ')', ',', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'SELECT', 'TABLE', 'UNION', 'VALUES', 'WHERE', 'WINDOW', 'WITH', <EOF>
[0m18:06:06.667983 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_silver (execute): 18:05:52.935875 => 18:06:06.667578
[0m18:06:06.670501 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: Close
[0m18:06:06.674082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9c56ea6-8137-4842-8e7b-0025eaadbc54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7613cd0>]}
[0m18:06:06.674108 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/pyathena/common.py", line 651, in _execute
    query_id = retry_api_call(
               ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pyathena/util.py", line 196, in retry_api_call
    return retry(func, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/botocore/client.py", line 602, in _api_call
    return self._make_api_call(operation_name, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/botocore/context.py", line 123, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/botocore/client.py", line 1078, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.errorfactory.InvalidRequestException: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 29:9: mismatched input 'row_number'. Expecting: '(', ')', ',', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'SELECT', 'TABLE', 'UNION', 'VALUES', 'WHERE', 'WINDOW', 'WITH', <EOF>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 158, in inner
    query_id = self._execute(
               ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pyathena/common.py", line 659, in _execute
    raise DatabaseError(*e.args) from e
pyathena.error.DatabaseError: An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 29:9: mismatched input 'row_number'. Expecting: '(', ')', ',', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'SELECT', 'TABLE', 'UNION', 'VALUES', 'WHERE', 'WINDOW', 'WITH', <EOF>

[0m18:06:06.675561 [info ] [Thread-1 (]: 10 of 10 OK created sql table model climate_bronze.sensor_silver ............... [[32mOK 1145[0m in 13.75s]
[0m18:06:06.678703 [debug] [Thread-1 (]: Finished running node model.climate_bronze.sensor_silver
[0m18:06:06.677972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b8ff10>]}
[0m18:06:06.681946 [error] [Thread-1 (]: 6 of 10 ERROR creating sql table model climate_bronze.eia_silver ............... [[31mERROR[0m in 189.63s]
[0m18:06:06.683781 [debug] [Thread-1 (]: Finished running node model.climate_bronze.eia_silver
[0m18:06:06.683217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:06.685386 [debug] [MainThread]: Connection 'model.climate_bronze.sensor_silver' was properly closed.
[0m18:06:06.687617 [info ] [MainThread]: 
[0m18:06:06.685047 [debug] [Thread-1 (]: Began running node model.climate_bronze.noaa_silver
[0m18:06:06.688937 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 21.01 seconds (81.01s).
[0m18:06:06.689325 [info ] [Thread-1 (]: 7 of 10 START sql table model climate_bronze.noaa_silver ....................... [RUN]
[0m18:06:06.691066 [debug] [MainThread]: Command end result
[0m18:06:06.692254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.eia_silver, now model.climate_bronze.noaa_silver)
[0m18:06:06.693081 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.noaa_silver
[0m18:06:06.704492 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.noaa_silver"
[0m18:06:06.707913 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_silver (compile): 18:06:06.695069 => 18:06:06.707679
[0m18:06:06.708682 [debug] [Thread-1 (]: Began executing node model.climate_bronze.noaa_silver
[0m18:06:06.713210 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:06:06.713945 [info ] [MainThread]: 
[0m18:06:06.714143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:06.714545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:06.715375 [info ] [MainThread]: 
[0m18:06:06.716305 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m18:06:06.717992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 81.52766, "process_user_time": 5.846612, "process_kernel_time": 0.754563, "process_mem_max_rss": "186884", "process_out_blocks": "2989", "process_in_blocks": "0"}
[0m18:06:06.718494 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:06.718382 after 81.53 seconds
[0m18:06:06.718875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b4e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9739d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf973990>]}
[0m18:06:06.719253 [debug] [MainThread]: Flushing usage events
[0m18:06:07.325775 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:06:07.327909 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.noaa_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/noaa_silver/11bee2b7-5eb3-492a-946e-4a3cac804f61',
      format='parquet'
    )
    as
      select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m18:06:07.908489 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0b893ab4-6286-479a-9815-8ffe4246eb5d
[0m18:06:15.444159 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 764daec3-4a3e-424b-92d7-cffb120eb522
[0m18:06:29.007320 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 54fc16ed-5b03-4dfd-b148-27ec945da42b
[0m18:06:54.573488 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c4e2dcc9-5846-4581-ba59-c5dcc6b1fc7e
[0m18:07:44.525276 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 02ae66bb-5af5-48ce-98f4-9b1d37573590
[0m18:09:22.457303 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ecd3d15d-38e3-49d5-82b2-6fc829812662
[0m18:09:23.957214 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.climate_bronze.noaa_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/ecd3d15d-38e3-49d5-82b2-6fc829812662' before retrying. Athena will not delete data in your account.
[0m18:09:23.957763 [debug] [Thread-1 (]: Timing info for model.climate_bronze.noaa_silver (execute): 18:06:06.709044 => 18:09:23.957632
[0m18:09:23.958050 [debug] [Thread-1 (]: On model.climate_bronze.noaa_silver: Close
[0m18:09:23.958661 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.climate_bronze.noaa_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/ecd3d15d-38e3-49d5-82b2-6fc829812662' before retrying. Athena will not delete data in your account.
[0m18:09:23.963235 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.climate_bronze.noaa_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/ecd3d15d-38e3-49d5-82b2-6fc829812662' before retrying. Athena will not delete data in your account.

[0m18:09:23.963806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa3e5a90>]}
[0m18:09:23.964296 [error] [Thread-1 (]: 7 of 10 ERROR creating sql table model climate_bronze.noaa_silver .............. [[31mERROR[0m in 197.27s]
[0m18:09:23.964749 [debug] [Thread-1 (]: Finished running node model.climate_bronze.noaa_silver
[0m18:09:23.965080 [debug] [Thread-1 (]: Began running node model.climate_bronze.openmeteo_silver
[0m18:09:23.965455 [info ] [Thread-1 (]: 8 of 10 START sql table model climate_bronze.openmeteo_silver .................. [RUN]
[0m18:09:23.965999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.noaa_silver, now model.climate_bronze.openmeteo_silver)
[0m18:09:23.966229 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openmeteo_silver
[0m18:09:23.968430 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openmeteo_silver"
[0m18:09:23.970191 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_silver (compile): 18:09:23.966374 => 18:09:23.970077
[0m18:09:23.970422 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openmeteo_silver
[0m18:09:23.974742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:25.477833 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m18:09:25.479682 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:09:25.483716 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:09:26.634718 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m18:09:26.636844 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:09:26.637816 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."climate_bronze"."openmeteo_silver" is stored in s3://climate-energy-raw-data/climate_bronze/openmeteo_silver/0701a242-2862-4775-9a84-6401a6ebc1bb
[0m18:09:27.904548 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/climate_bronze/openmeteo_silver/0701a242-2862-4775-9a84-6401a6ebc1bb', bucket='climate-energy-raw-data', prefix='climate_bronze/openmeteo_silver/0701a242-2862-4775-9a84-6401a6ebc1bb/'
[0m18:09:30.781217 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."climate_bronze"."openmeteo_silver"
[0m18:09:30.789395 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:09:31.985453 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:09:31.987826 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/openmeteo_silver/2c873e39-2240-4565-a34c-889eb3f5bf5f',
      format='parquet'
    )
    as
      select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."openmeteo_bronze"
[0m18:09:32.529296 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 77fcfba6-660d-46b2-a9bd-64b850baf027
[0m18:09:35.323890 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":41054}
[0m18:09:35.331895 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_silver"
[0m18:09:35.333167 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: alter table `AwsDataCatalog`.`climate_bronze`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m18:09:35.564822 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ff644a71-fd60-4e38-95a8-ff9d310a0b74
[0m18:09:37.189642 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:09:37.196188 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openmeteo_silver"
[0m18:09:37.199251 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openmeteo_silver"
[0m18:09:37.200098 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":41054}';
[0m18:09:37.389739 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 34458ece-0996-4687-b41d-7a79f39e6d18
[0m18:09:39.144142 [debug] [Thread-1 (]: SQL status: OK 4447 in 2.0 seconds
[0m18:09:39.155647 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openmeteo_silver (execute): 18:09:23.970561 => 18:09:39.154954
[0m18:09:39.157267 [debug] [Thread-1 (]: On model.climate_bronze.openmeteo_silver: Close
[0m18:09:39.159659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac241590>]}
[0m18:09:39.161337 [info ] [Thread-1 (]: 8 of 10 OK created sql table model climate_bronze.openmeteo_silver ............. [[32mOK 4447[0m in 15.19s]
[0m18:09:39.162906 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openmeteo_silver
[0m18:09:39.163827 [debug] [Thread-1 (]: Began running node model.climate_bronze.openweather_silver
[0m18:09:39.165007 [info ] [Thread-1 (]: 9 of 10 START sql table model climate_bronze.openweather_silver ................ [RUN]
[0m18:09:39.168892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openmeteo_silver, now model.climate_bronze.openweather_silver)
[0m18:09:39.169492 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.openweather_silver
[0m18:09:39.175699 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.openweather_silver"
[0m18:09:39.177598 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_silver (compile): 18:09:39.169900 => 18:09:39.177356
[0m18:09:39.178156 [debug] [Thread-1 (]: Began executing node model.climate_bronze.openweather_silver
[0m18:09:39.182090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:40.565641 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m18:09:40.566517 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:09:40.567314 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:09:41.732992 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m18:09:41.734757 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:09:41.736027 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."climate_bronze"."openweather_silver" is stored in s3://climate-energy-raw-data/climate_bronze/openweather_silver/36ce0ed9-d0d7-4f28-b2ba-9bfc9af7cf90
[0m18:09:42.930159 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/climate_bronze/openweather_silver/36ce0ed9-d0d7-4f28-b2ba-9bfc9af7cf90', bucket='climate-energy-raw-data', prefix='climate_bronze/openweather_silver/36ce0ed9-d0d7-4f28-b2ba-9bfc9af7cf90/'
[0m18:09:45.676951 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."climate_bronze"."openweather_silver"
[0m18:09:45.682385 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:09:46.862195 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:09:46.863736 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/openweather_silver/3196b0be-2387-4ea5-9a16-776047598346',
      format='parquet'
    )
    as
      select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."openweather_bronze"
[0m18:09:47.408050 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 997e8bf9-2064-4504-ab15-c04fd551bf65
[0m18:09:51.342558 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1589}
[0m18:09:51.344915 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_silver"
[0m18:09:51.345763 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: alter table `AwsDataCatalog`.`climate_bronze`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m18:09:51.660684 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e79111b9-bb90-4e7d-afeb-8270524fc8e9
[0m18:09:53.273158 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:09:53.277537 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.openweather_silver"
[0m18:09:53.280987 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.openweather_silver"
[0m18:09:53.282167 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1589}';
[0m18:09:53.474821 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4ff6b126-b6d2-40d5-9ea8-1ba9e7867463
[0m18:09:55.137561 [debug] [Thread-1 (]: SQL status: OK 63 in 2.0 seconds
[0m18:09:55.143270 [debug] [Thread-1 (]: Timing info for model.climate_bronze.openweather_silver (execute): 18:09:39.178524 => 18:09:55.142936
[0m18:09:55.144397 [debug] [Thread-1 (]: On model.climate_bronze.openweather_silver: Close
[0m18:09:55.146107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa08cf9d0>]}
[0m18:09:55.147265 [info ] [Thread-1 (]: 9 of 10 OK created sql table model climate_bronze.openweather_silver ........... [[32mOK 63[0m in 15.98s]
[0m18:09:55.148497 [debug] [Thread-1 (]: Finished running node model.climate_bronze.openweather_silver
[0m18:09:55.149390 [debug] [Thread-1 (]: Began running node model.climate_bronze.sensor_silver
[0m18:09:55.150351 [info ] [Thread-1 (]: 10 of 10 START sql table model climate_bronze.sensor_silver .................... [RUN]
[0m18:09:55.153674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_bronze.openweather_silver, now model.climate_bronze.sensor_silver)
[0m18:09:55.154493 [debug] [Thread-1 (]: Began compiling node model.climate_bronze.sensor_silver
[0m18:09:55.158719 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_bronze.sensor_silver"
[0m18:09:55.160738 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_silver (compile): 18:09:55.154927 => 18:09:55.160465
[0m18:09:55.161355 [debug] [Thread-1 (]: Began executing node model.climate_bronze.sensor_silver
[0m18:09:55.165962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:56.481245 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m18:09:56.482583 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:09:56.483667 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:09:57.688180 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m18:09:57.689411 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:09:57.690209 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."climate_bronze"."sensor_silver" is stored in s3://climate-energy-raw-data/climate_bronze/sensor_silver/7e413460-c7b4-4fb4-b711-fb0d75d4e8d4
[0m18:09:58.314561 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/climate_bronze/sensor_silver/7e413460-c7b4-4fb4-b711-fb0d75d4e8d4', bucket='climate-energy-raw-data', prefix='climate_bronze/sensor_silver/7e413460-c7b4-4fb4-b711-fb0d75d4e8d4/'
[0m18:10:00.484570 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."climate_bronze"."sensor_silver"
[0m18:10:00.488212 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:10:01.023179 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:10:01.025619 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_silver"} */


    create table "AwsDataCatalog"."climate_bronze"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/climate_bronze/sensor_silver/e5585c91-5323-4998-81ae-974487d7f384',
      format='parquet'
    )
    as
      select
    location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."climate_bronze"."sensor_bronze"
[0m18:10:01.571747 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 20173156-2a91-4106-b873-1399711fdb93
[0m18:10:04.329818 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":1145,"data_scanned_in_bytes":13364}
[0m18:10:04.332651 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_silver"
[0m18:10:04.334248 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: alter table `AwsDataCatalog`.`climate_bronze`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m18:10:04.583475 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 430760dd-67cf-4f42-9939-0c18c753d584
[0m18:10:06.210634 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:10:06.214558 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_bronze.sensor_silver"
[0m18:10:06.218557 [debug] [Thread-1 (]: Using athena connection "model.climate_bronze.sensor_silver"
[0m18:10:06.219694 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "climate_bronze", "target_name": "dev", "node_id": "model.climate_bronze.sensor_silver"} */
SELECT '{"rowcount":1145,"data_scanned_in_bytes":13364}';
[0m18:10:06.421212 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bbb31930-8336-4891-ae1b-8b656404e2b6
[0m18:10:08.102777 [debug] [Thread-1 (]: SQL status: OK 1145 in 2.0 seconds
[0m18:10:08.108287 [debug] [Thread-1 (]: Timing info for model.climate_bronze.sensor_silver (execute): 18:09:55.161790 => 18:10:08.107945
[0m18:10:08.110170 [debug] [Thread-1 (]: On model.climate_bronze.sensor_silver: Close
[0m18:10:08.112017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46356fea-199a-46cb-a1ed-6a3c531891c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8497510>]}
[0m18:10:08.113248 [info ] [Thread-1 (]: 10 of 10 OK created sql table model climate_bronze.sensor_silver ............... [[32mOK 1145[0m in 12.96s]
[0m18:10:08.114869 [debug] [Thread-1 (]: Finished running node model.climate_bronze.sensor_silver
[0m18:10:08.119569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:08.120455 [debug] [MainThread]: Connection 'model.climate_bronze.sensor_silver' was properly closed.
[0m18:10:08.122650 [info ] [MainThread]: 
[0m18:10:08.123810 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 7 minutes and 35.16 seconds (455.16s).
[0m18:10:08.126324 [debug] [MainThread]: Command end result
[0m18:10:08.141954 [info ] [MainThread]: 
[0m18:10:08.142549 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:10:08.143036 [info ] [MainThread]: 
[0m18:10:08.143568 [error] [MainThread]:   An error occurred (InvalidRequestException) when calling the StartQueryExecution operation: line 29:9: mismatched input 'row_number'. Expecting: '(', ')', ',', 'EXCEPT', 'FETCH', 'FROM', 'GROUP', 'HAVING', 'INTERSECT', 'LIMIT', 'OFFSET', 'ORDER', 'SELECT', 'TABLE', 'UNION', 'VALUES', 'WHERE', 'WINDOW', 'WITH', <EOF>
[0m18:10:08.143997 [info ] [MainThread]: 
[0m18:10:08.144461 [error] [MainThread]:   TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.climate_bronze.noaa_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/ecd3d15d-38e3-49d5-82b2-6fc829812662' before retrying. Athena will not delete data in your account.
[0m18:10:08.144986 [info ] [MainThread]: 
[0m18:10:08.145541 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m18:10:08.147398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 455.6508, "process_user_time": 6.216296, "process_kernel_time": 0.681182, "process_mem_max_rss": "194396", "process_out_blocks": "3021", "command_success": false, "process_in_blocks": "0"}
[0m18:10:08.148015 [debug] [MainThread]: Command `dbt run` failed at 18:10:08.147824 after 455.65 seconds
[0m18:10:08.148601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ed9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ed9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabc1fa10>]}
[0m18:10:08.149061 [debug] [MainThread]: Flushing usage events
[0m18:23:17.430662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8516d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea5a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d851490>]}


============================== 18:23:17.435294 | 478da8e5-6b7d-4470-a492-64ba4c9693e1 ==============================
[0m18:23:17.435294 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:23:17.436183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:23:17.436491 [info ] [MainThread]: dbt version: 1.7.9
[0m18:23:17.436781 [info ] [MainThread]: python version: 3.11.14
[0m18:23:17.437059 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m18:23:17.437299 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m18:23:17.439145 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:23:17.439391 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:23:17.439716 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:23:17.477098 [info ] [MainThread]: Configuration:
[0m18:23:17.477568 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:23:17.477911 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:23:17.478348 [info ] [MainThread]: Required dependencies:
[0m18:23:17.479119 [debug] [MainThread]: Executing "git --help"
[0m18:23:17.481409 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:23:17.481784 [debug] [MainThread]: STDERR: "b''"
[0m18:23:17.481972 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:23:17.482172 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:23:17.482391 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:23:17.482677 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'silver'


[0m18:23:17.483516 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.07462171, "process_user_time": 1.041762, "process_kernel_time": 0.235851, "process_mem_max_rss": "103952", "process_out_blocks": "1881", "command_success": false, "process_in_blocks": "0"}
[0m18:23:17.483919 [debug] [MainThread]: Command `dbt debug` failed at 18:23:17.483854 after 0.08 seconds
[0m18:23:17.484174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c85790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d891990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8485d0>]}
[0m18:23:17.484460 [debug] [MainThread]: Flushing usage events
[0m18:24:50.750276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6ee7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa8af990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6ee810>]}


============================== 18:24:50.752113 | 67a402e0-d0a3-4336-9af8-78453b010b57 ==============================
[0m18:24:50.752113 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:24:50.752901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:24:50.753191 [info ] [MainThread]: dbt version: 1.7.9
[0m18:24:50.753462 [info ] [MainThread]: python version: 3.11.14
[0m18:24:50.753789 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m18:24:50.754059 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m18:24:51.036885 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:24:51.037696 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:24:51.040535 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:24:51.044383 [info ] [MainThread]: adapter type: athena
[0m18:24:51.044785 [info ] [MainThread]: adapter version: 1.7.2
[0m18:24:51.088478 [info ] [MainThread]: Configuration:
[0m18:24:51.088903 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:24:51.089605 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:24:51.089912 [info ] [MainThread]: Required dependencies:
[0m18:24:51.090227 [debug] [MainThread]: Executing "git --help"
[0m18:24:51.092044 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:24:51.092380 [debug] [MainThread]: STDERR: "b''"
[0m18:24:51.092582 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:24:51.092807 [info ] [MainThread]: Connection:
[0m18:24:51.093082 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m18:24:51.093300 [info ] [MainThread]:   work_group: None
[0m18:24:51.093573 [info ] [MainThread]:   region_name: us-east-1
[0m18:24:51.093850 [info ] [MainThread]:   database: AwsDataCatalog
[0m18:24:51.094036 [info ] [MainThread]:   schema: silver
[0m18:24:51.094409 [info ] [MainThread]:   poll_interval: 1.0
[0m18:24:51.094808 [info ] [MainThread]:   aws_profile_name: None
[0m18:24:51.095033 [info ] [MainThread]:   aws_access_key_id: None
[0m18:24:51.095323 [info ] [MainThread]:   aws_secret_access_key: None
[0m18:24:51.095952 [info ] [MainThread]:   aws_session_token: None
[0m18:24:51.096256 [info ] [MainThread]:   endpoint_url: None
[0m18:24:51.096561 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m18:24:51.096819 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m18:24:51.097075 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m18:24:51.097370 [info ] [MainThread]:   debug_query_state: False
[0m18:24:51.097662 [info ] [MainThread]:   seed_s3_upload_args: None
[0m18:24:51.097937 [info ] [MainThread]:   lf_tags_database: None
[0m18:24:51.098239 [info ] [MainThread]:   spark_work_group: None
[0m18:24:51.098629 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m18:24:51.099128 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m18:24:51.099351 [debug] [MainThread]: Using athena connection "debug"
[0m18:24:51.099529 [debug] [MainThread]: On debug: select 1 as id
[0m18:24:51.099734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:51.859535 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID cc2cad1c-cac7-48c2-8012-b87a9583dd3c
[0m18:24:53.622600 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m18:24:53.625769 [debug] [MainThread]: On debug: Close
[0m18:24:53.626733 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:24:53.627761 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:24:53.630444 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.9024036, "process_user_time": 1.268657, "process_kernel_time": 0.393755, "process_mem_max_rss": "144272", "process_out_blocks": "341", "process_in_blocks": "0"}
[0m18:24:53.631483 [debug] [MainThread]: Command `dbt debug` succeeded at 18:24:53.631258 after 2.90 seconds
[0m18:24:53.632171 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:24:53.634964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabcb5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa972b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9749e90>]}
[0m18:24:53.635894 [debug] [MainThread]: Flushing usage events
[0m18:25:01.685123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac716fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac904750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad85de90>]}


============================== 18:25:01.686845 | 6f7aa1c5-b537-4c4e-8b0b-20c704ac4edb ==============================
[0m18:25:01.686845 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:25:01.687362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:25:01.922387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f7aa1c5-b537-4c4e-8b0b-20c704ac4edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab7edc50>]}
[0m18:25:01.962868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f7aa1c5-b537-4c4e-8b0b-20c704ac4edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab7bfd90>]}
[0m18:25:01.963335 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m18:25:01.968556 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:25:01.975431 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:25:01.975854 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:25:01.976207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f7aa1c5-b537-4c4e-8b0b-20c704ac4edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca05b90>]}
[0m18:25:02.606186 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.silver.noaa_bronze' (models/bronze/noaa_bronze.sql) depends on a source named 'silver.noaa_weather' which was not found
[0m18:25:02.607269 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.94287956, "process_user_time": 1.801374, "process_kernel_time": 0.122025, "process_mem_max_rss": "134188", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m18:25:02.607678 [debug] [MainThread]: Command `dbt run` failed at 18:25:02.607611 after 0.94 seconds
[0m18:25:02.607992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19e9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19e9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac71f7d0>]}
[0m18:25:02.608289 [debug] [MainThread]: Flushing usage events
[0m18:26:29.929273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8afdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbcd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c6e5990>]}


============================== 18:26:29.931142 | 61777b29-fe2f-48a6-9bea-8b01baea0d1d ==============================
[0m18:26:29.931142 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:26:29.932051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:26:30.167131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61777b29-fe2f-48a6-9bea-8b01baea0d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b8b0990>]}
[0m18:26:30.206451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61777b29-fe2f-48a6-9bea-8b01baea0d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b896050>]}
[0m18:26:30.206931 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m18:26:30.212628 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:26:30.233851 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:26:30.234333 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:26:30.234706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61777b29-fe2f-48a6-9bea-8b01baea0d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b80add0>]}
[0m18:26:30.930147 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.silver.noaa_bronze' (models/bronze/noaa_bronze.sql) depends on a source named 'silver.noaa_weather' which was not found
[0m18:26:30.931381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0269632, "process_user_time": 1.815162, "process_kernel_time": 0.210482, "process_mem_max_rss": "134328", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m18:26:30.931748 [debug] [MainThread]: Command `dbt run` failed at 18:26:30.931649 after 1.03 seconds
[0m18:26:30.932058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c707e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df7cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad04ed0>]}
[0m18:26:30.932340 [debug] [MainThread]: Flushing usage events
[0m18:27:46.170952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1061e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1217790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10632d0>]}


============================== 18:27:46.173162 | 0a43e708-f03a-4a91-8aff-6630d6746369 ==============================
[0m18:27:46.173162 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:27:46.173707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:27:46.415826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a43e708-f03a-4a91-8aff-6630d6746369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb025a9d0>]}
[0m18:27:46.455126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a43e708-f03a-4a91-8aff-6630d6746369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0213dd0>]}
[0m18:27:46.455627 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m18:27:46.460637 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:27:46.467418 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:27:46.467775 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:27:46.468211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0a43e708-f03a-4a91-8aff-6630d6746369', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb025ab90>]}
[0m18:27:47.084468 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.silver.noaa_bronze' (models/bronze/noaa_bronze.sql) depends on a source named 'silver.noaa_weather' which was not found
[0m18:27:47.085307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.94728816, "process_user_time": 1.892287, "process_kernel_time": 0.18434, "process_mem_max_rss": "134308", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m18:27:47.085624 [debug] [MainThread]: Command `dbt run` failed at 18:27:47.085549 after 0.95 seconds
[0m18:27:47.085907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6465790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6464950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafcdbd50>]}
[0m18:27:47.086211 [debug] [MainThread]: Flushing usage events
[0m18:29:30.851991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b3be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d22c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1d23910>]}


============================== 18:29:30.853863 | 5ef9cb37-eea5-431d-87c7-cc2cf67816fa ==============================
[0m18:29:30.853863 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:29:30.854288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:29:31.122239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c05c50>]}
[0m18:29:31.172516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0cea650>]}
[0m18:29:31.173015 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m18:29:31.177494 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:29:31.194940 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:29:31.195395 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m18:29:31.195787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0af0a90>]}
[0m18:29:31.859014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb096b2d0>]}
[0m18:29:31.866199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0a2b090>]}
[0m18:29:31.866481 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m18:29:31.866702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb05d2010>]}
[0m18:29:31.868022 [info ] [MainThread]: 
[0m18:29:31.868639 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m18:29:31.869961 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m18:29:31.870306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:32.556638 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m18:29:32.561782 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver'
[0m18:29:32.562730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:34.016614 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m18:29:34.019133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96b6a10>]}
[0m18:29:34.019954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:34.020514 [info ] [MainThread]: 
[0m18:29:34.023781 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m18:29:34.024462 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m18:29:34.025424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m18:29:34.025821 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m18:29:34.032658 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m18:29:34.035745 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 18:29:34.026046 => 18:29:34.035518
[0m18:29:34.036183 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m18:29:34.059396 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m18:29:34.061792 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m18:29:34.062262 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m18:29:34.062671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:34.754163 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5b40608f-c1ef-4594-a4a2-f70c2c07ac49
[0m18:29:36.482361 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:29:37.760585 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m18:29:37.763081 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:29:37.768383 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 18:29:34.036422 => 18:29:37.768238
[0m18:29:37.768862 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m18:29:37.769380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa88efe10>]}
[0m18:29:37.769765 [info ] [Thread-1 (]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 3.74s]
[0m18:29:37.770385 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m18:29:37.770796 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m18:29:37.771163 [info ] [Thread-1 (]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m18:29:37.772818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m18:29:37.773370 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m18:29:37.775187 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m18:29:37.776880 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 18:29:37.773525 => 18:29:37.776275
[0m18:29:37.777314 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m18:29:37.779336 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m18:29:37.780180 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m18:29:37.780445 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m18:29:37.780660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:38.484547 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d815b673-ea0d-4169-85f6-628be94441e1
[0m18:29:40.148331 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:29:41.404781 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m18:29:41.408840 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:29:41.411496 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 18:29:37.777480 => 18:29:41.411206
[0m18:29:41.412287 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m18:29:41.413635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa82a3ed0>]}
[0m18:29:41.414735 [info ] [Thread-1 (]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 3.64s]
[0m18:29:41.416047 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m18:29:41.416898 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m18:29:41.418006 [info ] [Thread-1 (]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m18:29:41.420797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m18:29:41.421461 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m18:29:41.425110 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m18:29:41.427130 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 18:29:41.421886 => 18:29:41.426837
[0m18:29:41.427698 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m18:29:41.431149 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m18:29:41.432729 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m18:29:41.433248 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m18:29:41.433731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:42.028878 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8a42535e-190a-44f8-b513-e87eee8996a6
[0m18:29:43.703174 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:29:45.027534 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m18:29:45.031274 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:29:45.033400 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 18:29:41.428106 => 18:29:45.033153
[0m18:29:45.034042 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m18:29:45.035258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87ec850>]}
[0m18:29:45.036090 [info ] [Thread-1 (]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 3.62s]
[0m18:29:45.036973 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m18:29:45.037612 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m18:29:45.038391 [info ] [Thread-1 (]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m18:29:45.040550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m18:29:45.041223 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m18:29:45.044467 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m18:29:45.045856 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 18:29:45.041601 => 18:29:45.045667
[0m18:29:45.046276 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m18:29:45.050548 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m18:29:45.052643 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m18:29:45.053222 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m18:29:45.053943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:45.648764 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ece1f889-fc59-482e-8c15-bb8ceef5da79
[0m18:29:47.368501 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:29:48.622547 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m18:29:48.625178 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:29:48.627490 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 18:29:45.046575 => 18:29:48.627196
[0m18:29:48.628196 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m18:29:48.629328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa82db890>]}
[0m18:29:48.630242 [info ] [Thread-1 (]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 3.59s]
[0m18:29:48.631305 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m18:29:48.631982 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m18:29:48.632928 [info ] [Thread-1 (]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m18:29:48.635460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m18:29:48.636158 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m18:29:48.639836 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m18:29:48.641430 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 18:29:48.636621 => 18:29:48.641213
[0m18:29:48.641914 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m18:29:48.645254 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m18:29:48.646859 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m18:29:48.647371 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m18:29:48.647909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:49.340034 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a36d689f-1f7d-4175-aa61-e6172136577c
[0m18:29:51.011034 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:29:52.261130 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m18:29:52.265855 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:29:52.268609 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 18:29:48.642282 => 18:29:52.268272
[0m18:29:52.269382 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m18:29:52.270744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa86e3d90>]}
[0m18:29:52.271808 [info ] [Thread-1 (]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 3.64s]
[0m18:29:52.273207 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m18:29:52.274119 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m18:29:52.275185 [info ] [Thread-1 (]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m18:29:52.277940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m18:29:52.278606 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m18:29:52.282314 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m18:29:52.284862 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 18:29:52.279020 => 18:29:52.284607
[0m18:29:52.285398 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m18:29:52.332704 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:29:52.333297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:53.568628 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:29:53.571952 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/dd6a37b9-fc7e-423c-9c10-c05424c611b1',
      format='parquet'
    )
    as
      with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m18:29:54.144226 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6aefbb04-9e77-469f-b656-fc85505225c7
[0m18:29:55.783158 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1613}
[0m18:29:55.790021 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m18:29:55.791138 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m18:29:56.100110 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3f58a724-34e5-45c8-9bb8-b2b35acf8053
[0m18:29:57.743205 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:29:57.750196 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m18:29:57.754120 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m18:29:57.754827 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1613}';
[0m18:29:57.937258 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e97968f4-3a3c-4ffa-8f2b-9e2e0d8d7265
[0m18:29:59.727922 [debug] [Thread-1 (]: SQL status: OK 2 in 2.0 seconds
[0m18:29:59.732761 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 18:29:52.285807 => 18:29:59.732406
[0m18:29:59.733597 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m18:29:59.735053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8be9c50>]}
[0m18:29:59.736220 [info ] [Thread-1 (]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2[0m in 7.46s]
[0m18:29:59.737535 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m18:29:59.738406 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m18:29:59.739341 [info ] [Thread-1 (]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m18:29:59.742434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m18:29:59.743060 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m18:29:59.746939 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m18:29:59.749461 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 18:29:59.743495 => 18:29:59.749215
[0m18:29:59.750043 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m18:29:59.753498 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:29:59.754071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:00.957485 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:30:00.960913 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/f0a710c8-5269-4986-99b1-019835189761',
      format='parquet'
    )
    as
      select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m18:30:01.521765 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 826eb1fb-3995-4827-bbf0-ccfcad039799
[0m18:30:03.148121 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":675}
[0m18:30:03.148976 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m18:30:03.149354 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m18:30:03.402311 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0de824af-d14d-496a-a03d-6cb84a98e579
[0m18:30:05.034679 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:30:05.039439 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m18:30:05.043232 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m18:30:05.044157 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":675}';
[0m18:30:05.235957 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b4da703f-1a52-4a0f-b56d-882dbb411668
[0m18:30:06.905110 [debug] [Thread-1 (]: SQL status: OK 31 in 2.0 seconds
[0m18:30:06.913447 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 18:29:59.750387 => 18:30:06.913061
[0m18:30:06.914633 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m18:30:06.916445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa829b090>]}
[0m18:30:06.917668 [info ] [Thread-1 (]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 7.18s]
[0m18:30:06.919029 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m18:30:06.920083 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m18:30:06.921209 [info ] [Thread-1 (]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m18:30:06.925022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m18:30:06.925672 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m18:30:06.930016 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m18:30:06.932002 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 18:30:06.926123 => 18:30:06.931689
[0m18:30:06.932591 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m18:30:06.936346 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:30:06.936976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:08.248726 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:30:08.250405 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/bfb7c8a2-c741-4415-8f13-631df2d1e85e',
      format='parquet'
    )
    as
      select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m18:30:08.845900 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b0b8e21c-79e0-4d7f-8063-3083280d7f02
[0m18:30:11.632057 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m18:30:11.634575 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m18:30:11.635512 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m18:30:11.895361 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 90f671c3-2839-42e2-8c47-8a7a9772c920
[0m18:30:13.633995 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:30:13.637908 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m18:30:13.640119 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m18:30:13.640822 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m18:30:13.859654 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3b7a0121-abe2-49f5-b8bf-8fcdc3dfaaa6
[0m18:30:15.589410 [debug] [Thread-1 (]: SQL status: OK 4447 in 2.0 seconds
[0m18:30:15.594024 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 18:30:06.933025 => 18:30:15.593707
[0m18:30:15.595059 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m18:30:15.597076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f4b9d0>]}
[0m18:30:15.598205 [info ] [Thread-1 (]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 8.67s]
[0m18:30:15.599393 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m18:30:15.600175 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m18:30:15.601026 [info ] [Thread-1 (]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m18:30:15.603344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m18:30:15.603965 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m18:30:15.607244 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m18:30:15.610421 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 18:30:15.604339 => 18:30:15.608902
[0m18:30:15.611369 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m18:30:15.618010 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:30:15.619863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:16.902371 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:30:16.905063 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/89359dc3-1dd3-40c2-acff-acdeffb0d081',
      format='parquet'
    )
    as
      select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m18:30:17.476631 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c7801623-ec08-4bdc-b676-b03a57773ed2
[0m18:30:19.115270 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m18:30:19.117844 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m18:30:19.119362 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m18:30:19.372958 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e1c58758-8e0c-4ef7-8277-71d2eb38d62d
[0m18:30:21.041542 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:30:21.049104 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m18:30:21.051856 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m18:30:21.052676 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m18:30:21.279030 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID aec9d366-5661-45ac-ae6a-c84547ea1652
[0m18:30:22.973884 [debug] [Thread-1 (]: SQL status: OK 63 in 2.0 seconds
[0m18:30:22.980312 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 18:30:15.612429 => 18:30:22.979919
[0m18:30:22.981697 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m18:30:22.983472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b9dcd0>]}
[0m18:30:22.984699 [info ] [Thread-1 (]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 7.38s]
[0m18:30:22.986190 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m18:30:22.987036 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m18:30:22.987969 [info ] [Thread-1 (]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m18:30:22.991060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m18:30:22.991862 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m18:30:22.995706 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m18:30:22.997556 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 18:30:22.992365 => 18:30:22.997303
[0m18:30:22.998139 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m18:30:23.002266 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:30:23.003057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:24.324875 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:30:24.327387 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/f8961fac-47c0-41c1-8967-ff0c25c34b84',
      format='parquet'
    )
    as
      select
    location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m18:30:24.879604 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 045243fb-02aa-4b2f-8f3c-76ef38fa5745
[0m18:30:26.520062 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":1145,"data_scanned_in_bytes":13286}
[0m18:30:26.522836 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m18:30:26.523721 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m18:30:26.790814 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 21f2ca58-1fbf-4df5-908a-e65cae1dd288
[0m18:30:28.428900 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:30:28.433608 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m18:30:28.436438 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m18:30:28.437216 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":1145,"data_scanned_in_bytes":13286}';
[0m18:30:28.633864 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3fbe6b90-ee28-4d88-9795-5b14019bd0b8
[0m18:30:30.306165 [debug] [Thread-1 (]: SQL status: OK 1145 in 2.0 seconds
[0m18:30:30.313320 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 18:30:22.998573 => 18:30:30.312877
[0m18:30:30.314404 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m18:30:30.315817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ef9cb37-eea5-431d-87c7-cc2cf67816fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96b6610>]}
[0m18:30:30.317040 [info ] [Thread-1 (]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 1145[0m in 7.33s]
[0m18:30:30.318589 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m18:30:30.322649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:30.323344 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m18:30:30.323834 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m18:30:30.325892 [info ] [MainThread]: 
[0m18:30:30.326551 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 0 minutes and 58.46 seconds (58.46s).
[0m18:30:30.328768 [debug] [MainThread]: Command end result
[0m18:30:30.346933 [info ] [MainThread]: 
[0m18:30:30.347628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:30.348778 [info ] [MainThread]: 
[0m18:30:30.349662 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m18:30:30.351834 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 59.523468, "process_user_time": 5.285504, "process_kernel_time": 0.818511, "process_mem_max_rss": "206992", "process_out_blocks": "2962", "process_in_blocks": "0"}
[0m18:30:30.352598 [debug] [MainThread]: Command `dbt run` succeeded at 18:30:30.352381 after 59.52 seconds
[0m18:30:30.353464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1b788d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb333a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f75790>]}
[0m18:30:30.354117 [debug] [MainThread]: Flushing usage events
[0m18:35:21.653499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930efe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930ec510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930ece10>]}


============================== 18:35:21.655438 | a2510cd8-cefc-454f-8924-405c10501a0c ==============================
[0m18:35:21.655438 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:35:21.656280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:21.656595 [info ] [MainThread]: dbt version: 1.7.9
[0m18:35:21.656898 [info ] [MainThread]: python version: 3.11.14
[0m18:35:21.657217 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m18:35:21.657513 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m18:35:21.852239 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:35:21.852723 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:35:21.853082 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:35:21.853547 [info ] [MainThread]: adapter type: athena
[0m18:35:21.853850 [info ] [MainThread]: adapter version: 1.7.2
[0m18:35:21.889530 [info ] [MainThread]: Configuration:
[0m18:35:21.889962 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:35:21.890355 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:35:21.890651 [info ] [MainThread]: Required dependencies:
[0m18:35:21.890982 [debug] [MainThread]: Executing "git --help"
[0m18:35:21.892787 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:35:21.893091 [debug] [MainThread]: STDERR: "b''"
[0m18:35:21.893285 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:35:21.893569 [info ] [MainThread]: Connection:
[0m18:35:21.893845 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m18:35:21.894171 [info ] [MainThread]:   work_group: None
[0m18:35:21.894455 [info ] [MainThread]:   region_name: us-east-1
[0m18:35:21.894822 [info ] [MainThread]:   database: AwsDataCatalog
[0m18:35:21.895176 [info ] [MainThread]:   schema: silver
[0m18:35:21.895444 [info ] [MainThread]:   poll_interval: 1.0
[0m18:35:21.895899 [info ] [MainThread]:   aws_profile_name: None
[0m18:35:21.896253 [info ] [MainThread]:   aws_access_key_id: None
[0m18:35:21.896509 [info ] [MainThread]:   aws_secret_access_key: None
[0m18:35:21.896831 [info ] [MainThread]:   aws_session_token: None
[0m18:35:21.897127 [info ] [MainThread]:   endpoint_url: None
[0m18:35:21.897376 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m18:35:21.897744 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m18:35:21.897970 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m18:35:21.898231 [info ] [MainThread]:   debug_query_state: False
[0m18:35:21.898465 [info ] [MainThread]:   seed_s3_upload_args: None
[0m18:35:21.898815 [info ] [MainThread]:   lf_tags_database: None
[0m18:35:21.899031 [info ] [MainThread]:   spark_work_group: None
[0m18:35:21.899351 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m18:35:21.901050 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m18:35:21.901344 [debug] [MainThread]: Using athena connection "debug"
[0m18:35:21.901541 [debug] [MainThread]: On debug: select 1 as id
[0m18:35:21.901776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:22.542338 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 48fc3882-a2d2-4440-99f7-cc81e46aa686
[0m18:35:24.287772 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m18:35:24.291635 [debug] [MainThread]: On debug: Close
[0m18:35:24.292886 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:35:24.294599 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:35:24.296381 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.6638286, "process_user_time": 1.235649, "process_kernel_time": 0.191635, "process_mem_max_rss": "144396", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m18:35:24.297390 [debug] [MainThread]: Command `dbt debug` succeeded at 18:35:24.297144 after 2.66 seconds
[0m18:35:24.298121 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:35:24.300735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930ed650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94900210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9226fb10>]}
[0m18:35:24.301614 [debug] [MainThread]: Flushing usage events
[0m18:35:32.267512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb040f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb025da10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb025cb10>]}


============================== 18:35:32.269216 | 596d9f58-0745-4923-ae01-b201c17a05cf ==============================
[0m18:35:32.269216 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:35:32.269669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:35:32.488067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf33e850>]}
[0m18:35:32.526715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf49b8d0>]}
[0m18:35:32.527169 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m18:35:32.533764 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:35:32.554593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m18:35:32.555069 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/sensor_silver.sql
[0m18:35:32.555361 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/eia_silver.sql
[0m18:35:32.555573 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/openmeteo_silver.sql
[0m18:35:32.555825 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/noaa_silver.sql
[0m18:35:32.556093 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/openweather_silver.sql
[0m18:35:32.696729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0a8f90>]}
[0m18:35:32.704171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf134390>]}
[0m18:35:32.704469 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m18:35:32.704874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb6f310>]}
[0m18:35:32.706266 [info ] [MainThread]: 
[0m18:35:32.707010 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m18:35:32.708011 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m18:35:32.708284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:33.383401 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m18:35:33.387603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m18:35:33.388186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:34.832067 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m18:35:34.838617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf5ab10>]}
[0m18:35:34.840313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:34.841207 [info ] [MainThread]: 
[0m18:35:34.847099 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m18:35:34.848187 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m18:35:34.849781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m18:35:34.850511 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m18:35:34.859785 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m18:35:34.862154 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 18:35:34.850928 => 18:35:34.861845
[0m18:35:34.862687 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m18:35:34.890585 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m18:35:34.892151 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m18:35:34.892513 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m18:35:34.892814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:35.479625 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b3be26c7-a571-4276-948a-2176ebc48e56
[0m18:35:37.265627 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:35:38.517818 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m18:35:38.522859 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:35:38.533188 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 18:35:34.863007 => 18:35:38.532885
[0m18:35:38.533909 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m18:35:38.535091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa789abd0>]}
[0m18:35:38.536147 [info ] [Thread-1 (]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 3.69s]
[0m18:35:38.537274 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m18:35:38.538057 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m18:35:38.539014 [info ] [Thread-1 (]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m18:35:38.541735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m18:35:38.542431 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m18:35:38.545781 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m18:35:38.547417 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 18:35:38.542885 => 18:35:38.547201
[0m18:35:38.547914 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m18:35:38.551282 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m18:35:38.552530 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m18:35:38.553013 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m18:35:38.553452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:39.238664 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ab5d26d5-6519-4288-b1fd-b6c8ad057dc3
[0m18:35:40.982677 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:35:42.231679 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m18:35:42.235465 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:35:42.237769 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 18:35:38.548260 => 18:35:42.237468
[0m18:35:42.238461 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m18:35:42.239649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bbe850>]}
[0m18:35:42.240659 [info ] [Thread-1 (]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 3.70s]
[0m18:35:42.241707 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m18:35:42.242401 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m18:35:42.243257 [info ] [Thread-1 (]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m18:35:42.245917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m18:35:42.246565 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m18:35:42.249971 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m18:35:42.251583 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 18:35:42.246984 => 18:35:42.251364
[0m18:35:42.252079 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m18:35:42.255366 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m18:35:42.256640 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m18:35:42.257050 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m18:35:42.257401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:42.931693 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d908af79-4f68-4dd9-9153-425d94dcdc35
[0m18:35:44.621508 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:35:45.852664 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m18:35:45.856547 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:35:45.859600 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 18:35:42.252419 => 18:35:45.859300
[0m18:35:45.860412 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m18:35:45.861669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa722a410>]}
[0m18:35:45.862743 [info ] [Thread-1 (]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 3.62s]
[0m18:35:45.863973 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m18:35:45.864816 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m18:35:45.865905 [info ] [Thread-1 (]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m18:35:45.868753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m18:35:45.869392 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m18:35:45.872966 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m18:35:45.875570 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 18:35:45.869799 => 18:35:45.875245
[0m18:35:45.876204 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m18:35:45.879806 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m18:35:45.881271 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m18:35:45.881810 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m18:35:45.882284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:46.479731 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0d6969ee-59ea-47e6-9d83-492d94e5c9f3
[0m18:35:48.225094 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:35:49.478334 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m18:35:49.482389 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:35:49.485707 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 18:35:45.876633 => 18:35:49.485344
[0m18:35:49.486589 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m18:35:49.488005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7226010>]}
[0m18:35:49.489162 [info ] [Thread-1 (]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 3.62s]
[0m18:35:49.490533 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m18:35:49.491417 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m18:35:49.492498 [info ] [Thread-1 (]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m18:35:49.495419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m18:35:49.496054 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m18:35:49.499647 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m18:35:49.501631 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 18:35:49.496466 => 18:35:49.501381
[0m18:35:49.502211 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m18:35:49.505966 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m18:35:49.507369 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m18:35:49.507899 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m18:35:49.508389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:50.108684 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bfaac45d-e590-4551-992d-f14a8751b254
[0m18:35:51.786536 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:35:53.083341 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m18:35:53.087291 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:35:53.090321 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 18:35:49.502631 => 18:35:53.089984
[0m18:35:53.091208 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m18:35:53.092646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa739f290>]}
[0m18:35:53.093781 [info ] [Thread-1 (]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 3.60s]
[0m18:35:53.095088 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m18:35:53.095970 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m18:35:53.097073 [info ] [Thread-1 (]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m18:35:53.100102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m18:35:53.100746 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m18:35:53.104768 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m18:35:53.107136 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 18:35:53.101189 => 18:35:53.106888
[0m18:35:53.107691 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m18:35:53.140875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:54.497125 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m18:35:54.498396 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:35:54.501695 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:35:55.711176 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m18:35:55.712406 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:35:55.713329 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/dd6a37b9-fc7e-423c-9c10-c05424c611b1
[0m18:35:57.054174 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/dd6a37b9-fc7e-423c-9c10-c05424c611b1', bucket='climate-energy-raw-data', prefix='silver/eia_silver/dd6a37b9-fc7e-423c-9c10-c05424c611b1/'
[0m18:35:59.708070 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m18:35:59.748520 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:36:00.920561 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:36:00.922901 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/0e0b2e9e-25a1-4aee-842b-b6888b6b84e5',
      format='parquet'
    )
    as
      
with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m18:36:01.488994 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 04117c1a-1a28-45d3-9e48-3fe6c60cc8e2
[0m18:36:03.158622 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1613}
[0m18:36:03.165534 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m18:36:03.166584 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m18:36:03.436053 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1f80c095-966d-4766-b800-0a3040888707
[0m18:36:05.080793 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:36:05.085221 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m18:36:05.088206 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m18:36:05.089347 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1613}';
[0m18:36:05.285549 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6d4e8f18-f81d-4160-8eec-e09be683e47d
[0m18:36:06.962120 [debug] [Thread-1 (]: SQL status: OK 2 in 2.0 seconds
[0m18:36:06.970273 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 18:35:53.108061 => 18:36:06.969924
[0m18:36:06.971464 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m18:36:06.973000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa537b750>]}
[0m18:36:06.974215 [info ] [Thread-1 (]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2[0m in 13.88s]
[0m18:36:06.975626 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m18:36:06.976644 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m18:36:06.977710 [info ] [Thread-1 (]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m18:36:06.981009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m18:36:06.981709 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m18:36:06.985873 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m18:36:06.987772 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 18:36:06.982175 => 18:36:06.987484
[0m18:36:06.988345 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m18:36:06.992038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:08.328122 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m18:36:08.329349 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:36:08.330441 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:36:09.531933 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m18:36:09.533271 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:36:09.534050 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/f0a710c8-5269-4986-99b1-019835189761
[0m18:36:10.760447 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/f0a710c8-5269-4986-99b1-019835189761', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/f0a710c8-5269-4986-99b1-019835189761/'
[0m18:36:13.653541 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m18:36:13.658915 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:36:14.866687 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:36:14.868572 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/f16ca353-a265-47b3-b588-71f136e30fc4',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m18:36:15.429386 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8963a872-de4d-4713-9cdb-03d26942164c
[0m18:36:17.103535 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":675}
[0m18:36:17.106919 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m18:36:17.107739 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m18:36:17.351533 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c689b6fe-ac64-4c22-adf5-74f3d16979a4
[0m18:36:19.001783 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:36:19.004510 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m18:36:19.007491 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m18:36:19.008179 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":675}';
[0m18:36:19.193594 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f013c8db-3885-4f23-bcc6-8ca50c77a3a0
[0m18:36:20.873882 [debug] [Thread-1 (]: SQL status: OK 31 in 2.0 seconds
[0m18:36:20.881582 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 18:36:06.988741 => 18:36:20.881131
[0m18:36:20.882942 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m18:36:20.884815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac3e2c90>]}
[0m18:36:20.885978 [info ] [Thread-1 (]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 13.91s]
[0m18:36:20.887133 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m18:36:20.888014 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m18:36:20.889002 [info ] [Thread-1 (]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m18:36:20.892529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m18:36:20.893397 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m18:36:20.897765 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m18:36:20.899525 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 18:36:20.893932 => 18:36:20.899264
[0m18:36:20.900141 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m18:36:20.904138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:22.230929 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m18:36:22.232219 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:36:22.233270 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:36:23.497954 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m18:36:23.499168 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:36:23.500090 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/bfb7c8a2-c741-4415-8f13-631df2d1e85e
[0m18:36:24.719890 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/bfb7c8a2-c741-4415-8f13-631df2d1e85e', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/bfb7c8a2-c741-4415-8f13-631df2d1e85e/'
[0m18:36:27.424286 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m18:36:27.430810 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:36:28.599145 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:36:28.601105 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/5d1af2bb-ceb4-4b8d-a3a2-4775de8003f8',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m18:36:29.160847 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0b6b614f-3b74-482a-a029-001b2e70e5ec
[0m18:36:31.955806 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m18:36:31.958781 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m18:36:31.959659 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m18:36:32.232134 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f2983e19-aa03-46eb-af96-02ac99ad65db
[0m18:36:33.905624 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:36:33.911174 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m18:36:33.914538 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m18:36:33.915209 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m18:36:34.115348 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d7568a69-3c50-4d08-a4b5-c38307e98c21
[0m18:36:35.805992 [debug] [Thread-1 (]: SQL status: OK 4447 in 2.0 seconds
[0m18:36:35.812845 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 18:36:20.900549 => 18:36:35.812360
[0m18:36:35.814156 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m18:36:35.815830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa412a810>]}
[0m18:36:35.817111 [info ] [Thread-1 (]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 14.93s]
[0m18:36:35.818560 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m18:36:35.819477 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m18:36:35.820515 [info ] [Thread-1 (]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m18:36:35.823841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m18:36:35.824535 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m18:36:35.828765 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m18:36:35.831487 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 18:36:35.824955 => 18:36:35.831196
[0m18:36:35.832059 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m18:36:35.835767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:37.130588 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m18:36:37.132377 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:36:37.133496 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:36:38.334716 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m18:36:38.336412 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:36:38.337253 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/89359dc3-1dd3-40c2-acff-acdeffb0d081
[0m18:36:39.604674 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/89359dc3-1dd3-40c2-acff-acdeffb0d081', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/89359dc3-1dd3-40c2-acff-acdeffb0d081/'
[0m18:36:42.427986 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m18:36:42.435137 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:36:43.618726 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:36:43.621635 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/1e9e6407-0f7d-4958-be05-5eda0ec0f2de',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m18:36:44.239879 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d0cb61ae-e183-47d2-b4bf-b31deeab99e2
[0m18:36:45.906477 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m18:36:45.909680 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m18:36:45.910591 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m18:36:46.203133 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bea7f643-0a32-4e61-b34b-3e40ecb3c1f7
[0m18:36:47.889252 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:36:47.895326 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m18:36:47.899750 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m18:36:47.900600 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m18:36:48.134031 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1839fb2c-537b-4fac-a5f4-6d4f8a8e2a16
[0m18:36:49.847594 [debug] [Thread-1 (]: SQL status: OK 63 in 2.0 seconds
[0m18:36:49.855882 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 18:36:35.832486 => 18:36:49.855192
[0m18:36:49.857019 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m18:36:49.858982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ba1d50>]}
[0m18:36:49.860623 [info ] [Thread-1 (]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 14.04s]
[0m18:36:49.862013 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m18:36:49.862950 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m18:36:49.864319 [info ] [Thread-1 (]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m18:36:49.867710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m18:36:49.868388 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m18:36:49.874592 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m18:36:49.876464 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 18:36:49.868838 => 18:36:49.876198
[0m18:36:49.877003 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m18:36:49.880735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:51.287031 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m18:36:51.288433 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:36:51.289572 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m18:36:52.542793 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m18:36:52.544218 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:36:52.545068 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/f8961fac-47c0-41c1-8967-ff0c25c34b84
[0m18:36:53.756360 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/f8961fac-47c0-41c1-8967-ff0c25c34b84', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/f8961fac-47c0-41c1-8967-ff0c25c34b84/'
[0m18:36:56.047441 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m18:36:56.053807 [debug] [Thread-1 (]: Skip partitioning: False
[0m18:36:56.608258 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:36:56.609169 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/e766f9a6-7e81-4ad6-bdd5-29afd9213722',
      format='parquet'
    )
    as
      
select
    location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m18:36:57.229776 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f8a7e56c-ab67-43cb-bede-c24530731604
[0m18:36:58.899830 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":1145,"data_scanned_in_bytes":13286}
[0m18:36:58.902437 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m18:36:58.903682 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m18:36:59.234379 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7d909eac-964f-47a6-886b-6d5c4086803c
[0m18:37:00.909789 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m18:37:00.914669 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m18:37:00.918937 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m18:37:00.919834 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":1145,"data_scanned_in_bytes":13286}';
[0m18:37:01.135624 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 62435505-aaf0-4fdf-bbcd-feba15990eba
[0m18:37:02.840394 [debug] [Thread-1 (]: SQL status: OK 1145 in 2.0 seconds
[0m18:37:02.847134 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 18:36:49.877393 => 18:37:02.846729
[0m18:37:02.848379 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m18:37:02.849964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '596d9f58-0745-4923-ae01-b201c17a05cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4c31d0>]}
[0m18:37:02.851186 [info ] [Thread-1 (]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 1145[0m in 12.98s]
[0m18:37:02.852627 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m18:37:02.856871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:02.857642 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m18:37:02.859739 [info ] [MainThread]: 
[0m18:37:02.860505 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 30.15 seconds (90.15s).
[0m18:37:02.862653 [debug] [MainThread]: Command end result
[0m18:37:02.879217 [info ] [MainThread]: 
[0m18:37:02.879968 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:37:02.880373 [info ] [MainThread]: 
[0m18:37:02.880784 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m18:37:02.883353 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 90.637955, "process_user_time": 6.617053, "process_kernel_time": 0.641727, "process_mem_max_rss": "186916", "process_out_blocks": "2981", "process_in_blocks": "0"}
[0m18:37:02.884137 [debug] [MainThread]: Command `dbt run` succeeded at 18:37:02.884014 after 90.64 seconds
[0m18:37:02.885244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1446410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56b94d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb56b9510>]}
[0m18:37:02.885943 [debug] [MainThread]: Flushing usage events
[0m19:50:13.619475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d456220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf9f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dbb2f70>]}


============================== 19:50:13.644237 | f9814a0e-7a46-456b-a61d-0d6baf77f657 ==============================
[0m19:50:13.644237 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:50:13.644676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:50:14.128754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9814a0e-7a46-456b-a61d-0d6baf77f657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78e18fd0>]}
[0m19:50:14.167611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9814a0e-7a46-456b-a61d-0d6baf77f657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcf6280>]}
[0m19:50:14.168412 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:50:14.188810 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:50:14.285372 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:50:14.286042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f9814a0e-7a46-456b-a61d-0d6baf77f657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c52d1c0>]}
[0m19:50:15.835132 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:50:15.835884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f9814a0e-7a46-456b-a61d-0d6baf77f657', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78dae1c0>]}
[0m19:50:16.104695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9814a0e-7a46-456b-a61d-0d6baf77f657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7916f9d0>]}
[0m19:50:16.227452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9814a0e-7a46-456b-a61d-0d6baf77f657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff790ca4f0>]}
[0m19:50:16.227963 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:50:16.228290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9814a0e-7a46-456b-a61d-0d6baf77f657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79139ca0>]}
[0m19:50:16.229765 [info ] [MainThread]: 
[0m19:50:16.230339 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:50:16.235757 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:50:16.236237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:17.503399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6061f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cafc4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecc2bb0>]}


============================== 19:50:17.520022 | a2be00f2-b09d-425b-a3ac-c0da992ebc63 ==============================
[0m19:50:17.520022 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:50:17.520591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:50:18.148584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2be00f2-b09d-425b-a3ac-c0da992ebc63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fca3a0>]}
[0m19:50:18.191773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2be00f2-b09d-425b-a3ac-c0da992ebc63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ecb3190>]}
[0m19:50:18.193244 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:50:18.208939 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:50:18.337691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:18.338330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:18.390518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2be00f2-b09d-425b-a3ac-c0da992ebc63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6d23a0>]}
[0m19:50:18.527229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2be00f2-b09d-425b-a3ac-c0da992ebc63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6bff40>]}
[0m19:50:18.528221 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:50:18.529219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2be00f2-b09d-425b-a3ac-c0da992ebc63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a65d4f0>]}
[0m19:50:18.535084 [info ] [MainThread]: 
[0m19:50:18.536499 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:50:18.548846 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:50:18.549469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:18.786028 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:50:18.785947 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:50:18.788031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:18.788383 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m19:50:18.788747 [info ] [MainThread]: 
[0m19:50:18.789339 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m19:50:18.790250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:18.792619 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m19:50:18.793185 [info ] [MainThread]: 
[0m19:50:18.793753 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m19:50:18.795340 [error] [MainThread]: Encountered an error:
Unable to locate credentials
[0m19:50:18.792265 [error] [MainThread]: Encountered an error:
Unable to locate credentials
[0m19:50:18.808423 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 198, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 134, in create_request
    self._event_emitter.emit(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 105, in handler
    return self.sign(operation_name, request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 195, in sign
    auth.add_auth(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/auth.py", line 418, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

[0m19:50:18.810309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3456817, "process_user_time": 1.994157, "process_kernel_time": 0.926975, "process_mem_max_rss": "149328", "process_in_blocks": "272", "process_out_blocks": "1045", "command_success": false}
[0m19:50:18.810913 [debug] [MainThread]: Command `dbt run` failed at 19:50:18.810821 after 1.35 seconds
[0m19:50:18.811255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6061f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99f1a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a65d4f0>]}
[0m19:50:18.811550 [debug] [MainThread]: Flushing usage events
[0m19:50:18.808427 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 198, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 134, in create_request
    self._event_emitter.emit(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 105, in handler
    return self.sign(operation_name, request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 195, in sign
    auth.add_auth(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/auth.py", line 418, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

[0m19:50:18.821207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.244401, "process_user_time": 3.397341, "process_kernel_time": 0.98371, "process_mem_max_rss": "149624", "process_in_blocks": "1784", "process_out_blocks": "2152", "command_success": false}
[0m19:50:18.822995 [debug] [MainThread]: Command `dbt run` failed at 19:50:18.822809 after 5.25 seconds
[0m19:50:18.823676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d456220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79040130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79139ca0>]}
[0m19:50:18.824141 [debug] [MainThread]: Flushing usage events
[0m19:50:32.439684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa58d7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3db7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6002bb0>]}


============================== 19:50:32.449284 | 10762f80-a37b-42da-a31a-6f8c16dd0895 ==============================
[0m19:50:32.449284 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:50:32.450249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:50:32.906093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10762f80-a37b-42da-a31a-6f8c16dd0895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa124fb50>]}
[0m19:50:32.941604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10762f80-a37b-42da-a31a-6f8c16dd0895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49b54f0>]}
[0m19:50:32.942247 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:50:32.955020 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:50:32.981088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6722160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4bf7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4bf72b0>]}


============================== 19:50:32.987922 | 1f67a47e-04df-406a-8c1f-190ade485ddf ==============================
[0m19:50:32.987922 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:50:32.988354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:50:33.081858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:33.082280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:33.124237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10762f80-a37b-42da-a31a-6f8c16dd0895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a122b0>]}
[0m19:50:33.218996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10762f80-a37b-42da-a31a-6f8c16dd0895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19c1f70>]}
[0m19:50:33.219622 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:50:33.220076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10762f80-a37b-42da-a31a-6f8c16dd0895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1954520>]}
[0m19:50:33.221623 [info ] [MainThread]: 
[0m19:50:33.222097 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:50:33.226876 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:50:33.227289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:33.328125 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:50:33.328887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:33.329313 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m19:50:33.329564 [info ] [MainThread]: 
[0m19:50:33.329903 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m19:50:33.331530 [error] [MainThread]: Encountered an error:
Unable to locate credentials
[0m19:50:33.333701 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 198, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 134, in create_request
    self._event_emitter.emit(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 105, in handler
    return self.sign(operation_name, request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 195, in sign
    auth.add_auth(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/auth.py", line 418, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

[0m19:50:33.334704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9424879, "process_user_time": 1.76677, "process_kernel_time": 0.275744, "process_mem_max_rss": "149320", "process_in_blocks": "56", "process_out_blocks": "1045", "command_success": false}
[0m19:50:33.335172 [debug] [MainThread]: Command `dbt run` failed at 19:50:33.335066 after 0.94 seconds
[0m19:50:33.335474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa58d7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa121c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1954520>]}
[0m19:50:33.335733 [debug] [MainThread]: Flushing usage events
[0m19:50:33.384876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f67a47e-04df-406a-8c1f-190ade485ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb20e23d0>]}
[0m19:50:33.414814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f67a47e-04df-406a-8c1f-190ade485ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6df3250>]}
[0m19:50:33.415413 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:50:33.427770 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:50:33.526350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:33.526772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:33.562148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f67a47e-04df-406a-8c1f-190ade485ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2812370>]}
[0m19:50:33.646080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f67a47e-04df-406a-8c1f-190ade485ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb27fffa0>]}
[0m19:50:33.646470 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:50:33.646689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f67a47e-04df-406a-8c1f-190ade485ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb279d550>]}
[0m19:50:33.648034 [info ] [MainThread]: 
[0m19:50:33.648576 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:50:33.653094 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:50:33.653372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:33.725776 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:50:33.726509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:33.726731 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m19:50:33.726926 [info ] [MainThread]: 
[0m19:50:33.727146 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m19:50:33.728558 [error] [MainThread]: Encountered an error:
Unable to locate credentials
[0m19:50:33.730417 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 198, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 134, in create_request
    self._event_emitter.emit(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 105, in handler
    return self.sign(operation_name, request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 195, in sign
    auth.add_auth(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/auth.py", line 418, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

[0m19:50:33.731328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.79294425, "process_user_time": 1.684492, "process_kernel_time": 0.182813, "process_mem_max_rss": "143444", "process_out_blocks": "1045", "command_success": false, "process_in_blocks": "0"}
[0m19:50:33.731944 [debug] [MainThread]: Command `dbt run` failed at 19:50:33.731827 after 0.79 seconds
[0m19:50:33.732519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6722160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2098070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1695f10>]}
[0m19:50:33.732975 [debug] [MainThread]: Flushing usage events
[0m19:51:29.174323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800071f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e53c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80682bb0>]}


============================== 19:51:29.178921 | d5626468-bd7a-4083-a0b2-623cb7e61167 ==============================
[0m19:51:29.178921 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:51:29.179362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:51:29.569337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5626468-bd7a-4083-a0b2-623cb7e61167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b9973a0>]}
[0m19:51:29.601903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5626468-bd7a-4083-a0b2-623cb7e61167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff806f3190>]}
[0m19:51:29.602531 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:51:29.617389 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:51:29.717924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:51:29.718250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:51:29.782959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5626468-bd7a-4083-a0b2-623cb7e61167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c1123a0>]}
[0m19:51:30.247423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5626468-bd7a-4083-a0b2-623cb7e61167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c101f40>]}
[0m19:51:30.249850 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:51:30.250515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5626468-bd7a-4083-a0b2-623cb7e61167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c09d4f0>]}
[0m19:51:30.259877 [info ] [MainThread]: 
[0m19:51:30.261504 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:51:30.269046 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:51:30.269568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:31.404457 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:51:31.408013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:31.408787 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m19:51:31.409078 [info ] [MainThread]: 
[0m19:51:31.409455 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m19:51:31.412465 [error] [MainThread]: Encountered an error:
Unable to locate credentials
[0m19:51:31.415342 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 198, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 134, in create_request
    self._event_emitter.emit(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 105, in handler
    return self.sign(operation_name, request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 195, in sign
    auth.add_auth(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/auth.py", line 418, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

[0m19:51:31.417048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2759132, "process_user_time": 1.860802, "process_kernel_time": 0.322181, "process_mem_max_rss": "149320", "process_out_blocks": "1045", "command_success": false, "process_in_blocks": "0"}
[0m19:51:31.417876 [debug] [MainThread]: Command `dbt run` failed at 19:51:31.417790 after 2.28 seconds
[0m19:51:31.418319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800071f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b95c2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c09d4f0>]}
[0m19:51:31.418626 [debug] [MainThread]: Flushing usage events
[0m19:52:21.996339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86a573a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86bc3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877bcf70>]}


============================== 19:52:22.033970 | c1db8cef-45ab-49c4-a30b-59b719a6ab69 ==============================
[0m19:52:22.033970 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:52:22.034420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:52:23.302720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1db8cef-45ab-49c4-a30b-59b719a6ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849c73d0>]}
[0m19:52:23.338040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1db8cef-45ab-49c4-a30b-59b719a6ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849d0e50>]}
[0m19:52:23.342037 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:52:23.362575 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:52:23.481744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:23.482141 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:23.518344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1db8cef-45ab-49c4-a30b-59b719a6ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825d0e20>]}
[0m19:52:23.612292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1db8cef-45ab-49c4-a30b-59b719a6ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82580d60>]}
[0m19:52:23.612771 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:52:23.613101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1db8cef-45ab-49c4-a30b-59b719a6ab69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8259c310>]}
[0m19:52:23.614842 [info ] [MainThread]: 
[0m19:52:23.615445 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:52:23.620973 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:52:23.621559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:24.792717 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:52:24.796142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:24.796718 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m19:52:24.797328 [info ] [MainThread]: 
[0m19:52:24.798000 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m19:52:24.807481 [error] [MainThread]: Encountered an error:
Unable to locate credentials
[0m19:52:24.817028 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 198, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 134, in create_request
    self._event_emitter.emit(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 105, in handler
    return self.sign(operation_name, request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 195, in sign
    auth.add_auth(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/auth.py", line 418, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

[0m19:52:24.820473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8561547, "process_user_time": 2.466386, "process_kernel_time": 0.814362, "process_mem_max_rss": "149160", "process_out_blocks": "6933", "command_success": false, "process_in_blocks": "0"}
[0m19:52:24.822630 [debug] [MainThread]: Command `dbt run` failed at 19:52:24.822143 after 2.86 seconds
[0m19:52:24.824664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86a573a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e07760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825199a0>]}
[0m19:52:24.826354 [debug] [MainThread]: Flushing usage events
[0m19:52:37.303024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7997340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5eb95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80c2bb0>]}


============================== 19:52:37.307645 | 74e44df1-cfe8-46fc-891d-6e45cbd17d3c ==============================
[0m19:52:37.307645 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:52:37.308730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:52:37.634171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74e44df1-cfe8-46fc-891d-6e45cbd17d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa339ab50>]}
[0m19:52:37.664241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74e44df1-cfe8-46fc-891d-6e45cbd17d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a894f0>]}
[0m19:52:37.664871 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:52:37.677390 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:52:37.778240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:37.778615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:37.811743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74e44df1-cfe8-46fc-891d-6e45cbd17d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a922b0>]}
[0m19:52:37.886304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74e44df1-cfe8-46fc-891d-6e45cbd17d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a7ff70>]}
[0m19:52:37.886702 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:52:37.887367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e44df1-cfe8-46fc-891d-6e45cbd17d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a14520>]}
[0m19:52:37.888892 [info ] [MainThread]: 
[0m19:52:37.889566 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:52:37.894153 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:52:37.894457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:37.963907 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:52:37.964766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:37.964965 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m19:52:37.965150 [info ] [MainThread]: 
[0m19:52:37.965381 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m19:52:37.966800 [error] [MainThread]: Encountered an error:
Unable to locate credentials
[0m19:52:37.968774 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 198, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 134, in create_request
    self._event_emitter.emit(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 105, in handler
    return self.sign(operation_name, request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 195, in sign
    auth.add_auth(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/auth.py", line 418, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

[0m19:52:37.969657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.69718707, "process_user_time": 1.268729, "process_kernel_time": 0.264734, "process_mem_max_rss": "143460", "process_out_blocks": "1045", "command_success": false, "process_in_blocks": "0"}
[0m19:52:37.970295 [debug] [MainThread]: Command `dbt run` failed at 19:52:37.970181 after 0.70 seconds
[0m19:52:37.970773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7997340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32d93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a14520>]}
[0m19:52:37.971232 [debug] [MainThread]: Flushing usage events
[0m19:52:40.239870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a222220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d5e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff887f0fd0>]}


============================== 19:52:40.244760 | fbfe6010-d472-4f93-9000-75777a6ad62e ==============================
[0m19:52:40.244760 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:52:40.245318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:52:40.710103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbfe6010-d472-4f93-9000-75777a6ad62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c08250>]}
[0m19:52:40.755513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbfe6010-d472-4f93-9000-75777a6ad62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b79c40>]}
[0m19:52:40.756264 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:52:40.777006 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:52:40.878225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:52:40.878668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:52:40.913007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbfe6010-d472-4f93-9000-75777a6ad62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86312400>]}
[0m19:52:40.994005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbfe6010-d472-4f93-9000-75777a6ad62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86301430>]}
[0m19:52:40.994440 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:52:40.994734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbfe6010-d472-4f93-9000-75777a6ad62e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff862a45e0>]}
[0m19:52:40.996347 [info ] [MainThread]: 
[0m19:52:40.996985 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:52:41.001740 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:52:41.002114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:41.085618 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:52:41.086492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:41.086683 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m19:52:41.086900 [info ] [MainThread]: 
[0m19:52:41.087201 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m19:52:41.088593 [error] [MainThread]: Encountered an error:
Unable to locate credentials
[0m19:52:41.090852 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 198, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 134, in create_request
    self._event_emitter.emit(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 105, in handler
    return self.sign(operation_name, request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 195, in sign
    auth.add_auth(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/auth.py", line 418, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

[0m19:52:41.091766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.89343697, "process_user_time": 2.138856, "process_kernel_time": 0.398563, "process_mem_max_rss": "149156", "process_out_blocks": "1045", "command_success": false, "process_in_blocks": "0"}
[0m19:52:41.092134 [debug] [MainThread]: Command `dbt run` failed at 19:52:41.092063 after 0.89 seconds
[0m19:52:41.092417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a222220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b99a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86301a60>]}
[0m19:52:41.092667 [debug] [MainThread]: Flushing usage events
[0m19:53:46.324019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e216370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e902850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6c0490>]}


============================== 19:53:46.333934 | 79410705-4d9e-4738-95e8-d1e4b51e1bed ==============================
[0m19:53:46.333934 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:53:46.334346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:53:46.696106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79410705-4d9e-4738-95e8-d1e4b51e1bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79c0e580>]}
[0m19:53:46.725401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79410705-4d9e-4738-95e8-d1e4b51e1bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd277f0>]}
[0m19:53:46.725925 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:53:46.740128 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:53:46.828979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:53:46.829261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:53:46.862389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79410705-4d9e-4738-95e8-d1e4b51e1bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a352340>]}
[0m19:53:46.938337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79410705-4d9e-4738-95e8-d1e4b51e1bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a301ee0>]}
[0m19:53:46.938676 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:53:46.938906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79410705-4d9e-4738-95e8-d1e4b51e1bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a29d490>]}
[0m19:53:46.940037 [info ] [MainThread]: 
[0m19:53:46.940397 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:53:46.944924 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:53:46.945191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:50.275938 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:53:50.280001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:50.282271 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m19:53:50.283944 [info ] [MainThread]: 
[0m19:53:50.284601 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m19:53:50.290324 [error] [MainThread]: Encountered an error:
Unable to locate credentials
[0m19:53:50.293838 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 198, in _send_request
    request = self.create_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 134, in create_request
    self._event_emitter.emit(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 412, in emit
    return self._emitter.emit(aliased_event_name, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 256, in emit
    return self._emit(event_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/hooks.py", line 239, in _emit
    response = handler(**kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 105, in handler
    return self.sign(operation_name, request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/signers.py", line 195, in sign
    auth.add_auth(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/auth.py", line 418, in add_auth
    raise NoCredentialsError()
botocore.exceptions.NoCredentialsError: Unable to locate credentials

[0m19:53:50.300143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.005017, "process_user_time": 1.43911, "process_kernel_time": 0.366851, "process_mem_max_rss": "149152", "process_out_blocks": "1045", "command_success": false, "process_in_blocks": "0"}
[0m19:53:50.301933 [debug] [MainThread]: Command `dbt run` failed at 19:53:50.301783 after 4.01 seconds
[0m19:53:50.302720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e216370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b4f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a29d850>]}
[0m19:53:50.303175 [debug] [MainThread]: Flushing usage events
[0m19:55:01.560787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d822190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd3e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd3e880>]}


============================== 19:55:01.565473 | 23abf2db-2dd7-4ab7-8806-15a7c0a2be3b ==============================
[0m19:55:01.565473 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:55:01.565926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:55:02.034193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d49f430>]}
[0m19:55:02.069020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bdf6280>]}
[0m19:55:02.069701 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:55:02.087624 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:55:02.196185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:02.196648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:02.232582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99912370>]}
[0m19:55:02.314321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99901fa0>]}
[0m19:55:02.314755 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:55:02.315006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998a4550>]}
[0m19:55:02.316487 [info ] [MainThread]: 
[0m19:55:02.316921 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:55:02.321235 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:55:02.321533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:03.104299 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:55:03.111502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m19:55:03.112331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:04.756487 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m19:55:04.763331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6bf160>]}
[0m19:55:04.765101 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:04.765772 [info ] [MainThread]: 
[0m19:55:04.776304 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m19:55:04.777417 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m19:55:04.778535 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m19:55:04.778955 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m19:55:04.799659 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m19:55:04.801806 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m19:55:04.823941 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m19:55:04.825273 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m19:55:04.825658 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m19:55:04.825970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:05.532392 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d2e7d50c-7f4e-490d-bae0-9d74dda64f10
[0m19:55:07.361149 [debug] [Thread-1  ]: SQL status: OK -1 in 2.535 seconds
[0m19:55:08.691668 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m19:55:08.697374 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m19:55:08.737996 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m19:55:08.743826 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6bf0d0>]}
[0m19:55:08.747823 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 3.96s]
[0m19:55:08.752496 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m19:55:08.754180 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m19:55:08.763705 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m19:55:08.778043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m19:55:08.779335 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m19:55:08.803749 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m19:55:08.812999 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m19:55:08.835147 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m19:55:08.855696 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m19:55:08.858430 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m19:55:08.860667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:09.931901 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e4e8c371-312c-4cc3-801f-9dde9388f31d
[0m19:55:11.692504 [debug] [Thread-1  ]: SQL status: OK -1 in 2.831 seconds
[0m19:55:12.903630 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m19:55:12.908810 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m19:55:12.921361 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m19:55:12.924698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99195cd0>]}
[0m19:55:12.927202 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.15s]
[0m19:55:12.929552 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m19:55:12.931335 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m19:55:12.933579 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m19:55:12.938325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m19:55:12.938985 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m19:55:12.954923 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m19:55:12.958123 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m19:55:12.961936 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m19:55:12.963216 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m19:55:12.963605 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m19:55:12.964085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:13.580304 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 523cad27-a4cb-47f2-aec4-4aeae796595a
[0m19:55:15.391438 [debug] [Thread-1  ]: SQL status: OK -1 in 2.419 seconds
[0m19:55:16.730042 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m19:55:16.733264 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m19:55:16.739809 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m19:55:16.741389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aca9370>]}
[0m19:55:16.742796 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 3.81s]
[0m19:55:16.744070 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m19:55:16.746369 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m19:55:16.747916 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m19:55:16.752536 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m19:55:16.753055 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m19:55:16.762178 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m19:55:16.765290 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m19:55:16.768958 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m19:55:16.770895 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m19:55:16.771324 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m19:55:16.772296 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:17.780874 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ec9e731f-48fd-4057-af78-b0ba2e0835aa
[0m19:55:19.587530 [debug] [Thread-1  ]: SQL status: OK -1 in 2.815 seconds
[0m19:55:20.924215 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m19:55:20.929395 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m19:55:20.935710 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m19:55:20.938586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991b9520>]}
[0m19:55:20.941198 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.19s]
[0m19:55:20.943272 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m19:55:20.946333 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m19:55:20.948361 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m19:55:20.953616 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m19:55:20.954274 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m19:55:20.964362 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m19:55:20.966031 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m19:55:20.972297 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m19:55:20.973781 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m19:55:20.974179 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m19:55:20.974553 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:21.566235 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 589d44c5-c4b7-4fde-8308-d021640d4565
[0m19:55:23.075010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87956190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e002e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e00880>]}


============================== 19:55:23.083815 | f385eebf-7bb5-47c2-8218-4845bb563442 ==============================
[0m19:55:23.083815 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:55:23.084329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:55:23.110577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91264370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f700940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7006a0>]}


============================== 19:55:23.121862 | c21c466b-6a67-4771-b14d-8d3da8e3bdd8 ==============================
[0m19:55:23.121862 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:55:23.124102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:55:23.395484 [debug] [Thread-1  ]: SQL status: OK -1 in 2.419 seconds
[0m19:55:23.914544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83315250>]}
[0m19:55:23.970696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff870a9100>]}
[0m19:55:23.971913 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:55:23.988196 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:55:24.023073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9100b4c0>]}
[0m19:55:24.076223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8faff250>]}
[0m19:55:24.077722 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:55:24.107490 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:55:24.136935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:24.137341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:24.171576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a923a0>]}
[0m19:55:24.213065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:24.213508 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:24.249670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d352430>]}
[0m19:55:24.257821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a42fd0>]}
[0m19:55:24.258330 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:55:24.258624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839dd580>]}
[0m19:55:24.260201 [info ] [MainThread]: 
[0m19:55:24.261629 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:55:24.267535 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:55:24.268216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:24.356640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3429a0>]}
[0m19:55:24.357119 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:55:24.357480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d2d45e0>]}
[0m19:55:24.359269 [info ] [MainThread]: 
[0m19:55:24.359765 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:55:24.366010 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:55:24.366588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:24.616171 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m19:55:24.618575 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m19:55:24.622885 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m19:55:24.630479 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991b8640>]}
[0m19:55:24.633432 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 3.68s]
[0m19:55:24.634863 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m19:55:24.635868 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m19:55:24.637218 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m19:55:24.640499 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m19:55:24.640844 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m19:55:24.647935 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m19:55:24.649054 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m19:55:24.672050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:24.926416 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:55:24.928847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m19:55:24.929168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:24.995319 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:55:24.998319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m19:55:24.998894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:26.057658 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m19:55:26.058241 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:26.059948 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:55:26.425566 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m19:55:26.445490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847ff0d0>]}
[0m19:55:26.448599 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:26.450572 [info ] [MainThread]: 
[0m19:55:26.457392 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m19:55:26.477579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d339a30>]}
[0m19:55:26.479840 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:26.482501 [info ] [MainThread]: 
[0m19:55:26.486550 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m19:55:26.489600 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m19:55:26.491892 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m19:55:26.493065 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m19:55:26.506207 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m19:55:26.507262 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m19:55:26.508767 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m19:55:26.510601 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m19:55:26.535125 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m19:55:26.540462 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m19:55:26.547723 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m19:55:26.551811 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m19:55:26.597194 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m19:55:26.602662 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m19:55:26.603737 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m19:55:26.604999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:26.613163 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m19:55:26.614911 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m19:55:26.615252 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m19:55:26.615637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:27.270089 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 52a0f0fb-48cf-41da-9f92-7b869ec74809
[0m19:55:27.302441 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m19:55:27.305612 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:27.306728 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/0e0b2e9e-25a1-4aee-842b-b6888b6b84e5
[0m19:55:27.340404 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c12a89f5-53b3-4cbb-8809-503a21165998
[0m19:55:28.045228 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/0e0b2e9e-25a1-4aee-842b-b6888b6b84e5', bucket='climate-energy-raw-data', prefix='silver/eia_silver/0e0b2e9e-25a1-4aee-842b-b6888b6b84e5/'
[0m19:55:29.152537 [debug] [Thread-1  ]: SQL status: OK -1 in 2.535 seconds
[0m19:55:30.150479 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m19:55:30.182232 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:55:30.528490 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m19:55:30.531523 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m19:55:30.551689 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m19:55:30.554671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f70c2b0>]}
[0m19:55:30.556133 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.04s]
[0m19:55:30.559896 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m19:55:30.561353 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m19:55:30.562688 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m19:55:30.565612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m19:55:30.566180 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m19:55:30.571129 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m19:55:30.572423 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m19:55:30.574854 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m19:55:30.575758 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m19:55:30.576040 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m19:55:30.576305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:30.725867 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:55:30.727319 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/9a536447-abde-4526-bf8c-c561bc43a94b',
      format='parquet'
    )
    as
      
with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m19:55:31.256065 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cb9feb92-6a9f-4a8f-bcf1-cea9a5897c01
[0m19:55:31.256892 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d7d59618-f24e-46cc-a90d-98e0da8b2450
[0m19:55:32.889369 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d85940dd-b86e-4720-8fbb-e20c6e03827d
[0m19:55:32.993546 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1613}
[0m19:55:33.002960 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m19:55:33.004330 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m19:55:33.069171 [debug] [Thread-1  ]: SQL status: OK -1 in 2.492 seconds
[0m19:55:33.223848 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a1235f2e-5302-4ab1-9611-ee6bcc3c2048
[0m19:55:34.296398 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m19:55:34.298727 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m19:55:34.302713 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m19:55:34.306449 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f70c550>]}
[0m19:55:34.310236 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 3.74s]
[0m19:55:34.313755 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m19:55:34.316853 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m19:55:34.319032 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m19:55:34.323405 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m19:55:34.324321 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m19:55:34.333038 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m19:55:34.336439 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m19:55:34.342153 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m19:55:34.344883 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m19:55:34.345450 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m19:55:34.346510 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:34.672935 [debug] [Thread-1  ]: SQL status: OK -1 in 8.067 seconds
[0m19:55:34.952782 [debug] [Thread-1  ]: SQL status: OK -1 in 1.947 seconds
[0m19:55:34.957783 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m19:55:34.959877 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b77190c0-bd81-4c01-85d0-e4f6dc3825cb
[0m19:55:34.961024 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m19:55:34.961447 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1613}';
[0m19:55:35.169343 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a84cfe9d-4477-4586-bebb-a28991f303c2
[0m19:55:36.063091 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m19:55:36.067750 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m19:55:36.643389 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m19:55:36.658729 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m19:55:36.660921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2ecbe0>]}
[0m19:55:36.661906 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 10.17s]
[0m19:55:36.662824 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m19:55:36.663570 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m19:55:36.665239 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m19:55:36.665863 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m19:55:36.666293 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m19:55:36.670375 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m19:55:36.671204 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m19:55:36.673430 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m19:55:36.674024 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m19:55:36.674233 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m19:55:36.674448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:36.749119 [debug] [Thread-1  ]: SQL status: OK -1 in 2.402 seconds
[0m19:55:36.922399 [debug] [Thread-1  ]: SQL status: OK 2 in 1.960 seconds
[0m19:55:36.927516 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m19:55:36.928958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991b9520>]}
[0m19:55:36.930254 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2[0m in 12.29s]
[0m19:55:36.931420 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m19:55:36.932428 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m19:55:36.933441 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m19:55:36.936351 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m19:55:36.936715 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m19:55:36.942841 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m19:55:36.943822 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m19:55:36.946389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:37.417596 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID eb7146af-6b10-4810-9934-1bb14dd5dde8
[0m19:55:37.962637 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m19:55:37.964916 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m19:55:37.968280 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m19:55:37.969463 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85dead60>]}
[0m19:55:37.970748 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 3.65s]
[0m19:55:37.972325 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m19:55:37.973892 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m19:55:37.974940 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m19:55:37.977581 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m19:55:37.978118 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m19:55:37.984198 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m19:55:37.985652 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m19:55:37.988654 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m19:55:37.989854 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m19:55:37.990240 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m19:55:37.990586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:38.363209 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:55:38.363974 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:38.364695 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:55:38.676242 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 82a1c4aa-900e-4180-89d8-03dac84203b2
[0m19:55:39.244749 [debug] [Thread-1  ]: SQL status: OK -1 in 2.569 seconds
[0m19:55:39.781118 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:55:39.784102 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:39.784750 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/f16ca353-a265-47b3-b588-71f136e30fc4
[0m19:55:40.343823 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/f16ca353-a265-47b3-b588-71f136e30fc4', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/f16ca353-a265-47b3-b588-71f136e30fc4/'
[0m19:55:40.440942 [debug] [Thread-1  ]: SQL status: OK -1 in 2.448 seconds
[0m19:55:40.501285 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m19:55:40.502756 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m19:55:41.034941 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m19:55:41.043562 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m19:55:41.045561 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b246bb0>]}
[0m19:55:41.047188 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.38s]
[0m19:55:41.048712 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m19:55:41.049838 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m19:55:41.051785 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m19:55:41.062261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m19:55:41.063792 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m19:55:41.081679 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m19:55:41.086097 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m19:55:41.090573 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m19:55:41.092070 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m19:55:41.092520 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m19:55:41.092940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:41.593678 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m19:55:41.597165 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m19:55:41.609361 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m19:55:41.612674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84ef4be0>]}
[0m19:55:41.616207 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 3.64s]
[0m19:55:41.617456 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m19:55:41.618634 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m19:55:41.622112 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m19:55:41.630319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m19:55:41.633696 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m19:55:41.672473 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4735f6f4-888c-41c0-b489-9e0492b56021
[0m19:55:41.673805 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m19:55:41.680278 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m19:55:41.698081 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m19:55:41.701720 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m19:55:41.703047 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m19:55:41.705726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:42.418714 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m19:55:42.431935 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:55:42.450704 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cff0775f-94f1-496e-9071-79df3099ca4f
[0m19:55:42.980962 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:55:42.983192 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/c70cf8a2-5bbd-426f-9611-2c830231dfcc',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m19:55:43.491978 [debug] [Thread-1  ]: SQL status: OK -1 in 2.398 seconds
[0m19:55:43.505950 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 20190ce4-a63f-4e61-9501-f7de1cbcab0e
[0m19:55:44.222209 [debug] [Thread-1  ]: SQL status: OK -1 in 2.518 seconds
[0m19:55:44.716695 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m19:55:44.719569 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m19:55:45.244968 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m19:55:45.251295 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m19:55:45.253807 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b219400>]}
[0m19:55:45.255846 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.20s]
[0m19:55:45.257695 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m19:55:45.259496 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m19:55:45.262149 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m19:55:45.266187 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":675}
[0m19:55:45.267025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m19:55:45.269322 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m19:55:45.268747 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m19:55:45.273315 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m19:55:45.278643 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m19:55:45.280320 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m19:55:45.284037 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m19:55:45.284972 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m19:55:45.285343 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m19:55:45.285705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:45.415277 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m19:55:45.416447 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m19:55:45.418888 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m19:55:45.419949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90380760>]}
[0m19:55:45.420944 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 3.79s]
[0m19:55:45.421836 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m19:55:45.422538 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m19:55:45.423495 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m19:55:45.425359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m19:55:45.425715 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m19:55:45.430109 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m19:55:45.430994 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m19:55:45.454339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:45.495185 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e2b59a1c-aa02-4ed4-90b9-fa9d6b5d3b61
[0m19:55:45.943955 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fead9f5d-1ab2-422c-8ffb-b2ab6d94b57a
[0m19:55:46.785570 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m19:55:46.787243 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:46.791465 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:55:47.245513 [debug] [Thread-1  ]: SQL status: OK -1 in 1.968 seconds
[0m19:55:47.251913 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m19:55:47.254194 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m19:55:47.254639 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":675}';
[0m19:55:47.483146 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d665c795-7d58-41f5-8315-f8f2a5112f34
[0m19:55:47.693901 [debug] [Thread-1  ]: SQL status: OK -1 in 2.408 seconds
[0m19:55:48.021202 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m19:55:48.022055 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:48.022626 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/9a536447-abde-4526-bf8c-c561bc43a94b
[0m19:55:48.564045 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/9a536447-abde-4526-bf8c-c561bc43a94b', bucket='climate-energy-raw-data', prefix='silver/eia_silver/9a536447-abde-4526-bf8c-c561bc43a94b/'
[0m19:55:48.922030 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m19:55:48.936171 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m19:55:49.305068 [debug] [Thread-1  ]: SQL status: OK 31 in 2.050 seconds
[0m19:55:49.314633 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m19:55:49.317703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99892c70>]}
[0m19:55:49.319641 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 12.38s]
[0m19:55:49.322401 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m19:55:49.328314 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m19:55:49.330368 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m19:55:49.339402 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m19:55:49.340218 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m19:55:49.370898 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m19:55:49.375707 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m19:55:49.387354 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:49.512311 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m19:55:49.522581 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m19:55:49.524913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839bd790>]}
[0m19:55:49.531079 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.26s]
[0m19:55:49.535344 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m19:55:49.538347 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m19:55:49.541192 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m19:55:49.545595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m19:55:49.546176 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m19:55:49.553909 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m19:55:49.564535 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m19:55:49.584377 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m19:55:49.587894 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m19:55:49.588848 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m19:55:49.591264 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:50.483455 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8c8fc0de-6232-4b5f-9b2d-43a6fbdf322d
[0m19:55:50.847915 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m19:55:50.849661 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:50.850677 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:55:51.035159 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m19:55:51.063961 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:55:51.597641 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:55:51.600999 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/07909c81-301f-4722-91a5-847fefc3b10c',
      format='parquet'
    )
    as
      
with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m19:55:51.951862 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m19:55:51.952316 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:51.952741 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/5d1af2bb-ceb4-4b8d-a3a2-4775de8003f8
[0m19:55:52.095997 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d00eda7e-d82f-432d-af30-b82b49bd6be9
[0m19:55:52.229906 [debug] [Thread-1  ]: SQL status: OK -1 in 2.639 seconds
[0m19:55:52.613811 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/5d1af2bb-ceb4-4b8d-a3a2-4775de8003f8', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/5d1af2bb-ceb4-4b8d-a3a2-4775de8003f8/'
[0m19:55:53.404508 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m19:55:53.405827 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m19:55:53.778286 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1613}
[0m19:55:53.784139 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m19:55:53.784661 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m19:55:53.944944 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m19:55:53.950344 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m19:55:53.952198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b352cd0>]}
[0m19:55:53.954788 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.41s]
[0m19:55:53.957527 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m19:55:53.958790 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m19:55:53.960290 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m19:55:53.963142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m19:55:53.963693 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m19:55:53.974767 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m19:55:53.977200 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m19:55:54.002133 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4a6b8497-f2b1-4f1c-ae5e-177c0b793fa0
[0m19:55:54.121548 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:54.538564 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m19:55:54.543589 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:55:55.041921 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:55:55.044108 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/2080abe8-185e-4ff8-8796-ea76368db927',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m19:55:55.248000 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m19:55:55.248587 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:55.250472 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:55:55.592654 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 303962a7-4220-4add-982c-0242da880be8
[0m19:55:55.709639 [debug] [Thread-1  ]: SQL status: OK -1 in 1.924 seconds
[0m19:55:55.716352 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m19:55:55.722834 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m19:55:55.724465 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1613}';
[0m19:55:55.936318 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID eac74f76-c870-4ad7-9c35-20cfe77210fb
[0m19:55:56.369874 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m19:55:56.371838 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:56.372851 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/07909c81-301f-4722-91a5-847fefc3b10c
[0m19:55:56.950605 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/07909c81-301f-4722-91a5-847fefc3b10c', bucket='climate-energy-raw-data', prefix='silver/eia_silver/07909c81-301f-4722-91a5-847fefc3b10c/'
[0m19:55:57.306225 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m19:55:57.308832 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m19:55:57.309248 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m19:55:57.521462 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6f877be3-6c32-4829-abbf-61fdc7c20890
[0m19:55:57.690962 [debug] [Thread-1  ]: SQL status: OK 2 in 1.966 seconds
[0m19:55:57.694550 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m19:55:57.696243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff871976a0>]}
[0m19:55:57.698005 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2[0m in 12.27s]
[0m19:55:57.699746 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m19:55:57.700659 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m19:55:57.701878 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m19:55:57.704885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m19:55:57.705453 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m19:55:57.710004 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m19:55:57.710918 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m19:55:57.713293 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:59.060692 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m19:55:59.145158 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:55:59.149598 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:55:59.151712 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:55:59.242172 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:55:59.358453 [debug] [Thread-1  ]: SQL status: OK -1 in 2.047 seconds
[0m19:55:59.367339 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m19:55:59.388767 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m19:55:59.390380 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m19:55:59.625744 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b316d749-0d91-4fe3-8658-ba04ae78d339
[0m19:55:59.793859 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:55:59.796102 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/5bdf6f32-3bb5-4caf-a6a6-2b84e29a4139',
      format='parquet'
    )
    as
      
with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m19:56:00.339745 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1afabbb6-2796-4931-a26c-763a0f8a8b15
[0m19:56:00.416954 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:56:00.418649 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:00.419377 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/c70cf8a2-5bbd-426f-9611-2c830231dfcc
[0m19:56:00.995113 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/c70cf8a2-5bbd-426f-9611-2c830231dfcc', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/c70cf8a2-5bbd-426f-9611-2c830231dfcc/'
[0m19:56:01.356712 [debug] [Thread-1  ]: SQL status: OK 4447 in 1.966 seconds
[0m19:56:01.363215 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m19:56:01.367368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac78a30>]}
[0m19:56:01.369065 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 12.03s]
[0m19:56:01.370879 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m19:56:01.372054 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m19:56:01.373332 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m19:56:01.379335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m19:56:01.380434 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m19:56:01.396709 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m19:56:01.398319 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m19:56:01.401944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:02.078839 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1613}
[0m19:56:02.097926 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m19:56:02.099393 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:02.338268 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 15d8c4d3-0f97-4282-9f8f-078fa0f2c0d8
[0m19:56:02.669299 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m19:56:02.670278 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:02.671218 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:56:03.026780 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m19:56:03.036245 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:56:03.545869 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:56:03.547869 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/d9883c0d-4661-45e9-afa8-6e8d70bc6ca1',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m19:56:03.844590 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m19:56:03.845446 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:03.846198 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/1e9e6407-0f7d-4958-be05-5eda0ec0f2de
[0m19:56:04.076231 [debug] [Thread-1  ]: SQL status: OK -1 in 1.976 seconds
[0m19:56:04.079332 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m19:56:04.080886 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m19:56:04.081195 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1613}';
[0m19:56:04.109721 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b714b365-68cc-4a46-9ec6-9e6c34fb1a4b
[0m19:56:04.307334 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 20916254-6c8d-43f2-a19c-5ecfee4c41fb
[0m19:56:04.362564 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/1e9e6407-0f7d-4958-be05-5eda0ec0f2de', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/1e9e6407-0f7d-4958-be05-5eda0ec0f2de/'
[0m19:56:05.887670 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":675}
[0m19:56:05.889773 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m19:56:05.890269 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:06.126360 [debug] [Thread-1  ]: SQL status: OK 2 in 2.043 seconds
[0m19:56:06.131519 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 95e9c47a-0fb0-4e7b-9492-cbfe880269ee
[0m19:56:06.229667 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m19:56:06.244141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b246fd0>]}
[0m19:56:06.248726 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2[0m in 12.28s]
[0m19:56:06.256712 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m19:56:06.261585 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m19:56:06.264165 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m19:56:06.277843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m19:56:06.279634 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m19:56:06.319663 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m19:56:06.342925 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m19:56:06.349807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:06.528625 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m19:56:06.558356 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:56:07.122858 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:56:07.124692 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/d3867b71-9d6b-45bc-bde5-e27f6ed9b524',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m19:56:07.633972 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 10091393-e568-4cfa-9b96-de4c27821844
[0m19:56:07.810527 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:56:07.813301 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:07.815846 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:56:07.913034 [debug] [Thread-1  ]: SQL status: OK -1 in 2.019 seconds
[0m19:56:07.929844 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m19:56:07.933137 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m19:56:07.933759 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":675}';
[0m19:56:08.162776 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 25343970-c4d5-463b-a57b-634a152b3b6c
[0m19:56:08.999725 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:56:09.001479 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:09.003594 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/d9883c0d-4661-45e9-afa8-6e8d70bc6ca1
[0m19:56:09.566770 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/d9883c0d-4661-45e9-afa8-6e8d70bc6ca1', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/d9883c0d-4661-45e9-afa8-6e8d70bc6ca1/'
[0m19:56:09.894952 [debug] [Thread-1  ]: SQL status: OK 31 in 1.960 seconds
[0m19:56:09.903461 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m19:56:09.905720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbd7b20>]}
[0m19:56:09.907819 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 12.20s]
[0m19:56:09.909911 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m19:56:09.911691 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m19:56:09.913611 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m19:56:09.920773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m19:56:09.921658 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m19:56:09.933725 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m19:56:09.935648 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m19:56:09.939884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:10.551907 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m19:56:10.555981 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m19:56:10.556422 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:10.769742 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1b18e5e2-276b-415e-8cfc-7326e510e7a5
[0m19:56:11.119503 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m19:56:11.120824 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:11.122236 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:56:11.754709 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m19:56:11.759844 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:56:12.237229 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:56:12.238921 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/c1f8279a-150f-4af3-82c7-a41cbd64f160',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m19:56:12.273544 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m19:56:12.274003 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:12.274409 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/2080abe8-185e-4ff8-8796-ea76368db927
[0m19:56:12.448906 [debug] [Thread-1  ]: SQL status: OK -1 in 1.892 seconds
[0m19:56:12.452049 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m19:56:12.453880 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m19:56:12.454195 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m19:56:12.685985 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 859f06d5-c91e-460a-b435-d7baffa70c4d
[0m19:56:12.758386 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 22a75ad5-e94f-41f7-b219-73aa9ba2950a
[0m19:56:12.856669 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/2080abe8-185e-4ff8-8796-ea76368db927', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/2080abe8-185e-4ff8-8796-ea76368db927/'
[0m19:56:14.600884 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":675}
[0m19:56:14.602671 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m19:56:14.603417 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:14.751131 [debug] [Thread-1  ]: SQL status: OK 63 in 2.296 seconds
[0m19:56:14.758238 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m19:56:14.759791 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac78a30>]}
[0m19:56:14.761311 [info ] [Thread-1  ]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 13.39s]
[0m19:56:14.763295 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m19:56:14.764802 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m19:56:14.766327 [info ] [Thread-1  ]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m19:56:14.770169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m19:56:14.770816 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m19:56:14.777282 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m19:56:14.778947 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m19:56:14.783140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:14.815887 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7d70c04b-9b3a-42fa-bd74-dd033b05134c
[0m19:56:14.960011 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m19:56:14.963034 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:56:15.494079 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:56:15.496650 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/e9bf5bdd-87a0-4f1c-81c9-9fb76593594b',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m19:56:16.044976 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m19:56:16.046154 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:16.047095 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:56:16.087560 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3fc84d2f-0b2a-4ad6-954a-409243554116
[0m19:56:16.594160 [debug] [Thread-1  ]: SQL status: OK -1 in 1.990 seconds
[0m19:56:16.597850 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m19:56:16.599711 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m19:56:16.600079 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":675}';
[0m19:56:16.845767 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 988fbbb3-b8f6-486e-9e35-1986557cb321
[0m19:56:17.217788 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m19:56:17.218752 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:17.219171 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/e766f9a6-7e81-4ad6-bdd5-29afd9213722
[0m19:56:17.770460 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/e766f9a6-7e81-4ad6-bdd5-29afd9213722', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/e766f9a6-7e81-4ad6-bdd5-29afd9213722/'
[0m19:56:17.799127 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m19:56:17.800096 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m19:56:17.800542 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:18.013957 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 85dfe0e7-0956-4587-8b87-fa60fc59105c
[0m19:56:18.617398 [debug] [Thread-1  ]: SQL status: OK 31 in 2.016 seconds
[0m19:56:18.630719 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m19:56:18.634813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b08c9d0>]}
[0m19:56:18.638690 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 12.37s]
[0m19:56:18.641572 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m19:56:18.643402 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m19:56:18.645479 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m19:56:18.648475 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m19:56:18.649089 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m19:56:18.657490 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m19:56:18.658782 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m19:56:18.662812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:19.759513 [debug] [Thread-1  ]: SQL status: OK -1 in 1.957 seconds
[0m19:56:19.768231 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m19:56:19.771747 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m19:56:19.772273 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m19:56:19.949614 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m19:56:19.951363 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:19.953007 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:56:19.983312 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m19:56:19.990820 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:56:20.055668 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 70f9cac0-f444-40bb-9ffc-39872e2482fe
[0m19:56:20.507817 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:56:20.513239 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/42bc3083-aa3e-4156-9fe9-2d05dcf82d8c',
      format='parquet'
    )
    as
      
select
    location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m19:56:21.070581 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6343921e-daa6-49c7-9580-ae8f0872265c
[0m19:56:21.096712 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m19:56:21.097618 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:21.098069 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/e9bf5bdd-87a0-4f1c-81c9-9fb76593594b
[0m19:56:21.704417 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/e9bf5bdd-87a0-4f1c-81c9-9fb76593594b', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/e9bf5bdd-87a0-4f1c-81c9-9fb76593594b/'
[0m19:56:21.830599 [debug] [Thread-1  ]: SQL status: OK 4447 in 2.058 seconds
[0m19:56:21.835767 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m19:56:21.837349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbd7b20>]}
[0m19:56:21.838804 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 11.92s]
[0m19:56:21.840210 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m19:56:21.844061 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m19:56:21.848824 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m19:56:21.851994 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m19:56:21.852564 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m19:56:21.859522 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m19:56:21.860663 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m19:56:21.863559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:22.835560 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1145,"data_scanned_in_bytes":13286}
[0m19:56:22.838284 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m19:56:22.838612 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:23.067195 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1489c37e-a6e2-4e34-a03a-7e60a32f13cc
[0m19:56:23.078310 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m19:56:23.079614 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:23.080812 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:56:23.691496 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m19:56:23.698789 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:56:24.207834 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:56:24.210506 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/5046d4f3-dfab-461c-9125-f59abcfab690',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m19:56:24.251455 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m19:56:24.252561 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:24.253469 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/d3867b71-9d6b-45bc-bde5-e27f6ed9b524
[0m19:56:24.769777 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 010e2982-136e-430d-b08e-67fa5ec111ad
[0m19:56:24.796703 [debug] [Thread-1  ]: SQL status: OK -1 in 1.955 seconds
[0m19:56:24.810023 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m19:56:24.814479 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m19:56:24.816189 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":1145,"data_scanned_in_bytes":13286}';
[0m19:56:24.877601 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/d3867b71-9d6b-45bc-bde5-e27f6ed9b524', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/d3867b71-9d6b-45bc-bde5-e27f6ed9b524/'
[0m19:56:25.116154 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d3904ee6-bfcd-46d0-91ab-d19f87ca6910
[0m19:56:26.530802 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m19:56:26.534750 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m19:56:26.535496 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:26.758899 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fe6bfa8b-927e-4339-aead-59ced2125ecf
[0m19:56:26.915893 [debug] [Thread-1  ]: SQL status: OK 1145 in 2.098 seconds
[0m19:56:26.935533 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m19:56:26.938515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23abf2db-2dd7-4ab7-8806-15a7c0a2be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980e4610>]}
[0m19:56:26.941225 [info ] [Thread-1  ]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 1145[0m in 12.17s]
[0m19:56:26.943540 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m19:56:26.954220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:26.954837 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m19:56:26.959625 [info ] [MainThread]: 
[0m19:56:26.961272 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 24.64 seconds (84.64s).
[0m19:56:26.964454 [debug] [MainThread]: Command end result
[0m19:56:27.018566 [info ] [MainThread]: 
[0m19:56:27.019622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:27.020063 [info ] [MainThread]: 
[0m19:56:27.020785 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m19:56:27.024231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 85.49652, "process_user_time": 9.972818, "process_kernel_time": 1.427769, "process_mem_max_rss": "173604", "process_in_blocks": "1432", "process_out_blocks": "2660"}
[0m19:56:27.025154 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:27.025041 after 85.50 seconds
[0m19:56:27.026043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d822190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0a8be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bdf6280>]}
[0m19:56:27.026364 [debug] [MainThread]: Flushing usage events
[0m19:56:27.041324 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m19:56:27.044349 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:56:27.538259 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:56:27.540032 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/02936c63-62d0-4621-a521-0f93ab9e0392',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m19:56:28.124088 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f1751f92-34da-4d60-be10-ef17ba9b726b
[0m19:56:28.492128 [debug] [Thread-1  ]: SQL status: OK -1 in 1.956 seconds
[0m19:56:28.498079 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m19:56:28.499971 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m19:56:28.500451 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m19:56:28.725123 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 61392758-a548-4b53-8fd5-9c1ca61ff7ab
[0m19:56:29.908496 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m19:56:29.913043 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m19:56:29.913522 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:30.128077 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID dff5942f-bbeb-4cf1-aff9-fc0547c39621
[0m19:56:30.542712 [debug] [Thread-1  ]: SQL status: OK 4447 in 2.034 seconds
[0m19:56:30.557490 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m19:56:30.559946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82771b80>]}
[0m19:56:30.565339 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 11.91s]
[0m19:56:30.567236 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m19:56:30.568778 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m19:56:30.570689 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m19:56:30.579980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m19:56:30.581025 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m19:56:30.589961 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m19:56:30.591551 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m19:56:30.594969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:31.862917 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m19:56:31.864365 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:31.865585 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:56:31.882380 [debug] [Thread-1  ]: SQL status: OK -1 in 1.969 seconds
[0m19:56:31.888966 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m19:56:31.892008 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m19:56:31.892642 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m19:56:32.133959 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9a63af8c-22a7-4996-8d86-3fda5fa74713
[0m19:56:33.053841 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m19:56:33.054585 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:33.054886 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/02936c63-62d0-4621-a521-0f93ab9e0392
[0m19:56:33.634907 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/02936c63-62d0-4621-a521-0f93ab9e0392', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/02936c63-62d0-4621-a521-0f93ab9e0392/'
[0m19:56:34.022627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f62160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb047d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb047d2b0>]}


============================== 19:56:34.028507 | 9156553a-311a-4a6f-943a-6add402417b7 ==============================
[0m19:56:34.028507 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:56:34.029008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:56:34.085842 [debug] [Thread-1  ]: SQL status: OK 63 in 2.192 seconds
[0m19:56:34.089530 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m19:56:34.090340 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847b4fd0>]}
[0m19:56:34.091880 [info ] [Thread-1  ]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 12.24s]
[0m19:56:34.092573 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m19:56:34.093946 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m19:56:34.094686 [info ] [Thread-1  ]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m19:56:34.096952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m19:56:34.097616 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m19:56:34.101345 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m19:56:34.104281 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m19:56:34.106718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:34.430525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9253d0>]}
[0m19:56:34.464094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2673280>]}
[0m19:56:34.464730 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:56:34.479265 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:56:34.578275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:56:34.578766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:56:34.616473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae052370>]}
[0m19:56:34.695633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae041fa0>]}
[0m19:56:34.696064 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:56:34.696360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadfe4550>]}
[0m19:56:34.697799 [info ] [MainThread]: 
[0m19:56:34.698433 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:56:34.703496 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:56:34.703860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:35.264730 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m19:56:35.265233 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:35.265813 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:56:35.269025 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:56:35.271057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m19:56:35.271399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:35.593237 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m19:56:35.602229 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:56:36.084650 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:56:36.086366 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/bd17554f-581d-4d85-88ef-6f6ea9932dc6',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m19:56:36.348044 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m19:56:36.349957 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:36.350716 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/42bc3083-aa3e-4156-9fe9-2d05dcf82d8c
[0m19:56:36.619612 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 92cc86bf-1ec8-4cff-83bc-82263bc95c58
[0m19:56:36.625953 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m19:56:36.632425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaedff340>]}
[0m19:56:36.637856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:36.641763 [info ] [MainThread]: 
[0m19:56:36.652192 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m19:56:36.654054 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m19:56:36.655522 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m19:56:36.656219 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m19:56:36.669948 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m19:56:36.672042 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m19:56:36.691115 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m19:56:36.692360 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m19:56:36.692693 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m19:56:36.692947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:36.912074 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/42bc3083-aa3e-4156-9fe9-2d05dcf82d8c', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/42bc3083-aa3e-4156-9fe9-2d05dcf82d8c/'
[0m19:56:37.239900 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4d46206a-1b22-4cfe-bce5-251ef5f8302e
[0m19:56:38.367731 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m19:56:38.370385 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m19:56:38.371301 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:38.588306 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6c9347c4-bf65-4162-86d5-9b8943d4307d
[0m19:56:39.026225 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m19:56:39.025909 [debug] [Thread-1  ]: SQL status: OK -1 in 2.332 seconds
[0m19:56:39.052359 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:56:39.623381 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:56:39.627269 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/6e4c8abf-521b-45ef-92e7-6f50b678745f',
      format='parquet'
    )
    as
      
select
    location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m19:56:40.187142 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1780659e-769b-4a93-90ee-36d08aae9364
[0m19:56:40.305438 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m19:56:40.309744 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m19:56:40.550469 [debug] [Thread-1  ]: SQL status: OK -1 in 2.178 seconds
[0m19:56:40.553197 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m19:56:40.554718 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m19:56:40.555092 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m19:56:40.783437 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1b09d60f-e9f8-47b5-ab67-7ec2ecdd37f8
[0m19:56:40.886323 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m19:56:40.913258 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m19:56:40.917420 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad8944f0>]}
[0m19:56:40.919156 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.26s]
[0m19:56:40.924976 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m19:56:40.926300 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m19:56:40.927987 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m19:56:40.931816 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m19:56:40.932520 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m19:56:40.939750 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m19:56:40.941347 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m19:56:40.944651 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m19:56:40.946497 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m19:56:40.947418 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m19:56:40.947892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:41.609082 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 88427cb3-9d1b-4efb-a100-569428841829
[0m19:56:41.956108 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1145,"data_scanned_in_bytes":13286}
[0m19:56:41.960157 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m19:56:41.960595 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:42.238638 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 78c2a027-f632-4e2e-a9d6-34c85b9156c1
[0m19:56:42.538951 [debug] [Thread-1  ]: SQL status: OK 63 in 1.983 seconds
[0m19:56:42.549775 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m19:56:42.551785 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86a7cb50>]}
[0m19:56:42.553441 [info ] [Thread-1  ]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 11.98s]
[0m19:56:42.555236 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m19:56:42.556647 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m19:56:42.558232 [info ] [Thread-1  ]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m19:56:42.564405 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m19:56:42.565549 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m19:56:42.572372 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m19:56:42.574183 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m19:56:42.578252 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:43.319250 [debug] [Thread-1  ]: SQL status: OK -1 in 2.370 seconds
[0m19:56:43.793505 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m19:56:43.794333 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:43.795503 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:56:43.966693 [debug] [Thread-1  ]: SQL status: OK -1 in 2.005 seconds
[0m19:56:43.973538 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m19:56:43.975527 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m19:56:43.976003 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":1145,"data_scanned_in_bytes":13286}';
[0m19:56:44.188862 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3e9687a4-6a97-4a23-bcba-57e2c6d1e3ac
[0m19:56:44.488930 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m19:56:44.491835 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m19:56:44.948087 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m19:56:44.949538 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:44.950351 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/6e4c8abf-521b-45ef-92e7-6f50b678745f
[0m19:56:45.041311 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m19:56:45.045828 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m19:56:45.047385 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad8dcd00>]}
[0m19:56:45.048725 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.12s]
[0m19:56:45.053388 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m19:56:45.054339 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m19:56:45.055213 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m19:56:45.057605 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m19:56:45.058013 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m19:56:45.064248 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m19:56:45.066943 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m19:56:45.069832 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m19:56:45.070994 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m19:56:45.071288 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m19:56:45.071575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:45.488350 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/6e4c8abf-521b-45ef-92e7-6f50b678745f', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/6e4c8abf-521b-45ef-92e7-6f50b678745f/'
[0m19:56:45.664876 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2611ede9-a3f5-4905-886a-1d83d54ab26b
[0m19:56:45.956826 [debug] [Thread-1  ]: SQL status: OK 1145 in 1.980 seconds
[0m19:56:45.966643 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m19:56:45.968938 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21c466b-6a67-4771-b14d-8d3da8e3bdd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d632fd0>]}
[0m19:56:45.971287 [info ] [Thread-1  ]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 1145[0m in 11.87s]
[0m19:56:45.973530 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m19:56:45.981231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:45.986580 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m19:56:45.990485 [info ] [MainThread]: 
[0m19:56:45.991165 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 21.63 seconds (81.63s).
[0m19:56:45.994062 [debug] [MainThread]: Command end result
[0m19:56:46.038783 [info ] [MainThread]: 
[0m19:56:46.039611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:46.039911 [info ] [MainThread]: 
[0m19:56:46.040290 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m19:56:46.047124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 83.00165, "process_user_time": 8.504496, "process_kernel_time": 1.635754, "process_mem_max_rss": "173216", "process_out_blocks": "2140", "process_in_blocks": "0"}
[0m19:56:46.048773 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:46.048501 after 83.00 seconds
[0m19:56:46.049348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91264370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8faff250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848572e0>]}
[0m19:56:46.049616 [debug] [MainThread]: Flushing usage events
[0m19:56:47.414124 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m19:56:47.420138 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:56:47.437774 [debug] [Thread-1  ]: SQL status: OK -1 in 2.366 seconds
[0m19:56:47.945786 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:56:47.947821 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/c1a5e715-0c85-49a3-aba9-9acb64e8d4be',
      format='parquet'
    )
    as
      
select
    location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m19:56:48.498413 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 745563df-8a1a-4099-a8e7-1d9285253b61
[0m19:56:48.751002 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m19:56:48.754242 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m19:56:49.326498 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m19:56:49.342100 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m19:56:49.344075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb107ab20>]}
[0m19:56:49.345718 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.29s]
[0m19:56:49.349613 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m19:56:49.353549 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m19:56:49.355193 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m19:56:49.360772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m19:56:49.361430 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m19:56:49.383694 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m19:56:49.385915 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m19:56:49.389333 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m19:56:49.390502 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m19:56:49.390856 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m19:56:49.391149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:50.242947 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 68a4fea7-06c2-47b4-bb47-0f13a70d8e30
[0m19:56:51.456019 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1145,"data_scanned_in_bytes":13286}
[0m19:56:51.471964 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m19:56:51.472790 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m19:56:51.683891 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1b329c79-ded8-49eb-ae3c-4b6728879b46
[0m19:56:52.047811 [debug] [Thread-1  ]: SQL status: OK -1 in 2.656 seconds
[0m19:56:53.334795 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m19:56:53.337037 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m19:56:53.394437 [debug] [Thread-1  ]: SQL status: OK -1 in 1.921 seconds
[0m19:56:53.404955 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m19:56:53.409553 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m19:56:53.410074 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":1145,"data_scanned_in_bytes":13286}';
[0m19:56:53.639763 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 040ec0a4-9430-45ac-8f1f-ac1779ae353c
[0m19:56:53.867410 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m19:56:53.876776 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m19:56:53.879297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb041ae20>]}
[0m19:56:53.880845 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.52s]
[0m19:56:53.882368 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m19:56:53.884072 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m19:56:53.885353 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m19:56:53.893699 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m19:56:53.894334 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m19:56:53.908703 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m19:56:53.910981 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m19:56:53.916388 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m19:56:53.917813 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m19:56:53.918249 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m19:56:53.918643 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:54.519790 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1f941963-fad8-4929-a427-7b298b7f45bc
[0m19:56:55.516842 [debug] [Thread-1  ]: SQL status: OK 1145 in 2.102 seconds
[0m19:56:55.524800 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m19:56:55.526145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f385eebf-7bb5-47c2-8218-4845bb563442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832d8910>]}
[0m19:56:55.527300 [info ] [Thread-1  ]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 1145[0m in 12.97s]
[0m19:56:55.528168 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m19:56:55.531978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:55.532369 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m19:56:55.536157 [info ] [MainThread]: 
[0m19:56:55.538166 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 31.27 seconds (91.27s).
[0m19:56:55.540612 [debug] [MainThread]: Command end result
[0m19:56:55.585665 [info ] [MainThread]: 
[0m19:56:55.586179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:56:55.586426 [info ] [MainThread]: 
[0m19:56:55.586770 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m19:56:55.589114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 92.55153, "process_user_time": 9.073514, "process_kernel_time": 1.766124, "process_mem_max_rss": "172716", "process_out_blocks": "2142", "process_in_blocks": "0"}
[0m19:56:55.590258 [debug] [MainThread]: Command `dbt run` succeeded at 19:56:55.589780 after 92.55 seconds
[0m19:56:55.590653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87956190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d02ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff870a9100>]}
[0m19:56:55.590891 [debug] [MainThread]: Flushing usage events
[0m19:56:56.279199 [debug] [Thread-1  ]: SQL status: OK -1 in 2.359 seconds
[0m19:56:57.484526 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m19:56:57.488158 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m19:56:58.033021 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m19:56:58.041304 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m19:56:58.043610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb041ae20>]}
[0m19:56:58.045342 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.16s]
[0m19:56:58.047144 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m19:56:58.048617 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m19:56:58.050621 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m19:56:58.055825 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m19:56:58.056527 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m19:56:58.070754 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m19:56:58.072642 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m19:56:58.111107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:56:59.703153 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m19:56:59.706158 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:56:59.713585 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:57:00.839839 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m19:57:00.840500 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:57:00.840876 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/5bdf6f32-3bb5-4caf-a6a6-2b84e29a4139
[0m19:57:01.414458 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/5bdf6f32-3bb5-4caf-a6a6-2b84e29a4139', bucket='climate-energy-raw-data', prefix='silver/eia_silver/5bdf6f32-3bb5-4caf-a6a6-2b84e29a4139/'
[0m19:57:02.293114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992a21c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97bafd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e4bf40>]}


============================== 19:57:02.297745 | 09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf ==============================
[0m19:57:02.297745 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:57:02.298202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:57:02.655181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f8b460>]}
[0m19:57:02.685059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bfad60>]}
[0m19:57:02.685614 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:57:02.698270 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:57:02.791401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:57:02.791730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:57:02.824889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff953d23d0>]}
[0m19:57:02.901122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95380340>]}
[0m19:57:02.901564 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:57:02.901850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9531d5b0>]}
[0m19:57:02.903216 [info ] [MainThread]: 
[0m19:57:02.903650 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:57:02.907819 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:57:02.908105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:03.389965 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m19:57:03.433255 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:57:03.499054 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:57:03.501029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m19:57:03.501449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:03.916258 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:57:03.917827 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/047a3094-0ba1-4e24-9430-2fef98f1ea39',
      format='parquet'
    )
    as
      
with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m19:57:04.465578 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d4d56f4c-1cf5-45bd-bd92-52fb12f6278c
[0m19:57:04.963780 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m19:57:04.971224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9612f250>]}
[0m19:57:04.972786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:04.973756 [info ] [MainThread]: 
[0m19:57:04.990454 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m19:57:04.991892 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m19:57:04.992806 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m19:57:04.993428 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m19:57:05.009532 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m19:57:05.012850 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m19:57:05.040310 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m19:57:05.042806 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m19:57:05.043398 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m19:57:05.043841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:05.662900 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2e97e6c7-74dc-4f60-b090-5e37b4c3af15
[0m19:57:06.185848 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1613}
[0m19:57:06.189367 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m19:57:06.189786 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m19:57:06.399055 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7a23c3e3-59e8-43b5-a5e1-f800c5bd53c6
[0m19:57:07.445725 [debug] [Thread-1  ]: SQL status: OK -1 in 2.401 seconds
[0m19:57:08.148624 [debug] [Thread-1  ]: SQL status: OK -1 in 1.958 seconds
[0m19:57:08.153571 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m19:57:08.155632 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m19:57:08.155967 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1613}';
[0m19:57:08.430432 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 756994a9-11b4-4e39-ac58-1c5f65f14afb
[0m19:57:08.593723 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m19:57:08.596118 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m19:57:09.150243 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m19:57:09.171378 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m19:57:09.174665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bd62e0>]}
[0m19:57:09.176246 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.18s]
[0m19:57:09.178202 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m19:57:09.179431 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m19:57:09.180975 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m19:57:09.186931 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m19:57:09.187982 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m19:57:09.195739 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m19:57:09.197183 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m19:57:09.200126 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m19:57:09.201298 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m19:57:09.201676 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m19:57:09.202198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:10.037878 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ce07ea7d-4184-47d6-afc0-560f0f8c3d7b
[0m19:57:10.238517 [debug] [Thread-1  ]: SQL status: OK 2 in 2.080 seconds
[0m19:57:10.263953 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m19:57:10.270462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6b73490>]}
[0m19:57:10.275007 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2[0m in 12.21s]
[0m19:57:10.277461 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m19:57:10.279431 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m19:57:10.281971 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m19:57:10.290201 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m19:57:10.291004 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m19:57:10.301517 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m19:57:10.303162 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m19:57:10.306866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:11.722164 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:57:11.723549 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:57:11.724266 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:57:11.790004 [debug] [Thread-1  ]: SQL status: OK -1 in 2.587 seconds
[0m19:57:12.817523 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:57:12.819600 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:57:12.820422 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/c1f8279a-150f-4af3-82c7-a41cbd64f160
[0m19:57:12.945048 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m19:57:12.946995 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m19:57:13.376808 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/c1f8279a-150f-4af3-82c7-a41cbd64f160', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/c1f8279a-150f-4af3-82c7-a41cbd64f160/'
[0m19:57:13.462760 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m19:57:13.472672 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m19:57:13.474907 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c14bb0>]}
[0m19:57:13.476342 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.29s]
[0m19:57:13.477415 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m19:57:13.478155 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m19:57:13.479480 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m19:57:13.481778 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m19:57:13.482404 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m19:57:13.488143 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m19:57:13.489851 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m19:57:13.493199 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m19:57:13.494630 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m19:57:13.495150 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m19:57:13.500413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:14.104598 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c60384b9-ae38-4a29-8abf-9d8491a92a2d
[0m19:57:15.516805 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m19:57:15.521199 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:57:15.887967 [debug] [Thread-1  ]: SQL status: OK -1 in 2.387 seconds
[0m19:57:16.041025 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:57:16.044696 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/d7dd7333-f5aa-4610-a045-97409a858fd0',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m19:57:16.577071 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 40ba8dff-dae6-4a5e-904e-46917020401b
[0m19:57:17.138069 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m19:57:17.143220 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m19:57:17.748189 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m19:57:17.762299 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m19:57:17.765322 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983cb070>]}
[0m19:57:17.769780 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.28s]
[0m19:57:17.773037 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m19:57:17.775123 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m19:57:17.777777 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m19:57:17.787053 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m19:57:17.788067 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m19:57:17.801177 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m19:57:17.803083 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m19:57:17.806806 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m19:57:17.808560 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m19:57:17.808988 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m19:57:17.809419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:18.332730 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":675}
[0m19:57:18.337255 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m19:57:18.337964 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m19:57:18.545134 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 26b5c922-6f1a-4eaf-ae53-611d6c4a2a5f
[0m19:57:18.555594 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fb07aee8-ec61-48cc-9f0a-510d8b62fd92
[0m19:57:20.390121 [debug] [Thread-1  ]: SQL status: OK -1 in 2.042 seconds
[0m19:57:20.400678 [debug] [Thread-1  ]: SQL status: OK -1 in 2.578 seconds
[0m19:57:20.460645 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m19:57:20.478501 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m19:57:20.479279 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":675}';
[0m19:57:20.706574 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0b50a3fc-bc66-49cf-b81c-5f7298a0df40
[0m19:57:22.110656 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m19:57:22.114142 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m19:57:22.510581 [debug] [Thread-1  ]: SQL status: OK 31 in 2.028 seconds
[0m19:57:22.527659 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m19:57:22.530209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad8e4be0>]}
[0m19:57:22.532293 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 12.25s]
[0m19:57:22.534317 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m19:57:22.535966 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m19:57:22.537708 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m19:57:22.543164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m19:57:22.543771 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m19:57:22.554509 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m19:57:22.558384 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m19:57:22.561755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:22.664333 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m19:57:22.670180 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m19:57:22.671803 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983cb070>]}
[0m19:57:22.673247 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.89s]
[0m19:57:22.674739 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m19:57:22.675717 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m19:57:22.676903 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m19:57:22.679969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m19:57:22.680440 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m19:57:22.686555 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m19:57:22.687467 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m19:57:22.691262 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m19:57:22.692190 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m19:57:22.692465 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m19:57:22.692758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:23.298127 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a9f23368-b045-448e-a0cf-71bc63e0568c
[0m19:57:23.756551 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m19:57:23.757312 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:57:23.758904 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:57:24.862729 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m19:57:24.863648 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:57:24.864235 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/5046d4f3-dfab-461c-9125-f59abcfab690
[0m19:57:25.070220 [debug] [Thread-1  ]: SQL status: OK -1 in 2.377 seconds
[0m19:57:25.585473 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/5046d4f3-dfab-461c-9125-f59abcfab690', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/5046d4f3-dfab-461c-9125-f59abcfab690/'
[0m19:57:26.234541 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m19:57:26.237191 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m19:57:26.748134 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m19:57:26.752128 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m19:57:26.753080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff956b5f10>]}
[0m19:57:26.754142 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.07s]
[0m19:57:26.755584 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m19:57:26.756507 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m19:57:26.757548 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m19:57:26.760871 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m19:57:26.761513 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m19:57:26.766290 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m19:57:26.767523 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m19:57:26.833961 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:57:26.835730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:27.614123 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m19:57:27.618807 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:57:27.669203 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:57:27.669806 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/33687150-6ddc-4726-9290-a8602d26447f',
      format='parquet'
    )
    as
      
with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m19:57:28.059055 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:57:28.060082 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/6b55eee6-7979-48a8-9b96-3c7e45379eef',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m19:57:28.084939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba659190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8b792e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8b79880>]}


============================== 19:57:28.089334 | 84e2a9d8-1a6c-4249-a460-c6fffe59cbc4 ==============================
[0m19:57:28.089334 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:57:28.089815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:28.227820 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 43a95e4d-07f2-409e-a7d1-7f986715646f
[0m19:57:28.420054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb604c250>]}
[0m19:57:28.450611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9dba100>]}
[0m19:57:28.451247 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:57:28.462266 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:57:28.556737 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 468fd199-ed4d-4402-bb19-9226445c26fe
[0m19:57:28.557891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:57:28.558258 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:57:28.591681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb67523a0>]}
[0m19:57:28.674446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6742fd0>]}
[0m19:57:28.675155 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:57:28.675647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb66de580>]}
[0m19:57:28.677417 [info ] [MainThread]: 
[0m19:57:28.677919 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:57:28.682400 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:57:28.682662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:29.434144 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:57:29.444207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m19:57:29.445387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:30.318896 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m19:57:30.323438 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m19:57:30.324196 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m19:57:30.551947 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1fcdc4a5-72cd-4402-aeea-12ebf37d5826
[0m19:57:30.762984 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID adfd76e4-8325-4cb3-a7e3-6406667f91c8
[0m19:57:30.960227 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m19:57:30.968013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74ff0d0>]}
[0m19:57:30.969618 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:30.970456 [info ] [MainThread]: 
[0m19:57:30.984221 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m19:57:30.985261 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m19:57:30.986245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m19:57:30.986780 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m19:57:31.007560 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m19:57:31.009831 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m19:57:31.033023 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m19:57:31.034321 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m19:57:31.034628 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m19:57:31.034907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:31.634982 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 99d4a729-9577-4d82-a6b2-88a21506b155
[0m19:57:32.313163 [debug] [Thread-1  ]: SQL status: OK -1 in 1.984 seconds
[0m19:57:32.358507 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m19:57:32.369823 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m19:57:32.370859 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m19:57:32.598434 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5c3e139c-f6b7-4d3e-b9d2-7a9113af847d
[0m19:57:33.566498 [debug] [Thread-1  ]: SQL status: OK -1 in 2.530 seconds
[0m19:57:34.354666 [debug] [Thread-1  ]: SQL status: OK 4447 in 1.983 seconds
[0m19:57:34.366854 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m19:57:34.368587 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9156553a-311a-4a6f-943a-6add402417b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3b8a00>]}
[0m19:57:34.369999 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 11.83s]
[0m19:57:34.371330 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m19:57:34.372532 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m19:57:34.373285 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m19:57:34.381429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m19:57:34.382113 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m19:57:34.389586 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m19:57:34.390752 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m19:57:34.393552 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:57:34.394048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:34.839764 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m19:57:34.842519 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m19:57:35.004869 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:57:35.006939 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/92416dbc-6a53-44af-9dd3-b33045b4be4f',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m19:57:35.363163 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m19:57:35.385974 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m19:57:35.390367 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb97cbc70>]}
[0m19:57:35.392092 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.40s]
[0m19:57:35.393803 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m19:57:35.395152 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m19:57:35.397636 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m19:57:35.400450 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m19:57:35.401053 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m19:57:35.407907 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m19:57:35.409557 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m19:57:35.412944 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m19:57:35.414239 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m19:57:35.414612 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m19:57:35.415058 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:35.593774 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4c165a69-a70e-4600-b690-dad548b67060
[0m19:57:36.076143 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a68c88df-d379-4fee-8b89-6858f5ff805f
[0m19:57:37.820214 [debug] [Thread-1  ]: SQL status: OK -1 in 2.405 seconds
[0m19:57:39.048008 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m19:57:39.101241 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m19:57:39.268345 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ef18dd85-f08c-4919-819c-350fb187b4aa
[0m19:57:39.716548 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m19:57:39.721434 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m19:57:39.722370 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fcf5b0>]}
[0m19:57:39.723461 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.32s]
[0m19:57:39.724662 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m19:57:39.725281 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m19:57:39.726031 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m19:57:39.728509 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m19:57:39.729043 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m19:57:39.737584 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m19:57:39.739021 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m19:57:39.741789 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m19:57:39.742938 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m19:57:39.743288 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m19:57:39.743656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:39.959217 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3d4cedb9-0a06-441e-8951-a5566d893e40
[0m19:57:40.321503 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c5b88c1d-ae19-492b-9e07-9413dbf76460
[0m19:57:42.137369 [debug] [Thread-1  ]: SQL status: OK -1 in 2.393 seconds
[0m19:57:42.540028 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID dc919625-20cf-407a-a37d-a74a73a79a7e
[0m19:57:43.270975 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m19:57:43.274101 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m19:57:43.820888 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m19:57:43.829207 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m19:57:43.832114 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbad58460>]}
[0m19:57:43.834302 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.10s]
[0m19:57:43.836211 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m19:57:43.837664 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m19:57:43.839663 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m19:57:43.842787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m19:57:43.843648 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m19:57:43.854192 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m19:57:43.856057 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m19:57:43.860034 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m19:57:43.861523 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m19:57:43.862014 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m19:57:43.862549 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:44.518904 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fca6291a-f3e4-4ef6-a418-3c170a1bae87
[0m19:57:46.305286 [debug] [Thread-1  ]: SQL status: OK -1 in 2.442 seconds
[0m19:57:47.198108 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1476e46c-c360-4fd2-b2b4-83086f4eb1bf
[0m19:57:47.531818 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m19:57:47.533557 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m19:57:48.063546 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m19:57:48.067300 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m19:57:48.068192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ffb7f0>]}
[0m19:57:48.069141 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.23s]
[0m19:57:48.070343 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m19:57:48.070985 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m19:57:48.071650 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m19:57:48.073710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m19:57:48.074209 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m19:57:48.078325 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m19:57:48.079814 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m19:57:48.084417 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m19:57:48.085449 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m19:57:48.085768 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  location,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m19:57:48.086100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:48.660692 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 371f3d0c-bfd8-4528-9cff-1039fbbd5faf
[0m19:57:50.455446 [debug] [Thread-1  ]: SQL status: OK -1 in 2.368 seconds
[0m19:57:51.682940 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m19:57:51.684292 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m19:57:52.192997 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m19:57:52.200251 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m19:57:52.202722 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ffb7f0>]}
[0m19:57:52.204741 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.13s]
[0m19:57:52.206766 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m19:57:52.208142 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m19:57:52.210093 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m19:57:52.213480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m19:57:52.214411 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m19:57:52.225325 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m19:57:52.227296 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m19:57:52.267225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:53.575252 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m19:57:53.576638 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:57:53.580769 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:57:54.217088 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID af000107-14fb-4a26-9c85-d9b11f49c997
[0m19:57:54.772580 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m19:57:54.774012 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:57:54.774775 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/047a3094-0ba1-4e24-9430-2fef98f1ea39
[0m19:57:55.386835 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/047a3094-0ba1-4e24-9430-2fef98f1ea39', bucket='climate-energy-raw-data', prefix='silver/eia_silver/047a3094-0ba1-4e24-9430-2fef98f1ea39/'
[0m19:57:57.613709 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m19:57:57.640676 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:57:58.097063 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:57:58.098803 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/e1883c19-98e4-4c4d-9eb2-c8f1b102bdca',
      format='parquet'
    )
    as
      
with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m19:57:58.863668 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 523b6230-6abb-4aaf-88ea-9bd3c81041a7
[0m19:58:00.961230 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1613}
[0m19:58:00.968468 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m19:58:00.968974 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m19:58:01.206475 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 561ca0bc-8978-4119-b9ce-58ce6338b34f
[0m19:58:02.960366 [debug] [Thread-1  ]: SQL status: OK -1 in 1.991 seconds
[0m19:58:02.963308 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m19:58:02.965286 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m19:58:02.965593 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1613}';
[0m19:58:03.190522 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fcf8ddc4-d32a-41aa-8cf7-7d70ef46e583
[0m19:58:03.441765 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 83ca5888-8185-41d7-8038-2fd7b2e8207f
[0m19:58:05.038396 [debug] [Thread-1  ]: SQL status: OK 2 in 2.071 seconds
[0m19:58:05.046839 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m19:58:05.048809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5fcfc40>]}
[0m19:58:05.050260 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2[0m in 12.84s]
[0m19:58:05.051625 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m19:58:05.052601 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m19:58:05.053744 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m19:58:05.056780 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m19:58:05.057306 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m19:58:05.070340 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m19:58:05.073784 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m19:58:05.077434 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:06.377392 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:58:06.377909 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:58:06.378348 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:58:07.494018 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:58:07.497244 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:58:07.499171 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/d7dd7333-f5aa-4610-a045-97409a858fd0
[0m19:58:08.229332 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/d7dd7333-f5aa-4610-a045-97409a858fd0', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/d7dd7333-f5aa-4610-a045-97409a858fd0/'
[0m19:58:10.695247 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m19:58:10.719891 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:58:11.286753 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:58:11.287822 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/a23e58ae-a6c2-4af7-bd73-3793c583e502',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m19:58:11.797372 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 71112ba8-e924-4207-b92e-e7aa40f90708
[0m19:58:14.757895 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":675}
[0m19:58:14.762257 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m19:58:14.763318 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m19:58:14.974364 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4efa4cea-672d-4e1d-be09-7adef311e010
[0m19:58:16.732569 [debug] [Thread-1  ]: SQL status: OK -1 in 1.964 seconds
[0m19:58:16.753677 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m19:58:16.783085 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m19:58:16.785368 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":675}';
[0m19:58:17.022464 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1644a8f1-97a2-46c6-bb92-2d36180960df
[0m19:58:18.815235 [debug] [Thread-1  ]: SQL status: OK 31 in 2.026 seconds
[0m19:58:18.843823 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m19:58:18.849248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb61ca1c0>]}
[0m19:58:18.851457 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 13.79s]
[0m19:58:18.855447 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m19:58:18.859408 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m19:58:18.870667 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m19:58:18.876921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m19:58:18.878840 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m19:58:18.915588 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m19:58:18.922265 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m19:58:18.936086 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:20.596375 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m19:58:20.598173 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:58:20.599692 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:58:21.691356 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m19:58:21.691855 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:58:21.692366 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/6b55eee6-7979-48a8-9b96-3c7e45379eef
[0m19:58:22.710990 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/6b55eee6-7979-48a8-9b96-3c7e45379eef', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/6b55eee6-7979-48a8-9b96-3c7e45379eef/'
[0m19:58:25.007135 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m19:58:25.017584 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:58:25.539624 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:58:25.546437 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/acab842b-d7dc-49e8-8ddc-49dd4e1e1496',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m19:58:26.156671 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9aecaffe-efff-403b-9e0e-bfec4a89027a
[0m19:58:27.918658 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m19:58:27.921529 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m19:58:27.922398 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m19:58:28.144757 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6d5e6577-ba20-400e-977b-cb36ec1b639b
[0m19:58:29.905467 [debug] [Thread-1  ]: SQL status: OK -1 in 1.981 seconds
[0m19:58:29.912258 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m19:58:29.917272 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m19:58:29.917969 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m19:58:30.142695 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 77997abd-b7ac-4e6f-8b1e-05ed015f2e4f
[0m19:58:31.948045 [debug] [Thread-1  ]: SQL status: OK 4447 in 2.031 seconds
[0m19:58:31.952729 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m19:58:31.955550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75dc700>]}
[0m19:58:31.957379 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 13.08s]
[0m19:58:31.958934 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m19:58:31.959711 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m19:58:31.960651 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m19:58:31.964086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m19:58:31.964721 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m19:58:31.978464 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m19:58:31.980266 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m19:58:31.983280 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:33.213361 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m19:58:33.214529 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:58:33.215495 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:58:34.693714 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m19:58:34.695441 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:58:34.695933 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/bd17554f-581d-4d85-88ef-6f6ea9932dc6
[0m19:58:35.338771 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/bd17554f-581d-4d85-88ef-6f6ea9932dc6', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/bd17554f-581d-4d85-88ef-6f6ea9932dc6/'
[0m19:58:37.480561 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m19:58:37.488861 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:58:37.984862 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:58:37.987348 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/1a844de7-6338-4d2a-9c30-51e734727ad2',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m19:58:38.543319 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 358c9ed6-1c56-4903-b13a-30ba55e096b4
[0m19:58:39.866544 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e758c4db-66c4-4ccc-83e7-74c0f3aaf269
[0m19:58:40.286957 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m19:58:40.290420 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m19:58:40.290895 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m19:58:40.519196 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 06953a15-f944-421d-b2e0-71e290048675
[0m19:58:42.372781 [debug] [Thread-1  ]: SQL status: OK -1 in 2.081 seconds
[0m19:58:42.378520 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m19:58:42.381804 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m19:58:42.382436 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m19:58:42.591475 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cd07a070-a8c6-42c2-9c97-92d2391d9bef
[0m19:58:44.515360 [debug] [Thread-1  ]: SQL status: OK 63 in 2.131 seconds
[0m19:58:44.520300 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m19:58:44.521618 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb976ff10>]}
[0m19:58:44.522935 [info ] [Thread-1  ]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 12.56s]
[0m19:58:44.524660 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m19:58:44.526079 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m19:58:44.527425 [info ] [Thread-1  ]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m19:58:44.531493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m19:58:44.532183 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m19:58:44.538089 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m19:58:44.541010 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m19:58:44.545220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:45.856708 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m19:58:45.857938 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:58:45.858992 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:58:47.036764 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m19:58:47.037699 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:58:47.038274 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/c1a5e715-0c85-49a3-aba9-9acb64e8d4be
[0m19:58:47.608893 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/c1a5e715-0c85-49a3-aba9-9acb64e8d4be', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/c1a5e715-0c85-49a3-aba9-9acb64e8d4be/'
[0m19:58:49.806097 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m19:58:49.812415 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:58:50.359708 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:58:50.361061 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/34f04223-850d-4c27-b4c7-93687edb29ca',
      format='parquet'
    )
    as
      
select
    location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m19:58:50.910707 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 32b140c5-cad8-4f4f-9aea-e271572c22c0
[0m19:58:52.627107 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1145,"data_scanned_in_bytes":13286}
[0m19:58:52.629785 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m19:58:52.630617 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m19:58:52.832932 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 88cae8e1-7250-4cb5-885f-39d5fe2cb0ec
[0m19:58:54.037642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b412340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99880580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bac2bb0>]}


============================== 19:58:54.046528 | a7e7fd6a-8adc-4a60-8c14-fecfb70da17b ==============================
[0m19:58:54.046528 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:58:54.049996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:58:54.552697 [debug] [Thread-1  ]: SQL status: OK -1 in 1.921 seconds
[0m19:58:54.555459 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m19:58:54.557155 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m19:58:54.557478 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":1145,"data_scanned_in_bytes":13286}';
[0m19:58:54.645784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7e7fd6a-8adc-4a60-8c14-fecfb70da17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d64b50>]}
[0m19:58:54.676264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7e7fd6a-8adc-4a60-8c14-fecfb70da17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4e54f0>]}
[0m19:58:54.676910 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m19:58:54.690127 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:58:54.758471 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4ff211ba-ce34-4b55-b4ab-6d7ebb63897c
[0m19:58:54.792428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:58:54.792801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:58:54.825590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7e7fd6a-8adc-4a60-8c14-fecfb70da17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975122b0>]}
[0m19:58:54.912246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7e7fd6a-8adc-4a60-8c14-fecfb70da17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974c0f70>]}
[0m19:58:54.912677 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m19:58:54.913187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7e7fd6a-8adc-4a60-8c14-fecfb70da17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9745d520>]}
[0m19:58:54.914553 [info ] [MainThread]: 
[0m19:58:54.915081 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m19:58:54.920011 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m19:58:54.920466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:55.526552 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m19:58:55.528845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m19:58:55.529256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:58:56.528405 [debug] [Thread-1  ]: SQL status: OK 1145 in 1.970 seconds
[0m19:58:56.538378 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m19:58:56.539688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84e2a9d8-1a6c-4249-a460-c6fffe59cbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf9a040>]}
[0m19:58:56.540969 [info ] [Thread-1  ]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 1145[0m in 12.01s]
[0m19:58:56.542862 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m19:58:56.552334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:56.553510 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m19:58:56.565374 [info ] [MainThread]: 
[0m19:58:56.566602 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 27.88 seconds (87.88s).
[0m19:58:56.569475 [debug] [MainThread]: Command end result
[0m19:58:56.622415 [info ] [MainThread]: 
[0m19:58:56.623206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:58:56.623957 [info ] [MainThread]: 
[0m19:58:56.624979 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m19:58:56.628365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 88.57862, "process_user_time": 8.874235, "process_kernel_time": 1.302474, "process_mem_max_rss": "175528", "process_in_blocks": "2768", "process_out_blocks": "2142"}
[0m19:58:56.629659 [debug] [MainThread]: Command `dbt run` succeeded at 19:58:56.629535 after 88.58 seconds
[0m19:58:56.630331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba659190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6265520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6265dc0>]}
[0m19:58:56.630632 [debug] [MainThread]: Flushing usage events
[0m19:58:57.104664 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m19:58:57.118283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7e7fd6a-8adc-4a60-8c14-fecfb70da17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982800d0>]}
[0m19:58:57.121145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:58:57.122614 [info ] [MainThread]: 
[0m19:58:57.166603 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m19:58:57.175234 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m19:58:57.178745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m19:58:57.179994 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m19:58:57.217889 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m19:58:57.222687 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m19:58:57.259708 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m19:58:57.261331 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m19:58:57.261689 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m19:58:57.262157 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:58.018708 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID eb0d1e01-c0ea-4746-8447-b68d98baaa3b
[0m19:58:59.804612 [debug] [Thread-1  ]: SQL status: OK -1 in 2.541 seconds
[0m19:59:01.014081 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['8', '7', '6', '5', '4']
[0m19:59:01.017006 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['4']
[0m19:59:01.509326 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 4 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m19:59:01.530392 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m19:59:01.533544 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7e7fd6a-8adc-4a60-8c14-fecfb70da17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982e0e80>]}
[0m19:59:01.535401 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.35s]
[0m19:59:01.540342 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m19:59:01.541497 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m19:59:01.542795 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m19:59:01.545789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m19:59:01.546313 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m19:59:01.553202 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m19:59:01.554920 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m19:59:01.558814 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m19:59:01.561263 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m19:59:01.561627 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m19:59:01.561957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:59:02.359262 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 41c13f84-6f87-43e8-b3cf-3de760ab9e75
[0m19:59:04.128474 [debug] [Thread-1  ]: SQL status: OK -1 in 2.566 seconds
[0m19:59:05.324423 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['8', '7', '6', '5', '4']
[0m19:59:05.326644 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['4']
[0m19:59:05.850196 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 4 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m19:59:05.858236 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m19:59:05.860723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7e7fd6a-8adc-4a60-8c14-fecfb70da17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d77280>]}
[0m19:59:05.866068 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.32s]
[0m19:59:05.871443 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m19:59:05.872602 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m19:59:05.874304 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m19:59:05.878100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m19:59:05.878711 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m19:59:05.890162 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m19:59:05.891759 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m19:59:05.894909 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m19:59:05.895992 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m19:59:05.896330 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m19:59:05.896743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:59:06.563526 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8b804776-df09-4b3d-9aff-5ff8611b30dc
[0m19:59:08.525074 [debug] [Thread-1  ]: SQL status: OK -1 in 2.624 seconds
[0m19:59:09.835789 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b18a675c-5a52-4aac-93d6-37499d928d67
[0m19:59:09.842799 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['8', '7', '6', '5', '4']
[0m19:59:09.845159 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['4']
[0m19:59:10.331655 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 4 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m19:59:10.346330 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m19:59:10.350353 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7e7fd6a-8adc-4a60-8c14-fecfb70da17b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe41fa0>]}
[0m19:59:10.354075 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.47s]
[0m19:59:10.360015 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m19:59:10.361696 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m19:59:10.367867 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m19:59:10.374565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m19:59:10.375403 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m19:59:10.387036 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m19:59:10.388659 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m19:59:10.391768 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m19:59:10.392790 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m19:59:10.393097 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m19:59:10.393458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:59:11.170133 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2f08a984-1d28-4326-bc67-31684a084877
[0m19:59:11.173660 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.eia_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/b18a675c-5a52-4aac-93d6-37499d928d67' before retrying. Athena will not delete data in your account.
[0m19:59:11.190973 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m19:59:11.201581 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.eia_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/b18a675c-5a52-4aac-93d6-37499d928d67' before retrying. Athena will not delete data in your account.
[0m19:59:11.217519 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.eia_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/b18a675c-5a52-4aac-93d6-37499d928d67' before retrying. Athena will not delete data in your account.

[0m19:59:11.224934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09251d5c-0ae1-4428-a7e2-fe0cf69c3ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb6ad90>]}
[0m19:59:11.232656 [error] [Thread-1  ]: 6 of 10 ERROR creating sql table model silver.eia_silver ....................... [[31mERROR[0m in 104.46s]
[0m19:59:11.233744 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m19:59:11.235407 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m19:59:11.247393 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m19:59:11.249942 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m19:59:11.251413 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m19:59:11.267415 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m19:59:11.268797 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m19:59:11.313748 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:59:12.653797 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:59:12.655337 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:59:12.658290 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m19:59:12.933579 [debug] [Thread-1  ]: SQL status: OK -1 in 2.540 seconds
[0m19:59:13.883182 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m19:59:13.895972 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m19:59:13.898433 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/a23e58ae-a6c2-4af7-bd73-3793c583e502
[0m19:59:15.333595 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/a23e58ae-a6c2-4af7-bd73-3793c583e502', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/a23e58ae-a6c2-4af7-bd73-3793c583e502/'
[0m19:59:18.639888 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m19:59:18.696865 [debug] [Thread-1  ]: Skip partitioning: False
[0m19:59:20.568857 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m19:59:20.593989 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/ae906c7e-5365-42a4-9132-942ca8568351',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m19:59:21.358347 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3d95d36e-5eeb-44f7-8775-23c25e0380fd
[0m14:25:06.699760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6f2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6f16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6f1d50>]}


============================== 14:25:06.705165 | c56691e8-c35c-4463-8fa3-cec4f032797b ==============================
[0m14:25:06.705165 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:25:06.705650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:25:06.706117 [info ] [MainThread]: dbt version: 1.7.9
[0m14:25:06.706394 [info ] [MainThread]: python version: 3.11.14
[0m14:25:06.706707 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:25:06.707043 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m14:25:07.017248 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m14:25:07.017800 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m14:25:07.018258 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m14:25:07.018791 [info ] [MainThread]: adapter type: athena
[0m14:25:07.019088 [info ] [MainThread]: adapter version: 1.7.2
[0m14:25:07.056166 [info ] [MainThread]: Configuration:
[0m14:25:07.056672 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:25:07.057062 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:25:07.057339 [info ] [MainThread]: Required dependencies:
[0m14:25:07.057664 [debug] [MainThread]: Executing "git --help"
[0m14:25:07.087009 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:25:07.087438 [debug] [MainThread]: STDERR: "b''"
[0m14:25:07.087667 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:25:07.087945 [info ] [MainThread]: Connection:
[0m14:25:07.088319 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m14:25:07.088616 [info ] [MainThread]:   work_group: None
[0m14:25:07.088920 [info ] [MainThread]:   region_name: us-east-1
[0m14:25:07.089246 [info ] [MainThread]:   database: AwsDataCatalog
[0m14:25:07.089481 [info ] [MainThread]:   schema: silver
[0m14:25:07.089743 [info ] [MainThread]:   poll_interval: 1.0
[0m14:25:07.089998 [info ] [MainThread]:   aws_profile_name: None
[0m14:25:07.090313 [info ] [MainThread]:   aws_access_key_id: None
[0m14:25:07.090630 [info ] [MainThread]:   aws_secret_access_key: None
[0m14:25:07.090896 [info ] [MainThread]:   aws_session_token: None
[0m14:25:07.091139 [info ] [MainThread]:   endpoint_url: None
[0m14:25:07.091395 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m14:25:07.091664 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m14:25:07.091897 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m14:25:07.092210 [info ] [MainThread]:   debug_query_state: False
[0m14:25:07.092439 [info ] [MainThread]:   seed_s3_upload_args: None
[0m14:25:07.092717 [info ] [MainThread]:   lf_tags_database: None
[0m14:25:07.092948 [info ] [MainThread]:   spark_work_group: None
[0m14:25:07.093598 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:25:07.094148 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m14:25:07.094411 [debug] [MainThread]: Using athena connection "debug"
[0m14:25:07.094607 [debug] [MainThread]: On debug: select 1 as id
[0m14:25:07.094796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:08.097740 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 4a287a3f-81b3-4e4c-9369-e7d8bae8e03c
[0m14:25:09.863650 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m14:25:09.869288 [debug] [MainThread]: On debug: Close
[0m14:25:09.870354 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:25:09.871414 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:25:09.875359 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.1989026, "process_user_time": 1.846635, "process_kernel_time": 0.757025, "process_mem_max_rss": "143808", "process_in_blocks": "104880", "process_out_blocks": "2213"}
[0m14:25:09.876449 [debug] [MainThread]: Command `dbt debug` succeeded at 14:25:09.876251 after 3.20 seconds
[0m14:25:09.877198 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:25:09.881978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c09990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e790110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8bbc90>]}
[0m14:25:09.882830 [debug] [MainThread]: Flushing usage events
[0m14:25:27.960802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa12f7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2515f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa28b55d0>]}


============================== 14:25:27.962744 | d590ecbe-2bdf-4762-a1ba-6382e4fa4b3f ==============================
[0m14:25:27.962744 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:25:27.963268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:25:28.213758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa035d2d0>]}
[0m14:25:28.259052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa035d2d0>]}
[0m14:25:28.259630 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:25:28.268182 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:25:28.288618 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:25:28.289255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0381c50>]}
[0m14:25:28.986778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fdbd850>]}
[0m14:25:28.994887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00496d0>]}
[0m14:25:28.995194 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m14:25:28.995574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa033c4d0>]}
[0m14:25:28.996931 [info ] [MainThread]: 
[0m14:25:28.997632 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:25:28.998769 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:25:28.999073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:29.667277 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:25:29.672148 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver'
[0m14:25:29.672654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:31.152959 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m14:25:31.159118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0286310>]}
[0m14:25:31.160802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:31.161823 [info ] [MainThread]: 
[0m14:25:31.164563 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m14:25:31.165360 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m14:25:31.166663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m14:25:31.167294 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m14:25:31.176703 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m14:25:31.179970 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 14:25:31.167778 => 14:25:31.179727
[0m14:25:31.180468 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m14:25:31.205317 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m14:25:31.207397 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m14:25:31.207751 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m14:25:31.208107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:31.790355 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b3681241-ae54-49f0-a8b1-c9f5e36ab79f
[0m14:25:33.490878 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:25:34.709039 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['9', '8', '7', '6', '5']
[0m14:25:34.711736 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['5']
[0m14:25:35.284753 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 5 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m14:25:35.298307 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 14:25:31.180746 => 14:25:35.297955
[0m14:25:35.299043 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m14:25:35.300422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d96990>]}
[0m14:25:35.301401 [info ] [Thread-1 (]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.13s]
[0m14:25:35.302535 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m14:25:35.303292 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m14:25:35.304707 [info ] [Thread-1 (]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m14:25:35.307666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m14:25:35.308291 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m14:25:35.313754 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m14:25:35.315365 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 14:25:35.308641 => 14:25:35.315162
[0m14:25:35.315767 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m14:25:35.320965 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m14:25:35.322451 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m14:25:35.322824 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m14:25:35.323173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:36.389314 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b00347ce-274f-469a-a6ee-ab368608c56e
[0m14:25:38.043258 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m14:25:39.326988 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['9', '8', '7', '6', '5']
[0m14:25:39.330708 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['5']
[0m14:25:39.895428 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 5 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m14:25:39.901362 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 14:25:35.315981 => 14:25:39.899979
[0m14:25:39.902025 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m14:25:39.903604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95380a90>]}
[0m14:25:39.904578 [info ] [Thread-1 (]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.60s]
[0m14:25:39.905348 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m14:25:39.905929 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m14:25:39.907083 [info ] [Thread-1 (]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m14:25:39.908678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m14:25:39.909060 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m14:25:39.914710 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m14:25:39.916237 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 14:25:39.909254 => 14:25:39.916091
[0m14:25:39.916601 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m14:25:39.920325 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m14:25:39.921903 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m14:25:39.922656 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m14:25:39.923608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:40.506505 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e3b89cff-21b9-47e2-93b6-ba857bfbb398
[0m14:25:42.169176 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:25:43.587868 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['9', '8', '7', '6', '5']
[0m14:25:43.590171 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['5']
[0m14:25:44.200634 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 5 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m14:25:44.208780 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 14:25:39.916846 => 14:25:44.208428
[0m14:25:44.209644 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m14:25:44.211130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f65910>]}
[0m14:25:44.212143 [info ] [Thread-1 (]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.30s]
[0m14:25:44.213358 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m14:25:44.213990 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m14:25:44.214764 [info ] [Thread-1 (]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m14:25:44.216672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m14:25:44.217127 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m14:25:44.220510 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m14:25:44.223167 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 14:25:44.217418 => 14:25:44.222979
[0m14:25:44.223572 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m14:25:44.226804 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m14:25:44.229931 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m14:25:44.230615 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m14:25:44.231184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:44.819772 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0d8b2c8e-ed01-4958-bb41-1d3c1927663e
[0m14:25:46.490717 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:25:47.777552 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['9', '8', '7', '6', '5', '4']
[0m14:25:47.779646 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['5', '4']
[0m14:25:48.346299 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 5 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m14:25:48.568713 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 4 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m14:25:48.579418 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 14:25:44.223859 => 14:25:48.578549
[0m14:25:48.580770 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m14:25:48.584080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d456d10>]}
[0m14:25:48.586430 [info ] [Thread-1 (]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.37s]
[0m14:25:48.588187 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m14:25:48.589476 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m14:25:48.593173 [info ] [Thread-1 (]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m14:25:48.596806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m14:25:48.597624 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m14:25:48.607853 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m14:25:48.609993 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 14:25:48.598013 => 14:25:48.609650
[0m14:25:48.610651 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m14:25:48.619157 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m14:25:48.620732 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m14:25:48.621366 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  sensor_id,
  temp_c,
  humidity_pct,
  location,
  dt_timestamp,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m14:25:48.622069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:49.412538 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 36dd6390-c358-429c-9c5a-e731b933ba69
[0m14:25:51.142460 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m14:25:52.378849 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['8', '7', '6', '5', '4']
[0m14:25:52.380053 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['4']
[0m14:25:52.960119 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 4 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m14:25:52.964570 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 14:25:48.611063 => 14:25:52.964217
[0m14:25:52.965454 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m14:25:52.967210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1c2550>]}
[0m14:25:52.968369 [info ] [Thread-1 (]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.37s]
[0m14:25:52.969850 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m14:25:52.971160 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m14:25:52.972289 [info ] [Thread-1 (]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m14:25:52.975003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m14:25:52.975711 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m14:25:52.980230 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m14:25:52.982539 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 14:25:52.976161 => 14:25:52.982323
[0m14:25:52.983049 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m14:25:53.015947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:54.281789 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m14:25:54.283099 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:25:54.288019 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:25:55.449773 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m14:25:55.451157 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:25:55.452069 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/e1883c19-98e4-4c4d-9eb2-c8f1b102bdca
[0m14:25:56.297166 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:25:57.717172 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m14:25:57.769136 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:25:58.283167 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:25:58.285057 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/52d13ec9-8afd-4e5b-957d-d56d29f7a3a6',
      format='parquet'
    )
    as
      
with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m14:25:58.891846 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 13544804-f265-4cdd-8321-d190c79eef1a
[0m14:26:01.684757 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1613}
[0m14:26:01.692321 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m14:26:01.693307 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m14:26:01.977620 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 020af922-2a52-401b-8f0d-b299a4b92a06
[0m14:26:03.611256 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:26:03.619958 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m14:26:03.625161 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m14:26:03.625915 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1613}';
[0m14:26:03.813449 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 60ff4e4b-d74b-43c4-be5c-258abb3a846f
[0m14:26:05.467095 [debug] [Thread-1 (]: SQL status: OK 2 in 2.0 seconds
[0m14:26:05.472150 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 14:25:52.983400 => 14:26:05.471591
[0m14:26:05.473087 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m14:26:05.475982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f92550>]}
[0m14:26:05.477465 [info ] [Thread-1 (]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2[0m in 12.50s]
[0m14:26:05.478589 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m14:26:05.479455 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m14:26:05.480759 [info ] [Thread-1 (]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m14:26:05.483296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m14:26:05.483905 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m14:26:05.490069 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m14:26:05.492011 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 14:26:05.484271 => 14:26:05.491820
[0m14:26:05.492424 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m14:26:05.495800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:06.819475 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m14:26:06.820864 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:26:06.822250 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:26:08.004667 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m14:26:08.006038 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:26:08.007355 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/ae906c7e-5365-42a4-9132-942ca8568351
[0m14:26:08.549468 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:26:10.105970 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m14:26:10.113894 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:26:10.637536 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:26:10.638986 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/70c4eabc-6e23-497b-8d6e-9219c970acd6',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m14:26:11.179311 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b55a11e2-0770-4ecf-8ed6-7b473d151c2d
[0m14:26:14.144280 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":675}
[0m14:26:14.146757 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m14:26:14.147590 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m14:26:14.400848 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1effaece-8483-4b17-8756-ad1e74810b38
[0m14:26:16.115991 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:26:16.119082 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m14:26:16.121911 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m14:26:16.122207 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":675}';
[0m14:26:16.327540 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9cbd823e-77e3-42e9-9ba9-f271f9a210fb
[0m14:26:18.011902 [debug] [Thread-1 (]: SQL status: OK 31 in 2.0 seconds
[0m14:26:18.019253 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 14:26:05.492709 => 14:26:18.018711
[0m14:26:18.020202 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m14:26:18.022330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94364310>]}
[0m14:26:18.027236 [info ] [Thread-1 (]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 12.54s]
[0m14:26:18.028869 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m14:26:18.031155 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m14:26:18.032350 [info ] [Thread-1 (]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m14:26:18.035849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m14:26:18.036326 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m14:26:18.044482 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m14:26:18.045738 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 14:26:18.036565 => 14:26:18.045601
[0m14:26:18.046062 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m14:26:18.049005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:19.330339 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m14:26:19.331993 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:26:19.333382 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:26:20.544694 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m14:26:20.546366 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:26:20.547268 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/acab842b-d7dc-49e8-8ddc-49dd4e1e1496
[0m14:26:21.125390 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:26:22.486330 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m14:26:22.490587 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:26:23.029550 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:26:23.030559 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/2adf1f6b-5461-44bb-a0cb-761d88ef3ba1',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m14:26:23.559639 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7a4f941f-9570-4947-b6e7-40697a8b0d5e
[0m14:26:25.171571 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m14:26:25.175053 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:26:25.176322 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m14:26:25.434275 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 66952712-c6ef-40b9-a35b-63f90b83939f
[0m14:26:27.082252 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:26:27.115911 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m14:26:27.126706 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:26:27.128453 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m14:26:27.347169 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d9bd1322-178a-4987-9219-993454db4134
[0m14:26:29.016346 [debug] [Thread-1 (]: SQL status: OK 4447 in 2.0 seconds
[0m14:26:29.020271 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 14:26:18.046299 => 14:26:29.019897
[0m14:26:29.020996 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m14:26:29.022352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff960c4790>]}
[0m14:26:29.023461 [info ] [Thread-1 (]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 10.99s]
[0m14:26:29.024405 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m14:26:29.025068 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m14:26:29.025968 [info ] [Thread-1 (]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m14:26:29.029173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m14:26:29.029624 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m14:26:29.038971 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m14:26:29.042096 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 14:26:29.029840 => 14:26:29.041833
[0m14:26:29.042868 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m14:26:29.048612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:30.572253 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m14:26:30.574597 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:26:30.575968 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:26:31.763370 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m14:26:31.764319 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:26:31.765104 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/1a844de7-6338-4d2a-9c30-51e734727ad2
[0m14:26:32.297684 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:26:33.761825 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m14:26:33.770564 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:26:34.302722 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:26:34.306156 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/ea229727-1c99-4ba3-97c1-a6fd24d192fb',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m14:26:34.860287 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 847bce15-03ca-4acb-a120-3b872e9bdcbe
[0m14:26:37.646047 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m14:26:37.650797 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m14:26:37.651398 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m14:26:37.926351 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e3d97ee9-cc74-4bdb-8785-9ee0ef0ce976
[0m14:26:39.560152 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:26:39.568806 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m14:26:39.573453 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m14:26:39.574286 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m14:26:39.777152 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5531b595-9550-4ab1-94e4-d5a5d1caa58b
[0m14:26:41.431328 [debug] [Thread-1 (]: SQL status: OK 63 in 2.0 seconds
[0m14:26:41.435337 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 14:26:29.043443 => 14:26:41.434980
[0m14:26:41.435992 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m14:26:41.437365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0197ad0>]}
[0m14:26:41.438307 [info ] [Thread-1 (]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 12.41s]
[0m14:26:41.438972 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m14:26:41.439596 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m14:26:41.440337 [info ] [Thread-1 (]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m14:26:41.442315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m14:26:41.442733 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m14:26:41.448197 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m14:26:41.449488 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 14:26:41.442916 => 14:26:41.449352
[0m14:26:41.449784 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m14:26:41.452271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:42.911614 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m14:26:42.913234 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:26:42.914886 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:26:44.105734 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m14:26:44.108771 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:26:44.109892 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/34f04223-850d-4c27-b4c7-93687edb29ca
[0m14:26:45.276886 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:26:46.764726 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m14:26:46.769451 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:26:47.274332 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:26:47.276566 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/94bdff5b-e68a-417e-b1ad-50e06e40cc53',
      format='parquet'
    )
    as
      
select
    location,
  dt_timestamp,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m14:26:47.802363 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID da2f1896-189a-4d18-9875-d7791091deb2
[0m14:26:50.598327 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":300,"data_scanned_in_bytes":8044}
[0m14:26:50.604295 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m14:26:50.605469 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m14:26:50.865772 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 492a0174-c264-4114-a165-062470f68c7e
[0m14:26:52.492449 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:26:52.497039 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m14:26:52.499685 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m14:26:52.500376 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":300,"data_scanned_in_bytes":8044}';
[0m14:26:52.681850 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 52cd4079-f3c9-4ca9-8912-3e3b7b42ad2e
[0m14:26:54.326989 [debug] [Thread-1 (]: SQL status: OK 300 in 2.0 seconds
[0m14:26:54.334664 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 14:26:41.449949 => 14:26:54.333862
[0m14:26:54.335885 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m14:26:54.338932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd590ecbe-2bdf-4762-a1ba-6382e4fa4b3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96155690>]}
[0m14:26:54.340908 [info ] [Thread-1 (]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 300[0m in 12.90s]
[0m14:26:54.342435 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m14:26:54.351435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:54.352058 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m14:26:54.352484 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m14:26:54.356801 [info ] [MainThread]: 
[0m14:26:54.361385 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 25.36 seconds (85.36s).
[0m14:26:54.369044 [debug] [MainThread]: Command end result
[0m14:26:54.412345 [info ] [MainThread]: 
[0m14:26:54.413425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:54.413960 [info ] [MainThread]: 
[0m14:26:54.414399 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:26:54.416652 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 86.47762, "process_user_time": 8.002257, "process_kernel_time": 0.745671, "process_mem_max_rss": "208912", "process_in_blocks": "2896", "process_out_blocks": "2981"}
[0m14:26:54.417256 [debug] [MainThread]: Command `dbt run` succeeded at 14:26:54.417134 after 86.48 seconds
[0m14:26:54.417764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952d0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0100fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66f9510>]}
[0m14:26:54.418125 [debug] [MainThread]: Flushing usage events
[0m14:38:12.809755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82de5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83500a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81379700>]}


============================== 14:38:12.836156 | b92d7a8f-9f01-4a50-8f0d-f570911378de ==============================
[0m14:38:12.836156 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:38:12.836653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:38:13.612804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e7da550>]}
[0m14:38:13.643863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81380c10>]}
[0m14:38:13.645083 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m14:38:13.663482 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:38:13.738241 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:38:13.738739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f52b50>]}
[0m14:38:14.650709 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:38:14.651305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ef6ca90>]}
[0m14:38:14.824273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eae2d90>]}
[0m14:38:14.906016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea9a880>]}
[0m14:38:14.906410 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m14:38:14.906695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eab11c0>]}
[0m14:38:14.907999 [info ] [MainThread]: 
[0m14:38:14.908422 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:38:14.912657 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:38:14.912965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:15.742416 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:38:15.747487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m14:38:15.748129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:17.457544 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m14:38:17.464325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea0ae20>]}
[0m14:38:17.465736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:17.466258 [info ] [MainThread]: 
[0m14:38:17.476334 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m14:38:17.477227 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m14:38:17.477868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m14:38:17.478161 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m14:38:17.494325 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m14:38:17.495922 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m14:38:17.516204 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m14:38:17.517517 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m14:38:17.517765 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m14:38:17.518051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:38:18.163229 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b241ada9-4e6a-485e-9b94-236beb3d39bf
[0m14:38:20.022675 [debug] [Thread-1  ]: SQL status: OK -1 in 2.501 seconds
[0m14:38:21.079886 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['10', '9', '8', '7', '6']
[0m14:38:21.083107 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['6']
[0m14:38:21.637361 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 6 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m14:38:21.661430 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m14:38:21.664661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ebe77f0>]}
[0m14:38:21.666147 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.19s]
[0m14:38:21.667210 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m14:38:21.668020 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m14:38:21.669202 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m14:38:21.672024 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m14:38:21.672513 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m14:38:21.677349 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m14:38:21.678684 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m14:38:21.681570 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m14:38:21.682469 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m14:38:21.682722 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m14:38:21.682977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:38:22.238218 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 08f56b50-0560-45d3-9a55-02e1e6f0a323
[0m14:38:24.051118 [debug] [Thread-1  ]: SQL status: OK -1 in 2.366 seconds
[0m14:38:25.132886 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['10', '9', '8', '7', '6']
[0m14:38:25.136703 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['6']
[0m14:38:25.622325 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 6 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m14:38:25.626733 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m14:38:25.628275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f193640>]}
[0m14:38:25.629700 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 3.96s]
[0m14:38:25.631571 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m14:38:25.632939 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m14:38:25.634140 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m14:38:25.636652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m14:38:25.637223 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m14:38:25.644552 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m14:38:25.645939 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m14:38:25.649332 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m14:38:25.650220 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m14:38:25.650561 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m14:38:25.650911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:38:26.198056 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 392d20ab-6d7d-4d3c-a82e-1ed67004ab6d
[0m14:38:27.934177 [debug] [Thread-1  ]: SQL status: OK -1 in 2.283 seconds
[0m14:38:29.064958 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['10', '9', '8', '7', '6']
[0m14:38:29.067996 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['6']
[0m14:38:29.597132 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 6 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m14:38:29.600663 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m14:38:29.601676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0c57f0>]}
[0m14:38:29.602510 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 3.97s]
[0m14:38:29.603613 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m14:38:29.604393 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m14:38:29.605050 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m14:38:29.606782 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m14:38:29.607199 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m14:38:29.611381 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m14:38:29.612544 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m14:38:29.614894 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m14:38:29.615861 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m14:38:29.616156 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m14:38:29.616382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:38:30.301640 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7ec19556-76b2-4e4e-8ba4-c841ac7b4f19
[0m14:38:32.097544 [debug] [Thread-1  ]: SQL status: OK -1 in 2.479 seconds
[0m14:38:33.212614 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['10', '9', '8', '7', '6']
[0m14:38:33.214727 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['6']
[0m14:38:33.740525 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 6 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m14:38:33.750668 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m14:38:33.752466 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e91ea90>]}
[0m14:38:33.754057 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.15s]
[0m14:38:33.756479 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m14:38:33.757933 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m14:38:33.758964 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m14:38:33.762099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m14:38:33.762739 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m14:38:33.770416 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m14:38:33.772506 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m14:38:33.777005 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m14:38:33.778331 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m14:38:33.778735 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  sensor_id,
  temp_c,
  humidity_pct,
  location,
  dt_timestamp,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m14:38:33.779113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:38:34.293129 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1037a6e0-e3aa-480c-bdee-12a22d7d76a9
[0m14:38:35.991066 [debug] [Thread-1  ]: SQL status: OK -1 in 2.194 seconds
[0m14:38:37.269505 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['9', '8', '7', '6', '5']
[0m14:38:37.272976 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['5']
[0m14:38:37.766022 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 5 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m14:38:37.775687 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m14:38:37.779180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f20a400>]}
[0m14:38:37.782231 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.02s]
[0m14:38:37.784707 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m14:38:37.786527 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m14:38:37.789194 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m14:38:37.793420 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m14:38:37.794223 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m14:38:37.808561 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m14:38:37.810870 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m14:38:37.842087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:38:39.142607 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m14:38:39.144084 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:38:39.148245 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m14:38:40.147759 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m14:38:40.149349 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:38:40.150197 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/52d13ec9-8afd-4e5b-957d-d56d29f7a3a6
[0m14:38:40.780062 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/52d13ec9-8afd-4e5b-957d-d56d29f7a3a6', bucket='climate-energy-raw-data', prefix='silver/eia_silver/52d13ec9-8afd-4e5b-957d-d56d29f7a3a6/'
[0m14:38:42.658166 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m14:38:42.706489 [debug] [Thread-1  ]: Skip partitioning: False
[0m14:38:43.138740 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:38:43.144831 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/58cab119-eb15-4bab-aad0-54343d0de08e',
      format='parquet'
    )
    as
      
with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m14:38:43.738359 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0f7b2f7d-4838-4e25-b94e-6e201f6928e2
[0m14:38:46.661102 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1613}
[0m14:38:46.666391 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m14:38:46.666709 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m14:38:46.862112 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4ed377c1-604d-4443-b976-27af39ad5d72
[0m14:38:48.594664 [debug] [Thread-1  ]: SQL status: OK -1 in 1.927 seconds
[0m14:38:48.599200 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m14:38:48.601091 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m14:38:48.601470 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1613}';
[0m14:38:48.796934 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID acfbaa19-3a6b-4964-baff-3fc787d021ff
[0m14:38:50.710705 [debug] [Thread-1  ]: SQL status: OK 2 in 2.108 seconds
[0m14:38:50.717189 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m14:38:50.718772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0f3b50>]}
[0m14:38:50.720344 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2[0m in 12.93s]
[0m14:38:50.721698 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m14:38:50.723418 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m14:38:50.724941 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m14:38:50.730745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m14:38:50.731350 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m14:38:50.740726 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m14:38:50.741812 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m14:38:50.745275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:38:52.601737 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m14:38:52.602807 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:38:52.604124 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m14:38:54.547558 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m14:38:54.548172 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:38:54.548406 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/70c4eabc-6e23-497b-8d6e-9219c970acd6
[0m14:38:55.558637 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/70c4eabc-6e23-497b-8d6e-9219c970acd6', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/70c4eabc-6e23-497b-8d6e-9219c970acd6/'
[0m14:38:58.129917 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m14:38:58.139786 [debug] [Thread-1  ]: Skip partitioning: False
[0m14:38:58.626234 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:38:58.628959 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/e36c2f63-b3f8-421d-8564-8150b50a0980',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m14:38:59.149190 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 915a64cb-121a-4d4d-99c8-a50828a85d28
[0m14:39:00.930363 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":675}
[0m14:39:00.935528 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m14:39:00.936154 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m14:39:01.143108 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 50cc6df9-df5e-4b54-a517-90ceb6d9ca9d
[0m14:39:02.934061 [debug] [Thread-1  ]: SQL status: OK -1 in 1.997 seconds
[0m14:39:02.944564 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m14:39:02.948488 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m14:39:02.949097 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":675}';
[0m14:39:03.149265 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ea08975a-6548-4bee-a1ab-d90c1e7f1a97
[0m14:39:04.887326 [debug] [Thread-1  ]: SQL status: OK 31 in 1.938 seconds
[0m14:39:04.895141 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m14:39:04.898626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0f3880>]}
[0m14:39:04.901978 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 14.17s]
[0m14:39:04.904879 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m14:39:04.906761 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m14:39:04.908783 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m14:39:04.911957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m14:39:04.912980 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m14:39:04.923062 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m14:39:04.925196 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m14:39:04.928664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:06.288039 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m14:39:06.297690 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:39:06.319076 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m14:39:07.505274 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m14:39:07.506806 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:39:07.507999 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/2adf1f6b-5461-44bb-a0cb-761d88ef3ba1
[0m14:39:08.032178 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/2adf1f6b-5461-44bb-a0cb-761d88ef3ba1', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/2adf1f6b-5461-44bb-a0cb-761d88ef3ba1/'
[0m14:39:09.937063 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m14:39:09.949285 [debug] [Thread-1  ]: Skip partitioning: False
[0m14:39:10.414172 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:39:10.416570 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/fcadbb12-ed62-4cc1-9850-c716118880af',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m14:39:10.875369 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2326a0c6-8f69-4c03-b112-47bc38ad04e8
[0m14:39:12.726162 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m14:39:12.726955 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m14:39:12.727314 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m14:39:12.924546 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cc9fa69d-1d8e-4ac5-aeca-6c8ee11d7816
[0m14:39:14.607226 [debug] [Thread-1  ]: SQL status: OK -1 in 1.879 seconds
[0m14:39:14.611136 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m14:39:14.614213 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m14:39:14.615041 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m14:39:14.818220 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f10db0f9-d65c-42b3-876e-667d554fefb1
[0m14:39:16.620036 [debug] [Thread-1  ]: SQL status: OK 4447 in 2.006 seconds
[0m14:39:16.629717 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m14:39:16.631374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845349d0>]}
[0m14:39:16.633378 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 11.72s]
[0m14:39:16.634670 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m14:39:16.635603 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m14:39:16.636721 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m14:39:16.639729 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m14:39:16.640160 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m14:39:16.646882 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m14:39:16.648379 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m14:39:16.651274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:17.986990 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m14:39:17.988172 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:39:17.989273 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m14:39:19.021614 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m14:39:19.022601 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:39:19.022931 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/ea229727-1c99-4ba3-97c1-a6fd24d192fb
[0m14:39:19.587348 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/ea229727-1c99-4ba3-97c1-a6fd24d192fb', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/ea229727-1c99-4ba3-97c1-a6fd24d192fb/'
[0m14:39:21.488023 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m14:39:21.498862 [debug] [Thread-1  ]: Skip partitioning: False
[0m14:39:21.946569 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:39:21.950358 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/a950f392-1a79-4165-af03-c27196d06d5a',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m14:39:22.446892 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 99037f69-23fc-4e63-80ff-4b9b4f6faa66
[0m14:39:24.105395 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m14:39:24.109139 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m14:39:24.109941 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m14:39:24.308541 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6d7d1d99-115b-40c4-bb24-f8dbfac947c4
[0m14:39:26.039262 [debug] [Thread-1  ]: SQL status: OK -1 in 1.896 seconds
[0m14:39:26.083700 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m14:39:26.106563 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m14:39:26.112333 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m14:39:26.318158 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 935e258b-5b14-4209-b6fd-d4aeb811f7fd
[0m14:39:28.007563 [debug] [Thread-1  ]: SQL status: OK 63 in 1.892 seconds
[0m14:39:28.014220 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m14:39:28.015717 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f21e5e0>]}
[0m14:39:28.017119 [info ] [Thread-1  ]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 11.38s]
[0m14:39:28.018291 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m14:39:28.019241 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m14:39:28.020205 [info ] [Thread-1  ]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m14:39:28.023168 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m14:39:28.023629 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m14:39:28.030889 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m14:39:28.032333 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m14:39:28.034979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:29.257464 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m14:39:29.259782 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:39:29.260903 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m14:39:30.262022 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m14:39:30.263317 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:39:30.264145 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/94bdff5b-e68a-417e-b1ad-50e06e40cc53
[0m14:39:30.752137 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/94bdff5b-e68a-417e-b1ad-50e06e40cc53', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/94bdff5b-e68a-417e-b1ad-50e06e40cc53/'
[0m14:39:32.598751 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m14:39:32.608351 [debug] [Thread-1  ]: Skip partitioning: False
[0m14:39:33.019103 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:39:33.020633 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/2048ae43-062f-41fa-a64f-fbdb060027fa',
      format='parquet'
    )
    as
      
select
    location,
  dt_timestamp,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m14:39:33.505547 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 691c980f-ff3e-4eda-b96c-6d215dfd555c
[0m14:39:35.208713 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":300,"data_scanned_in_bytes":8044}
[0m14:39:35.214660 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m14:39:35.215625 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m14:39:35.410421 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cbd80c44-34cc-4ff2-a41b-c6d48ad0c8b2
[0m14:39:37.080293 [debug] [Thread-1  ]: SQL status: OK -1 in 1.862 seconds
[0m14:39:37.090111 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m14:39:37.098086 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m14:39:37.100686 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":300,"data_scanned_in_bytes":8044}';
[0m14:39:37.305535 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d4a8bd1c-8288-4561-a6bb-aad963d59516
[0m14:39:38.987170 [debug] [Thread-1  ]: SQL status: OK 300 in 1.885 seconds
[0m14:39:38.992242 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m14:39:38.993766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b92d7a8f-9f01-4a50-8f0d-f570911378de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845349d0>]}
[0m14:39:38.995090 [info ] [Thread-1  ]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 300[0m in 10.97s]
[0m14:39:38.996228 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m14:39:39.000177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:39.000600 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m14:39:39.002955 [info ] [MainThread]: 
[0m14:39:39.003684 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 24.09 seconds (84.09s).
[0m14:39:39.007179 [debug] [MainThread]: Command end result
[0m14:39:39.054212 [info ] [MainThread]: 
[0m14:39:39.054713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:39.055026 [info ] [MainThread]: 
[0m14:39:39.055534 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:39:39.058435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 86.280205, "process_user_time": 10.226482, "process_kernel_time": 1.545792, "process_mem_max_rss": "184680", "process_in_blocks": "109232", "process_out_blocks": "9547"}
[0m14:39:39.059119 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:39.059050 after 86.28 seconds
[0m14:39:39.059504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82de5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a313a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea1d250>]}
[0m14:39:39.059824 [debug] [MainThread]: Flushing usage events
[0m15:04:15.942512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990dd160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997c2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c13a60>]}


============================== 15:04:15.947362 | 6149d733-c84f-4ffe-afe0-ee66be65984a ==============================
[0m15:04:15.947362 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:04:15.947851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:04:16.334178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975561f0>]}
[0m15:04:16.363732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9754f760>]}
[0m15:04:16.364227 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:04:16.380297 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:04:16.474852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:16.475155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:16.508243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952113a0>]}
[0m15:04:16.863971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951bef40>]}
[0m15:04:16.867167 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m15:04:16.867796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9515e4f0>]}
[0m15:04:16.871112 [info ] [MainThread]: 
[0m15:04:16.872926 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:04:16.885175 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:04:16.886447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:17.577407 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:04:17.587372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m15:04:17.589434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:18.892343 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:04:18.895030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f710d0>]}
[0m15:04:18.895658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:04:18.896045 [info ] [MainThread]: 
[0m15:04:18.904143 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m15:04:18.904720 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m15:04:18.905163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m15:04:18.905431 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m15:04:18.915311 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:04:18.916854 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m15:04:18.959502 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:04:18.961208 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m15:04:18.961555 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:04:18.961822 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:04:19.514601 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 73736e99-d34b-44dd-ba81-8e2a0d13fc1c
[0m15:04:21.225041 [debug] [Thread-1  ]: SQL status: OK -1 in 2.261 seconds
[0m15:04:22.384133 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['11', '10', '9', '8', '7']
[0m15:04:22.391800 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['7']
[0m15:04:22.833303 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 7 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m15:04:22.858098 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m15:04:22.862069 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f710d0>]}
[0m15:04:22.863668 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 3.95s]
[0m15:04:22.865394 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m15:04:22.866410 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m15:04:22.868057 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m15:04:22.871946 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:04:22.872812 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m15:04:22.888169 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:04:22.889632 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m15:04:22.892304 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:04:22.893176 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m15:04:22.893490 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:04:22.893920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:04:23.545137 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 44bbd77d-1b55-469d-9ea2-7a3b586578f8
[0m15:04:25.236920 [debug] [Thread-1  ]: SQL status: OK -1 in 2.341 seconds
[0m15:04:26.272622 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['11', '10', '9', '8', '7']
[0m15:04:26.274126 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['7']
[0m15:04:26.734691 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 7 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m15:04:26.743760 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m15:04:26.745414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f710d0>]}
[0m15:04:26.747000 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 3.88s]
[0m15:04:26.750619 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m15:04:26.752495 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m15:04:26.757163 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m15:04:26.763339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:04:26.764178 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m15:04:26.778517 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:04:26.780961 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m15:04:26.785603 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:04:26.786637 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:04:26.786993 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:04:26.787482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:04:27.378353 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b00f47d0-6462-45ff-b246-f9774d2d5fe7
[0m15:04:29.247574 [debug] [Thread-1  ]: SQL status: OK -1 in 2.459 seconds
[0m15:04:30.500756 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['11', '10', '9', '8', '7']
[0m15:04:30.507711 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['7']
[0m15:04:31.442555 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 7 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m15:04:31.456708 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m15:04:31.458775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a557c0>]}
[0m15:04:31.461617 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.70s]
[0m15:04:31.463852 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m15:04:31.464951 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m15:04:31.466400 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m15:04:31.471779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:04:31.472257 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m15:04:31.481997 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:04:31.487942 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m15:04:31.490871 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:04:31.494199 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m15:04:31.494525 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:04:31.494788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:04:32.862165 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3e23d185-3bc6-4dde-8497-a9062ce66894
[0m15:04:34.713114 [debug] [Thread-1  ]: SQL status: OK -1 in 3.217 seconds
[0m15:04:35.684265 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['11', '10', '9', '8', '7']
[0m15:04:35.685917 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['7']
[0m15:04:36.139674 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 7 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m15:04:36.149512 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m15:04:36.152127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a7ca90>]}
[0m15:04:36.154507 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.68s]
[0m15:04:36.156731 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m15:04:36.158361 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m15:04:36.161588 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m15:04:36.165899 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:04:36.166596 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m15:04:36.180550 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:04:36.182405 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m15:04:36.187689 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:04:36.188953 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m15:04:36.189411 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  sensor_id,
  temp_c,
  humidity_pct,
  location,
  dt_timestamp,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:04:36.189788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:04:36.684021 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f95620ac-5721-408c-9c1b-00f1b6352e4e
[0m15:04:38.382737 [debug] [Thread-1  ]: SQL status: OK -1 in 2.187 seconds
[0m15:04:39.360924 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['10', '9', '8', '7', '6']
[0m15:04:39.363353 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['6']
[0m15:04:39.800522 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 6 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m15:04:39.806180 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m15:04:39.807449 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954206a0>]}
[0m15:04:39.808599 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 3.64s]
[0m15:04:39.811336 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m15:04:39.812866 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m15:04:39.814807 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m15:04:39.817322 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:04:39.817761 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m15:04:39.824214 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:04:39.825725 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m15:04:39.853526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:04:40.966336 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:04:40.968697 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:04:40.973316 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:04:41.888827 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:04:41.890078 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:04:41.891184 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/58cab119-eb15-4bab-aad0-54343d0de08e
[0m15:04:42.427480 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/58cab119-eb15-4bab-aad0-54343d0de08e', bucket='climate-energy-raw-data', prefix='silver/eia_silver/58cab119-eb15-4bab-aad0-54343d0de08e/'
[0m15:04:44.287623 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:04:44.334519 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:04:44.752193 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:04:44.754757 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/f2d6048a-42a5-4c23-8be7-56489eb4a9c2',
      format='parquet'
    )
    as
      
with ranked as (
    select
        state,
        sector,
        cast(dt_timestamp as date) as observation_date,
        price,
        event_timestamp as ingestion_timestamp,
        row_number() over (
            partition by state, cast(dt_timestamp as date)
            order by event_timestamp desc
        ) as rn
    from "AwsDataCatalog"."silver"."eia_bronze"
)

select
    state,
    sector,
    observation_date,
    price,
    ingestion_timestamp
from ranked
where rn = 1
[0m15:04:45.215733 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fced2431-a950-49ea-8a5f-2764e56ec256
[0m15:04:48.008292 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2,"data_scanned_in_bytes":1613}
[0m15:04:48.017176 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:04:48.017731 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:04:48.208081 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c67961ec-ed7b-4fd1-a4d0-b9f6372590aa
[0m15:04:49.831352 [debug] [Thread-1  ]: SQL status: OK -1 in 1.813 seconds
[0m15:04:49.835581 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:04:49.837716 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:04:49.838101 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2,"data_scanned_in_bytes":1613}';
[0m15:04:50.026635 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 31af5019-737a-4474-ba9e-8ad809340b61
[0m15:04:51.735828 [debug] [Thread-1  ]: SQL status: OK 2 in 1.894 seconds
[0m15:04:51.751055 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m15:04:51.759459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a9d1f0>]}
[0m15:04:51.763898 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2[0m in 11.94s]
[0m15:04:51.766043 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m15:04:51.767873 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m15:04:51.769741 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:04:51.776498 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:04:51.777130 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m15:04:51.790483 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:04:51.791781 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m15:04:51.795817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:04:52.915917 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:04:52.917074 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:04:52.917932 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:04:53.872697 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:04:53.873728 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:04:53.874065 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/e36c2f63-b3f8-421d-8564-8150b50a0980
[0m15:04:54.313443 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/e36c2f63-b3f8-421d-8564-8150b50a0980', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/e36c2f63-b3f8-421d-8564-8150b50a0980/'
[0m15:04:56.084139 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:04:56.088770 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:04:56.536419 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:04:56.539248 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/3d7183b1-a74f-4b82-bdd1-372b56470ce3',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:04:57.103894 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID aa8b3ee9-7f64-4e54-a897-8dd1287279fe
[0m15:04:59.868707 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":675}
[0m15:04:59.872218 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:04:59.873049 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:05:00.059821 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 221c6017-f010-4a93-80f1-f28cb7a6246a
[0m15:05:01.656673 [debug] [Thread-1  ]: SQL status: OK -1 in 1.783 seconds
[0m15:05:01.662281 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:05:01.665350 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:05:01.665947 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":675}';
[0m15:05:01.876780 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3b48dffa-b311-4f8b-bbb0-a4008823d270
[0m15:05:03.590551 [debug] [Thread-1  ]: SQL status: OK 31 in 1.924 seconds
[0m15:05:03.602630 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m15:05:03.605713 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954206a0>]}
[0m15:05:03.608653 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 11.83s]
[0m15:05:03.611026 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m15:05:03.612853 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m15:05:03.614621 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m15:05:03.619166 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:05:03.619952 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m15:05:03.631599 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:05:03.633924 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m15:05:03.638497 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:05:04.704066 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:05:04.705913 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:05:04.706900 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:05:05.653053 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:05:05.653726 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:05:05.654230 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/fcadbb12-ed62-4cc1-9850-c716118880af
[0m15:05:06.246620 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/fcadbb12-ed62-4cc1-9850-c716118880af', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/fcadbb12-ed62-4cc1-9850-c716118880af/'
[0m15:05:08.047600 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:05:08.054844 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:05:08.495773 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:05:08.498782 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/0bd9f774-3c5e-4200-8fed-b5977a582601',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m15:05:08.962664 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ffde0df1-6e98-43a6-a0bf-e84a39919f4c
[0m15:05:10.610085 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m15:05:10.613965 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:05:10.615250 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:05:10.805150 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c2d20ff0-1cb5-4646-82f3-32b06706ef54
[0m15:05:12.404638 [debug] [Thread-1  ]: SQL status: OK -1 in 1.788 seconds
[0m15:05:12.410667 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:05:12.419154 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:05:12.419699 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m15:05:12.624851 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3fd8dd6c-15a3-4892-8fa4-f9626c19f3df
[0m15:05:14.353696 [debug] [Thread-1  ]: SQL status: OK 4447 in 1.933 seconds
[0m15:05:14.377894 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m15:05:14.380945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c480a0>]}
[0m15:05:14.383738 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 10.76s]
[0m15:05:14.386493 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m15:05:14.388190 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m15:05:14.393641 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m15:05:14.406619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:05:14.409494 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m15:05:14.439908 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:05:14.441643 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m15:05:14.446460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:05:15.447411 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:05:15.447969 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:05:15.448515 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:05:16.389538 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:05:16.390724 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:05:16.391528 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/a950f392-1a79-4165-af03-c27196d06d5a
[0m15:05:16.935347 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/a950f392-1a79-4165-af03-c27196d06d5a', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/a950f392-1a79-4165-af03-c27196d06d5a/'
[0m15:05:18.896671 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:05:18.901945 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:05:19.306137 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:05:19.308445 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/ddc2cc97-1b17-44b9-9a67-6bfc5e13fbef',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m15:05:19.778070 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a16cdb9b-1aee-48c9-834c-75d9d1872c84
[0m15:05:22.577592 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m15:05:22.582582 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:05:22.583247 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:05:22.784722 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 22f8a218-da5d-4440-b1aa-eb0e0b68f634
[0m15:05:24.407530 [debug] [Thread-1  ]: SQL status: OK -1 in 1.824 seconds
[0m15:05:24.410270 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:05:24.412675 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:05:24.412989 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m15:05:24.605304 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e47f548b-5b3f-482a-9e85-b6a01557bcdf
[0m15:05:26.442456 [debug] [Thread-1  ]: SQL status: OK 63 in 2.029 seconds
[0m15:05:26.447084 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m15:05:26.448743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905c1ee0>]}
[0m15:05:26.451751 [info ] [Thread-1  ]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 12.05s]
[0m15:05:26.453756 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m15:05:26.455194 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m15:05:26.456410 [info ] [Thread-1  ]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m15:05:26.460282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:05:26.461031 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m15:05:26.467020 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:05:26.468703 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m15:05:26.472972 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:05:27.582094 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:05:27.584712 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:05:27.586714 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:05:28.578700 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:05:28.579624 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:05:28.580369 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/2048ae43-062f-41fa-a64f-fbdb060027fa
[0m15:05:29.090146 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/2048ae43-062f-41fa-a64f-fbdb060027fa', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/2048ae43-062f-41fa-a64f-fbdb060027fa/'
[0m15:05:30.904808 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:05:30.911889 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:05:31.327808 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:05:31.331342 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/f3d4d0e0-aa59-4c5a-8a55-5e0c1576c456',
      format='parquet'
    )
    as
      
select
    location,
  dt_timestamp,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m15:05:31.785052 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c87bc3f0-dfca-466c-8b36-b4def1d43170
[0m15:05:34.636585 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":300,"data_scanned_in_bytes":8044}
[0m15:05:34.647446 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:05:34.648142 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:05:34.840946 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ff65a20f-7e0c-4c09-b945-36533906f7c2
[0m15:05:36.456513 [debug] [Thread-1  ]: SQL status: OK -1 in 1.807 seconds
[0m15:05:36.461693 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:05:36.464283 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:05:36.466215 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":300,"data_scanned_in_bytes":8044}';
[0m15:05:36.670984 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d8a77f1f-11c8-4d57-b898-6413b2ba8e29
[0m15:05:38.416928 [debug] [Thread-1  ]: SQL status: OK 300 in 1.948 seconds
[0m15:05:38.431413 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m15:05:38.433948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6149d733-c84f-4ffe-afe0-ee66be65984a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cf8130>]}
[0m15:05:38.436282 [info ] [Thread-1  ]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 300[0m in 11.98s]
[0m15:05:38.438774 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m15:05:38.450306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:38.451168 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m15:05:38.460459 [info ] [MainThread]: 
[0m15:05:38.461108 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 21.59 seconds (81.59s).
[0m15:05:38.464043 [debug] [MainThread]: Command end result
[0m15:05:38.510710 [info ] [MainThread]: 
[0m15:05:38.511188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:38.511607 [info ] [MainThread]: 
[0m15:05:38.511972 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m15:05:38.516849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 82.60846, "process_user_time": 9.443486, "process_kernel_time": 1.253979, "process_mem_max_rss": "173656", "process_out_blocks": "2145", "process_in_blocks": "0"}
[0m15:05:38.517630 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:38.517545 after 82.61 seconds
[0m15:05:38.518111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990dd160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952cf370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9754f760>]}
[0m15:05:38.518354 [debug] [MainThread]: Flushing usage events
[0m15:16:05.508321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2636050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b01250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2819dd0>]}


============================== 15:16:05.517518 | 8d68353a-4dc2-4e91-9daa-b7dc9350aeda ==============================
[0m15:16:05.517518 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:16:05.517967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:16:05.984846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa173db90>]}
[0m15:16:06.028795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1605c50>]}
[0m15:16:06.029347 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:16:06.038026 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:16:06.053086 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:16:06.053640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15600d0>]}
[0m15:16:07.609235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1435dd0>]}
[0m15:16:07.631239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa156e950>]}
[0m15:16:07.631871 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m15:16:07.632785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f4b590>]}
[0m15:16:07.635676 [info ] [MainThread]: 
[0m15:16:07.639412 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:16:07.642687 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:16:07.644220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:08.512760 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:16:08.518226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m15:16:08.518822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:10.189009 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:16:10.203520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17739d0>]}
[0m15:16:10.206949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:16:10.207902 [info ] [MainThread]: 
[0m15:16:10.212862 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m15:16:10.213725 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m15:16:10.218275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m15:16:10.219026 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m15:16:10.231082 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:16:10.232458 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 15:16:10.219741 => 15:16:10.232265
[0m15:16:10.232780 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m15:16:10.253243 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:16:10.254990 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m15:16:10.255261 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:16:10.255479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:10.943708 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 68f817c0-b730-4f5c-99b9-d0f6acaad313
[0m15:16:12.624763 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:16:13.917196 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['12', '11', '10', '9', '8']
[0m15:16:13.918997 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['8']
[0m15:16:14.496872 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 8 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m15:16:14.509971 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 15:16:10.232998 => 15:16:14.509596
[0m15:16:14.510735 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m15:16:14.515502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0fab50>]}
[0m15:16:14.517319 [info ] [Thread-1 (]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.30s]
[0m15:16:14.518262 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m15:16:14.518953 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m15:16:14.520079 [info ] [Thread-1 (]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m15:16:14.526373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:16:14.527005 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m15:16:14.531740 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:16:14.532731 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 15:16:14.527237 => 15:16:14.532608
[0m15:16:14.533162 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m15:16:14.537858 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:16:14.539317 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m15:16:14.539700 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:16:14.540058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:15.441826 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4672476f-4bf8-4b7c-9446-ff77680b97a9
[0m15:16:17.200008 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:16:18.479738 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['12', '11', '10', '9', '8']
[0m15:16:18.484743 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['8']
[0m15:16:19.059898 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 8 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m15:16:19.072810 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 15:16:14.533499 => 15:16:19.072089
[0m15:16:19.073923 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m15:16:19.076420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d9b850>]}
[0m15:16:19.078218 [info ] [Thread-1 (]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.55s]
[0m15:16:19.079403 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m15:16:19.080265 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m15:16:19.082147 [info ] [Thread-1 (]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m15:16:19.086384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:16:19.087271 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m15:16:19.096848 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:16:19.099141 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 15:16:19.087548 => 15:16:19.098919
[0m15:16:19.099539 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m15:16:19.112561 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:16:19.115347 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:16:19.115781 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:16:19.116968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:19.751760 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a5dd672c-6df2-4740-817f-cf77db870a32
[0m15:16:21.429763 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:16:23.008930 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['12', '11', '10', '9', '8']
[0m15:16:23.012432 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['8']
[0m15:16:23.620893 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 8 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m15:16:23.631109 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 15:16:19.099793 => 15:16:23.630578
[0m15:16:23.632181 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m15:16:23.634129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99c75890>]}
[0m15:16:23.635495 [info ] [Thread-1 (]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.55s]
[0m15:16:23.636927 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m15:16:23.638293 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m15:16:23.639644 [info ] [Thread-1 (]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m15:16:23.643346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:16:23.643992 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m15:16:23.649476 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:16:23.651689 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 15:16:23.644352 => 15:16:23.651427
[0m15:16:23.652296 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m15:16:23.656093 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:16:23.657507 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m15:16:23.657956 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:16:23.658401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:24.310162 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7968e374-9847-445b-908b-e9fc2583f605
[0m15:16:26.067378 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:16:27.364977 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['12', '11', '10', '9', '8']
[0m15:16:27.371315 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['8']
[0m15:16:27.932877 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 8 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m15:16:27.951329 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 15:16:23.652701 => 15:16:27.950581
[0m15:16:27.952848 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m15:16:27.955692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999d8e10>]}
[0m15:16:27.957815 [info ] [Thread-1 (]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.31s]
[0m15:16:27.959155 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m15:16:27.960418 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m15:16:27.962765 [info ] [Thread-1 (]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m15:16:27.969136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:16:27.969850 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m15:16:27.985138 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:16:27.987615 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 15:16:27.970199 => 15:16:27.987426
[0m15:16:27.987990 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m15:16:27.994074 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:16:27.995295 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m15:16:27.995607 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  sensor_id,
  temp_c,
  humidity_pct,
  location,
  dt_timestamp,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:16:27.996000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:28.813177 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID dd4a3b5a-ed9a-423e-a213-37fa6705e334
[0m15:16:30.484733 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:16:31.773645 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['11', '10', '9', '8', '7']
[0m15:16:31.776387 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['7']
[0m15:16:32.443006 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 7 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m15:16:32.450563 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 15:16:27.988312 => 15:16:32.449985
[0m15:16:32.451433 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m15:16:32.454264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d68353a-4dc2-4e91-9daa-b7dc9350aeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e744d50>]}
[0m15:16:32.459539 [info ] [Thread-1 (]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.49s]
[0m15:16:32.461116 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m15:16:32.462303 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:16:32.464469 [info ] [Thread-1 (]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m15:16:32.467846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:16:32.468436 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:16:32.484611 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:16:32.486206 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:16:32.468768 => 15:16:32.486024
[0m15:16:32.486530 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:16:32.517797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:33.810037 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:16:33.810760 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:16:33.814193 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:16:35.459640 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:16:35.813833 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:16:35.947029 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/f2d6048a-42a5-4c23-8be7-56489eb4a9c2
[0m15:16:37.205405 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/f2d6048a-42a5-4c23-8be7-56489eb4a9c2', bucket='climate-energy-raw-data', prefix='silver/eia_silver/f2d6048a-42a5-4c23-8be7-56489eb4a9c2/'
[0m15:16:40.002042 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:16:40.042299 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:16:41.240387 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:16:41.242119 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/4eb48917-a3d0-4f23-9f22-3349ea4ef983',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m15:16:41.808558 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 49873a3a-9d66-4a31-9ccb-7841ec5a0b77
[0m15:16:49.503814 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 77dd2827-5fec-4d18-a509-9927eb5a0d43
[0m15:17:03.157965 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f31c2b41-ad57-4226-99fe-8af861159db3
[0m15:17:28.680414 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ef4aca49-61bf-47a4-9a01-e72408c57268
[0m15:17:59.494873 [error] [MainThread]: CANCEL query model.silver.eia_silver ........................................... [[31mCANCEL[0m]
[0m15:18:01.623442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:01.624451 [debug] [MainThread]: Connection 'model.silver.eia_silver' was left open.
[0m15:18:01.624915 [debug] [MainThread]: On model.silver.eia_silver: Close
[0m15:18:01.626132 [info ] [MainThread]: 
[0m15:18:01.626780 [info ] [MainThread]: Finished running 5 view models in 0 hours 1 minutes and 53.99 seconds (113.99s).
[0m15:18:01.627918 [error] [MainThread]: Encountered an error:

[0m15:18:01.638644 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:18:01.642565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 116.16218, "process_user_time": 7.083985, "process_kernel_time": 1.950844, "process_mem_max_rss": "192932", "process_in_blocks": "15656", "process_out_blocks": "1978", "command_success": false}
[0m15:18:01.643580 [debug] [MainThread]: Command `dbt run` failed at 15:18:01.643386 after 116.16 seconds
[0m15:18:01.645039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa266b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ab9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ab9610>]}
[0m15:18:01.647948 [debug] [MainThread]: Flushing usage events
[0m15:18:09.697867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e10f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e37e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e37e750>]}


============================== 15:18:09.701353 | a4936ac8-12e0-4f1b-90b7-d526eda1b5be ==============================
[0m15:18:09.701353 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:09.701851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:09.702304 [info ] [MainThread]: dbt version: 1.7.9
[0m15:18:09.702664 [info ] [MainThread]: python version: 3.11.14
[0m15:18:09.703006 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m15:18:09.703333 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m15:18:10.001019 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m15:18:10.001761 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m15:18:10.002229 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m15:18:10.002687 [info ] [MainThread]: adapter type: athena
[0m15:18:10.003050 [info ] [MainThread]: adapter version: 1.7.2
[0m15:18:10.050467 [info ] [MainThread]: Configuration:
[0m15:18:10.051024 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:18:10.051477 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:18:10.051748 [info ] [MainThread]: Required dependencies:
[0m15:18:10.052068 [debug] [MainThread]: Executing "git --help"
[0m15:18:10.069295 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:18:10.069777 [debug] [MainThread]: STDERR: "b''"
[0m15:18:10.070003 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:18:10.070338 [info ] [MainThread]: Connection:
[0m15:18:10.070836 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m15:18:10.071199 [info ] [MainThread]:   work_group: None
[0m15:18:10.071521 [info ] [MainThread]:   region_name: us-east-1
[0m15:18:10.071778 [info ] [MainThread]:   database: AwsDataCatalog
[0m15:18:10.072974 [info ] [MainThread]:   schema: silver
[0m15:18:10.073595 [info ] [MainThread]:   poll_interval: 1.0
[0m15:18:10.074070 [info ] [MainThread]:   aws_profile_name: None
[0m15:18:10.074731 [info ] [MainThread]:   aws_access_key_id: None
[0m15:18:10.075384 [info ] [MainThread]:   aws_secret_access_key: None
[0m15:18:10.078462 [info ] [MainThread]:   aws_session_token: None
[0m15:18:10.078867 [info ] [MainThread]:   endpoint_url: None
[0m15:18:10.079411 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m15:18:10.079950 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m15:18:10.080525 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m15:18:10.081065 [info ] [MainThread]:   debug_query_state: False
[0m15:18:10.081712 [info ] [MainThread]:   seed_s3_upload_args: None
[0m15:18:10.082472 [info ] [MainThread]:   lf_tags_database: None
[0m15:18:10.082871 [info ] [MainThread]:   spark_work_group: None
[0m15:18:10.083555 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:18:10.084247 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m15:18:10.084489 [debug] [MainThread]: Using athena connection "debug"
[0m15:18:10.084704 [debug] [MainThread]: On debug: select 1 as id
[0m15:18:10.084926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:10.709735 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID ecf37f86-f7e4-4d77-a894-a6909bf8cbd6
[0m15:18:12.435822 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m15:18:12.444031 [debug] [MainThread]: On debug: Close
[0m15:18:12.445017 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:18:12.445582 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:18:12.448061 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.7730777, "process_user_time": 1.376552, "process_kernel_time": 0.281091, "process_mem_max_rss": "144020", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m15:18:12.448923 [debug] [MainThread]: Command `dbt debug` succeeded at 15:18:12.448738 after 2.77 seconds
[0m15:18:12.449538 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:18:12.454742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df6a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df68b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cebc390>]}
[0m15:18:12.455750 [debug] [MainThread]: Flushing usage events
[0m15:18:17.588943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90116fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901170d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901176d0>]}


============================== 15:18:17.592501 | 6e2a9c53-7a83-427c-af6b-fa37bf17e3f6 ==============================
[0m15:18:17.592501 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:17.593077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:18:18.116355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f01e750>]}
[0m15:18:18.164628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f13e650>]}
[0m15:18:18.165369 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:18:18.172013 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:18:18.204992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:18:18.205470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:18:18.210148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8edfda10>]}
[0m15:18:18.222126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f02a4d0>]}
[0m15:18:18.222579 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m15:18:18.223070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eef0750>]}
[0m15:18:18.225203 [info ] [MainThread]: 
[0m15:18:18.225995 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:18:18.227534 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:18:18.228120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:18.911834 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:18:18.916767 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver'
[0m15:18:18.917369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:20.578660 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:18:20.593625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c556190>]}
[0m15:18:20.597006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:20.597994 [info ] [MainThread]: 
[0m15:18:20.612696 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m15:18:20.614281 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m15:18:20.622976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m15:18:20.624423 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m15:18:20.670480 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:18:20.673585 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 15:18:20.624849 => 15:18:20.673043
[0m15:18:20.674042 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m15:18:20.698391 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:18:20.699886 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m15:18:20.700397 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:18:20.700762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:21.354195 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b4fc2e39-cfdc-47c5-af4d-cd5d062ae133
[0m15:18:23.019317 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:18:24.625445 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['13', '12', '11', '10', '9']
[0m15:18:24.638695 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['9']
[0m15:18:25.258106 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 9 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m15:18:25.280855 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 15:18:20.674254 => 15:18:25.280333
[0m15:18:25.281861 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m15:18:25.283516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85991ad0>]}
[0m15:18:25.288904 [info ] [Thread-1 (]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.67s]
[0m15:18:25.290354 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m15:18:25.291314 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m15:18:25.293112 [info ] [Thread-1 (]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m15:18:25.296510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:18:25.297010 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m15:18:25.304644 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:18:25.306645 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 15:18:25.297232 => 15:18:25.306302
[0m15:18:25.307208 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m15:18:25.316359 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:18:25.319983 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m15:18:25.321159 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:18:25.321878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:25.976954 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 72ea52a8-103a-4597-b1df-f7d29d2612da
[0m15:18:27.717068 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:18:28.977342 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['13', '12', '11', '10', '9']
[0m15:18:28.979554 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['9']
[0m15:18:29.556251 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 9 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m15:18:29.566569 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 15:18:25.307457 => 15:18:29.565564
[0m15:18:29.568093 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m15:18:29.571481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c1f57d0>]}
[0m15:18:29.574022 [info ] [Thread-1 (]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.28s]
[0m15:18:29.575583 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m15:18:29.577082 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m15:18:29.579530 [info ] [Thread-1 (]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m15:18:29.584012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:18:29.584693 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m15:18:29.596222 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:18:29.598615 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 15:18:29.585147 => 15:18:29.598388
[0m15:18:29.599092 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m15:18:29.603220 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:18:29.604421 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:18:29.604910 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:18:29.605371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:30.364246 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 70f8a692-df6b-467f-ab25-63caea0b2f3e
[0m15:18:32.111631 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:18:33.447028 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['13', '12', '11', '10', '9']
[0m15:18:33.450020 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['9']
[0m15:18:34.023482 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 9 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m15:18:34.035006 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 15:18:29.599371 => 15:18:34.033931
[0m15:18:34.036640 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m15:18:34.039941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dab8950>]}
[0m15:18:34.042664 [info ] [Thread-1 (]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.46s]
[0m15:18:34.044524 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m15:18:34.045860 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m15:18:34.048093 [info ] [Thread-1 (]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m15:18:34.052601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:18:34.053517 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m15:18:34.064866 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:18:34.068237 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 15:18:34.053969 => 15:18:34.067963
[0m15:18:34.068820 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m15:18:34.074947 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:18:34.079539 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m15:18:34.081611 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:18:34.083357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:34.668426 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3162b03d-bca1-44cd-b95d-6e946f745869
[0m15:18:36.430228 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:18:38.036593 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['13', '12', '11', '10', '9']
[0m15:18:38.038337 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['9']
[0m15:18:38.611018 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 9 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m15:18:38.616477 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 15:18:34.069137 => 15:18:38.615672
[0m15:18:38.617637 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m15:18:38.619098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86bfca50>]}
[0m15:18:38.620281 [info ] [Thread-1 (]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.57s]
[0m15:18:38.621752 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m15:18:38.622584 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m15:18:38.623779 [info ] [Thread-1 (]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m15:18:38.626406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:18:38.627050 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m15:18:38.631167 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:18:38.632837 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 15:18:38.627442 => 15:18:38.632613
[0m15:18:38.633296 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m15:18:38.636618 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:18:38.637860 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m15:18:38.638276 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  sensor_id,
  temp_c,
  humidity_pct,
  location,
  dt_timestamp,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:18:38.638673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:39.256023 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID faebc120-7b8b-4304-b295-2761a40f725e
[0m15:18:40.951255 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:18:42.164223 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['12', '11', '10', '9', '8']
[0m15:18:42.168119 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['8']
[0m15:18:42.729509 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 8 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m15:18:42.738985 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 15:18:38.633624 => 15:18:42.738009
[0m15:18:42.740226 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m15:18:42.743523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86bf86d0>]}
[0m15:18:42.746019 [info ] [Thread-1 (]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.12s]
[0m15:18:42.747652 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m15:18:42.748949 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:18:42.751062 [info ] [Thread-1 (]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m15:18:42.754664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:18:42.756012 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:18:42.766816 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:18:42.768944 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:18:42.756449 => 15:18:42.768695
[0m15:18:42.769473 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:18:42.820938 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:18:42.821638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:44.214310 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:18:44.217424 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/c19f2d14-87a5-42e9-aafb-898cee902bf3',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m15:18:44.774555 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2dde549a-df5a-4d51-9395-62d75f8d68e0
[0m15:18:52.303985 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 57bdb947-ef23-4c54-ac06-f27f69bfdd3e
[0m15:19:05.899614 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 81487f90-bf3a-4071-9934-38a4dec9b648
[0m15:19:31.523994 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5bda74b1-465e-4d1e-8b57-a6a77f59cc62
[0m15:20:21.498650 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cbbeb3f4-a678-4fa6-b90f-be80f173c2fc
[0m15:21:59.472387 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2e71973f-9266-43f5-9a4e-e129bac33fdb
[0m15:22:00.766929 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: COLUMN_NOT_FOUND: line 12:3: Column 'ingestion_timestamp' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/2e71973f-9266-43f5-9a4e-e129bac33fdb' before retrying. Athena will not delete data in your account.
[0m15:22:00.781790 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 15:18:42.769762 => 15:22:00.779110
[0m15:22:00.788250 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m15:22:00.807836 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
COLUMN_NOT_FOUND: line 12:3: Column 'ingestion_timestamp' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/2e71973f-9266-43f5-9a4e-e129bac33fdb' before retrying. Athena will not delete data in your account.
[0m15:22:00.868139 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: COLUMN_NOT_FOUND: line 12:3: Column 'ingestion_timestamp' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/2e71973f-9266-43f5-9a4e-e129bac33fdb' before retrying. Athena will not delete data in your account.

[0m15:22:00.873514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e2a9c53-7a83-427c-af6b-fa37bf17e3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858ea910>]}
[0m15:22:00.878208 [error] [Thread-1 (]: 6 of 10 ERROR creating sql table model silver.eia_silver ....................... [[31mERROR[0m in 198.12s]
[0m15:22:00.879293 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m15:22:00.881603 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m15:22:00.894810 [info ] [Thread-1 (]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:22:00.896202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:22:00.896867 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m15:22:00.925312 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:22:00.928850 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 15:22:00.897336 => 15:22:00.928566
[0m15:22:00.929194 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m15:22:00.943247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:02.322561 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:22:02.324378 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:22:02.326951 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:22:03.517403 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:22:03.518883 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:22:03.519249 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/3d7183b1-a74f-4b82-bdd1-372b56470ce3
[0m15:22:04.115717 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/3d7183b1-a74f-4b82-bdd1-372b56470ce3', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/3d7183b1-a74f-4b82-bdd1-372b56470ce3/'
[0m15:22:06.584979 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:22:06.595813 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:22:07.151564 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:22:07.160641 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/e7c62a3a-9c4c-4e95-97e0-99784d6ff93c',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
#where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:22:56.621485 [error] [MainThread]: CANCEL query list_AwsDataCatalog ............................................... [[31mCANCEL[0m]
[0m15:22:56.625943 [error] [MainThread]: CANCEL query model.silver.noaa_silver .......................................... [[31mCANCEL[0m]
[0m15:22:59.829373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:59.831278 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m15:22:59.831664 [debug] [MainThread]: Connection 'model.silver.noaa_silver' was left open.
[0m15:22:59.832298 [debug] [MainThread]: On model.silver.noaa_silver: Close
[0m15:22:59.837258 [info ] [MainThread]: 
[0m15:22:59.839409 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 4 minutes and 41.61 seconds (281.61s).
[0m15:22:59.843485 [error] [MainThread]: Encountered an error:

[0m15:22:59.858517 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:22:59.864897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 282.38455, "process_user_time": 6.737384, "process_kernel_time": 0.896145, "process_mem_max_rss": "201612", "process_in_blocks": "664", "process_out_blocks": "1060", "command_success": false}
[0m15:22:59.867927 [debug] [MainThread]: Command `dbt run` failed at 15:22:59.867329 after 282.39 seconds
[0m15:22:59.869133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85be5a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff857c6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95375790>]}
[0m15:22:59.870016 [debug] [MainThread]: Flushing usage events
[0m15:24:15.894668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa655b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa655b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa655bc10>]}


============================== 15:24:15.898229 | b34a945d-4f1d-49d7-8d62-620d6669ef6a ==============================
[0m15:24:15.898229 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:24:15.899058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:24:15.899445 [info ] [MainThread]: dbt version: 1.7.9
[0m15:24:15.899731 [info ] [MainThread]: python version: 3.11.14
[0m15:24:15.900026 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m15:24:15.900339 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m15:24:16.184820 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m15:24:16.185348 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m15:24:16.185713 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m15:24:16.186141 [info ] [MainThread]: adapter type: athena
[0m15:24:16.186418 [info ] [MainThread]: adapter version: 1.7.2
[0m15:24:16.224513 [info ] [MainThread]: Configuration:
[0m15:24:16.225051 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:24:16.225444 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:24:16.225746 [info ] [MainThread]: Required dependencies:
[0m15:24:16.226121 [debug] [MainThread]: Executing "git --help"
[0m15:24:16.230230 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:24:16.230525 [debug] [MainThread]: STDERR: "b''"
[0m15:24:16.230700 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:24:16.230967 [info ] [MainThread]: Connection:
[0m15:24:16.231320 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m15:24:16.231681 [info ] [MainThread]:   work_group: None
[0m15:24:16.232000 [info ] [MainThread]:   region_name: us-east-1
[0m15:24:16.232299 [info ] [MainThread]:   database: AwsDataCatalog
[0m15:24:16.232583 [info ] [MainThread]:   schema: silver
[0m15:24:16.232864 [info ] [MainThread]:   poll_interval: 1.0
[0m15:24:16.233113 [info ] [MainThread]:   aws_profile_name: None
[0m15:24:16.233403 [info ] [MainThread]:   aws_access_key_id: None
[0m15:24:16.233669 [info ] [MainThread]:   aws_secret_access_key: None
[0m15:24:16.233917 [info ] [MainThread]:   aws_session_token: None
[0m15:24:16.234219 [info ] [MainThread]:   endpoint_url: None
[0m15:24:16.234469 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m15:24:16.234758 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m15:24:16.235049 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m15:24:16.235270 [info ] [MainThread]:   debug_query_state: False
[0m15:24:16.235557 [info ] [MainThread]:   seed_s3_upload_args: None
[0m15:24:16.235910 [info ] [MainThread]:   lf_tags_database: None
[0m15:24:16.236291 [info ] [MainThread]:   spark_work_group: None
[0m15:24:16.236639 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:24:16.237197 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m15:24:16.237417 [debug] [MainThread]: Using athena connection "debug"
[0m15:24:16.237618 [debug] [MainThread]: On debug: select 1 as id
[0m15:24:16.237850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:24:16.884715 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 29327ac2-7595-4a29-a132-93ab38e1602f
[0m15:24:18.624929 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m15:24:18.630406 [debug] [MainThread]: On debug: Close
[0m15:24:18.631564 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:24:18.632503 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:24:18.635574 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.7481039, "process_user_time": 1.488941, "process_kernel_time": 0.344217, "process_mem_max_rss": "143792", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m15:24:18.636759 [debug] [MainThread]: Command `dbt debug` succeeded at 15:24:18.636407 after 2.75 seconds
[0m15:24:18.637582 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:24:18.645127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56405d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa57c8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5523990>]}
[0m15:24:18.646023 [debug] [MainThread]: Flushing usage events
[0m15:24:21.882005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0903cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14d1750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0aaf190>]}


============================== 15:24:21.883801 | 399bc3c2-a7fc-4f5c-b140-7e6f73361c07 ==============================
[0m15:24:21.883801 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:24:21.884221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:24:22.142373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa7c650>]}
[0m15:24:22.220921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa42150>]}
[0m15:24:22.223966 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:24:22.243726 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:24:22.295594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:24:22.296313 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/eia_silver.sql
[0m15:24:22.478961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f6d16d0>]}
[0m15:24:22.493004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f747690>]}
[0m15:24:22.493936 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m15:24:22.494282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f9839d0>]}
[0m15:24:22.496396 [info ] [MainThread]: 
[0m15:24:22.497305 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:24:22.499153 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:24:22.499987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:23.256987 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:24:23.259347 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver'
[0m15:24:23.259761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:24.730183 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:24:24.740211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f6f2fd0>]}
[0m15:24:24.742653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:24:24.743724 [info ] [MainThread]: 
[0m15:24:24.748922 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m15:24:24.750094 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m15:24:24.752398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m15:24:24.753227 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m15:24:24.769226 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:24:24.772520 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 15:24:24.753828 => 15:24:24.771969
[0m15:24:24.773181 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m15:24:24.797562 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:24:24.799032 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m15:24:24.799326 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:24:24.799581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:25.404042 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 682d987f-b13d-4a78-9c24-82db2ba727ac
[0m15:24:27.361116 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:24:28.655344 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['14', '13', '12', '11', '10']
[0m15:24:28.657070 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['10']
[0m15:24:29.217247 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 10 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m15:24:29.246698 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 15:24:24.773488 => 15:24:29.245981
[0m15:24:29.247994 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m15:24:29.251010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f95d90>]}
[0m15:24:29.253366 [info ] [Thread-1 (]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.50s]
[0m15:24:29.255464 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m15:24:29.256720 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m15:24:29.258626 [info ] [Thread-1 (]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m15:24:29.263253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:24:29.264301 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m15:24:29.275484 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:24:29.279071 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 15:24:29.265182 => 15:24:29.278701
[0m15:24:29.279648 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m15:24:29.283389 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:24:29.285115 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m15:24:29.285522 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:24:29.285958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:29.916121 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 060a42f4-376f-4caf-a9e0-35414ca34ca6
[0m15:24:31.540710 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:24:32.773387 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['14', '13', '12', '11', '10']
[0m15:24:32.775724 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['10']
[0m15:24:33.334603 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 10 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m15:24:33.337922 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 15:24:29.279961 => 15:24:33.337672
[0m15:24:33.338395 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m15:24:33.339436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97047c10>]}
[0m15:24:33.340188 [info ] [Thread-1 (]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.08s]
[0m15:24:33.340924 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m15:24:33.341471 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m15:24:33.342233 [info ] [Thread-1 (]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m15:24:33.344106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:24:33.344465 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m15:24:33.347939 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:24:33.349118 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 15:24:33.344673 => 15:24:33.348984
[0m15:24:33.349404 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m15:24:33.351606 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:24:33.352553 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:24:33.352865 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:24:33.353167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:34.232046 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 245211b8-53b4-4a6f-b479-ffe35ec8f077
[0m15:24:35.951580 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:24:37.266939 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['14', '13', '12', '11', '10']
[0m15:24:37.277163 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['10']
[0m15:24:37.873427 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 10 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m15:24:37.880222 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 15:24:33.349603 => 15:24:37.879841
[0m15:24:37.881121 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m15:24:37.883280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973668d0>]}
[0m15:24:37.886241 [info ] [Thread-1 (]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.54s]
[0m15:24:37.887799 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m15:24:37.888570 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m15:24:37.889961 [info ] [Thread-1 (]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m15:24:37.892644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:24:37.893118 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m15:24:37.907679 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:24:37.910975 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 15:24:37.893340 => 15:24:37.910639
[0m15:24:37.911860 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m15:24:37.919766 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:24:37.923266 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m15:24:37.925575 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:24:37.928561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:38.542082 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 26cf8f00-4467-4720-9221-522be7003ac4
[0m15:24:40.401132 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:24:41.686384 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['14', '13', '12', '11', '10']
[0m15:24:41.689025 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['10']
[0m15:24:42.246459 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 10 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m15:24:42.251807 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 15:24:37.912608 => 15:24:42.251362
[0m15:24:42.252887 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m15:24:42.254620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0c2310>]}
[0m15:24:42.256015 [info ] [Thread-1 (]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.36s]
[0m15:24:42.257241 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m15:24:42.258046 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m15:24:42.259202 [info ] [Thread-1 (]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m15:24:42.261836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:24:42.262373 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m15:24:42.267698 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:24:42.269780 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 15:24:42.262736 => 15:24:42.269583
[0m15:24:42.270180 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m15:24:42.273224 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:24:42.274249 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m15:24:42.274636 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  sensor_id,
  temp_c,
  humidity_pct,
  location,
  dt_timestamp,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:24:42.275056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:42.873828 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 767a3b87-24bf-4295-b231-2c489332abe1
[0m15:24:44.527132 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:24:45.792229 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['13', '12', '11', '10', '9']
[0m15:24:45.794856 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['9']
[0m15:24:46.377294 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 9 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m15:24:46.385114 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 15:24:42.270453 => 15:24:46.384586
[0m15:24:46.386263 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m15:24:46.388242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947a1510>]}
[0m15:24:46.389717 [info ] [Thread-1 (]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.13s]
[0m15:24:46.391904 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m15:24:46.393554 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:24:46.394869 [info ] [Thread-1 (]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m15:24:46.398484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:24:46.399206 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:24:46.404776 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:24:46.406587 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:24:46.399640 => 15:24:46.406358
[0m15:24:46.407089 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:24:46.457815 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:24:46.458528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:47.359109 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:24:47.372833 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/31138742-ba48-4b64-bc1d-3255ceea2fec',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m15:24:47.932851 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 030200cb-186f-4a92-80d8-77eea211d4aa
[0m15:24:49.593770 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":221,"data_scanned_in_bytes":1613}
[0m15:24:49.610087 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:24:49.611192 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:24:49.857368 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6a13949d-8f1b-48f2-8184-08117b91c7a3
[0m15:24:51.491917 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:24:51.504088 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:24:51.507762 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:24:51.508401 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":221,"data_scanned_in_bytes":1613}';
[0m15:24:51.716327 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b25ba5a0-011a-4a91-9bcc-1c5ebb14a46c
[0m15:24:53.434130 [debug] [Thread-1 (]: SQL status: OK 221 in 2.0 seconds
[0m15:24:53.444862 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 15:24:46.407401 => 15:24:53.443459
[0m15:24:53.446377 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m15:24:53.450511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '399bc3c2-a7fc-4f5c-b140-7e6f73361c07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95870590>]}
[0m15:24:53.453030 [info ] [Thread-1 (]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 221[0m in 7.05s]
[0m15:24:53.454862 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m15:24:53.456260 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m15:24:53.457864 [info ] [Thread-1 (]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:24:53.463644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:24:53.464327 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m15:24:53.474256 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:24:53.475831 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 15:24:53.464751 => 15:24:53.475581
[0m15:24:53.476350 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m15:24:53.480569 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:24:53.481588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:24:54.260790 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:24:54.262173 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/28793735-f79b-4e7d-98ec-23eb76da8fac',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
#where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:25:42.868312 [error] [MainThread]: CANCEL query list_AwsDataCatalog ............................................... [[31mCANCEL[0m]
[0m15:25:42.871338 [error] [MainThread]: CANCEL query model.silver.noaa_silver .......................................... [[31mCANCEL[0m]
[0m15:25:43.362972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:43.364390 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m15:25:43.365438 [debug] [MainThread]: Connection 'model.silver.noaa_silver' was left open.
[0m15:25:43.366519 [debug] [MainThread]: On model.silver.noaa_silver: Close
[0m15:25:43.374494 [info ] [MainThread]: 
[0m15:25:43.377020 [info ] [MainThread]: Finished running 5 view models, 1 table model in 0 hours 1 minutes and 20.88 seconds (80.88s).
[0m15:25:43.382956 [error] [MainThread]: Encountered an error:

[0m15:25:43.400326 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:25:43.406166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 81.55317, "process_user_time": 5.100401, "process_kernel_time": 0.542874, "process_mem_max_rss": "200656", "process_out_blocks": "1989", "command_success": false, "process_in_blocks": "0"}
[0m15:25:43.408067 [debug] [MainThread]: Command `dbt run` failed at 15:25:43.407644 after 81.56 seconds
[0m15:25:43.409946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5cf9890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5cf9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9578cd90>]}
[0m15:25:43.411544 [debug] [MainThread]: Flushing usage events
[0m15:26:49.509611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1173d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e116f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e11e0d0>]}


============================== 15:26:49.511950 | 36ace08d-8dc0-4fff-b6c6-414f39ed9b3e ==============================
[0m15:26:49.511950 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:26:49.512443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:49.512826 [info ] [MainThread]: dbt version: 1.7.9
[0m15:26:49.513173 [info ] [MainThread]: python version: 3.11.14
[0m15:26:49.514055 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m15:26:49.514648 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m15:26:49.820290 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m15:26:49.821160 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m15:26:49.821563 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m15:26:49.822106 [info ] [MainThread]: adapter type: athena
[0m15:26:49.822452 [info ] [MainThread]: adapter version: 1.7.2
[0m15:26:49.885664 [info ] [MainThread]: Configuration:
[0m15:26:49.889229 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:26:49.889763 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:26:49.890530 [info ] [MainThread]: Required dependencies:
[0m15:26:49.892638 [debug] [MainThread]: Executing "git --help"
[0m15:26:49.897558 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:26:49.901119 [debug] [MainThread]: STDERR: "b''"
[0m15:26:49.902089 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:26:49.902656 [info ] [MainThread]: Connection:
[0m15:26:49.903661 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m15:26:49.904073 [info ] [MainThread]:   work_group: None
[0m15:26:49.904383 [info ] [MainThread]:   region_name: us-east-1
[0m15:26:49.904758 [info ] [MainThread]:   database: AwsDataCatalog
[0m15:26:49.905027 [info ] [MainThread]:   schema: silver
[0m15:26:49.905368 [info ] [MainThread]:   poll_interval: 1.0
[0m15:26:49.907067 [info ] [MainThread]:   aws_profile_name: None
[0m15:26:49.907980 [info ] [MainThread]:   aws_access_key_id: None
[0m15:26:49.908642 [info ] [MainThread]:   aws_secret_access_key: None
[0m15:26:49.909165 [info ] [MainThread]:   aws_session_token: None
[0m15:26:49.909879 [info ] [MainThread]:   endpoint_url: None
[0m15:26:49.910980 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m15:26:49.912054 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m15:26:49.912689 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m15:26:49.913094 [info ] [MainThread]:   debug_query_state: False
[0m15:26:49.913529 [info ] [MainThread]:   seed_s3_upload_args: None
[0m15:26:49.913969 [info ] [MainThread]:   lf_tags_database: None
[0m15:26:49.915243 [info ] [MainThread]:   spark_work_group: None
[0m15:26:49.916622 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:26:49.918096 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m15:26:49.918543 [debug] [MainThread]: Using athena connection "debug"
[0m15:26:49.918855 [debug] [MainThread]: On debug: select 1 as id
[0m15:26:49.919233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:26:50.630156 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 5e6f0714-2e9c-448c-b43f-71db178cfecd
[0m15:26:52.345522 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m15:26:52.352566 [debug] [MainThread]: On debug: Close
[0m15:26:52.354095 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:26:52.355230 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:26:52.359517 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.8745458, "process_user_time": 1.417239, "process_kernel_time": 0.23403, "process_mem_max_rss": "144140", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m15:26:52.360892 [debug] [MainThread]: Command `dbt debug` succeeded at 15:26:52.360567 after 2.88 seconds
[0m15:26:52.362000 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:26:52.367913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3752d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf5bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df6f9d0>]}
[0m15:26:52.371956 [debug] [MainThread]: Flushing usage events
[0m15:26:56.267148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca03fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc4da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbf3c10>]}


============================== 15:26:56.270318 | 43596073-b7ed-432f-ae34-641d1b74a505 ==============================
[0m15:26:56.270318 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:26:56.271126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:26:56.553832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bab2cd0>]}
[0m15:26:56.595727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca43f10>]}
[0m15:26:56.596305 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:26:56.602781 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:26:56.630360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:26:56.630952 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/noaa_silver.sql
[0m15:26:56.699859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba3cb50>]}
[0m15:26:56.709328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b87f210>]}
[0m15:26:56.709935 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m15:26:56.710334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7d9bd0>]}
[0m15:26:56.712017 [info ] [MainThread]: 
[0m15:26:56.712738 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:26:56.713869 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:26:56.714367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:57.385148 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:26:57.393585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m15:26:57.394843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:26:58.938121 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:26:58.945108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb379d0>]}
[0m15:26:58.948387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:58.949647 [info ] [MainThread]: 
[0m15:26:58.954067 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m15:26:58.954918 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m15:26:58.956060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m15:26:58.956480 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m15:26:58.969175 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:26:58.971750 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 15:26:58.956786 => 15:26:58.971445
[0m15:26:58.972281 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m15:26:58.996854 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:26:58.999351 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m15:26:58.999701 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:26:58.999986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:26:59.583174 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 22a74d76-6b53-4ea7-9435-867e7ff12926
[0m15:27:01.279977 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:27:02.693752 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['15', '14', '13', '12', '11']
[0m15:27:02.695736 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['11']
[0m15:27:03.246492 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 11 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m15:27:03.262004 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 15:26:58.972567 => 15:27:03.261512
[0m15:27:03.262903 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m15:27:03.264213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff72b7f050>]}
[0m15:27:03.265459 [info ] [Thread-1 (]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.31s]
[0m15:27:03.266981 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m15:27:03.268001 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m15:27:03.269243 [info ] [Thread-1 (]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m15:27:03.272870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:27:03.273499 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m15:27:03.277304 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:27:03.279922 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 15:27:03.273937 => 15:27:03.279683
[0m15:27:03.280450 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m15:27:03.283877 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:27:03.285183 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m15:27:03.285642 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:27:03.286136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:03.887474 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 85b7f9a5-15ab-47d8-8dcf-440f7fd4e2a1
[0m15:27:05.551269 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:27:06.929309 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['15', '14', '13', '12', '11']
[0m15:27:06.933008 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['11']
[0m15:27:07.499735 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 11 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m15:27:07.510692 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 15:27:03.280826 => 15:27:07.510179
[0m15:27:07.511729 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m15:27:07.514184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b990a50>]}
[0m15:27:07.516546 [info ] [Thread-1 (]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.24s]
[0m15:27:07.518732 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m15:27:07.520020 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m15:27:07.521681 [info ] [Thread-1 (]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m15:27:07.525735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:27:07.528103 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m15:27:07.537747 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:27:07.539051 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 15:27:07.528855 => 15:27:07.538853
[0m15:27:07.539388 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m15:27:07.550674 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:27:07.552544 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:27:07.553312 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:27:07.553818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:08.577165 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7b90269e-bb12-430b-9574-8021f439c583
[0m15:27:10.283869 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:27:11.520663 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['15', '14', '13', '12', '11']
[0m15:27:11.525778 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['11']
[0m15:27:12.114707 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 11 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m15:27:12.120970 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 15:27:07.539595 => 15:27:12.120257
[0m15:27:12.121923 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m15:27:12.124231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78aeef90>]}
[0m15:27:12.126242 [info ] [Thread-1 (]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.60s]
[0m15:27:12.127674 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m15:27:12.128537 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m15:27:12.130274 [info ] [Thread-1 (]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m15:27:12.132883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:27:12.133400 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m15:27:12.147558 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:27:12.150671 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 15:27:12.133705 => 15:27:12.150446
[0m15:27:12.151138 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m15:27:12.156229 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:27:12.157878 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m15:27:12.158424 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:27:12.159554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:12.778837 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 689e059f-9e85-4455-9aee-0752a02f06c9
[0m15:27:14.507419 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:27:15.973893 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['15', '14', '13', '12', '11']
[0m15:27:15.975156 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['11']
[0m15:27:16.537980 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 11 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m15:27:16.541709 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 15:27:12.151404 => 15:27:16.541400
[0m15:27:16.542328 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m15:27:16.543543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7eb150>]}
[0m15:27:16.544566 [info ] [Thread-1 (]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.41s]
[0m15:27:16.545410 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m15:27:16.546058 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m15:27:16.546989 [info ] [Thread-1 (]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m15:27:16.549016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:27:16.549453 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m15:27:16.553374 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:27:16.555258 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 15:27:16.549708 => 15:27:16.555116
[0m15:27:16.555554 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m15:27:16.557849 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:27:16.558775 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m15:27:16.559102 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  sensor_id,
  temp_c,
  humidity_pct,
  location,
  dt_timestamp,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:27:16.559439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:17.151620 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3779723e-0c85-41b0-a4cf-7f1ca841d354
[0m15:27:18.948256 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:27:20.221867 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['14', '13', '12', '11', '10']
[0m15:27:20.227074 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['10']
[0m15:27:20.782076 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 10 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m15:27:20.785943 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 15:27:16.555775 => 15:27:20.785556
[0m15:27:20.786469 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m15:27:20.787839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a3b5d10>]}
[0m15:27:20.789018 [info ] [Thread-1 (]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.24s]
[0m15:27:20.789945 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m15:27:20.790558 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:27:20.792591 [info ] [Thread-1 (]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m15:27:20.796070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:27:20.796764 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:27:20.805895 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:27:20.807526 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:27:20.797384 => 15:27:20.807362
[0m15:27:20.807862 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:27:20.835417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:22.286228 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:27:22.286923 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:27:22.288722 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:27:23.436079 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:27:23.437784 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:27:23.438868 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/31138742-ba48-4b64-bc1d-3255ceea2fec
[0m15:27:24.067752 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/31138742-ba48-4b64-bc1d-3255ceea2fec', bucket='climate-energy-raw-data', prefix='silver/eia_silver/31138742-ba48-4b64-bc1d-3255ceea2fec/'
[0m15:27:26.333900 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:27:26.373314 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:27:26.888625 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:27:26.890256 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/b15c2fa3-22b7-4f63-8f84-29c29873bc51',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m15:27:27.499427 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 922dd990-b08b-4a17-80f9-094d26edf18f
[0m15:27:30.316651 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":221,"data_scanned_in_bytes":1613}
[0m15:27:30.334253 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:27:30.335335 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:27:30.609439 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c2d4d80e-552e-42dc-8f00-be5a8ae8654b
[0m15:27:32.257771 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:27:32.266039 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:27:32.269485 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:27:32.270314 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":221,"data_scanned_in_bytes":1613}';
[0m15:27:32.467077 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f7f75457-2305-45fa-9358-86737c461a97
[0m15:27:34.228810 [debug] [Thread-1 (]: SQL status: OK 221 in 2.0 seconds
[0m15:27:34.245387 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 15:27:20.808088 => 15:27:34.243578
[0m15:27:34.247320 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m15:27:34.252740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b30b590>]}
[0m15:27:34.258592 [info ] [Thread-1 (]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 221[0m in 13.46s]
[0m15:27:34.262282 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m15:27:34.265165 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m15:27:34.268415 [info ] [Thread-1 (]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:27:34.276415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:27:34.277612 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m15:27:34.296982 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:27:34.299724 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 15:27:34.278219 => 15:27:34.299147
[0m15:27:34.300588 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m15:27:34.305344 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:27:34.305993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:35.049737 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:27:35.051828 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/59690512-673c-4e32-b426-e46d2f4b737f',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:27:35.611193 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f421782c-1b27-447b-b590-3ad99bb2c443
[0m15:27:37.260545 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":630}
[0m15:27:37.269448 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:27:37.271637 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:27:37.534370 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 25f10b2a-be35-4d97-9bb3-f70d58c6ab07
[0m15:27:39.200096 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:27:39.204934 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:27:39.206784 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:27:39.207133 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":630}';
[0m15:27:39.403732 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3f08ac0b-2229-4192-9ef1-bfc53ec8fdee
[0m15:27:41.106494 [debug] [Thread-1 (]: SQL status: OK 31 in 2.0 seconds
[0m15:27:41.119783 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 15:27:34.301059 => 15:27:41.118431
[0m15:27:41.121415 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m15:27:41.124566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7213bb10>]}
[0m15:27:41.127193 [info ] [Thread-1 (]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 6.85s]
[0m15:27:41.128976 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m15:27:41.130297 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m15:27:41.132021 [info ] [Thread-1 (]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m15:27:41.138161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:27:41.138906 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m15:27:41.153753 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:27:41.155604 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 15:27:41.139316 => 15:27:41.155391
[0m15:27:41.156039 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m15:27:41.159896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:42.433346 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:27:42.434696 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:27:42.436547 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:27:43.629031 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:27:43.630502 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:27:43.631343 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/0bd9f774-3c5e-4200-8fed-b5977a582601
[0m15:27:45.125951 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/0bd9f774-3c5e-4200-8fed-b5977a582601', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/0bd9f774-3c5e-4200-8fed-b5977a582601/'
[0m15:27:47.358445 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:27:47.387732 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:27:47.972448 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:27:47.974172 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/3e7ac166-3062-4d51-b93d-fb04d6b61848',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m15:27:48.544461 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8055b139-8206-4736-ace3-0c30f0c61b8c
[0m15:27:50.231583 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m15:27:50.234608 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:27:50.235107 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:27:50.493435 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7a0bcc5e-2493-4350-a0c8-f305443c2113
[0m15:27:52.154626 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:27:52.163169 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:27:52.165526 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:27:52.165993 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m15:27:52.364906 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cbd8aaa7-e8ee-4481-a4f5-156cfb910638
[0m15:27:54.056199 [debug] [Thread-1 (]: SQL status: OK 4447 in 2.0 seconds
[0m15:27:54.070484 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 15:27:41.156308 => 15:27:54.067647
[0m15:27:54.073195 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m15:27:54.079352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71284e50>]}
[0m15:27:54.081842 [info ] [Thread-1 (]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 12.95s]
[0m15:27:54.083492 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m15:27:54.084740 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m15:27:54.086294 [info ] [Thread-1 (]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m15:27:54.092408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:27:54.093443 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m15:27:54.113547 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:27:54.118496 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 15:27:54.094157 => 15:27:54.115505
[0m15:27:54.119905 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m15:27:54.124929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:55.416014 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:27:55.417998 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:27:55.419589 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:27:56.617197 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:27:56.619449 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:27:56.620537 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/ddc2cc97-1b17-44b9-9a67-6bfc5e13fbef
[0m15:27:57.361466 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/ddc2cc97-1b17-44b9-9a67-6bfc5e13fbef', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/ddc2cc97-1b17-44b9-9a67-6bfc5e13fbef/'
[0m15:27:59.790777 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:27:59.796896 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:28:01.027066 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:28:01.030141 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/54f6db38-5a1f-4f7f-9cf5-30c876e3947f',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m15:28:01.630969 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1ff5f69c-67af-4cbc-9843-18c2c2987da8
[0m15:28:03.298058 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m15:28:03.301942 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:28:03.302935 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:28:03.563328 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID fd1b0848-2781-47e4-a925-c04d6ee5497e
[0m15:28:05.230483 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:05.240604 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:28:05.244325 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:28:05.245225 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m15:28:05.445126 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 503f8f4f-8d2d-4ef9-8d0f-c107d16d454e
[0m15:28:07.157937 [debug] [Thread-1 (]: SQL status: OK 63 in 2.0 seconds
[0m15:28:07.170915 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 15:27:54.120226 => 15:28:07.167146
[0m15:28:07.173880 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m15:28:07.189902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7db550>]}
[0m15:28:07.203787 [info ] [Thread-1 (]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 13.10s]
[0m15:28:07.212768 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m15:28:07.218539 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m15:28:07.236250 [info ] [Thread-1 (]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m15:28:07.264266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:28:07.281145 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m15:28:07.453455 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:28:07.473923 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 15:28:07.290224 => 15:28:07.469158
[0m15:28:07.478242 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m15:28:07.508938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:08.922006 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:28:08.924783 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:28:08.929015 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:28:10.113305 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:28:10.114070 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:28:10.114551 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/f3d4d0e0-aa59-4c5a-8a55-5e0c1576c456
[0m15:28:10.655075 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/f3d4d0e0-aa59-4c5a-8a55-5e0c1576c456', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/f3d4d0e0-aa59-4c5a-8a55-5e0c1576c456/'
[0m15:28:12.701871 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:28:12.721885 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:28:13.634157 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:28:13.638154 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/a36616bf-e264-4fd0-823d-021e20a69fe2',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m15:28:14.233526 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4433ccc8-13cf-4086-9025-a8882dcb6688
[0m15:28:15.909966 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":300,"data_scanned_in_bytes":8044}
[0m15:28:15.920461 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:28:15.921581 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:28:16.191139 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d514d750-e9e1-4d76-9de5-d3ce535bad4a
[0m15:28:17.947343 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:17.969608 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:28:17.986032 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:28:17.988109 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":300,"data_scanned_in_bytes":8044}';
[0m15:28:18.192397 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 25fd934d-e902-4358-97f0-2688aa4857cf
[0m15:28:19.997950 [debug] [Thread-1 (]: SQL status: OK 300 in 2.0 seconds
[0m15:28:20.005771 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 15:28:07.483743 => 15:28:20.004676
[0m15:28:20.006734 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m15:28:20.009671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43596073-b7ed-432f-ae34-641d1b74a505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff780c8fd0>]}
[0m15:28:20.011102 [info ] [Thread-1 (]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 300[0m in 12.77s]
[0m15:28:20.011927 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m15:28:20.018792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:20.019395 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m15:28:20.025834 [info ] [MainThread]: 
[0m15:28:20.026661 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 23.31 seconds (83.31s).
[0m15:28:20.030005 [debug] [MainThread]: Command end result
[0m15:28:20.057619 [info ] [MainThread]: 
[0m15:28:20.058133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:20.058631 [info ] [MainThread]: 
[0m15:28:20.059368 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m15:28:20.064706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 83.82082, "process_user_time": 8.652604, "process_kernel_time": 0.896984, "process_mem_max_rss": "187644", "process_out_blocks": "2980", "process_in_blocks": "0"}
[0m15:28:20.068535 [debug] [MainThread]: Command `dbt run` succeeded at 15:28:20.067900 after 83.83 seconds
[0m15:28:20.069437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca03fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7de15c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e08a50>]}
[0m15:28:20.069805 [debug] [MainThread]: Flushing usage events
[0m16:09:42.779203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1da430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f341550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d85cd00>]}


============================== 16:09:42.825571 | 4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706 ==============================
[0m16:09:42.825571 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:09:42.826116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:09:43.550719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a61fa30>]}
[0m16:09:43.620151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd84cd0>]}
[0m16:09:43.621295 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m16:09:43.643778 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:09:43.731818 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:09:43.732244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd6d9a0>]}
[0m16:09:44.576405 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:09:44.576952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af77be0>]}
[0m16:09:44.792594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a92af10>]}
[0m16:09:44.898298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8839d0>]}
[0m16:09:44.898785 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m16:09:44.899170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a845340>]}
[0m16:09:44.901048 [info ] [MainThread]: 
[0m16:09:44.901642 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:09:44.907079 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:09:44.907570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:46.413224 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:09:46.424649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m16:09:46.426181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:47.803045 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:09:47.805636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac653d0>]}
[0m16:09:47.806163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:47.806515 [info ] [MainThread]: 
[0m16:09:47.815816 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m16:09:47.816391 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m16:09:47.816974 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m16:09:47.817258 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m16:09:47.823274 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m16:09:47.824486 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m16:09:47.857844 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m16:09:47.859536 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m16:09:47.859851 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m16:09:47.860155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:48.462788 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f773f04e-f425-4e0f-8121-0b09c752cec5
[0m16:09:50.259828 [debug] [Thread-1  ]: SQL status: OK -1 in 2.399 seconds
[0m16:09:51.311715 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['16', '15', '14', '13', '12']
[0m16:09:51.314180 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['12']
[0m16:09:51.784821 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 12 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m16:09:51.794720 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m16:09:51.796965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd84d60>]}
[0m16:09:51.797932 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 3.98s]
[0m16:09:51.798878 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m16:09:51.800383 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m16:09:51.803688 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m16:09:51.808282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m16:09:51.808855 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m16:09:51.813394 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m16:09:51.814553 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m16:09:51.817217 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m16:09:51.818170 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m16:09:51.818402 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m16:09:51.818603 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:52.307853 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ce86bb12-fa11-4dda-9fc2-587db8aabe4c
[0m16:09:54.114089 [debug] [Thread-1  ]: SQL status: OK -1 in 2.295 seconds
[0m16:09:55.173670 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['16', '15', '14', '13', '12']
[0m16:09:55.181572 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['12']
[0m16:09:55.656805 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 12 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m16:09:55.663040 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m16:09:55.666810 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd84d60>]}
[0m16:09:55.669578 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 3.86s]
[0m16:09:55.673171 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m16:09:55.674662 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m16:09:55.675811 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m16:09:55.685799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m16:09:55.690151 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m16:09:55.710284 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m16:09:55.716223 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m16:09:55.726377 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m16:09:55.730853 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m16:09:55.731974 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m16:09:55.732523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:09:56.333092 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 381b6cfc-bf2c-44e8-988b-1448f4988086
[0m16:09:58.016473 [debug] [Thread-1  ]: SQL status: OK -1 in 2.283 seconds
[0m16:09:59.005872 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['16', '15', '14', '13', '12']
[0m16:09:59.006957 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['12']
[0m16:09:59.516333 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 12 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m16:09:59.528414 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m16:09:59.531640 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd84d60>]}
[0m16:09:59.533822 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 3.85s]
[0m16:09:59.535868 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m16:09:59.538561 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m16:09:59.542807 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m16:09:59.547641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m16:09:59.548338 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m16:09:59.557410 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m16:09:59.560657 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m16:09:59.566836 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m16:09:59.568522 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m16:09:59.569082 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m16:09:59.569689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:10:00.223696 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 03bf1560-ff37-4634-bf63-018f3440d97c
[0m16:10:01.892029 [debug] [Thread-1  ]: SQL status: OK -1 in 2.320 seconds
[0m16:10:02.973777 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['16', '15', '14', '13', '12']
[0m16:10:02.975521 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['12']
[0m16:10:03.464038 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 12 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m16:10:03.475788 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m16:10:03.478804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9dd940>]}
[0m16:10:03.481089 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 3.93s]
[0m16:10:03.482944 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m16:10:03.484442 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m16:10:03.486438 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m16:10:03.491230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m16:10:03.491921 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m16:10:03.500010 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m16:10:03.501869 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m16:10:03.505834 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m16:10:03.506956 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m16:10:03.507373 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  sensor_id,
  temp_c,
  humidity_pct,
  location,
  dt_timestamp,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m16:10:03.507784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:10:04.064541 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 24f09a2a-7e1b-44ac-90bc-1178d4170335
[0m16:10:05.789337 [debug] [Thread-1  ]: SQL status: OK -1 in 2.279 seconds
[0m16:10:06.888900 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['15', '14', '13', '12', '11']
[0m16:10:06.891606 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['11']
[0m16:10:07.357989 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 11 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m16:10:07.369845 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m16:10:07.373403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9dd850>]}
[0m16:10:07.376796 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 3.88s]
[0m16:10:07.379110 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m16:10:07.380882 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m16:10:07.383004 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m16:10:07.387822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m16:10:07.388485 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m16:10:07.400422 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m16:10:07.403016 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m16:10:07.434969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:10:08.612699 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m16:10:08.613595 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:10:08.615702 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:10:09.636828 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m16:10:09.638347 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:10:09.639198 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/b15c2fa3-22b7-4f63-8f84-29c29873bc51
[0m16:10:10.200207 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/b15c2fa3-22b7-4f63-8f84-29c29873bc51', bucket='climate-energy-raw-data', prefix='silver/eia_silver/b15c2fa3-22b7-4f63-8f84-29c29873bc51/'
[0m16:10:11.975615 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m16:10:12.021534 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:10:12.472894 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:10:12.474142 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/8380bfb1-8e7c-4d39-a81c-7ebfe8276092',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m16:10:12.920261 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 52dfbf61-edaa-4fbe-bb66-9613e3e77a81
[0m16:10:14.556696 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":221,"data_scanned_in_bytes":1613}
[0m16:10:14.565002 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m16:10:14.565972 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m16:10:14.789527 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5e87a784-3119-4f62-972c-034b74550b04
[0m16:10:16.476474 [debug] [Thread-1  ]: SQL status: OK -1 in 1.909 seconds
[0m16:10:16.480847 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m16:10:16.482829 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m16:10:16.483150 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":221,"data_scanned_in_bytes":1613}';
[0m16:10:16.688482 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 09e884f2-e27d-47dd-97ab-fbd29af944b9
[0m16:10:18.377178 [debug] [Thread-1  ]: SQL status: OK 221 in 1.894 seconds
[0m16:10:18.382380 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m16:10:18.384216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9dd850>]}
[0m16:10:18.385822 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 221[0m in 11.00s]
[0m16:10:18.387368 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m16:10:18.388395 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m16:10:18.389649 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m16:10:18.393554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m16:10:18.394247 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m16:10:18.401224 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m16:10:18.402680 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m16:10:18.406565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:10:19.460142 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m16:10:19.461604 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:10:19.462765 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:10:20.604801 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m16:10:20.606059 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:10:20.606920 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/59690512-673c-4e32-b426-e46d2f4b737f
[0m16:10:21.056871 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/59690512-673c-4e32-b426-e46d2f4b737f', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/59690512-673c-4e32-b426-e46d2f4b737f/'
[0m16:10:23.033656 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m16:10:23.036641 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:10:23.456557 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:10:23.458975 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/4274225b-227f-4ea1-89af-bdbff373b476',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m16:10:23.934035 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d81fb0ad-a56f-46cd-baae-e54c1d95e01f
[0m16:10:25.625988 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":630}
[0m16:10:25.627847 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m16:10:25.628432 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m16:10:25.822390 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a085d73e-40c7-4179-8fa8-a6fd41aed9b2
[0m16:10:27.479869 [debug] [Thread-1  ]: SQL status: OK -1 in 1.850 seconds
[0m16:10:27.485392 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m16:10:27.489388 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m16:10:27.490571 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":630}';
[0m16:10:27.676714 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 30cf7967-999c-46ca-8ecf-2ea46dd4a139
[0m16:10:29.358498 [debug] [Thread-1  ]: SQL status: OK 31 in 1.866 seconds
[0m16:10:29.367934 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m16:10:29.373687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8aeee0>]}
[0m16:10:29.381142 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 10.98s]
[0m16:10:29.384326 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m16:10:29.385815 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m16:10:29.387537 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m16:10:29.392883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m16:10:29.393512 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m16:10:29.402014 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m16:10:29.403319 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m16:10:29.407069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:10:30.521673 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m16:10:30.523474 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:10:30.526281 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:10:31.551989 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m16:10:31.554872 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:10:31.558149 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/3e7ac166-3062-4d51-b93d-fb04d6b61848
[0m16:10:32.335217 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/3e7ac166-3062-4d51-b93d-fb04d6b61848', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/3e7ac166-3062-4d51-b93d-fb04d6b61848/'
[0m16:10:34.408458 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m16:10:34.415894 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:10:34.837700 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:10:34.839454 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/0d8d4b31-a886-4d7f-b6e0-0f7ebb601467',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m16:10:35.367494 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 48228d22-e8cb-4b11-bf31-6755390c0f1a
[0m16:10:38.378322 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m16:10:38.382143 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m16:10:38.382960 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m16:10:38.578104 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 52efe0d5-a2da-4fdc-8e3d-7b8e3e7754db
[0m16:10:55.156230 [debug] [Thread-1  ]: SQL status: OK -1 in 16.754 seconds
[0m16:10:55.207637 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m16:10:55.224667 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m16:10:55.227099 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m16:10:55.431055 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c39f3302-b1eb-48c7-9e8a-b094ef1065ca
[0m16:10:57.179970 [debug] [Thread-1  ]: SQL status: OK 4447 in 1.950 seconds
[0m16:10:57.187167 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m16:10:57.189129 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8aeee0>]}
[0m16:10:57.190568 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 27.80s]
[0m16:10:57.191776 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m16:10:57.193610 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m16:10:57.196378 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m16:10:57.203527 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m16:10:57.204051 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m16:10:57.210683 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m16:10:57.211917 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m16:10:57.214702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:10:58.308404 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m16:10:58.309435 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:10:58.310254 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:10:59.296825 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m16:10:59.297597 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:10:59.298222 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/54f6db38-5a1f-4f7f-9cf5-30c876e3947f
[0m16:10:59.824252 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/54f6db38-5a1f-4f7f-9cf5-30c876e3947f', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/54f6db38-5a1f-4f7f-9cf5-30c876e3947f/'
[0m16:11:01.640929 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m16:11:01.649970 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:11:02.097247 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:11:02.099292 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/5d00f462-ff8c-4935-8481-29e37a2ea0ae',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m16:11:02.553702 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6218c66d-c0fb-49b9-bd0e-f633fabb1af8
[0m16:11:05.479833 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m16:11:05.486307 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m16:11:05.489631 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m16:11:05.678750 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID bf69419c-d85a-417a-9dff-3e008319223f
[0m16:11:07.354016 [debug] [Thread-1  ]: SQL status: OK -1 in 1.862 seconds
[0m16:11:07.363980 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m16:11:07.366531 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m16:11:07.367016 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m16:11:07.558766 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1fb0aa2b-626c-46ec-9d0c-62575ce45d09
[0m16:11:09.251251 [debug] [Thread-1  ]: SQL status: OK 63 in 1.883 seconds
[0m16:11:09.262020 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m16:11:09.265159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8aeee0>]}
[0m16:11:09.267848 [info ] [Thread-1  ]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 12.07s]
[0m16:11:09.270260 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m16:11:09.272042 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m16:11:09.274145 [info ] [Thread-1  ]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m16:11:09.286112 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m16:11:09.286844 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m16:11:09.296728 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m16:11:09.298507 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m16:11:09.302811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:11:10.596746 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m16:11:10.598018 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:11:10.599105 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:11:11.742199 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m16:11:11.742760 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:11:11.743151 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/a36616bf-e264-4fd0-823d-021e20a69fe2
[0m16:11:12.221898 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/a36616bf-e264-4fd0-823d-021e20a69fe2', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/a36616bf-e264-4fd0-823d-021e20a69fe2/'
[0m16:11:14.238438 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m16:11:14.242415 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:11:14.667013 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:11:14.668731 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/8131a6a4-4afd-4119-9c86-f62f2175a7a3',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m16:11:15.182709 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6a6d7d91-0270-4bab-9b57-f2464f222c31
[0m16:11:16.947481 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":300,"data_scanned_in_bytes":8044}
[0m16:11:16.952793 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m16:11:16.953368 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m16:11:17.151126 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fd6dfa37-1f59-453f-8fe8-6269e8bedb6b
[0m16:11:18.808043 [debug] [Thread-1  ]: SQL status: OK -1 in 1.854 seconds
[0m16:11:18.810859 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m16:11:18.813385 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m16:11:18.814179 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":300,"data_scanned_in_bytes":8044}';
[0m16:11:19.001865 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6c630254-f766-42e6-be84-4406ab6c84d1
[0m16:11:20.688576 [debug] [Thread-1  ]: SQL status: OK 300 in 1.874 seconds
[0m16:11:20.697811 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m16:11:20.699942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be3e85d-39ae-4d3d-9ba6-5a88e7cb7706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac54d90>]}
[0m16:11:20.701844 [info ] [Thread-1  ]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 300[0m in 11.42s]
[0m16:11:20.703901 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m16:11:20.719521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:20.720099 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m16:11:20.723358 [info ] [MainThread]: 
[0m16:11:20.724012 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 35.82 seconds (95.82s).
[0m16:11:20.727307 [debug] [MainThread]: Command end result
[0m16:11:20.769647 [info ] [MainThread]: 
[0m16:11:20.770038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:20.770280 [info ] [MainThread]: 
[0m16:11:20.770554 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:11:20.772235 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 98.0234, "process_user_time": 10.465129, "process_kernel_time": 2.265091, "process_mem_max_rss": "186760", "process_in_blocks": "55048", "process_out_blocks": "9543"}
[0m16:11:20.773047 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:20.772943 after 98.02 seconds
[0m16:11:20.773450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1da430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae3ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac438e0>]}
[0m16:11:20.773752 [debug] [MainThread]: Flushing usage events
[0m16:31:21.551090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc80f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e3ef990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dc800d0>]}


============================== 16:31:21.556896 | 822b9697-409b-43fa-a686-7b620cda8511 ==============================
[0m16:31:21.556896 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:31:21.558017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:21.558302 [info ] [MainThread]: dbt version: 1.7.9
[0m16:31:21.558623 [info ] [MainThread]: python version: 3.11.14
[0m16:31:21.558913 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:31:21.559204 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m16:31:21.849752 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m16:31:21.850228 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m16:31:21.850575 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m16:31:21.851068 [info ] [MainThread]: adapter type: athena
[0m16:31:21.851321 [info ] [MainThread]: adapter version: 1.7.2
[0m16:31:21.886283 [info ] [MainThread]: Configuration:
[0m16:31:21.886743 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:31:21.887104 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:31:21.887398 [info ] [MainThread]: Required dependencies:
[0m16:31:21.887679 [debug] [MainThread]: Executing "git --help"
[0m16:31:21.900055 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:31:21.900897 [debug] [MainThread]: STDERR: "b''"
[0m16:31:21.901163 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:31:21.901414 [info ] [MainThread]: Connection:
[0m16:31:21.901776 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m16:31:21.902105 [info ] [MainThread]:   work_group: None
[0m16:31:21.902392 [info ] [MainThread]:   region_name: us-east-1
[0m16:31:21.902649 [info ] [MainThread]:   database: AwsDataCatalog
[0m16:31:21.902905 [info ] [MainThread]:   schema: silver
[0m16:31:21.903154 [info ] [MainThread]:   poll_interval: 1.0
[0m16:31:21.903378 [info ] [MainThread]:   aws_profile_name: None
[0m16:31:21.903612 [info ] [MainThread]:   aws_access_key_id: None
[0m16:31:21.903922 [info ] [MainThread]:   aws_secret_access_key: None
[0m16:31:21.904159 [info ] [MainThread]:   aws_session_token: None
[0m16:31:21.904411 [info ] [MainThread]:   endpoint_url: None
[0m16:31:21.904622 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m16:31:21.904897 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m16:31:21.905135 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m16:31:21.905364 [info ] [MainThread]:   debug_query_state: False
[0m16:31:21.905600 [info ] [MainThread]:   seed_s3_upload_args: None
[0m16:31:21.905892 [info ] [MainThread]:   lf_tags_database: None
[0m16:31:21.906182 [info ] [MainThread]:   spark_work_group: None
[0m16:31:21.906499 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:31:21.907006 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m16:31:21.907246 [debug] [MainThread]: Using athena connection "debug"
[0m16:31:21.907454 [debug] [MainThread]: On debug: select 1 as id
[0m16:31:21.907632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:22.610762 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 4d715a3c-2d1e-492a-8578-0ae7778b6f6d
[0m16:31:24.360801 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m16:31:24.363277 [debug] [MainThread]: On debug: Close
[0m16:31:24.364240 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:31:24.365244 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:31:24.368100 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.8402033, "process_user_time": 1.515607, "process_kernel_time": 0.677981, "process_mem_max_rss": "143984", "process_in_blocks": "89720", "process_out_blocks": "2213"}
[0m16:31:24.369028 [debug] [MainThread]: Command `dbt debug` succeeded at 16:31:24.368809 after 2.84 seconds
[0m16:31:24.369552 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:31:24.372089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ceada50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cced790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccefd90>]}
[0m16:31:24.372933 [debug] [MainThread]: Flushing usage events
[0m16:31:38.170242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0723d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a09250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa071c350>]}


============================== 16:31:38.172383 | 06ded882-16c3-4a40-ad80-a2296b71eeda ==============================
[0m16:31:38.172383 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:31:38.172908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:31:38.484396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7ee0d0>]}
[0m16:31:38.528806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7883d0>]}
[0m16:31:38.529463 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:31:38.535863 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:31:38.546697 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:31:38.547256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f564050>]}
[0m16:31:39.344703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f408410>]}
[0m16:31:39.360507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f799f50>]}
[0m16:31:39.361128 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m16:31:39.361662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef37c90>]}
[0m16:31:39.363653 [info ] [MainThread]: 
[0m16:31:39.364818 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:31:39.368760 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:31:39.370316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:40.038090 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:31:40.041890 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver'
[0m16:31:40.042671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:41.593409 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:31:41.600565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f574210>]}
[0m16:31:41.602370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:41.603309 [info ] [MainThread]: 
[0m16:31:41.607091 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m16:31:41.608043 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m16:31:41.609407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m16:31:41.609996 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m16:31:41.620004 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m16:31:41.622193 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 16:31:41.610382 => 16:31:41.621959
[0m16:31:41.622672 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m16:31:41.646232 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m16:31:41.647653 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m16:31:41.647940 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  dt_timestamp,
  state,
  sector,
  price,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m16:31:41.648262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:42.248621 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 85d15b65-7d84-4245-b758-06f796c6fdcb
[0m16:31:43.933925 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:31:45.345635 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['17', '16', '15', '14', '13']
[0m16:31:45.348301 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['13']
[0m16:31:45.918542 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 13 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m16:31:45.935779 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 16:31:41.622993 => 16:31:45.934911
[0m16:31:45.938280 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m16:31:45.940626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94676550>]}
[0m16:31:45.942346 [info ] [Thread-1 (]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.33s]
[0m16:31:45.943517 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m16:31:45.944603 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m16:31:45.946266 [info ] [Thread-1 (]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m16:31:45.949951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m16:31:45.950658 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m16:31:45.957632 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m16:31:45.959551 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 16:31:45.951190 => 16:31:45.959186
[0m16:31:45.960549 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m16:31:45.964604 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m16:31:45.966782 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m16:31:45.967365 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  station_id,
  dt_timestamp,
  datatype,
  value
from "AwsDataCatalog"."silver"."noaa_weather"

[0m16:31:45.968141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:46.990145 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d6871353-c8c5-43e0-aaa2-ecd55b7a51ee
[0m16:31:48.688077 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m16:31:49.851825 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['17', '16', '15', '14', '13']
[0m16:31:49.856018 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['13']
[0m16:31:50.428249 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 13 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m16:31:50.441317 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 16:31:45.960935 => 16:31:50.440218
[0m16:31:50.442996 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m16:31:50.446021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f345990>]}
[0m16:31:50.448899 [info ] [Thread-1 (]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.50s]
[0m16:31:50.451317 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m16:31:50.452933 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m16:31:50.456399 [info ] [Thread-1 (]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m16:31:50.469209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m16:31:50.470607 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m16:31:50.481829 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m16:31:50.484263 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 16:31:50.471020 => 16:31:50.483977
[0m16:31:50.484773 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m16:31:50.491042 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m16:31:50.493022 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m16:31:50.493469 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  temp_mic_c as temp_min,
  precipitation_mm as precipitation,
  windspeed_max_mps as windspeed,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m16:31:50.493854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:51.110615 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f007aa25-c978-40e4-aab8-dc954c99cb14
[0m16:31:52.752431 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:31:54.358098 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['17', '16', '15', '14', '13']
[0m16:31:54.363740 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['13']
[0m16:31:54.974972 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 13 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m16:31:54.989666 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 16:31:50.485055 => 16:31:54.987847
[0m16:31:54.993509 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m16:31:55.003183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943b03d0>]}
[0m16:31:55.007833 [info ] [Thread-1 (]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.54s]
[0m16:31:55.010153 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m16:31:55.011988 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m16:31:55.017923 [info ] [Thread-1 (]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m16:31:55.024424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m16:31:55.025319 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m16:31:55.044516 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m16:31:55.050356 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 16:31:55.025743 => 16:31:55.049983
[0m16:31:55.051169 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m16:31:55.056919 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m16:31:55.059237 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m16:31:55.059965 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  city,
  dt_timestamp,
  temp_c as temperature,
  feelslike_c as feelslike_temp,
  humidity_pct as humidity,
  windspeed_mps as windspeed,
  visibility_m as visibility,
  weather_status,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m16:31:55.060677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:55.686842 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a30ad7a0-6168-4d88-b6b9-c0fc8b02b78a
[0m16:31:57.370417 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:31:58.546877 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['17', '16', '15', '14', '13']
[0m16:31:58.548153 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['13']
[0m16:31:59.088399 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 13 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m16:31:59.103974 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 16:31:55.051685 => 16:31:59.103136
[0m16:31:59.106119 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m16:31:59.110746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c411f50>]}
[0m16:31:59.112963 [info ] [Thread-1 (]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.09s]
[0m16:31:59.114392 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m16:31:59.115637 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m16:31:59.118982 [info ] [Thread-1 (]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m16:31:59.125037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m16:31:59.126037 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m16:31:59.141527 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m16:31:59.143426 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 16:31:59.126638 => 16:31:59.143218
[0m16:31:59.143816 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m16:31:59.146974 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m16:31:59.148106 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m16:31:59.148770 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  power_kw,
  voltage,
  sensor_id,
  temp_c,
  humidity_pct,
  location,
  dt_timestamp,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m16:31:59.149465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:00.108293 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cbe7ae63-ac95-469d-8a79-f2b3c746352c
[0m16:32:01.781586 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m16:32:03.002503 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['16', '15', '14', '13', '12']
[0m16:32:03.007014 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['12']
[0m16:32:03.573119 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 12 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m16:32:03.586940 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 16:31:59.144047 => 16:32:03.585984
[0m16:32:03.588410 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m16:32:03.591775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f679690>]}
[0m16:32:03.594377 [info ] [Thread-1 (]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.47s]
[0m16:32:03.596255 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m16:32:03.597736 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m16:32:03.600440 [info ] [Thread-1 (]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m16:32:03.606368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m16:32:03.607092 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m16:32:03.617593 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m16:32:03.620466 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 16:32:03.607581 => 16:32:03.620279
[0m16:32:03.620879 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m16:32:03.663309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:04.913262 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m16:32:04.915778 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:32:04.926547 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:32:06.301448 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m16:32:06.304107 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:32:06.304969 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/8380bfb1-8e7c-4d39-a81c-7ebfe8276092
[0m16:32:07.232914 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/8380bfb1-8e7c-4d39-a81c-7ebfe8276092', bucket='climate-energy-raw-data', prefix='silver/eia_silver/8380bfb1-8e7c-4d39-a81c-7ebfe8276092/'
[0m16:32:09.344015 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m16:32:09.388853 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:32:09.920978 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:32:09.923920 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/cc49412e-597d-43e7-91bd-d87877e8656a',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m16:32:10.490333 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 49ff48e1-fa55-45e3-b407-dc0a2696940f
[0m16:32:12.181386 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":221,"data_scanned_in_bytes":1613}
[0m16:32:12.189331 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m16:32:12.190621 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m16:32:12.460116 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c7b1f32c-12e4-4985-b15a-ea05386d9296
[0m16:32:14.094205 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:32:14.102390 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m16:32:14.105749 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m16:32:14.106518 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":221,"data_scanned_in_bytes":1613}';
[0m16:32:14.301794 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID eca29ce2-8f66-430a-ba46-a0db4b046b48
[0m16:32:16.184920 [debug] [Thread-1 (]: SQL status: OK 221 in 2.0 seconds
[0m16:32:16.207438 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 16:32:03.621160 => 16:32:16.204826
[0m16:32:16.210446 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m16:32:16.218442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ecae10>]}
[0m16:32:16.220827 [info ] [Thread-1 (]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 221[0m in 12.61s]
[0m16:32:16.222885 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m16:32:16.224006 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m16:32:16.225587 [info ] [Thread-1 (]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m16:32:16.234386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m16:32:16.235482 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m16:32:16.244772 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m16:32:16.248669 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 16:32:16.235890 => 16:32:16.247560
[0m16:32:16.251273 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m16:32:16.255028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:17.634962 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m16:32:17.636449 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:32:17.637481 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:32:18.828804 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m16:32:18.844267 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:32:18.844737 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/4274225b-227f-4ea1-89af-bdbff373b476
[0m16:32:19.323096 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/4274225b-227f-4ea1-89af-bdbff373b476', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/4274225b-227f-4ea1-89af-bdbff373b476/'
[0m16:32:21.950903 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m16:32:21.955393 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:32:22.515791 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:32:22.517859 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/f741e7df-3d38-49e2-8721-c7faefac6f1c',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m16:32:23.107492 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 437661de-9d14-4d29-ab97-954adb1f5bd6
[0m16:32:24.795414 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":31,"data_scanned_in_bytes":630}
[0m16:32:24.798876 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m16:32:24.800564 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m16:32:25.072618 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 02babc88-c874-4c33-a29e-556b17ef174a
[0m16:32:26.764399 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:32:26.781697 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m16:32:26.786551 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m16:32:26.787330 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":31,"data_scanned_in_bytes":630}';
[0m16:32:26.984992 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 571f52a2-8f84-4b43-a043-827a1324e827
[0m16:32:28.735968 [debug] [Thread-1 (]: SQL status: OK 31 in 2.0 seconds
[0m16:32:28.740446 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 16:32:16.251620 => 16:32:28.739978
[0m16:32:28.741322 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m16:32:28.742960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940d8910>]}
[0m16:32:28.744794 [info ] [Thread-1 (]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 31[0m in 12.52s]
[0m16:32:28.745956 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m16:32:28.746821 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m16:32:28.747976 [info ] [Thread-1 (]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m16:32:28.751638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m16:32:28.752217 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m16:32:28.763456 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m16:32:28.767682 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 16:32:28.752542 => 16:32:28.766601
[0m16:32:28.768758 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m16:32:28.771776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:30.046262 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m16:32:30.047216 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:32:30.048144 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:32:31.339796 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m16:32:31.341672 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:32:31.342899 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/0d8d4b31-a886-4d7f-b6e0-0f7ebb601467
[0m16:32:31.985109 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/0d8d4b31-a886-4d7f-b6e0-0f7ebb601467', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/0d8d4b31-a886-4d7f-b6e0-0f7ebb601467/'
[0m16:32:34.352707 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m16:32:34.363392 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:32:34.909192 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:32:34.913000 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/c2afb676-e7d3-4dce-a1d4-22d341f3a955',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m16:32:35.487154 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 58f03ada-1a24-400c-8535-4faab2e16a48
[0m16:32:38.360656 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":4447,"data_scanned_in_bytes":38803}
[0m16:32:38.373411 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m16:32:38.374432 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m16:32:38.745551 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6ccc8788-9879-45b3-9279-a7f1c8a1257c
[0m16:32:40.394524 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:32:40.403816 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m16:32:40.407985 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m16:32:40.408878 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":4447,"data_scanned_in_bytes":38803}';
[0m16:32:40.609107 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a9cee269-aeee-4d07-bcdb-f65f4bb89bf0
[0m16:32:42.346330 [debug] [Thread-1 (]: SQL status: OK 4447 in 2.0 seconds
[0m16:32:42.354449 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 16:32:28.768998 => 16:32:42.353815
[0m16:32:42.355694 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m16:32:42.358266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f678d90>]}
[0m16:32:42.360328 [info ] [Thread-1 (]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 4447[0m in 13.61s]
[0m16:32:42.361580 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m16:32:42.362607 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m16:32:42.364032 [info ] [Thread-1 (]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m16:32:42.373560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m16:32:42.374591 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m16:32:42.393721 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m16:32:42.396422 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 16:32:42.375135 => 16:32:42.395742
[0m16:32:42.398087 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m16:32:42.404823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:44.003990 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m16:32:44.005141 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:32:44.006108 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:32:45.226199 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m16:32:45.226752 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:32:45.227140 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/5d00f462-ff8c-4935-8481-29e37a2ea0ae
[0m16:32:45.868261 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/5d00f462-ff8c-4935-8481-29e37a2ea0ae', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/5d00f462-ff8c-4935-8481-29e37a2ea0ae/'
[0m16:32:48.649597 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m16:32:48.669818 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:32:49.827522 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:32:49.836987 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/d3c89d72-ea1e-472a-bcc0-7ddeb8d0593d',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m16:32:50.409882 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c5d2cb7d-b3d7-4960-a861-54c2da6bbee4
[0m16:32:53.864699 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":63,"data_scanned_in_bytes":1584}
[0m16:32:53.876506 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m16:32:53.877704 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m16:32:54.130174 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c4c080c2-8452-4459-8b4c-68b168fd631d
[0m16:32:55.879206 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:32:55.896721 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m16:32:55.904727 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m16:32:55.905516 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":63,"data_scanned_in_bytes":1584}';
[0m16:32:56.095892 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4de1c1cf-312e-4b9f-aa31-11d7011655ef
[0m16:32:57.841869 [debug] [Thread-1 (]: SQL status: OK 63 in 2.0 seconds
[0m16:32:57.865182 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 16:32:42.398703 => 16:32:57.861552
[0m16:32:57.868270 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m16:32:57.876313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94208210>]}
[0m16:32:57.879206 [info ] [Thread-1 (]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 63[0m in 15.51s]
[0m16:32:57.881853 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m16:32:57.886437 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m16:32:57.892149 [info ] [Thread-1 (]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m16:32:57.898458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m16:32:57.899282 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m16:32:57.937223 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m16:32:57.938596 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 16:32:57.900079 => 16:32:57.938474
[0m16:32:57.939242 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m16:32:57.947986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:59.848668 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m16:32:59.851716 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:32:59.854061 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:33:01.040611 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m16:33:01.042559 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:33:01.044095 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/8131a6a4-4afd-4119-9c86-f62f2175a7a3
[0m16:33:02.340591 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/8131a6a4-4afd-4119-9c86-f62f2175a7a3', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/8131a6a4-4afd-4119-9c86-f62f2175a7a3/'
[0m16:33:05.282267 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m16:33:05.301556 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:33:06.528916 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:33:06.533013 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/b17288d7-f9ba-4eb9-bdf5-e16823e38e12',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m16:33:07.110902 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a92d0c73-b93c-48e6-9386-8646a2558852
[0m16:33:08.746618 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":300,"data_scanned_in_bytes":8044}
[0m16:33:08.749983 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m16:33:08.750538 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m16:33:08.999303 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9d132fcb-37ec-4a86-b84c-04c56461a3ed
[0m16:33:10.674867 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:33:10.684481 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m16:33:10.689352 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m16:33:10.690386 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":300,"data_scanned_in_bytes":8044}';
[0m16:33:10.918732 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4ef881cf-2b93-4038-a93b-fed85e96aaf6
[0m16:33:12.598539 [debug] [Thread-1 (]: SQL status: OK 300 in 2.0 seconds
[0m16:33:12.602820 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 16:32:57.939437 => 16:33:12.602438
[0m16:33:12.603528 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m16:33:12.605010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06ded882-16c3-4a40-ad80-a2296b71eeda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946ae250>]}
[0m16:33:12.606241 [info ] [Thread-1 (]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 300[0m in 14.71s]
[0m16:33:12.607159 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m16:33:12.620695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:12.621155 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m16:33:12.621403 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m16:33:12.624959 [info ] [MainThread]: 
[0m16:33:12.625591 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 33.26 seconds (93.26s).
[0m16:33:12.627806 [debug] [MainThread]: Command end result
[0m16:33:12.681984 [info ] [MainThread]: 
[0m16:33:12.683124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:12.684346 [info ] [MainThread]: 
[0m16:33:12.685030 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:33:12.696419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 94.54782, "process_user_time": 10.641098, "process_kernel_time": 1.182928, "process_mem_max_rss": "208712", "process_in_blocks": "4000", "process_out_blocks": "2979"}
[0m16:33:12.699343 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:12.699171 after 94.55 seconds
[0m16:33:12.699857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a09290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59e9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59e94d0>]}
[0m16:33:12.700176 [debug] [MainThread]: Flushing usage events
[0m17:02:20.283857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d1cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d17190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d1f910>]}


============================== 17:02:20.287808 | 529722f6-77e8-4014-a73b-bba5967a91ff ==============================
[0m17:02:20.287808 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:02:20.288805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:20.289139 [info ] [MainThread]: dbt version: 1.7.9
[0m17:02:20.289460 [info ] [MainThread]: python version: 3.11.14
[0m17:02:20.289800 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:02:20.290099 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m17:02:20.636598 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m17:02:20.637187 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m17:02:20.637598 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m17:02:20.637992 [info ] [MainThread]: adapter type: athena
[0m17:02:20.638270 [info ] [MainThread]: adapter version: 1.7.2
[0m17:02:20.691407 [info ] [MainThread]: Configuration:
[0m17:02:20.691996 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:02:20.692368 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:02:20.692677 [info ] [MainThread]: Required dependencies:
[0m17:02:20.692924 [debug] [MainThread]: Executing "git --help"
[0m17:02:20.704208 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:02:20.704623 [debug] [MainThread]: STDERR: "b''"
[0m17:02:20.704826 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:02:20.705021 [info ] [MainThread]: Connection:
[0m17:02:20.705327 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m17:02:20.705573 [info ] [MainThread]:   work_group: None
[0m17:02:20.705918 [info ] [MainThread]:   region_name: us-east-1
[0m17:02:20.706129 [info ] [MainThread]:   database: AwsDataCatalog
[0m17:02:20.706386 [info ] [MainThread]:   schema: silver
[0m17:02:20.706611 [info ] [MainThread]:   poll_interval: 1.0
[0m17:02:20.706887 [info ] [MainThread]:   aws_profile_name: None
[0m17:02:20.707152 [info ] [MainThread]:   aws_access_key_id: None
[0m17:02:20.707422 [info ] [MainThread]:   aws_secret_access_key: None
[0m17:02:20.707659 [info ] [MainThread]:   aws_session_token: None
[0m17:02:20.707915 [info ] [MainThread]:   endpoint_url: None
[0m17:02:20.708215 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m17:02:20.708557 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m17:02:20.708798 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m17:02:20.709085 [info ] [MainThread]:   debug_query_state: False
[0m17:02:20.709330 [info ] [MainThread]:   seed_s3_upload_args: None
[0m17:02:20.709557 [info ] [MainThread]:   lf_tags_database: None
[0m17:02:20.710138 [info ] [MainThread]:   spark_work_group: None
[0m17:02:20.710466 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:02:20.711370 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m17:02:20.711624 [debug] [MainThread]: Using athena connection "debug"
[0m17:02:20.712900 [debug] [MainThread]: On debug: select 1 as id
[0m17:02:20.713238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:02:21.520118 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 1ad88265-b423-4033-8a78-7424d919496b
[0m17:02:23.261938 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m17:02:23.268478 [debug] [MainThread]: On debug: Close
[0m17:02:23.269946 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:02:23.272424 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:02:23.275956 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.0175655, "process_user_time": 1.571853, "process_kernel_time": 0.79548, "process_mem_max_rss": "143984", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m17:02:23.277374 [debug] [MainThread]: Command `dbt debug` succeeded at 17:02:23.277091 after 3.02 seconds
[0m17:02:23.278415 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:02:23.283418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d62850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c22d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d25ed0>]}
[0m17:02:23.284761 [debug] [MainThread]: Flushing usage events
[0m17:02:28.675636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2023fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2023490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2023bd0>]}


============================== 17:02:28.677657 | edef355e-97f2-499c-be9a-cef4d185c86f ==============================
[0m17:02:28.677657 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:02:28.678052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:02:28.912465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edef355e-97f2-499c-be9a-cef4d185c86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1075950>]}
[0m17:02:28.965459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edef355e-97f2-499c-be9a-cef4d185c86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa20199d0>]}
[0m17:02:28.966048 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:02:28.972047 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:02:29.003817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m17:02:29.004311 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/openmeteo_bronze.sql
[0m17:02:29.004604 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/noaa_bronze.sql
[0m17:02:29.004829 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/eia_bronze.sql
[0m17:02:29.005067 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/sensor_bronze.sql
[0m17:02:29.005287 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/openweather_bronze.sql
[0m17:02:29.083125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edef355e-97f2-499c-be9a-cef4d185c86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0fa4610>]}
[0m17:02:29.090806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edef355e-97f2-499c-be9a-cef4d185c86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0e39010>]}
[0m17:02:29.091132 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:02:29.091437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edef355e-97f2-499c-be9a-cef4d185c86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0fa4610>]}
[0m17:02:29.092915 [info ] [MainThread]: 
[0m17:02:29.093712 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:02:29.095203 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:02:29.095537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:29.816696 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:02:29.821775 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver'
[0m17:02:29.822692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:31.324531 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:02:31.337826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edef355e-97f2-499c-be9a-cef4d185c86f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9856ab10>]}
[0m17:02:31.340084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:31.340755 [info ] [MainThread]: 
[0m17:02:31.347024 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m17:02:31.347859 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m17:02:31.349151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m17:02:31.349576 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m17:02:31.361834 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m17:02:31.363533 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 17:02:31.349899 => 17:02:31.363325
[0m17:02:31.363847 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m17:02:31.387006 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m17:02:31.388924 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m17:02:31.389460 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS float) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m17:02:31.390001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:32.021758 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID dccbb13b-8746-4a54-b091-aa0346673a8c
[0m17:02:39.635347 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID fe267436-0504-4098-a2a2-3a6f33542c22
[0m17:02:53.159716 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2d6a2bcc-f5d0-4c4e-b3f4-de1a024d065b
[0m17:03:18.733160 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 168ee33d-6e34-4dfc-bfd9-3bbb6433d3a3
[0m17:03:54.002974 [error] [MainThread]: CANCEL query list_AwsDataCatalog ............................................... [[31mCANCEL[0m]
[0m17:03:54.009790 [error] [MainThread]: CANCEL query model.silver.eia_bronze ........................................... [[31mCANCEL[0m]
[0m17:03:55.850963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:55.880397 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m17:03:55.882127 [debug] [MainThread]: Connection 'model.silver.eia_bronze' was left open.
[0m17:03:55.886231 [debug] [MainThread]: On model.silver.eia_bronze: Close
[0m17:03:55.896608 [info ] [MainThread]: 
[0m17:03:55.898384 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 26.80 seconds (86.80s).
[0m17:03:55.905413 [error] [MainThread]: Encountered an error:

[0m17:03:55.939346 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 272, in run_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:03:55.949800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 87.29455, "process_user_time": 2.10743, "process_kernel_time": 0.438208, "process_mem_max_rss": "186396", "process_in_blocks": "272", "process_out_blocks": "1945", "command_success": false}
[0m17:03:55.951187 [debug] [MainThread]: Command `dbt run` failed at 17:03:55.950890 after 87.30 seconds
[0m17:03:55.952408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e5f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7299610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2019990>]}
[0m17:03:55.953532 [debug] [MainThread]: Flushing usage events
[0m17:25:08.770441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8645bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86909250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8644f350>]}


============================== 17:25:08.774840 | 168d1a90-456d-48a3-ac33-95394f49d3d2 ==============================
[0m17:25:08.774840 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:25:08.775683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:25:08.775990 [info ] [MainThread]: dbt version: 1.7.9
[0m17:25:08.776279 [info ] [MainThread]: python version: 3.11.14
[0m17:25:08.776569 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:25:08.776824 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m17:25:09.089877 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m17:25:09.090501 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m17:25:09.090854 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m17:25:09.091278 [info ] [MainThread]: adapter type: athena
[0m17:25:09.091567 [info ] [MainThread]: adapter version: 1.7.2
[0m17:25:09.134177 [info ] [MainThread]: Configuration:
[0m17:25:09.134610 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:25:09.135041 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:25:09.135310 [info ] [MainThread]: Required dependencies:
[0m17:25:09.135728 [debug] [MainThread]: Executing "git --help"
[0m17:25:09.153253 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:25:09.153749 [debug] [MainThread]: STDERR: "b''"
[0m17:25:09.153970 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:25:09.154244 [info ] [MainThread]: Connection:
[0m17:25:09.154615 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m17:25:09.154904 [info ] [MainThread]:   work_group: None
[0m17:25:09.155174 [info ] [MainThread]:   region_name: us-east-1
[0m17:25:09.155420 [info ] [MainThread]:   database: AwsDataCatalog
[0m17:25:09.155758 [info ] [MainThread]:   schema: silver
[0m17:25:09.156017 [info ] [MainThread]:   poll_interval: 1.0
[0m17:25:09.156227 [info ] [MainThread]:   aws_profile_name: None
[0m17:25:09.156467 [info ] [MainThread]:   aws_access_key_id: None
[0m17:25:09.156767 [info ] [MainThread]:   aws_secret_access_key: None
[0m17:25:09.157020 [info ] [MainThread]:   aws_session_token: None
[0m17:25:09.157264 [info ] [MainThread]:   endpoint_url: None
[0m17:25:09.157482 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m17:25:09.157728 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m17:25:09.157969 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m17:25:09.158223 [info ] [MainThread]:   debug_query_state: False
[0m17:25:09.158450 [info ] [MainThread]:   seed_s3_upload_args: None
[0m17:25:09.158684 [info ] [MainThread]:   lf_tags_database: None
[0m17:25:09.158948 [info ] [MainThread]:   spark_work_group: None
[0m17:25:09.159233 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:25:09.159690 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m17:25:09.159905 [debug] [MainThread]: Using athena connection "debug"
[0m17:25:09.160075 [debug] [MainThread]: On debug: select 1 as id
[0m17:25:09.160250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:09.912656 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID f4549250-3b97-4b15-b37b-c83cd07b6b95
[0m17:25:11.724005 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m17:25:11.728550 [debug] [MainThread]: On debug: Close
[0m17:25:11.729708 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:25:11.730527 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:25:11.733279 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.9843802, "process_user_time": 1.478738, "process_kernel_time": 0.921083, "process_mem_max_rss": "143996", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m17:25:11.734402 [debug] [MainThread]: Command `dbt debug` succeeded at 17:25:11.734150 after 2.99 seconds
[0m17:25:11.735325 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:25:11.740072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8646f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854e5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853f44d0>]}
[0m17:25:11.741064 [debug] [MainThread]: Flushing usage events
[0m17:25:16.064856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e82690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c1ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c1e410>]}


============================== 17:25:16.067112 | 8e82016b-5e29-40b9-a9c1-08cf9bc77779 ==============================
[0m17:25:16.067112 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:25:16.067689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:16.335090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b45c50>]}
[0m17:25:16.376432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c75850>]}
[0m17:25:16.377036 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:25:16.382347 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:25:16.412760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m17:25:16.413335 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/noaa_bronze.sql
[0m17:25:16.413595 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/eia_bronze.sql
[0m17:25:16.413807 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/openmeteo_bronze.sql
[0m17:25:16.414059 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/sensor_bronze.sql
[0m17:25:16.414282 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/openweather_bronze.sql
[0m17:25:16.490549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96855c50>]}
[0m17:25:16.499590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96934410>]}
[0m17:25:16.500085 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:25:16.500493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9680a010>]}
[0m17:25:16.501955 [info ] [MainThread]: 
[0m17:25:16.502638 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:25:16.503719 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:25:16.504034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:17.516808 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:25:17.523228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m17:25:17.524200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:19.050023 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:25:19.057050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968bd4d0>]}
[0m17:25:19.060193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:19.061390 [info ] [MainThread]: 
[0m17:25:19.067129 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m17:25:19.068657 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m17:25:19.070428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m17:25:19.071132 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m17:25:19.084225 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m17:25:19.086582 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 17:25:19.071681 => 17:25:19.086241
[0m17:25:19.087116 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m17:25:19.112346 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m17:25:19.114097 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m17:25:19.114669 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS float) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m17:25:19.115186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:19.716124 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 436e5954-208e-48b5-ad3a-1e61080ac84b
[0m17:25:27.274432 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d2255924-f1fe-4a60-bd71-9b9a1b9a759a
[0m17:25:40.809776 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b254f980-a79b-4422-a426-8b9c716fdd32
[0m17:26:06.325110 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 30c446c6-5629-453b-973e-be8bc2767c81
[0m17:26:56.249541 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID eefc0c19-7623-4bd8-a6aa-164e50218e54
[0m17:28:34.415554 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ada309e3-765b-4359-a309-d47720438f63
[0m17:28:35.699744 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS float) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m17:28:35.702021 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 17:25:19.087389 => 17:28:35.701415
[0m17:28:35.703657 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m17:28:35.727443 [debug] [Thread-1 (]: Runtime Error in model eia_bronze (models/bronze/eia_bronze.sql)
  line 8:3: Unknown type: float
[0m17:28:35.730204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c55c4d0>]}
[0m17:28:35.733217 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model silver.eia_bronze ........................ [[31mERROR[0m in 196.66s]
[0m17:28:35.734893 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m17:28:35.736353 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m17:28:35.740848 [info ] [Thread-1 (]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m17:28:35.742870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m17:28:35.743898 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m17:28:35.761051 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m17:28:35.767029 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 17:28:35.744745 => 17:28:35.766684
[0m17:28:35.767920 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m17:28:35.775477 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m17:28:35.781595 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m17:28:35.782068 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m17:28:35.782389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:36.490314 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ce7e239a-4d50-43df-bc2c-c4509051ad4d
[0m17:28:38.208546 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:28:39.634944 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['18', '17', '16', '15', '14']
[0m17:28:39.637404 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['14']
[0m17:28:40.225941 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 14 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m17:28:40.255459 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 17:28:35.768674 => 17:28:40.254052
[0m17:28:40.256959 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m17:28:40.259881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eeeba90>]}
[0m17:28:40.262424 [info ] [Thread-1 (]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.52s]
[0m17:28:40.263801 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m17:28:40.264864 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m17:28:40.267048 [info ] [Thread-1 (]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m17:28:40.276922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m17:28:40.278048 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m17:28:40.285623 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m17:28:40.292766 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 17:28:40.278568 => 17:28:40.291337
[0m17:28:40.295211 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m17:28:40.306675 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m17:28:40.307910 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m17:28:40.308223 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m17:28:40.308602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:41.140686 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1cea4ad2-dbc0-4b5c-8b74-8fc4179c65bd
[0m17:28:42.840664 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m17:28:44.202906 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['18', '17', '16', '15', '14']
[0m17:28:44.209834 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['14']
[0m17:28:44.806660 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 14 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m17:28:44.816128 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 17:28:40.296407 => 17:28:44.815652
[0m17:28:44.817739 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m17:28:44.820585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c55ca90>]}
[0m17:28:44.823614 [info ] [Thread-1 (]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.55s]
[0m17:28:44.824803 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m17:28:44.825667 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m17:28:44.827269 [info ] [Thread-1 (]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m17:28:44.836902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m17:28:44.837795 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m17:28:44.851493 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m17:28:44.855211 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 17:28:44.838715 => 17:28:44.854376
[0m17:28:44.856295 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m17:28:44.861656 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m17:28:44.863505 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m17:28:44.863964 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m17:28:44.864287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:45.492040 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1bbbf550-7a77-439b-aaf6-354ce3e21dab
[0m17:28:47.504130 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m17:28:48.979669 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['18', '17', '16', '15', '14']
[0m17:28:48.980991 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['14']
[0m17:28:49.569987 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 14 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m17:28:49.575757 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 17:28:44.856768 => 17:28:49.575479
[0m17:28:49.576554 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m17:28:49.577522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5feb10>]}
[0m17:28:49.578503 [info ] [Thread-1 (]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.75s]
[0m17:28:49.579561 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m17:28:49.580254 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m17:28:49.581156 [info ] [Thread-1 (]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m17:28:49.585025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m17:28:49.585881 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m17:28:49.591174 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m17:28:49.593756 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 17:28:49.586407 => 17:28:49.593261
[0m17:28:49.594481 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m17:28:49.607114 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m17:28:49.616274 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m17:28:49.620757 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m17:28:49.623018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:50.236902 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4ec16a0d-685a-4f13-b23a-2c3ad9e9e351
[0m17:28:51.914215 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:28:53.201588 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['17', '16', '15', '14', '13']
[0m17:28:53.203877 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['13']
[0m17:28:53.806183 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 13 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m17:28:53.817503 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 17:28:49.595128 => 17:28:53.816642
[0m17:28:53.819047 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m17:28:53.822743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5fead0>]}
[0m17:28:53.825564 [info ] [Thread-1 (]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.24s]
[0m17:28:53.827708 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m17:28:53.831570 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m17:28:53.836519 [info ] [Thread-1 (]: 6 of 10 SKIP relation silver.eia_silver ........................................ [[33mSKIP[0m]
[0m17:28:53.837739 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m17:28:53.838823 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m17:28:53.839742 [info ] [Thread-1 (]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m17:28:53.846170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.noaa_silver)
[0m17:28:53.847023 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m17:28:53.858799 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m17:28:53.862031 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 17:28:53.847386 => 17:28:53.861387
[0m17:28:53.863038 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m17:28:53.924339 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:28:53.925007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:54.701985 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:28:54.702780 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/b0847498-688d-418a-9a27-f6864505e916',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m17:28:55.293062 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5ebc6d71-e9f3-46d7-b485-1ffdf138f8c1
[0m17:28:58.056980 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m17:28:58.082625 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m17:28:58.083807 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m17:28:58.329660 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6d08d3aa-0bbb-4e93-9015-ca8f32655840
[0m17:28:59.928375 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:28:59.936667 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m17:28:59.940069 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m17:28:59.940788 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m17:29:00.142081 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 25099722-ae7e-4ba4-99ca-23173fb2a2f8
[0m17:29:01.805418 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m17:29:01.815700 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 17:28:53.863527 => 17:29:01.815011
[0m17:29:01.817114 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m17:29:01.819967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fd6790>]}
[0m17:29:01.822573 [info ] [Thread-1 (]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 7.98s]
[0m17:29:01.824141 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m17:29:01.825730 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m17:29:01.827210 [info ] [Thread-1 (]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m17:29:01.835292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m17:29:01.836279 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m17:29:01.844840 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m17:29:01.846784 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 17:29:01.836601 => 17:29:01.846319
[0m17:29:01.847407 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m17:29:01.864350 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:29:01.865070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:02.466662 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:29:02.468272 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/40736ab4-1b15-4179-8cfd-c38810f2ad6e',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m17:29:03.013515 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5261e879-b0b4-4dd9-98a0-a27060195560
[0m17:29:05.818226 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m17:29:05.823594 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m17:29:05.824292 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m17:29:06.089822 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a9fafdb7-470e-4ec1-ae7e-f4e2a69c7b01
[0m17:29:07.898339 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:29:07.904980 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m17:29:07.907492 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m17:29:07.908121 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m17:29:08.120071 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7412ca9b-4755-4744-9fd1-3aca7e90038b
[0m17:29:09.878064 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m17:29:09.920630 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 17:29:01.847825 => 17:29:09.919390
[0m17:29:09.925219 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m17:29:09.933745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fd6b50>]}
[0m17:29:09.943394 [info ] [Thread-1 (]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 8.10s]
[0m17:29:09.946878 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m17:29:09.948649 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m17:29:09.952215 [info ] [Thread-1 (]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m17:29:09.972090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m17:29:09.973834 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m17:29:09.981301 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m17:29:09.983295 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 17:29:09.974057 => 17:29:09.982888
[0m17:29:09.983852 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m17:29:09.987832 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:29:09.988443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:11.503378 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:29:11.504523 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/0518b411-6a0c-4594-ac51-bd44417c62cb',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m17:29:12.042684 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 09e9c153-d7cc-4d66-a9f7-427867568714
[0m17:29:14.822583 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m17:29:14.832300 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m17:29:14.833208 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m17:29:15.099816 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ba21b985-2778-46b6-b028-8a4778dbfda2
[0m17:29:16.767462 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:29:16.835280 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m17:29:16.860075 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m17:29:16.863817 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m17:29:17.154184 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6b678d6b-8dd5-4e87-801b-43fe76b8003e
[0m17:29:18.850379 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m17:29:18.859992 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 17:29:09.984133 => 17:29:18.859416
[0m17:29:18.861080 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m17:29:18.863411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b6ab10>]}
[0m17:29:18.869815 [info ] [Thread-1 (]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 8.91s]
[0m17:29:18.871511 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m17:29:18.872562 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m17:29:18.873851 [info ] [Thread-1 (]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m17:29:18.878641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m17:29:18.879099 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m17:29:18.886432 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m17:29:18.887877 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 17:29:18.879369 => 17:29:18.887716
[0m17:29:18.888235 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m17:29:18.892927 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:29:18.893462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:29:19.487070 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:29:19.488094 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/6fc4f1d5-e39e-4758-be31-1721dd39baeb',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m17:29:20.028098 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7b30f08d-5355-4182-a875-414431079d22
[0m17:29:22.996370 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m17:29:23.000741 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m17:29:23.001951 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m17:29:23.399979 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 26d07267-27a6-4c60-b123-d4572119f69f
[0m17:29:25.034799 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:29:25.037532 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m17:29:25.039447 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m17:29:25.039949 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m17:29:25.230546 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 824f2a0a-3ec2-4e3d-b386-3a51254cf7bc
[0m17:29:26.986080 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m17:29:27.028325 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 17:29:18.888552 => 17:29:27.027077
[0m17:29:27.030838 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m17:29:27.043371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e82016b-5e29-40b9-a9c1-08cf9bc77779', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c3e550>]}
[0m17:29:27.046960 [info ] [Thread-1 (]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 8.17s]
[0m17:29:27.049645 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m17:29:27.069912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:27.076874 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m17:29:27.102374 [info ] [MainThread]: 
[0m17:29:27.104025 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 4 minutes and 10.60 seconds (250.60s).
[0m17:29:27.109387 [debug] [MainThread]: Command end result
[0m17:29:27.173664 [info ] [MainThread]: 
[0m17:29:27.178436 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:29:27.180602 [info ] [MainThread]: 
[0m17:29:27.182482 [error] [MainThread]:   Runtime Error in model eia_bronze (models/bronze/eia_bronze.sql)
  line 8:3: Unknown type: float
[0m17:29:27.183364 [info ] [MainThread]: 
[0m17:29:27.184801 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=1 TOTAL=10
[0m17:29:27.204370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 251.15855, "process_user_time": 6.76664, "process_kernel_time": 0.85579, "process_mem_max_rss": "189712", "process_in_blocks": "552", "process_out_blocks": "2981", "command_success": false}
[0m17:29:27.207008 [debug] [MainThread]: Command `dbt run` failed at 17:29:27.206296 after 251.17 seconds
[0m17:29:27.208913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce99610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce99890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968b9410>]}
[0m17:29:27.211195 [debug] [MainThread]: Flushing usage events
[0m17:31:25.032214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93e71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa44d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9e05450>]}


============================== 17:31:25.034969 | 6390c9ce-0059-4fc0-8bea-15af5633ca12 ==============================
[0m17:31:25.034969 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:31:25.035918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:25.321357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6390c9ce-0059-4fc0-8bea-15af5633ca12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa82955d0>]}
[0m17:31:25.367152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6390c9ce-0059-4fc0-8bea-15af5633ca12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8379fd0>]}
[0m17:31:25.367932 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:31:25.374531 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:31:25.400194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:31:25.400545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:31:25.403941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6390c9ce-0059-4fc0-8bea-15af5633ca12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8259910>]}
[0m17:31:25.412832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6390c9ce-0059-4fc0-8bea-15af5633ca12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa830f890>]}
[0m17:31:25.413162 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:31:25.413439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6390c9ce-0059-4fc0-8bea-15af5633ca12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa838efd0>]}
[0m17:31:25.414910 [info ] [MainThread]: 
[0m17:31:25.415484 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:31:25.416443 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:31:25.416739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:26.045918 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:31:26.048266 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver'
[0m17:31:26.048627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:27.754785 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:31:27.762394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6390c9ce-0059-4fc0-8bea-15af5633ca12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa82742d0>]}
[0m17:31:27.770097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:27.771059 [info ] [MainThread]: 
[0m17:31:27.775483 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m17:31:27.776769 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m17:31:27.778543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m17:31:27.779600 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m17:31:27.793320 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m17:31:27.795947 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 17:31:27.780569 => 17:31:27.795321
[0m17:31:27.796589 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m17:31:27.819180 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m17:31:27.820512 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m17:31:27.820840 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS float) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m17:31:27.821112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:28.444200 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c609ba1c-6ba4-4e1a-954e-0e1eb914ea19
[0m17:31:36.005617 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 515cd002-bc42-4442-a309-e8f47e6f4b41
[0m17:31:49.532579 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 01930eb8-d6d7-4a0f-a859-223bac8c91e9
[0m17:32:06.223777 [error] [MainThread]: CANCEL query list_AwsDataCatalog ............................................... [[31mCANCEL[0m]
[0m17:32:06.229608 [error] [MainThread]: CANCEL query model.silver.eia_bronze ........................................... [[31mCANCEL[0m]
[0m17:32:06.896962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:06.901161 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m17:32:06.905468 [debug] [MainThread]: Connection 'model.silver.eia_bronze' was left open.
[0m17:32:06.908394 [debug] [MainThread]: On model.silver.eia_bronze: Close
[0m17:32:06.938521 [info ] [MainThread]: 
[0m17:32:06.951639 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 41.52 seconds (41.52s).
[0m17:32:06.955318 [error] [MainThread]: Encountered an error:

[0m17:32:07.058641 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 272, in run_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:32:07.079069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 42.068348, "process_user_time": 2.012889, "process_kernel_time": 0.493375, "process_mem_max_rss": "182584", "process_out_blocks": "1001", "command_success": false, "process_in_blocks": "0"}
[0m17:32:07.087466 [debug] [MainThread]: Command `dbt run` failed at 17:32:07.086546 after 42.08 seconds
[0m17:32:07.096231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae629610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae628a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae629890>]}
[0m17:32:07.105623 [debug] [MainThread]: Flushing usage events
[0m17:32:29.735692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd5aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd5a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd5b910>]}


============================== 17:32:29.737819 | f160140f-b171-4d05-8472-864fe46489a7 ==============================
[0m17:32:29.737819 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:32:29.738230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:32:29.738585 [info ] [MainThread]: dbt version: 1.7.9
[0m17:32:29.738851 [info ] [MainThread]: python version: 3.11.14
[0m17:32:29.739193 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m17:32:29.739483 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m17:32:29.950189 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m17:32:29.950631 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m17:32:29.950961 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m17:32:29.951377 [info ] [MainThread]: adapter type: athena
[0m17:32:29.951645 [info ] [MainThread]: adapter version: 1.7.2
[0m17:32:29.987300 [info ] [MainThread]: Configuration:
[0m17:32:29.987769 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:32:29.988126 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:32:29.988405 [info ] [MainThread]: Required dependencies:
[0m17:32:29.988746 [debug] [MainThread]: Executing "git --help"
[0m17:32:29.991710 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:32:29.992077 [debug] [MainThread]: STDERR: "b''"
[0m17:32:29.992286 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:32:29.992519 [info ] [MainThread]: Connection:
[0m17:32:29.992816 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m17:32:29.993253 [info ] [MainThread]:   work_group: None
[0m17:32:29.993534 [info ] [MainThread]:   region_name: us-east-1
[0m17:32:29.993798 [info ] [MainThread]:   database: AwsDataCatalog
[0m17:32:29.994109 [info ] [MainThread]:   schema: silver
[0m17:32:29.994403 [info ] [MainThread]:   poll_interval: 1.0
[0m17:32:29.994671 [info ] [MainThread]:   aws_profile_name: None
[0m17:32:29.994919 [info ] [MainThread]:   aws_access_key_id: None
[0m17:32:29.995185 [info ] [MainThread]:   aws_secret_access_key: None
[0m17:32:29.995473 [info ] [MainThread]:   aws_session_token: None
[0m17:32:29.995721 [info ] [MainThread]:   endpoint_url: None
[0m17:32:29.995954 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m17:32:29.996211 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m17:32:29.996445 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m17:32:29.996745 [info ] [MainThread]:   debug_query_state: False
[0m17:32:29.997003 [info ] [MainThread]:   seed_s3_upload_args: None
[0m17:32:29.997396 [info ] [MainThread]:   lf_tags_database: None
[0m17:32:29.997688 [info ] [MainThread]:   spark_work_group: None
[0m17:32:29.998042 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:32:29.998501 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m17:32:29.998722 [debug] [MainThread]: Using athena connection "debug"
[0m17:32:29.998895 [debug] [MainThread]: On debug: select 1 as id
[0m17:32:29.999061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:30.664632 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 4e83f010-6234-4024-8d0c-b4c46095c33b
[0m17:32:32.420846 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m17:32:32.424706 [debug] [MainThread]: On debug: Close
[0m17:32:32.425860 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:32:32.427071 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:32:32.429963 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.7164464, "process_user_time": 1.239244, "process_kernel_time": 0.213181, "process_mem_max_rss": "144248", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m17:32:32.430924 [debug] [MainThread]: Command `dbt debug` succeeded at 17:32:32.430765 after 2.72 seconds
[0m17:32:32.431696 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:32:32.438466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed23f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8edd9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd70750>]}
[0m17:32:32.439445 [debug] [MainThread]: Flushing usage events
[0m17:32:38.509086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8019510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8301250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa801a7d0>]}


============================== 17:32:38.510987 | 210c526e-0260-48ed-8d71-485fbc25b45c ==============================
[0m17:32:38.510987 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:32:38.511417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:32:38.769329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '210c526e-0260-48ed-8d71-485fbc25b45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa801aa90>]}
[0m17:32:38.809639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '210c526e-0260-48ed-8d71-485fbc25b45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa705d010>]}
[0m17:32:38.810128 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:32:38.816604 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:32:38.842936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:38.843372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:38.847120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '210c526e-0260-48ed-8d71-485fbc25b45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6d02690>]}
[0m17:32:38.857857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '210c526e-0260-48ed-8d71-485fbc25b45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6ed78d0>]}
[0m17:32:38.858321 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:32:38.858806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '210c526e-0260-48ed-8d71-485fbc25b45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa703db50>]}
[0m17:32:38.860795 [info ] [MainThread]: 
[0m17:32:38.861438 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:32:38.862434 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:32:38.862734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:39.690398 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:32:39.700045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m17:32:39.701700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:41.136335 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:32:41.142241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '210c526e-0260-48ed-8d71-485fbc25b45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59a2b10>]}
[0m17:32:41.143982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:41.144733 [info ] [MainThread]: 
[0m17:32:41.148009 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m17:32:41.148832 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m17:32:41.149891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m17:32:41.150409 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m17:32:41.161728 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m17:32:41.163984 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 17:32:41.150805 => 17:32:41.163747
[0m17:32:41.164462 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m17:32:41.187991 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m17:32:41.189510 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m17:32:41.189852 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS float) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m17:32:41.190175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:41.783040 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d3cef1ce-76a4-457d-bf14-6a22e7b2e25b
[0m17:32:49.332324 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1e0a4ce5-8e4b-4825-bcf7-dcc361ba47d3
[0m17:33:02.909927 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6733900f-6e49-41f4-a1df-265c416af59f
[0m17:33:28.486620 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bdbeb030-6e5e-4bed-8fc1-448727e20caa
[0m17:34:18.487990 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 619e3906-dd35-4112-9a01-43bad601f121
[0m17:34:35.733405 [error] [MainThread]: CANCEL query model.silver.eia_bronze ........................................... [[31mCANCEL[0m]
[0m17:34:35.800631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:35.801591 [debug] [MainThread]: Connection 'model.silver.eia_bronze' was left open.
[0m17:34:35.802379 [debug] [MainThread]: On model.silver.eia_bronze: Close
[0m17:34:35.806427 [info ] [MainThread]: 
[0m17:34:35.808728 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 56.94 seconds (116.94s).
[0m17:34:35.810893 [error] [MainThread]: Encountered an error:

[0m17:34:35.820779 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 272, in run_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:34:35.828434 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 117.33993, "process_user_time": 2.06316, "process_kernel_time": 0.30762, "process_mem_max_rss": "168452", "process_out_blocks": "1001", "command_success": false, "process_in_blocks": "0"}
[0m17:34:35.829481 [debug] [MainThread]: Command `dbt run` failed at 17:34:35.829279 after 117.34 seconds
[0m17:34:35.830463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8282710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8301290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad299890>]}
[0m17:34:35.832628 [debug] [MainThread]: Flushing usage events
[0m17:34:44.546777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c042d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8482f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8482ed50>]}


============================== 17:34:44.548744 | ab953b5b-7cd5-488d-b761-c1f325135619 ==============================
[0m17:34:44.548744 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:34:44.549106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:34:44.825556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83895910>]}
[0m17:34:44.872057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839f1050>]}
[0m17:34:44.872814 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:34:44.878607 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m17:34:44.907150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:44.907762 [debug] [MainThread]: Partial parsing: updated file: silver://models/bronze/eia_bronze.sql
[0m17:34:44.987176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836063d0>]}
[0m17:34:44.998618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83760290>]}
[0m17:34:44.999024 [info ] [MainThread]: Found 10 models, 4 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m17:34:44.999367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff835c8690>]}
[0m17:34:45.000828 [info ] [MainThread]: 
[0m17:34:45.001529 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:34:45.002731 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:34:45.003096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:45.697745 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:34:45.702854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m17:34:45.703898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:47.348997 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:34:47.355387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84807950>]}
[0m17:34:47.357227 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:34:47.357977 [info ] [MainThread]: 
[0m17:34:47.362423 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m17:34:47.363280 [info ] [Thread-1 (]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m17:34:47.364185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m17:34:47.364870 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m17:34:47.373129 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m17:34:47.375877 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 17:34:47.365269 => 17:34:47.375520
[0m17:34:47.376361 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m17:34:47.418615 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m17:34:47.423744 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m17:34:47.426347 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m17:34:47.428412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:48.161898 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e83a133c-0867-4b12-b66c-7f38107fc504
[0m17:34:49.878964 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:34:51.343951 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['18', '17', '16', '15', '14']
[0m17:34:51.345302 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['14']
[0m17:34:51.999669 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 14 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m17:34:52.011626 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 17:34:47.376650 => 17:34:52.011285
[0m17:34:52.012472 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m17:34:52.013665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83935150>]}
[0m17:34:52.014653 [info ] [Thread-1 (]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.65s]
[0m17:34:52.015764 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m17:34:52.016473 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m17:34:52.017521 [info ] [Thread-1 (]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m17:34:52.020051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m17:34:52.020722 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m17:34:52.024600 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m17:34:52.027049 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 17:34:52.021151 => 17:34:52.026818
[0m17:34:52.027579 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m17:34:52.030990 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m17:34:52.032244 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m17:34:52.032770 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m17:34:52.033272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:52.768675 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID efd8aad9-2a46-4ccf-932a-a35382cbcc0f
[0m17:34:54.524879 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:34:55.922441 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['19', '18', '17', '16', '15']
[0m17:34:55.926978 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['15']
[0m17:34:56.536055 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 15 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m17:34:56.545881 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 17:34:52.027961 => 17:34:56.545118
[0m17:34:56.547261 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m17:34:56.549843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8319b710>]}
[0m17:34:56.551923 [info ] [Thread-1 (]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.53s]
[0m17:34:56.553576 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m17:34:56.554564 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m17:34:56.556049 [info ] [Thread-1 (]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m17:34:56.559303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m17:34:56.560047 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m17:34:56.567033 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m17:34:56.569109 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 17:34:56.560510 => 17:34:56.568863
[0m17:34:56.569697 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m17:34:56.575829 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m17:34:56.577316 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m17:34:56.577790 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m17:34:56.578239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:57.442921 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 75417cd9-329f-4e47-bcd8-eb7c9e02df2b
[0m17:34:59.238189 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m17:35:00.610161 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['19', '18', '17', '16', '15']
[0m17:35:00.614250 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['15']
[0m17:35:01.190245 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 15 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m17:35:01.194873 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 17:34:56.570041 => 17:35:01.194498
[0m17:35:01.195453 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m17:35:01.196794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff834f6c90>]}
[0m17:35:01.198046 [info ] [Thread-1 (]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.64s]
[0m17:35:01.199188 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m17:35:01.199982 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m17:35:01.201355 [info ] [Thread-1 (]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m17:35:01.203244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m17:35:01.203690 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m17:35:01.211638 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m17:35:01.213156 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 17:35:01.203999 => 17:35:01.212984
[0m17:35:01.213468 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m17:35:01.216580 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m17:35:01.217514 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m17:35:01.217853 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m17:35:01.218194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:01.900646 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5b72e339-0cd6-43a8-96da-60873c068a9c
[0m17:35:03.626842 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:35:05.026764 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['19', '18', '17', '16', '15']
[0m17:35:05.030059 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['15']
[0m17:35:05.615840 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 15 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m17:35:05.619922 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 17:35:01.213699 => 17:35:05.619625
[0m17:35:05.620712 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m17:35:05.621916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808b7e90>]}
[0m17:35:05.622832 [info ] [Thread-1 (]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.42s]
[0m17:35:05.623889 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m17:35:05.624591 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m17:35:05.625469 [info ] [Thread-1 (]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m17:35:05.628134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m17:35:05.628777 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m17:35:05.632602 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m17:35:05.634190 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 17:35:05.629199 => 17:35:05.633913
[0m17:35:05.634719 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m17:35:05.637956 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m17:35:05.639814 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m17:35:05.640393 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m17:35:05.640926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:06.308507 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a47f85b1-a499-413b-a696-6adfccd838da
[0m17:35:08.048914 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:35:09.438526 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['18', '17', '16', '15', '14']
[0m17:35:09.440625 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['14']
[0m17:35:10.010262 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 14 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m17:35:10.016560 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 17:35:05.635066 => 17:35:10.015857
[0m17:35:10.017429 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m17:35:10.019474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff795056d0>]}
[0m17:35:10.021251 [info ] [Thread-1 (]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.39s]
[0m17:35:10.022648 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m17:35:10.023549 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m17:35:10.025129 [info ] [Thread-1 (]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m17:35:10.027849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m17:35:10.028399 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m17:35:10.036053 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m17:35:10.037988 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 17:35:10.028755 => 17:35:10.037802
[0m17:35:10.038383 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m17:35:10.080414 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:35:10.081046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:10.784998 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:35:10.787099 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/69818e29-dbce-40d9-bcd5-ba3eaebfacaa',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m17:35:11.374901 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6944956f-8f5a-4759-8cca-0779be8b885f
[0m17:35:14.250436 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m17:35:14.259306 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m17:35:14.260179 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m17:35:14.543601 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bc50b2c9-d51a-4efa-9389-c26e856423d8
[0m17:35:16.185767 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:35:16.190636 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m17:35:16.194683 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m17:35:16.195470 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m17:35:16.401359 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 91c15e31-7ada-45a2-80ab-1f4015f80c5d
[0m17:35:18.153055 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m17:35:18.178709 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 17:35:10.038671 => 17:35:18.177896
[0m17:35:18.180304 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m17:35:18.183525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a022d0>]}
[0m17:35:18.185822 [info ] [Thread-1 (]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 8.16s]
[0m17:35:18.187606 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m17:35:18.188805 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m17:35:18.190282 [info ] [Thread-1 (]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m17:35:18.196249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m17:35:18.197225 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m17:35:18.205084 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m17:35:18.207967 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 17:35:18.197597 => 17:35:18.207534
[0m17:35:18.208785 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m17:35:18.218213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:19.616823 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m17:35:19.617855 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:35:19.620286 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:35:20.906461 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m17:35:20.907603 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:35:20.908355 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/b0847498-688d-418a-9a27-f6864505e916
[0m17:35:22.396457 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/b0847498-688d-418a-9a27-f6864505e916', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/b0847498-688d-418a-9a27-f6864505e916/'
[0m17:35:25.374455 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m17:35:25.376137 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:35:26.648795 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:35:26.650147 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/dc5cf7ea-d230-418e-9de8-ab753f9a06c5',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m17:35:27.245559 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a533daa8-5651-4471-bf2e-d76ca0e6e3f5
[0m17:35:30.072347 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m17:35:30.075980 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m17:35:30.076435 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m17:35:30.381581 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 91db81e3-8cc2-4944-8c3b-7c4d4405bd5d
[0m17:35:32.084931 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:35:32.093271 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m17:35:32.097109 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m17:35:32.097906 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m17:35:32.304528 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 376cba34-1a89-4369-9ad5-539c4ee9d5b7
[0m17:35:34.018501 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m17:35:34.021642 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 17:35:18.209234 => 17:35:34.021291
[0m17:35:34.022599 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m17:35:34.024288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a01590>]}
[0m17:35:34.025510 [info ] [Thread-1 (]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 15.83s]
[0m17:35:34.026253 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m17:35:34.026825 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m17:35:34.027573 [info ] [Thread-1 (]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m17:35:34.029415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m17:35:34.029786 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m17:35:34.042518 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m17:35:34.046471 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 17:35:34.029969 => 17:35:34.046182
[0m17:35:34.046852 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m17:35:34.049790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:35.439182 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m17:35:35.441374 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:35:35.442801 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:35:36.914874 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m17:35:36.916604 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:35:36.920165 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/40736ab4-1b15-4179-8cfd-c38810f2ad6e
[0m17:35:38.575523 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/40736ab4-1b15-4179-8cfd-c38810f2ad6e', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/40736ab4-1b15-4179-8cfd-c38810f2ad6e/'
[0m17:35:41.731500 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m17:35:41.736377 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:35:43.019140 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:35:43.022374 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/7382db4b-7b37-4f5e-ab39-29f0c9daaa76',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m17:35:43.668267 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2d375e1a-c105-4385-8e75-129a58699166
[0m17:35:46.470919 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m17:35:46.473892 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m17:35:46.474420 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m17:35:46.760499 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6f82851a-6dc7-4b55-883c-9e0ee7aff03f
[0m17:35:48.435946 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:35:48.439993 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m17:35:48.442286 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m17:35:48.442691 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m17:35:48.631747 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f53d3544-a01d-417b-9746-4c25dbf2287a
[0m17:35:50.385990 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m17:35:50.397393 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 17:35:34.047045 => 17:35:50.396197
[0m17:35:50.398794 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m17:35:50.402136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839dc5d0>]}
[0m17:35:50.404682 [info ] [Thread-1 (]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 16.37s]
[0m17:35:50.406229 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m17:35:50.409964 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m17:35:50.413139 [info ] [Thread-1 (]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m17:35:50.417786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m17:35:50.418506 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m17:35:50.430426 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m17:35:50.432607 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 17:35:50.419049 => 17:35:50.432296
[0m17:35:50.433117 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m17:35:50.439647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:51.816136 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m17:35:51.816957 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:35:51.817859 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:35:53.067552 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m17:35:53.069090 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:35:53.069918 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/0518b411-6a0c-4594-ac51-bd44417c62cb
[0m17:35:53.754264 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/0518b411-6a0c-4594-ac51-bd44417c62cb', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/0518b411-6a0c-4594-ac51-bd44417c62cb/'
[0m17:35:55.979505 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m17:35:55.986871 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:35:56.714943 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:35:56.716905 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/9945cb13-a5ff-4a78-b312-665687688055',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m17:35:57.311118 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cd5dd4bd-1978-4380-9688-83ee03f2e21c
[0m17:36:00.126861 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m17:36:00.134607 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m17:36:00.135368 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m17:36:00.392019 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d2bec846-1158-4a2b-94ff-62b0f1910f32
[0m17:36:02.116057 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:36:02.124249 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m17:36:02.127845 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m17:36:02.128620 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m17:36:02.357225 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cafeb9cd-8f6b-4784-a7a2-d90f622b7191
[0m17:36:04.088595 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m17:36:04.092529 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 17:35:50.433423 => 17:36:04.092145
[0m17:36:04.093121 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m17:36:04.094483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83791690>]}
[0m17:36:04.095762 [info ] [Thread-1 (]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 13.68s]
[0m17:36:04.098192 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m17:36:04.099279 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m17:36:04.102295 [info ] [Thread-1 (]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m17:36:04.104839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m17:36:04.105299 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m17:36:04.111513 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m17:36:04.113275 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 17:36:04.105510 => 17:36:04.113121
[0m17:36:04.113586 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m17:36:04.116327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:05.544750 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m17:36:05.546298 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:36:05.548446 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:36:06.848599 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m17:36:06.849844 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:36:06.850850 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/6fc4f1d5-e39e-4758-be31-1721dd39baeb
[0m17:36:07.679867 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/6fc4f1d5-e39e-4758-be31-1721dd39baeb', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/6fc4f1d5-e39e-4758-be31-1721dd39baeb/'
[0m17:36:10.227103 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m17:36:10.231288 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:36:11.493981 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:36:11.497659 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/d84db2e2-303e-44a0-ab88-bfca374b8e88',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m17:36:12.160124 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 037a6a88-eef1-4d8b-a597-e150da6af9a6
[0m17:36:15.188014 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m17:36:15.189626 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m17:36:15.190289 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m17:36:15.456244 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6366f19f-d8c7-4426-bf62-76cc9c6cdb6f
[0m17:36:17.180839 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:36:17.189652 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m17:36:17.197207 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m17:36:17.199909 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m17:36:17.395667 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 73999b12-1e36-4510-8435-7fcff06a2778
[0m17:36:19.191679 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m17:36:19.196529 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 17:36:04.113772 => 17:36:19.196251
[0m17:36:19.197218 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m17:36:19.198324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab953b5b-7cd5-488d-b761-c1f325135619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80962490>]}
[0m17:36:19.199323 [info ] [Thread-1 (]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 15.10s]
[0m17:36:19.199979 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m17:36:19.205648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:19.205989 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m17:36:19.207533 [info ] [MainThread]: 
[0m17:36:19.208091 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 34.21 seconds (94.21s).
[0m17:36:19.209661 [debug] [MainThread]: Command end result
[0m17:36:19.230878 [info ] [MainThread]: 
[0m17:36:19.231471 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:36:19.232099 [info ] [MainThread]: 
[0m17:36:19.232523 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:36:19.239739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 94.71452, "process_user_time": 7.313722, "process_kernel_time": 0.790451, "process_mem_max_rss": "190376", "process_out_blocks": "2997", "process_in_blocks": "0"}
[0m17:36:19.240867 [debug] [MainThread]: Command `dbt run` succeeded at 17:36:19.240710 after 94.72 seconds
[0m17:36:19.241467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c09890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c08a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849e6910>]}
[0m17:36:19.242100 [debug] [MainThread]: Flushing usage events
[0m15:13:32.124423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8673c670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8607cbb0>]}


============================== 15:13:32.152328 | 2505eda3-629d-4549-a6d3-9839fac9afe9 ==============================
[0m15:13:32.152328 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:13:32.152854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:13:33.167578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87802b80>]}
[0m15:13:33.211543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86011dc0>]}
[0m15:13:33.212615 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:13:33.231373 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:13:33.326870 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:13:33.327476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c4d940>]}
[0m15:13:35.084629 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:13:35.085738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83dac2e0>]}
[0m15:13:35.805620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a39ee0>]}
[0m15:13:36.013358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837819a0>]}
[0m15:13:36.019485 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m15:13:36.022609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83706310>]}
[0m15:13:36.030529 [info ] [MainThread]: 
[0m15:13:36.032337 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:13:36.047411 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:13:36.048177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:37.205706 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:13:37.212489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m15:13:37.213181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:38.879681 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:13:38.882780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b11580>]}
[0m15:13:38.883649 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:38.884115 [info ] [MainThread]: 
[0m15:13:38.894413 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m15:13:38.895153 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m15:13:38.895773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m15:13:38.896159 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m15:13:38.905508 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:13:38.909195 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m15:13:38.935740 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:13:38.938012 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m15:13:38.938249 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:13:38.938469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:39.534471 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID dedef295-0e57-43da-acf8-ab1fd988eeb9
[0m15:13:41.255856 [debug] [Thread-1  ]: SQL status: OK -1 in 2.317 seconds
[0m15:13:42.289100 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['19', '18', '17', '16', '15']
[0m15:13:42.291680 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['15']
[0m15:13:42.766769 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 15 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m15:13:42.784597 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m15:13:42.787742 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8218c1f0>]}
[0m15:13:42.789066 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 3.89s]
[0m15:13:42.790457 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m15:13:42.791397 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m15:13:42.792326 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m15:13:42.795050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:13:42.795789 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m15:13:42.803152 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:13:42.804813 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m15:13:42.808577 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:13:42.810168 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m15:13:42.810641 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:13:42.811147 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:43.342001 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 439139a0-0d1e-4ec8-af01-ee13126c2c03
[0m15:13:45.191296 [debug] [Thread-1  ]: SQL status: OK -1 in 2.380 seconds
[0m15:13:46.190531 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['20', '19', '18', '17', '16']
[0m15:13:46.192772 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['16']
[0m15:13:46.649431 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 16 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m15:13:46.655056 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m15:13:46.656448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872aef70>]}
[0m15:13:46.657810 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 3.86s]
[0m15:13:46.659392 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m15:13:46.660679 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m15:13:46.662176 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m15:13:46.664711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:13:46.665193 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m15:13:46.673600 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:13:46.675183 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m15:13:46.678731 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:13:46.680063 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:13:46.680444 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:13:46.680802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:47.194190 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2b57db32-e0eb-4b12-8fd8-2bae08ac7161
[0m15:13:48.880439 [debug] [Thread-1  ]: SQL status: OK -1 in 2.199 seconds
[0m15:13:49.920434 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['20', '19', '18', '17', '16']
[0m15:13:49.923361 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['16']
[0m15:13:50.504123 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 16 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m15:13:50.508739 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m15:13:50.510235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872aef70>]}
[0m15:13:50.511617 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 3.85s]
[0m15:13:50.513472 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m15:13:50.514886 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m15:13:50.516949 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m15:13:50.520146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:13:50.520771 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m15:13:50.526420 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:13:50.528408 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m15:13:50.532562 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:13:50.534152 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m15:13:50.534644 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:13:50.535182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:51.197978 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9600f03e-7aa1-4b23-a06b-ef583f61ed2b
[0m15:13:52.862586 [debug] [Thread-1  ]: SQL status: OK -1 in 2.327 seconds
[0m15:13:53.896788 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['20', '19', '18', '17', '16']
[0m15:13:53.899625 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['16']
[0m15:13:54.418471 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 16 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m15:13:54.420937 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m15:13:54.421451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cf5be0>]}
[0m15:13:54.421985 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 3.90s]
[0m15:13:54.422697 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m15:13:54.423133 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m15:13:54.423552 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m15:13:54.424868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:13:54.425267 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m15:13:54.428679 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:13:54.432079 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m15:13:54.434573 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:13:54.435469 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m15:13:54.435766 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:13:54.436107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:54.926298 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d7198106-d927-4534-aa8a-59ae8d06ca8b
[0m15:13:56.580650 [debug] [Thread-1  ]: SQL status: OK -1 in 2.144 seconds
[0m15:13:57.705048 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['19', '18', '17', '16', '15']
[0m15:13:57.706924 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['15']
[0m15:13:58.209518 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 15 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m15:13:58.212711 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m15:13:58.213507 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b4ce670>]}
[0m15:13:58.214209 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 3.79s]
[0m15:13:58.215004 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m15:13:58.215633 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m15:13:58.216620 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m15:13:58.222618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:13:58.223333 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m15:13:58.230023 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:13:58.232679 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m15:13:58.258102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:59.405841 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:13:59.406837 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:13:59.410415 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:14:00.413798 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:14:00.414718 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:14:00.415308 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/69818e29-dbce-40d9-bcd5-ba3eaebfacaa
[0m15:14:00.911860 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/69818e29-dbce-40d9-bcd5-ba3eaebfacaa', bucket='climate-energy-raw-data', prefix='silver/eia_silver/69818e29-dbce-40d9-bcd5-ba3eaebfacaa/'
[0m15:14:02.635019 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:14:02.672147 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:14:03.100388 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:14:03.101663 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/e563909f-6efc-4c06-80d7-f31f0c3010e7',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m15:14:03.591158 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 03010611-8885-42bd-97c4-cb56c001da4f
[0m15:14:06.381663 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:14:06.399144 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:14:06.400084 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:14:06.589357 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1fbc31a6-4b53-4211-93e2-5f6af729510a
[0m15:14:08.237597 [debug] [Thread-1  ]: SQL status: OK -1 in 1.836 seconds
[0m15:14:08.243793 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:14:08.248421 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:14:08.249086 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:14:08.449683 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b5823a86-2584-4b9c-8a20-8d0b11921ea5
[0m15:14:10.256442 [debug] [Thread-1  ]: SQL status: OK 2842 in 2.006 seconds
[0m15:14:10.264054 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m15:14:10.266425 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ca5af0>]}
[0m15:14:10.268691 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 12.05s]
[0m15:14:10.270982 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m15:14:10.272680 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m15:14:10.274624 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:14:10.278575 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:14:10.279414 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m15:14:10.288376 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:14:10.290142 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m15:14:10.295487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:11.329656 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:14:11.330882 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:14:11.332100 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:14:12.497153 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:14:12.508923 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:14:12.514084 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/dc5cf7ea-d230-418e-9de8-ab753f9a06c5
[0m15:14:13.004528 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/dc5cf7ea-d230-418e-9de8-ab753f9a06c5', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/dc5cf7ea-d230-418e-9de8-ab753f9a06c5/'
[0m15:14:15.011096 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:14:15.024868 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:14:15.470787 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:14:15.473748 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/11737913-d5b7-4797-8e5a-38e4deed30d5',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:14:15.962543 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3af6f02f-89c4-49ce-b75e-8ec19845bb61
[0m15:14:18.808515 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:14:18.811056 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:14:18.811539 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:14:19.011381 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9029394c-fac2-456b-8d90-c225a160f37f
[0m15:14:20.668731 [debug] [Thread-1  ]: SQL status: OK -1 in 1.856 seconds
[0m15:14:20.684765 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:14:20.687874 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:14:20.688182 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:14:20.885384 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e70c8ddb-9c07-412f-a5a8-771de45cc375
[0m15:14:22.604313 [debug] [Thread-1  ]: SQL status: OK 305 in 1.915 seconds
[0m15:14:22.612075 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m15:14:22.614677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b1b3a0>]}
[0m15:14:22.616680 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 12.34s]
[0m15:14:22.619765 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m15:14:22.621509 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m15:14:22.624150 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m15:14:22.632509 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:14:22.633373 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m15:14:22.649534 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:14:22.651788 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m15:14:22.656155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:23.723669 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:14:23.724905 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:14:23.725878 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:14:24.774965 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:14:24.776629 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:14:24.777139 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/7382db4b-7b37-4f5e-ab39-29f0c9daaa76
[0m15:14:25.309505 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/7382db4b-7b37-4f5e-ab39-29f0c9daaa76', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/7382db4b-7b37-4f5e-ab39-29f0c9daaa76/'
[0m15:14:27.200736 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:14:27.210495 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:14:27.646561 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:14:27.650731 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/c56f7101-2dc1-4633-b971-1bbed362edfc',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m15:14:28.122149 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d066f63a-894d-462a-8b14-34ba46e164c6
[0m15:14:31.064470 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m15:14:31.067192 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:14:31.068012 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:14:31.262190 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 65269417-6b65-4a06-ab0d-d0021e1e6af7
[0m15:14:32.924924 [debug] [Thread-1  ]: SQL status: OK -1 in 1.856 seconds
[0m15:14:32.926459 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:14:32.927849 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:14:32.928232 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m15:14:33.127805 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 136cec80-1fa2-48b2-8a56-a776459836a4
[0m15:14:34.823041 [debug] [Thread-1  ]: SQL status: OK 12458 in 1.894 seconds
[0m15:14:34.833496 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m15:14:34.836295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f27e80>]}
[0m15:14:34.837831 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 12.21s]
[0m15:14:34.838969 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m15:14:34.839824 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m15:14:34.840790 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m15:14:34.848257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:14:34.849327 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m15:14:34.856520 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:14:34.858166 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m15:14:34.862043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:35.960396 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:14:35.961328 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:14:35.961890 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:14:36.941453 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:14:36.949032 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:14:36.952328 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/9945cb13-a5ff-4a78-b312-665687688055
[0m15:14:37.574907 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/9945cb13-a5ff-4a78-b312-665687688055', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/9945cb13-a5ff-4a78-b312-665687688055/'
[0m15:14:39.684640 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:14:39.690874 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:14:40.116624 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:14:40.119277 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/b3c03b12-6fd6-4365-b108-fc02f45f5a1f',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m15:14:40.610489 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 65cc0b29-b776-4fdd-8b08-f2c781d51856
[0m15:14:43.396693 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m15:14:43.400957 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:14:43.401479 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:14:43.596708 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d366e892-ab28-4167-bb10-35959d0305ba
[0m15:14:45.281788 [debug] [Thread-1  ]: SQL status: OK -1 in 1.879 seconds
[0m15:14:45.289542 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:14:45.292840 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:14:45.293456 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m15:14:45.496038 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 57e8b886-fd0d-4437-8722-e72453710369
[0m15:14:47.168709 [debug] [Thread-1  ]: SQL status: OK 473 in 1.875 seconds
[0m15:14:47.172010 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m15:14:47.173113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837aaeb0>]}
[0m15:14:47.174472 [info ] [Thread-1  ]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 12.33s]
[0m15:14:47.177657 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m15:14:47.180593 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m15:14:47.181535 [info ] [Thread-1  ]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m15:14:47.184380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:14:47.184778 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m15:14:47.191800 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:14:47.193181 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m15:14:47.196274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:48.352470 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:14:48.353495 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:14:48.354467 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:14:49.510733 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:14:49.512812 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:14:49.513340 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/d84db2e2-303e-44a0-ab88-bfca374b8e88
[0m15:14:50.011894 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/d84db2e2-303e-44a0-ab88-bfca374b8e88', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/d84db2e2-303e-44a0-ab88-bfca374b8e88/'
[0m15:14:51.867790 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:14:51.872455 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:14:52.283699 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:14:52.286126 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/a51063f9-d7a3-4edc-a09b-e75165344a2b',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m15:14:52.762383 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 79bdfec3-9b43-48e9-9492-52e1a2a8cfb9
[0m15:14:55.592349 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m15:14:55.599067 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:14:55.599766 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:14:56.823524 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8412dee4-ecae-48ce-ab40-4c4e48970c53
[0m15:14:58.462624 [debug] [Thread-1  ]: SQL status: OK -1 in 2.861 seconds
[0m15:14:58.472079 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:14:58.475309 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:14:58.476440 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m15:14:58.673958 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b6dd78c6-dddc-421b-8a81-69ac5e307e84
[0m15:15:00.352431 [debug] [Thread-1  ]: SQL status: OK 700 in 1.875 seconds
[0m15:15:00.362318 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m15:15:00.364493 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2505eda3-629d-4549-a6d3-9839fac9afe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cf5be0>]}
[0m15:15:00.366131 [info ] [Thread-1  ]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 13.18s]
[0m15:15:00.367707 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m15:15:00.377790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:00.378582 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m15:15:00.381198 [info ] [MainThread]: 
[0m15:15:00.381627 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 24.35 seconds (84.35s).
[0m15:15:00.385421 [debug] [MainThread]: Command end result
[0m15:15:00.437546 [info ] [MainThread]: 
[0m15:15:00.438070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:00.438594 [info ] [MainThread]: 
[0m15:15:00.438958 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m15:15:00.441362 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 88.34918, "process_user_time": 10.948341, "process_kernel_time": 2.375573, "process_mem_max_rss": "184748", "process_in_blocks": "47464", "process_out_blocks": "9559"}
[0m15:15:00.442191 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:00.442101 after 88.35 seconds
[0m15:15:00.442681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87714100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86c65160>]}
[0m15:15:00.443030 [debug] [MainThread]: Flushing usage events
[0m17:18:54.017982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f55fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7680a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54fd700>]}


============================== 17:18:54.670479 | 6f6baa55-2c0b-4458-a843-c5177ab8aa49 ==============================
[0m17:18:54.670479 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:18:54.675284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:18:56.141759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2957550>]}
[0m17:18:56.174851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5500c10>]}
[0m17:18:56.176560 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m17:18:56.208719 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:18:56.360237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:56.360860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:56.409810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3091310>]}
[0m17:18:56.521901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3042eb0>]}
[0m17:18:56.522423 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m17:18:56.522679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa305a460>]}
[0m17:18:56.524434 [info ] [MainThread]: 
[0m17:18:56.525033 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:18:56.529685 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:18:56.530010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:57.695634 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:18:57.704625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m17:18:57.705543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:59.779451 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:18:59.795075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3020070>]}
[0m17:18:59.799527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:59.801100 [info ] [MainThread]: 
[0m17:18:59.830863 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m17:18:59.834477 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m17:18:59.838571 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m17:18:59.844125 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m17:18:59.962182 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m17:18:59.984948 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m17:19:00.190543 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m17:19:00.198508 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m17:19:00.201185 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m17:19:00.202604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:01.086622 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 10b41a35-687b-4de0-bc43-e87d399cb27b
[0m17:19:02.963290 [debug] [Thread-1  ]: SQL status: OK -1 in 2.775 seconds
[0m17:19:04.218180 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['20', '19', '18', '17', '16']
[0m17:19:04.224498 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['16']
[0m17:19:04.875192 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 16 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m17:19:04.910761 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m17:19:04.921751 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e3a0d0>]}
[0m17:19:04.924643 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 5.08s]
[0m17:19:04.936359 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m17:19:04.950642 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m17:19:04.955141 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m17:19:04.961305 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m17:19:04.962462 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m17:19:04.975560 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m17:19:04.978703 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m17:19:04.983871 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m17:19:04.985148 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m17:19:04.985469 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m17:19:04.985776 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:05.895208 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID eaa9d1b5-c29a-4e3b-b711-5762ea5847c6
[0m17:19:07.769276 [debug] [Thread-1  ]: SQL status: OK -1 in 2.782 seconds
[0m17:19:09.166097 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['21', '20', '19', '18', '17']
[0m17:19:09.169837 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['17']
[0m17:19:09.669532 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 17 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m17:19:09.674494 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m17:19:09.676089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e3a0d0>]}
[0m17:19:09.677694 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.72s]
[0m17:19:09.679124 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m17:19:09.682793 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m17:19:09.685109 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m17:19:09.688068 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m17:19:09.688613 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m17:19:09.700534 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m17:19:09.702180 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m17:19:09.705496 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m17:19:09.706589 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m17:19:09.706931 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m17:19:09.707256 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:10.255867 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 25e46d93-6cc6-4daf-a403-bd2c58a45553
[0m17:19:12.237521 [debug] [Thread-1  ]: SQL status: OK -1 in 2.529 seconds
[0m17:19:13.482949 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['21', '20', '19', '18', '17']
[0m17:19:13.487150 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['17']
[0m17:19:14.044130 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 17 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m17:19:14.058358 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m17:19:14.064471 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0311700>]}
[0m17:19:14.072634 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.37s]
[0m17:19:14.077537 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m17:19:14.082779 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m17:19:14.088584 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m17:19:14.104807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m17:19:14.108191 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m17:19:14.172985 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m17:19:14.199181 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m17:19:14.255859 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m17:19:14.280313 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m17:19:14.284214 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m17:19:14.289164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:15.432639 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 09183e4f-fd2c-4448-9822-a3591c3cd339
[0m17:19:17.182630 [debug] [Thread-1  ]: SQL status: OK -1 in 2.892 seconds
[0m17:19:18.599227 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['21', '20', '19', '18', '17']
[0m17:19:18.602043 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['17']
[0m17:19:19.108695 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 17 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m17:19:19.128437 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m17:19:19.133805 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0311700>]}
[0m17:19:19.138757 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 5.04s]
[0m17:19:19.142294 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m17:19:19.144753 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m17:19:19.147091 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m17:19:19.155149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m17:19:19.156173 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m17:19:19.177975 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m17:19:19.180689 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m17:19:19.189214 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m17:19:19.193130 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m17:19:19.194875 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m17:19:19.195875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:19.940274 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID bb057aad-6893-4e5c-9802-d95a7a68bb65
[0m17:19:21.942370 [debug] [Thread-1  ]: SQL status: OK -1 in 2.744 seconds
[0m17:19:23.109740 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['20', '19', '18', '17', '16']
[0m17:19:23.121003 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['16']
[0m17:19:23.732751 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 16 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m17:19:23.767388 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m17:19:23.777132 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be44370>]}
[0m17:19:23.779029 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.63s]
[0m17:19:23.780404 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m17:19:23.781710 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m17:19:23.783957 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m17:19:23.792234 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m17:19:23.793544 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m17:19:23.811805 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m17:19:23.813571 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m17:19:24.839332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:26.190164 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m17:19:26.191240 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:19:26.194201 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m17:19:27.354518 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m17:19:27.355556 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:19:27.356058 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/e563909f-6efc-4c06-80d7-f31f0c3010e7
[0m17:19:28.012036 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/e563909f-6efc-4c06-80d7-f31f0c3010e7', bucket='climate-energy-raw-data', prefix='silver/eia_silver/e563909f-6efc-4c06-80d7-f31f0c3010e7/'
[0m17:19:30.886438 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m17:19:30.957670 [debug] [Thread-1  ]: Skip partitioning: False
[0m17:19:31.466513 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:19:31.469875 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/f9981035-8290-4896-923e-269b2efcc285',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m17:19:32.040148 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c68c756d-b91a-4df9-b427-c6d74817aa59
[0m17:19:35.105100 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m17:19:35.118918 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m17:19:35.119509 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m17:19:35.347741 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8685411f-935e-4bb3-9a58-b3e6642ed57b
[0m17:19:37.060295 [debug] [Thread-1  ]: SQL status: OK -1 in 1.940 seconds
[0m17:19:37.068254 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m17:19:37.071632 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m17:19:37.072338 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m17:19:37.280298 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 74b8336e-3a7b-49ca-8b1a-fbbe1263d2ee
[0m17:19:39.110850 [debug] [Thread-1  ]: SQL status: OK 2842 in 2.031 seconds
[0m17:19:39.160826 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m17:19:39.163392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6117ca0>]}
[0m17:19:39.165468 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 15.38s]
[0m17:19:39.174739 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m17:19:39.178056 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m17:19:39.179759 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m17:19:39.184986 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m17:19:39.186229 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m17:19:39.202399 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m17:19:39.203964 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m17:19:39.207209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:40.636143 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m17:19:40.642353 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:19:40.644992 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m17:19:41.881188 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m17:19:41.882986 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:19:41.884430 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/11737913-d5b7-4797-8e5a-38e4deed30d5
[0m17:19:42.490820 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/11737913-d5b7-4797-8e5a-38e4deed30d5', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/11737913-d5b7-4797-8e5a-38e4deed30d5/'
[0m17:19:45.106386 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m17:19:45.116991 [debug] [Thread-1  ]: Skip partitioning: False
[0m17:19:45.642002 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:19:45.645117 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/8090a867-440a-42bb-a3a7-0c3a9560d3a8',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m17:19:46.253137 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 91dbc648-60e6-40bd-b5d7-dc9aee284ec2
[0m17:19:49.151524 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m17:19:49.160060 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m17:19:49.161267 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m17:19:49.393689 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 55f766b2-dce3-4684-877b-e93320625996
[0m17:19:51.141963 [debug] [Thread-1  ]: SQL status: OK -1 in 1.979 seconds
[0m17:19:51.170431 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m17:19:51.180608 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m17:19:51.184022 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m17:19:51.391531 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fbdade10-d91a-4758-87e0-55aab975bb6a
[0m17:19:53.236115 [debug] [Thread-1  ]: SQL status: OK 305 in 2.046 seconds
[0m17:19:53.253884 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m17:19:53.256724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a74f820>]}
[0m17:19:53.259151 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 14.08s]
[0m17:19:53.261049 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m17:19:53.262691 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m17:19:53.264474 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m17:19:53.269678 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m17:19:53.270446 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m17:19:53.280258 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m17:19:53.281613 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m17:19:53.285821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:54.657762 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m17:19:54.659171 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:19:54.660496 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m17:19:55.917462 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m17:19:55.919127 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:19:55.920373 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/c56f7101-2dc1-4633-b971-1bbed362edfc
[0m17:19:56.748456 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/c56f7101-2dc1-4633-b971-1bbed362edfc', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/c56f7101-2dc1-4633-b971-1bbed362edfc/'
[0m17:19:58.831600 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m17:19:58.846591 [debug] [Thread-1  ]: Skip partitioning: False
[0m17:19:59.472927 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:19:59.474971 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/7260f07e-33d6-4666-a965-3dfc2f88271e',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m17:20:00.167231 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 69300a8c-9c62-4460-b4c0-44c11b43a7bb
[0m17:20:03.134225 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m17:20:03.141290 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m17:20:03.142438 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m17:20:03.351872 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID eea91e3a-df3b-43ed-968f-9a8828824958
[0m17:20:05.103782 [debug] [Thread-1  ]: SQL status: OK -1 in 1.957 seconds
[0m17:20:05.119205 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m17:20:05.122842 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m17:20:05.123252 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m17:20:05.346147 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5616ba38-d64f-4483-a40c-4b127065d308
[0m17:20:07.145647 [debug] [Thread-1  ]: SQL status: OK 12458 in 2.020 seconds
[0m17:20:07.173684 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m17:20:07.181576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e3a0d0>]}
[0m17:20:07.188110 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 13.91s]
[0m17:20:07.192432 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m17:20:07.194825 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m17:20:07.201612 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m17:20:07.210177 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m17:20:07.210792 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m17:20:07.224470 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m17:20:07.225698 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m17:20:07.228649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:08.444664 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m17:20:08.445469 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:20:08.446388 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m17:20:09.479709 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m17:20:09.480798 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:20:09.481469 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/b3c03b12-6fd6-4365-b108-fc02f45f5a1f
[0m17:20:10.003776 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/b3c03b12-6fd6-4365-b108-fc02f45f5a1f', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/b3c03b12-6fd6-4365-b108-fc02f45f5a1f/'
[0m17:20:12.259805 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m17:20:12.268529 [debug] [Thread-1  ]: Skip partitioning: False
[0m17:20:12.798906 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:20:12.802010 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/7eee01be-3e76-4148-bd39-9c1995454212',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m17:20:13.369102 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e9d9dbc9-8fdf-4022-8809-6a0e6a2f3d6e
[0m17:20:16.484727 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m17:20:16.497653 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m17:20:16.498517 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m17:20:16.711434 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f1e6dd16-82a2-4231-bb21-20e1379ef978
[0m17:20:18.425545 [debug] [Thread-1  ]: SQL status: OK -1 in 1.925 seconds
[0m17:20:18.434031 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m17:20:18.437609 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m17:20:18.438280 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m17:20:18.712932 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID af2dde64-c19f-4774-8b90-6916f920e63f
[0m17:20:20.860486 [debug] [Thread-1  ]: SQL status: OK 473 in 2.421 seconds
[0m17:20:20.865103 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m17:20:20.866542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e3a0d0>]}
[0m17:20:20.867946 [info ] [Thread-1  ]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 13.66s]
[0m17:20:20.869324 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m17:20:20.870411 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m17:20:20.871632 [info ] [Thread-1  ]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m17:20:20.876824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m17:20:20.877558 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m17:20:20.884775 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m17:20:20.886959 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m17:20:20.890530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:22.189853 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m17:20:22.192274 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:20:22.195282 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m17:20:23.475700 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m17:20:23.490115 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:20:23.491882 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/a51063f9-d7a3-4edc-a09b-e75165344a2b
[0m17:20:24.050677 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/a51063f9-d7a3-4edc-a09b-e75165344a2b', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/a51063f9-d7a3-4edc-a09b-e75165344a2b/'
[0m17:20:26.425748 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m17:20:26.447773 [debug] [Thread-1  ]: Skip partitioning: False
[0m17:20:26.933356 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:20:26.935042 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/0f6fe23f-65ea-43cf-b62d-2554c08d665e',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m17:20:27.468558 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f5dcf76a-d1e8-462b-a755-ae777087928b
[0m17:20:29.179973 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m17:20:29.191960 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m17:20:29.193340 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m17:20:29.392089 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0daf8cda-f8d7-4620-a83c-500879dd5408
[0m17:20:31.196629 [debug] [Thread-1  ]: SQL status: OK -1 in 2.002 seconds
[0m17:20:31.206972 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m17:20:31.210459 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m17:20:31.211599 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m17:20:31.455879 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2f5b0b31-f9ba-4651-8994-6cdaa6e2806c
[0m17:20:33.242082 [debug] [Thread-1  ]: SQL status: OK 700 in 2.028 seconds
[0m17:20:33.265248 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m17:20:33.270412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f6baa55-2c0b-4458-a843-c5177ab8aa49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f7b970>]}
[0m17:20:33.273243 [info ] [Thread-1  ]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 12.40s]
[0m17:20:33.277983 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m17:20:33.297636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:33.298426 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m17:20:33.304060 [info ] [MainThread]: 
[0m17:20:33.304990 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 36.78 seconds (96.78s).
[0m17:20:33.308311 [debug] [MainThread]: Command end result
[0m17:20:33.369180 [info ] [MainThread]: 
[0m17:20:33.369685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:20:33.369976 [info ] [MainThread]: 
[0m17:20:33.370720 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m17:20:33.378192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 99.40236, "process_user_time": 13.823049, "process_kernel_time": 3.43254, "process_mem_max_rss": "173884", "process_in_blocks": "100704", "process_out_blocks": "8563"}
[0m17:20:33.379517 [debug] [MainThread]: Command `dbt run` succeeded at 17:20:33.379411 after 99.40 seconds
[0m17:20:33.380709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f55fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60c2a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bacc40>]}
[0m17:20:33.381031 [debug] [MainThread]: Flushing usage events
[0m12:05:05.734976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8355fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ac0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68fd700>]}


============================== 12:05:05.753431 | 5fd580cb-db14-449d-9abc-58a6f8c5e3a8 ==============================
[0m12:05:05.753431 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:05:05.753923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:05:06.377079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d58550>]}
[0m12:05:06.408684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6900c10>]}
[0m12:05:06.409491 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m12:05:06.429888 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:05:06.657242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:06.657850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:06.696885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4490310>]}
[0m12:05:06.802326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4443eb0>]}
[0m12:05:06.803142 [info ] [MainThread]: Found 10 models, 4 data tests, 5 sources, 450 macros
[0m12:05:06.804411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb445b460>]}
[0m12:05:06.806481 [info ] [MainThread]: 
[0m12:05:06.807132 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m12:05:06.812676 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m12:05:06.813335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:07.837363 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m12:05:07.841715 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m12:05:07.842536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:05:09.287795 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m12:05:09.299177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4420070>]}
[0m12:05:09.301586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:05:09.302407 [info ] [MainThread]: 
[0m12:05:09.317918 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m12:05:09.319155 [info ] [Thread-1  ]: 1 of 10 START sql view model silver.eia_bronze ................................. [RUN]
[0m12:05:09.320265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m12:05:09.320805 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m12:05:09.335117 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m12:05:09.338143 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m12:05:09.366325 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m12:05:09.368232 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m12:05:09.368459 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m12:05:09.368667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:05:09.931753 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4369ba46-31dc-4e33-a961-97842127f086
[0m12:05:11.956160 [debug] [Thread-1  ]: SQL status: OK -1 in 2.577 seconds
[0m12:05:13.453419 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['21', '20', '19', '18', '17']
[0m12:05:13.525227 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['17']
[0m12:05:14.114859 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 17 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m12:05:14.234710 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m12:05:14.245097 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb523a0d0>]}
[0m12:05:14.250722 [info ] [Thread-1  ]: 1 of 10 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.92s]
[0m12:05:14.255722 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m12:05:14.264030 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m12:05:14.267649 [info ] [Thread-1  ]: 2 of 10 START sql view model silver.noaa_bronze ................................ [RUN]
[0m12:05:14.280921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m12:05:14.282810 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m12:05:14.297024 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m12:05:14.301957 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m12:05:14.306049 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m12:05:14.313602 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m12:05:14.316512 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m12:05:14.317841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:05:15.298742 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2f68907c-bb88-48d3-8c8d-5ff51fbe32ab
[0m12:05:17.013353 [debug] [Thread-1  ]: SQL status: OK -1 in 2.695 seconds
[0m12:05:18.045753 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['22', '21', '20', '19', '18']
[0m12:05:18.049763 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['18']
[0m12:05:18.503456 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 18 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m12:05:18.514865 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m12:05:18.518145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb523a0d0>]}
[0m12:05:18.520976 [info ] [Thread-1  ]: 2 of 10 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.25s]
[0m12:05:18.523228 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m12:05:18.525136 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m12:05:18.529382 [info ] [Thread-1  ]: 3 of 10 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m12:05:18.535006 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m12:05:18.535943 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m12:05:18.547575 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m12:05:18.550464 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m12:05:18.554530 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m12:05:18.556148 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m12:05:18.556607 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m12:05:18.557045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:05:19.072295 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b69f7e7a-73e4-4912-a61c-92150447d02b
[0m12:05:20.780279 [debug] [Thread-1  ]: SQL status: OK -1 in 2.222 seconds
[0m12:05:21.845016 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['22', '21', '20', '19', '18']
[0m12:05:21.846423 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['18']
[0m12:05:22.301148 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 18 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m12:05:22.312961 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m12:05:22.316524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ed0700>]}
[0m12:05:22.320102 [info ] [Thread-1  ]: 3 of 10 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 3.78s]
[0m12:05:22.322286 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m12:05:22.323971 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m12:05:22.326598 [info ] [Thread-1  ]: 4 of 10 START sql view model silver.openweather_bronze ......................... [RUN]
[0m12:05:22.332339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m12:05:22.333280 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m12:05:22.347108 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m12:05:22.349765 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m12:05:22.353529 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m12:05:22.354924 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m12:05:22.355288 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m12:05:22.355709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:05:23.041512 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8063981d-0f5d-427d-adc7-24ce006868f9
[0m12:05:24.819166 [debug] [Thread-1  ]: SQL status: OK -1 in 2.462 seconds
[0m12:05:25.934478 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['22', '21', '20', '19', '18']
[0m12:05:25.939226 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['18']
[0m12:05:26.421163 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 18 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m12:05:26.433814 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m12:05:26.436220 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d73bb0>]}
[0m12:05:26.438567 [info ] [Thread-1  ]: 4 of 10 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.11s]
[0m12:05:26.440363 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m12:05:26.442180 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m12:05:26.444057 [info ] [Thread-1  ]: 5 of 10 START sql view model silver.sensor_bronze .............................. [RUN]
[0m12:05:26.448827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m12:05:26.449432 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m12:05:26.464420 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m12:05:26.466205 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m12:05:26.469697 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m12:05:26.470860 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m12:05:26.471185 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m12:05:26.471524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:05:27.021159 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8e213aa4-21d5-42ec-8722-4e483dc9f606
[0m12:05:28.703971 [debug] [Thread-1  ]: SQL status: OK -1 in 2.232 seconds
[0m12:05:29.778372 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['21', '20', '19', '18', '17']
[0m12:05:29.788633 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['17']
[0m12:05:30.282329 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 17 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m12:05:30.294232 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m12:05:30.296053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb41f7cd0>]}
[0m12:05:30.298123 [info ] [Thread-1  ]: 5 of 10 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 3.85s]
[0m12:05:30.300040 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m12:05:30.302610 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m12:05:30.308217 [info ] [Thread-1  ]: 6 of 10 START sql table model silver.eia_silver ................................ [RUN]
[0m12:05:30.313503 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m12:05:30.314063 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m12:05:30.322417 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m12:05:30.326233 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m12:05:30.671803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:05:31.781006 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m12:05:31.783604 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m12:05:31.794611 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m12:05:32.798485 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m12:05:32.799539 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m12:05:32.800517 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/f9981035-8290-4896-923e-269b2efcc285
[0m12:05:33.695480 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/f9981035-8290-4896-923e-269b2efcc285', bucket='climate-energy-raw-data', prefix='silver/eia_silver/f9981035-8290-4896-923e-269b2efcc285/'
[0m12:05:35.526697 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m12:05:35.558008 [debug] [Thread-1  ]: Skip partitioning: False
[0m12:05:36.051773 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m12:05:36.057279 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/bd474f3a-15a8-4f3e-b4ab-20d0b0383385',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m12:05:36.527599 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6a692ad3-c536-4356-8516-2b1c79a385ee
[0m12:05:39.369958 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m12:05:39.387885 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m12:05:39.389019 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m12:05:39.589642 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fbafc1ec-986e-43ad-a9ed-d805507b2bac
[0m12:05:41.243435 [debug] [Thread-1  ]: SQL status: OK -1 in 1.850 seconds
[0m12:05:41.253340 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m12:05:41.262398 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m12:05:41.263392 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m12:05:41.494621 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 41de2060-1b7e-455d-be7c-d0ae184d5822
[0m12:05:43.238293 [debug] [Thread-1  ]: SQL status: OK 2842 in 1.969 seconds
[0m12:05:43.309584 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m12:05:43.322885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d40f10>]}
[0m12:05:43.344380 [info ] [Thread-1  ]: 6 of 10 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 13.00s]
[0m12:05:43.367974 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m12:05:43.419340 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m12:05:43.431675 [info ] [Thread-1  ]: 7 of 10 START sql table model silver.noaa_silver ............................... [RUN]
[0m12:05:43.529079 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m12:05:43.533230 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m12:05:43.601313 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m12:05:43.605433 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m12:05:43.617044 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:05:46.268287 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m12:05:46.300672 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m12:05:46.310803 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m12:05:47.535637 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m12:05:47.540287 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m12:05:47.545773 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/8090a867-440a-42bb-a3a7-0c3a9560d3a8
[0m12:05:48.645599 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/8090a867-440a-42bb-a3a7-0c3a9560d3a8', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/8090a867-440a-42bb-a3a7-0c3a9560d3a8/'
[0m12:05:51.516214 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m12:05:51.547742 [debug] [Thread-1  ]: Skip partitioning: False
[0m12:05:52.113351 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m12:05:52.119317 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/6ac3fcdc-23b7-40ea-bd18-70634e5b3a3c',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m12:05:52.613970 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8a968e11-4d3c-46ec-a6e2-e103b642b913
[0m12:05:55.419173 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m12:05:55.431187 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m12:05:55.432019 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m12:05:55.627773 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 03b12b3f-a90a-4b45-81ff-112a5ff6a217
[0m12:05:57.301142 [debug] [Thread-1  ]: SQL status: OK -1 in 1.867 seconds
[0m12:05:57.316165 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m12:05:57.319903 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m12:05:57.320726 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m12:05:57.518946 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 863aec59-789e-48b1-9e66-e0ded076583a
[0m12:05:59.192418 [debug] [Thread-1  ]: SQL status: OK 305 in 1.871 seconds
[0m12:05:59.203709 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m12:05:59.207272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab995340>]}
[0m12:05:59.212501 [info ] [Thread-1  ]: 7 of 10 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 15.77s]
[0m12:05:59.213870 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m12:05:59.215906 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m12:05:59.217858 [info ] [Thread-1  ]: 8 of 10 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m12:05:59.221839 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m12:05:59.222480 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m12:05:59.231629 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m12:05:59.233301 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m12:05:59.237439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:06:00.399337 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m12:06:00.401164 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m12:06:00.402593 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m12:06:01.357995 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m12:06:01.358561 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m12:06:01.358973 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/7260f07e-33d6-4666-a965-3dfc2f88271e
[0m12:06:01.958630 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/7260f07e-33d6-4666-a965-3dfc2f88271e', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/7260f07e-33d6-4666-a965-3dfc2f88271e/'
[0m12:06:03.968398 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m12:06:03.984726 [debug] [Thread-1  ]: Skip partitioning: False
[0m12:06:04.418903 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m12:06:04.420087 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/987cbd42-062c-4968-b896-a36c2d0c5543',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m12:06:04.881588 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 14359dd2-80ac-4298-9256-6539bab07381
[0m12:06:07.685890 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m12:06:07.693743 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m12:06:07.694519 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m12:06:07.900169 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e1cd2ef9-4b47-436e-ab22-ae4aed22769d
[0m12:06:09.511500 [debug] [Thread-1  ]: SQL status: OK -1 in 1.816 seconds
[0m12:06:09.517943 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m12:06:09.522595 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m12:06:09.523329 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m12:06:09.711528 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ba0c112b-8297-424a-b711-5fd847e7c418
[0m12:06:11.469854 [debug] [Thread-1  ]: SQL status: OK 12458 in 1.945 seconds
[0m12:06:11.482716 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m12:06:11.484527 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04442e0>]}
[0m12:06:11.486091 [info ] [Thread-1  ]: 8 of 10 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 12.27s]
[0m12:06:11.488884 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m12:06:11.493997 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m12:06:11.496287 [info ] [Thread-1  ]: 9 of 10 START sql table model silver.openweather_silver ........................ [RUN]
[0m12:06:11.501550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m12:06:11.502104 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m12:06:11.514435 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m12:06:11.516831 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m12:06:11.520374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:06:12.583811 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m12:06:12.584561 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m12:06:12.585215 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m12:06:13.886270 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m12:06:13.889087 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m12:06:13.892491 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/7eee01be-3e76-4148-bd39-9c1995454212
[0m12:06:14.480986 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/7eee01be-3e76-4148-bd39-9c1995454212', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/7eee01be-3e76-4148-bd39-9c1995454212/'
[0m12:06:16.228418 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m12:06:16.235235 [debug] [Thread-1  ]: Skip partitioning: False
[0m12:06:16.660085 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m12:06:16.662003 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/f371c6c2-08f5-415a-888c-51adbe2d42a7',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m12:06:17.162963 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 84767548-8e19-4621-a8e1-6346cdcd4f47
[0m12:06:19.948049 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m12:06:19.952581 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m12:06:19.953000 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m12:06:20.146399 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 350f70b6-5a53-48b2-94d2-6ec8654906a3
[0m12:06:21.773572 [debug] [Thread-1  ]: SQL status: OK -1 in 1.820 seconds
[0m12:06:21.779489 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m12:06:21.784179 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m12:06:21.784660 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m12:06:21.983678 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5f572a2f-3c79-4543-9225-b756913c785d
[0m12:06:24.192035 [debug] [Thread-1  ]: SQL status: OK 473 in 2.406 seconds
[0m12:06:24.198365 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m12:06:24.200812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45c5b50>]}
[0m12:06:24.204076 [info ] [Thread-1  ]: 9 of 10 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 12.70s]
[0m12:06:24.206489 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m12:06:24.207493 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m12:06:24.209869 [info ] [Thread-1  ]: 10 of 10 START sql table model silver.sensor_silver ............................ [RUN]
[0m12:06:24.214804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m12:06:24.216200 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m12:06:24.220867 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m12:06:24.223303 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m12:06:24.228095 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:06:25.347589 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m12:06:25.349105 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m12:06:25.350949 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m12:06:26.316824 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m12:06:26.317420 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m12:06:26.317860 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/0f6fe23f-65ea-43cf-b62d-2554c08d665e
[0m12:06:26.818389 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/0f6fe23f-65ea-43cf-b62d-2554c08d665e', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/0f6fe23f-65ea-43cf-b62d-2554c08d665e/'
[0m12:06:28.698288 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m12:06:28.705991 [debug] [Thread-1  ]: Skip partitioning: False
[0m12:06:29.125963 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m12:06:29.131055 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/a2081cd2-0fb0-4b61-b64e-e26cec7b8bed',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m12:06:29.639370 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID febba175-477e-463e-acf6-c585dcd2a7ee
[0m12:06:32.436498 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m12:06:32.441712 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m12:06:32.442502 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m12:06:32.624477 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c37b5cc5-1923-45a6-821e-34670a8e825e
[0m12:06:34.253638 [debug] [Thread-1  ]: SQL status: OK -1 in 1.810 seconds
[0m12:06:34.261380 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m12:06:34.264230 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m12:06:34.264696 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m12:06:34.449930 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fcec3be0-1075-4d2d-af09-4b29e1623102
[0m12:06:36.113141 [debug] [Thread-1  ]: SQL status: OK 700 in 1.848 seconds
[0m12:06:36.120158 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m12:06:36.121934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fd580cb-db14-449d-9abc-58a6f8c5e3a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb453be20>]}
[0m12:06:36.123613 [info ] [Thread-1  ]: 10 of 10 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 11.91s]
[0m12:06:36.125992 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m12:06:36.132169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:36.133068 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m12:06:36.136833 [info ] [MainThread]: 
[0m12:06:36.137446 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 1 minutes and 29.33 seconds (89.33s).
[0m12:06:36.139875 [debug] [MainThread]: Command end result
[0m12:06:36.228141 [info ] [MainThread]: 
[0m12:06:36.232574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:36.234811 [info ] [MainThread]: 
[0m12:06:36.236634 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m12:06:36.245180 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 90.53974, "process_user_time": 13.301677, "process_kernel_time": 2.119823, "process_mem_max_rss": "172172", "process_in_blocks": "101256", "process_out_blocks": "8563"}
[0m12:06:36.246702 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:36.246526 after 90.54 seconds
[0m12:06:36.248046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8355fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74c2a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6facc40>]}
[0m12:06:36.248950 [debug] [MainThread]: Flushing usage events
[0m11:16:22.479423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa0c88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa804cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80bce20>]}


============================== 11:16:22.508865 | 8415fa79-9724-430d-ba4b-c97cee7cbcad ==============================
[0m11:16:22.508865 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:16:22.509308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:16:22.486100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a5a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f9cc4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa2be20>]}


============================== 11:16:22.510905 | aa0c48b2-f613-43b5-85a8-23b1898b4111 ==============================
[0m11:16:22.510905 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:16:22.511298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:16:23.793851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8415fa79-9724-430d-ba4b-c97cee7cbcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9821670>]}
[0m11:16:23.794419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa0c48b2-f613-43b5-85a8-23b1898b4111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa11a2610>]}
[0m11:16:23.827053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa0c48b2-f613-43b5-85a8-23b1898b4111', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa2bc10>]}
[0m11:16:23.827912 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:16:23.828575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8415fa79-9724-430d-ba4b-c97cee7cbcad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80c0bb0>]}
[0m11:16:23.834055 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:16:23.855418 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:16:23.857432 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:16:23.999579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:16:24.005268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:16:24.006177 [debug] [MainThread]: Partial parsing: added file: silver://models/gold/weather_data_gold.sql
[0m11:16:24.007030 [debug] [MainThread]: Partial parsing: added file: silver://models/gold/weather_data_gold.sql
[0m11:16:24.008177 [debug] [MainThread]: Partial parsing: updated file: silver://models/schema.yml
[0m11:16:24.007364 [debug] [MainThread]: Partial parsing: updated file: silver://models/schema.yml
[0m11:16:24.141400 [error] [MainThread]: Encountered an error:
Compilation Error in model weather_data_gold (models/gold/weather_data_gold.sql)
  expected token ',', got 'table_type'
    line 5
      table_type='iceberg',
[0m11:16:24.142094 [error] [MainThread]: Encountered an error:
Compilation Error in model weather_data_gold (models/gold/weather_data_gold.sql)
  expected token ',', got 'table_type'
    line 5
      table_type='iceberg',
[0m11:16:24.143257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7264532, "process_user_time": 2.268026, "process_kernel_time": 0.594613, "process_mem_max_rss": "149464", "process_in_blocks": "15600", "process_out_blocks": "5629", "command_success": false}
[0m11:16:24.144277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.727526, "process_user_time": 2.257714, "process_kernel_time": 0.559133, "process_mem_max_rss": "149460", "process_in_blocks": "19616", "process_out_blocks": "5557", "command_success": false}
[0m11:16:24.144958 [debug] [MainThread]: Command `dbt run` failed at 11:16:24.144807 after 1.73 seconds
[0m11:16:24.145605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa0c88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bd8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bd8fa0>]}
[0m11:16:24.146053 [debug] [MainThread]: Flushing usage events
[0m11:16:24.145121 [debug] [MainThread]: Command `dbt run` failed at 11:16:24.144965 after 1.73 seconds
[0m11:16:24.149118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a5a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d561940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d561fa0>]}
[0m11:16:24.150206 [debug] [MainThread]: Flushing usage events
[0m11:21:14.430411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863613d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8681dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86350250>]}


============================== 11:21:14.436726 | f5392414-3f9a-438c-a1bc-806fe44c1469 ==============================
[0m11:21:14.436726 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:21:14.437900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select gold', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:21:14.779266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5392414-3f9a-438c-a1bc-806fe44c1469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85576450>]}
[0m11:21:14.830620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5392414-3f9a-438c-a1bc-806fe44c1469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852f5c50>]}
[0m11:21:14.831520 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m11:21:14.837779 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:21:14.846997 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:21:14.847410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5392414-3f9a-438c-a1bc-806fe44c1469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85251110>]}
[0m11:21:15.365832 [error] [MainThread]: Encountered an error:
Compilation Error in model weather_data_gold (models/gold/weather_data_gold.sql)
  expected token ',', got 'table_type'
    line 5
      table_type='iceberg',
[0m11:21:15.367527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9592212, "process_user_time": 1.977675, "process_kernel_time": 0.374291, "process_mem_max_rss": "130940", "process_in_blocks": "83152", "process_out_blocks": "2205", "command_success": false}
[0m11:21:15.367895 [debug] [MainThread]: Command `dbt run` failed at 11:21:15.367804 after 0.96 seconds
[0m11:21:15.368178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff863511d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8638c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8512ad50>]}
[0m11:21:15.368461 [debug] [MainThread]: Flushing usage events
[0m11:21:26.704573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa979d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c46070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c95130>]}


============================== 11:21:26.712943 | 779df687-54f7-4ca9-a989-911db0b003bc ==============================
[0m11:21:26.712943 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:21:26.714038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:21:27.116055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '779df687-54f7-4ca9-a989-911db0b003bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa511cc70>]}
[0m11:21:27.145860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '779df687-54f7-4ca9-a989-911db0b003bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7c0b220>]}
[0m11:21:27.146436 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:21:27.161683 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:21:27.328352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:21:27.329321 [debug] [MainThread]: Partial parsing: added file: silver://models/gold/weather_data_gold.sql
[0m11:21:27.329915 [debug] [MainThread]: Partial parsing: updated file: silver://models/schema.yml
[0m11:21:27.427733 [error] [MainThread]: Encountered an error:
Compilation Error in model weather_data_gold (models/gold/weather_data_gold.sql)
  expected token ',', got 'table_type'
    line 5
      table_type='iceberg',
[0m11:21:27.428866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7785398, "process_user_time": 1.34089, "process_kernel_time": 0.220652, "process_mem_max_rss": "149432", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m11:21:27.429447 [debug] [MainThread]: Command `dbt run` failed at 11:21:27.429356 after 0.78 seconds
[0m11:21:27.429853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa979d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa580dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa580dfa0>]}
[0m11:21:27.430186 [debug] [MainThread]: Flushing usage events
[0m11:21:27.829916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac3561c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacab1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf0bf40>]}


============================== 11:21:27.842085 | 75a0c5eb-ba0e-42b0-82e0-43020e651d39 ==============================
[0m11:21:27.842085 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:21:27.842454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:21:28.261737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75a0c5eb-ba0e-42b0-82e0-43020e651d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac04d460>]}
[0m11:21:28.307679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75a0c5eb-ba0e-42b0-82e0-43020e651d39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7caaeb0>]}
[0m11:21:28.309108 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:21:28.325877 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:21:28.470341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:21:28.470906 [debug] [MainThread]: Partial parsing: added file: silver://models/gold/weather_data_gold.sql
[0m11:21:28.471335 [debug] [MainThread]: Partial parsing: updated file: silver://models/schema.yml
[0m11:21:28.596678 [error] [MainThread]: Encountered an error:
Compilation Error in model weather_data_gold (models/gold/weather_data_gold.sql)
  expected token ',', got 'table_type'
    line 5
      table_type='iceberg',
[0m11:21:28.597594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7999982, "process_user_time": 1.405964, "process_kernel_time": 0.24382, "process_mem_max_rss": "149436", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m11:21:28.597965 [debug] [MainThread]: Command `dbt run` failed at 11:21:28.597901 after 0.80 seconds
[0m11:21:28.598240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac3561c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83cca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83ccee0>]}
[0m11:21:28.598491 [debug] [MainThread]: Flushing usage events
[0m11:22:31.500776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959517d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9716c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95951b90>]}


============================== 11:22:31.505350 | b578b02c-7cdb-4d7c-9452-d242d7ab8382 ==============================
[0m11:22:31.505350 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:22:31.505820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select gold', 'send_anonymous_usage_stats': 'True'}
[0m11:22:31.829679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b578b02c-7cdb-4d7c-9452-d242d7ab8382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95992810>]}
[0m11:22:31.872076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b578b02c-7cdb-4d7c-9452-d242d7ab8382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b86c10>]}
[0m11:22:31.873082 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m11:22:31.881233 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:22:31.897537 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:22:31.898932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b578b02c-7cdb-4d7c-9452-d242d7ab8382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948a6010>]}
[0m11:22:32.465079 [error] [MainThread]: Encountered an error:
Compilation Error in model weather_data_gold (models/gold/weather_data_gold.sql)
  expected token ',', got 'table_type'
    line 5
      table_type='iceberg',
[0m11:22:32.466469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9872361, "process_user_time": 2.491113, "process_kernel_time": 0.285353, "process_mem_max_rss": "130756", "process_in_blocks": "60200", "process_out_blocks": "2205", "command_success": false}
[0m11:22:32.466921 [debug] [MainThread]: Command `dbt run` failed at 11:22:32.466799 after 0.99 seconds
[0m11:22:32.467312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9714f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e1e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9494fbd0>]}
[0m11:22:32.467614 [debug] [MainThread]: Flushing usage events
[0m11:22:47.358010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0649910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0afa290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0649a50>]}


============================== 11:22:47.362371 | 991131ec-a67f-44c6-b2cb-bc46d3538f3e ==============================
[0m11:22:47.362371 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:22:47.362855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select gold', 'send_anonymous_usage_stats': 'True'}
[0m11:22:47.627014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '991131ec-a67f-44c6-b2cb-bc46d3538f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f823ed0>]}
[0m11:22:47.668188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '991131ec-a67f-44c6-b2cb-bc46d3538f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0685e10>]}
[0m11:22:47.668715 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m11:22:47.673027 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:22:47.681068 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:22:47.681470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '991131ec-a67f-44c6-b2cb-bc46d3538f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0675250>]}
[0m11:22:48.553782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '991131ec-a67f-44c6-b2cb-bc46d3538f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3f9a90>]}
[0m11:22:48.564351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '991131ec-a67f-44c6-b2cb-bc46d3538f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f326210>]}
[0m11:22:48.564845 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m11:22:48.565311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '991131ec-a67f-44c6-b2cb-bc46d3538f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7ff110>]}
[0m11:22:48.567462 [info ] [MainThread]: 
[0m11:22:48.568212 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:22:48.569373 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:22:48.569698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:49.386254 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:22:49.393279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m11:22:49.394298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:51.255477 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:22:51.264378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '991131ec-a67f-44c6-b2cb-bc46d3538f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7ff1d0>]}
[0m11:22:51.266443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:22:51.267338 [info ] [MainThread]: 
[0m11:22:51.271320 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m11:22:51.272236 [info ] [Thread-1 (]: 1 of 1 START sql incremental model silver.weather_data_gold .................... [RUN]
[0m11:22:51.273699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.weather_data_gold)
[0m11:22:51.274293 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m11:22:51.290578 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:22:51.297707 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 11:22:51.274689 => 11:22:51.297299
[0m11:22:51.298396 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m11:22:51.367584 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:22:51.368125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:52.010801 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:22:52.012084 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."silver"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(ingestion_timestamp)           AS ingestion_date,
        observation_date,
        city                             AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather'                   AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(ingestion_timestamp)           AS ingestion_date,
        observation_date,
        city                            AS location,
        temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed               AS windspeed_mps,
        'openmeteo'                     AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:22:52.794003 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a6080d9b-a465-4d15-b083-3df15181eaa8
[0m11:23:00.516226 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 71e2f582-ccca-42c8-b268-8274ea220683
[0m11:23:14.193877 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a40bfa4a-f8c7-4864-8c2e-8dd7b8e74143
[0m11:23:39.862009 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID be1548d6-8a51-495e-94e9-e10e469f0919
[0m11:24:29.909710 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e87ade6d-82f1-4aaa-b1e3-65f3ef48a07c
[0m11:24:56.443389 [error] [MainThread]: CANCEL query model.silver.weather_data_gold .................................... [[31mCANCEL[0m]
[0m11:24:56.966238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:56.967482 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was left open.
[0m11:24:56.968202 [debug] [MainThread]: On model.silver.weather_data_gold: Close
[0m11:24:56.969103 [info ] [MainThread]: 
[0m11:24:56.969891 [info ] [MainThread]: Finished running  in 0 hours 2 minutes and 8.40 seconds (128.40s).
[0m11:24:56.971658 [error] [MainThread]: Encountered an error:

[0m11:24:56.992983 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:24:57.000167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 129.66304, "process_user_time": 3.362611, "process_kernel_time": 0.443983, "process_mem_max_rss": "172272", "process_in_blocks": "13456", "process_out_blocks": "4182", "command_success": false}
[0m11:24:57.001731 [debug] [MainThread]: Command `dbt run` failed at 11:24:57.001495 after 129.67 seconds
[0m11:24:57.004388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1852490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96505090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96583650>]}
[0m11:24:57.006720 [debug] [MainThread]: Flushing usage events
[0m11:25:13.225569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc55c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc55dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc57a90>]}


============================== 11:25:13.230074 | 5da21f8a-c10f-411a-9646-e1a25675f2e6 ==============================
[0m11:25:13.230074 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:25:13.230663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select gold', 'send_anonymous_usage_stats': 'True'}
[0m11:25:13.505852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5da21f8a-c10f-411a-9646-e1a25675f2e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad13f10>]}
[0m11:25:13.549182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5da21f8a-c10f-411a-9646-e1a25675f2e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ada7390>]}
[0m11:25:13.549818 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m11:25:13.554253 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:25:13.583208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:25:13.583779 [debug] [MainThread]: Partial parsing: updated file: silver://models/gold/weather_data_gold.sql
[0m11:25:13.771946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5da21f8a-c10f-411a-9646-e1a25675f2e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a52df50>]}
[0m11:25:13.782778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5da21f8a-c10f-411a-9646-e1a25675f2e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac43e90>]}
[0m11:25:13.783251 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m11:25:13.783857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5da21f8a-c10f-411a-9646-e1a25675f2e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a98f850>]}
[0m11:25:13.785088 [info ] [MainThread]: 
[0m11:25:13.785915 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:25:13.786849 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:25:13.787201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:14.823217 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:25:14.826055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now create_AwsDataCatalog_silver_gold)
[0m11:25:14.827338 [debug] [ThreadPool]: Creating schema "database: "AwsDataCatalog"
schema: "silver_gold"
"
[0m11:25:14.839647 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_silver_gold"
[0m11:25:14.840212 [debug] [ThreadPool]: On create_AwsDataCatalog_silver_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "connection_name": "create_AwsDataCatalog_silver_gold"} */
create schema if not exists `AwsDataCatalog`.`silver_gold`
  
[0m11:25:14.840706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:15.622219 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Athena query ID aaa602b8-54e0-47c6-b058-8ba5af16dcc0
[0m11:25:17.385119 [debug] [ThreadPool]: SQL status: OK -1 in 3.0 seconds
[0m11:25:17.392570 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Lakeformation is disabled for "AwsDataCatalog"."silver_gold"
[0m11:25:17.394165 [debug] [ThreadPool]: On create_AwsDataCatalog_silver_gold: Close
[0m11:25:17.401829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AwsDataCatalog_silver_gold, now list_AwsDataCatalog_silver_gold)
[0m11:25:17.402817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:18.799203 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m11:25:18.801391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now list_AwsDataCatalog_silver)
[0m11:25:18.801825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:25:20.322329 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:25:20.332750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5da21f8a-c10f-411a-9646-e1a25675f2e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98073890>]}
[0m11:25:20.338986 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:25:20.339707 [info ] [MainThread]: 
[0m11:25:20.343622 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m11:25:20.344604 [info ] [Thread-1 (]: 1 of 1 START sql incremental model silver_gold.weather_data_gold ............... [RUN]
[0m11:25:20.346025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.weather_data_gold)
[0m11:25:20.346488 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m11:25:20.364625 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:25:20.367605 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 11:25:20.347070 => 11:25:20.366718
[0m11:25:20.371143 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m11:25:20.523045 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:25:20.524291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:21.254259 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:25:21.258943 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."silver_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(ingestion_timestamp)           AS ingestion_date,
        observation_date,
        city                             AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather'                   AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(ingestion_timestamp)           AS ingestion_date,
        observation_date,
        city                            AS location,
        temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed               AS windspeed_mps,
        'openmeteo'                     AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:25:21.786667 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID fa28efc5-37d4-4ddf-9d83-63f6fafeca2f
[0m11:25:29.431749 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c49d457a-b7d1-4f65-ac09-54d7e19882c8
[0m11:25:43.369200 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4b113d1e-31d5-4493-be40-68c8d0c1d7c5
[0m11:26:03.861482 [error] [MainThread]: CANCEL query model.silver.weather_data_gold .................................... [[31mCANCEL[0m]
[0m11:26:04.055948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:04.057168 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was left open.
[0m11:26:04.058324 [debug] [MainThread]: On model.silver.weather_data_gold: Close
[0m11:26:04.059861 [info ] [MainThread]: 
[0m11:26:04.060916 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 50.27 seconds (50.27s).
[0m11:26:04.062729 [error] [MainThread]: Encountered an error:

[0m11:26:04.071334 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:26:04.076302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 50.874107, "process_user_time": 3.329512, "process_kernel_time": 0.48707, "process_mem_max_rss": "189460", "process_out_blocks": "4187", "command_success": false, "process_in_blocks": "0"}
[0m11:26:04.078447 [debug] [MainThread]: Command `dbt run` failed at 11:26:04.078209 after 50.88 seconds
[0m11:26:04.079609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc91610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a15bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1464d0>]}
[0m11:26:04.080765 [debug] [MainThread]: Flushing usage events
[0m11:26:29.792740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2571c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b972d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e0bf40>]}


============================== 11:26:29.799429 | 2ce51f60-8593-4b52-978b-debf4ac18d42 ==============================
[0m11:26:29.799429 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:26:29.799890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:26:30.512333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af4a460>]}
[0m11:26:30.562211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86bb9d60>]}
[0m11:26:30.562984 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:26:30.581326 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:26:30.717817 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:26:30.718588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a32d0a0>]}
[0m11:26:31.282502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9a2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7de462b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7de46880>]}


============================== 11:26:31.286693 | 896d8d65-f449-4596-a9b7-21af307b91dc ==============================
[0m11:26:31.286693 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:26:31.287171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:26:31.668347 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:26:31.670646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876162b0>]}
[0m11:26:31.734861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b355250>]}
[0m11:26:31.765928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f0fc100>]}
[0m11:26:31.766547 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:26:31.780508 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:26:31.886226 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:26:31.886946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea58f40>]}
[0m11:26:31.899624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86f72820>]}
[0m11:26:32.019936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e46400>]}
[0m11:26:32.020369 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 450 macros
[0m11:26:32.020662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ecd400>]}
[0m11:26:32.021978 [info ] [MainThread]: 
[0m11:26:32.022403 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:26:32.027056 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:26:32.027346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:32.798863 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:26:32.799373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bce5f70>]}
[0m11:26:32.918707 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:26:32.922308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:33.101254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6b18b0>]}
[0m11:26:33.271223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2443d0>]}
[0m11:26:33.271919 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 450 macros
[0m11:26:33.272305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3ce3d0>]}
[0m11:26:33.274302 [info ] [MainThread]: 
[0m11:26:33.274908 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:26:33.279785 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:26:33.280158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:33.661904 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:26:33.665301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver_gold)
[0m11:26:33.666462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:33.899370 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:26:33.900261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:34.580654 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:26:34.582857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver_gold)
[0m11:26:34.583286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:35.044034 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m11:26:35.054099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now list_AwsDataCatalog_silver)
[0m11:26:35.056001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:35.789961 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m11:26:35.792452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now list_AwsDataCatalog_silver)
[0m11:26:35.792891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:36.476268 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:26:36.484317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87215880>]}
[0m11:26:36.487454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:36.489098 [info ] [MainThread]: 
[0m11:26:36.509175 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m11:26:36.510311 [info ] [Thread-1  ]: 1 of 11 START sql view model silver.eia_bronze ................................. [RUN]
[0m11:26:36.511262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m11:26:36.511705 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m11:26:36.526768 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m11:26:36.528802 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m11:26:36.547367 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m11:26:36.549088 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m11:26:36.549446 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m11:26:36.549774 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:37.234739 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:26:37.241940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b744790>]}
[0m11:26:37.245072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:37.246819 [info ] [MainThread]: 
[0m11:26:37.264903 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m11:26:37.266041 [info ] [Thread-1  ]: 1 of 11 START sql view model silver.eia_bronze ................................. [RUN]
[0m11:26:37.266915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m11:26:37.267329 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m11:26:37.284221 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m11:26:37.285548 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m11:26:37.305857 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m11:26:37.306883 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m11:26:37.307167 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m11:26:37.307430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:37.351363 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 232acb1e-28cc-47ce-8902-6c2145ef8370
[0m11:26:37.960989 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 542b8389-9262-4d3a-8e42-03137c28ea0b
[0m11:26:39.161202 [debug] [Thread-1  ]: SQL status: OK -1 in 2.611 seconds
[0m11:26:39.750869 [debug] [Thread-1  ]: SQL status: OK -1 in 2.442 seconds
[0m11:26:40.411168 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['23', '22', '21', '20', '19', '18']
[0m11:26:40.418607 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['19', '18']
[0m11:26:40.954164 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 19 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m11:26:41.090202 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['23', '22', '21', '20', '18']
[0m11:26:41.092114 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['18']
[0m11:26:41.196208 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 18 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m11:26:41.218831 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m11:26:41.222326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a31fb50>]}
[0m11:26:41.224510 [info ] [Thread-1  ]: 1 of 11 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.71s]
[0m11:26:41.226009 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m11:26:41.227742 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m11:26:41.234552 [info ] [Thread-1  ]: 2 of 11 START sql view model silver.noaa_bronze ................................ [RUN]
[0m11:26:41.239595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m11:26:41.240516 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m11:26:41.247025 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m11:26:41.248943 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m11:26:41.252558 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m11:26:41.253952 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m11:26:41.254307 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m11:26:41.254636 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:41.592523 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: There was an error when expiring table version 18 with error: An error occurred (EntityNotFoundException) when calling the DeleteTableVersion operation: Table version (18) not found
[0m11:26:41.615153 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m11:26:41.617794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bbb7b20>]}
[0m11:26:41.620555 [info ] [Thread-1  ]: 1 of 11 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.35s]
[0m11:26:41.625350 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m11:26:41.626339 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m11:26:41.627696 [info ] [Thread-1  ]: 2 of 11 START sql view model silver.noaa_bronze ................................ [RUN]
[0m11:26:41.631385 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m11:26:41.632515 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m11:26:41.642499 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m11:26:41.644055 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m11:26:41.648207 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m11:26:41.650537 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m11:26:41.651603 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m11:26:41.652065 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:41.861757 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ef465ee7-8bf8-497f-a3df-2e9f7dd8bb3e
[0m11:26:42.275584 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3e94359a-24ce-4cfd-bba9-1ec255132a47
[0m11:26:43.859579 [debug] [Thread-1  ]: SQL status: OK -1 in 2.603 seconds
[0m11:26:44.040699 [debug] [Thread-1  ]: SQL status: OK -1 in 2.386 seconds
[0m11:26:44.135950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c55a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9f1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c99ee90>]}


============================== 11:26:44.147153 | 66969f1f-355c-41bf-b3f3-5d29b8aa6ca6 ==============================
[0m11:26:44.147153 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:26:44.147850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select gold', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:26:44.763813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66969f1f-355c-41bf-b3f3-5d29b8aa6ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b605890>]}
[0m11:26:44.816791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66969f1f-355c-41bf-b3f3-5d29b8aa6ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7feed0>]}
[0m11:26:44.817571 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m11:26:44.827656 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:26:44.849905 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:26:44.853775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66969f1f-355c-41bf-b3f3-5d29b8aa6ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b696c50>]}
[0m11:26:45.123661 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['24', '23', '22', '21', '20', '19']
[0m11:26:45.131054 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['20', '19']
[0m11:26:45.278313 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['24', '23', '22', '21', '20', '19']
[0m11:26:45.283421 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['20', '19']
[0m11:26:45.659494 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 20 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m11:26:45.668363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66969f1f-355c-41bf-b3f3-5d29b8aa6ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3a2790>]}
[0m11:26:45.682449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66969f1f-355c-41bf-b3f3-5d29b8aa6ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4a0ed0>]}
[0m11:26:45.682863 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m11:26:45.684791 [info ] [MainThread]: 
[0m11:26:45.685434 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:26:45.686403 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:26:45.686691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:45.825782 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: There was an error when expiring table version 20 with error: An error occurred (EntityNotFoundException) when calling the DeleteTableVersion operation: Table version (20) not found
[0m11:26:45.877672 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 19 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m11:26:45.884536 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m11:26:45.887683 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2499d0>]}
[0m11:26:45.891679 [info ] [Thread-1  ]: 2 of 11 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.65s]
[0m11:26:45.893159 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m11:26:45.894255 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m11:26:45.895565 [info ] [Thread-1  ]: 3 of 11 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m11:26:45.902301 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m11:26:45.902819 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m11:26:45.915557 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m11:26:45.916925 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m11:26:45.919971 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m11:26:45.921239 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m11:26:45.921571 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m11:26:45.921895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:46.050213 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: There was an error when expiring table version 19 with error: An error occurred (EntityNotFoundException) when calling the DeleteTableVersion operation: Table version (19) not found
[0m11:26:46.061715 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m11:26:46.063611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc37c10>]}
[0m11:26:46.065439 [info ] [Thread-1  ]: 2 of 11 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.43s]
[0m11:26:46.068366 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m11:26:46.070136 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m11:26:46.071320 [info ] [Thread-1  ]: 3 of 11 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m11:26:46.073616 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m11:26:46.075102 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m11:26:46.086999 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m11:26:46.090891 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m11:26:46.093809 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m11:26:46.094867 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m11:26:46.095219 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m11:26:46.095760 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:46.437554 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:26:46.442163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver_gold)
[0m11:26:46.442669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:46.738107 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 06bb4821-7893-4a80-856c-fb02f4d00a5c
[0m11:26:46.844823 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c80fbee8-10dc-46bf-b71d-0c725df0625f
[0m11:26:47.892252 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m11:26:47.894719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now list_AwsDataCatalog_silver)
[0m11:26:47.895177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:48.539173 [debug] [Thread-1  ]: SQL status: OK -1 in 2.615 seconds
[0m11:26:48.612534 [debug] [Thread-1  ]: SQL status: OK -1 in 2.516 seconds
[0m11:26:49.314680 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:26:49.325145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66969f1f-355c-41bf-b3f3-5d29b8aa6ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9f46d0>]}
[0m11:26:49.327260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:49.328130 [info ] [MainThread]: 
[0m11:26:49.332009 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m11:26:49.332900 [info ] [Thread-1 (]: 1 of 6 START sql incremental model silver_gold.weather_data_gold ............... [RUN]
[0m11:26:49.333869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.weather_data_gold)
[0m11:26:49.334305 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m11:26:49.347226 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:26:49.348581 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 11:26:49.337693 => 11:26:49.348374
[0m11:26:49.348891 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m11:26:49.403528 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:26:49.404112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:49.752688 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['24', '23', '22', '21', '20', '19']
[0m11:26:49.756994 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['20', '19']
[0m11:26:49.773216 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['24', '23', '22', '21', '20', '19']
[0m11:26:49.776261 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['20', '19']
[0m11:26:50.150966 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:26:50.154505 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."silver_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(ingestion_timestamp)           AS ingestion_date,
        observation_date,
        city                             AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather'                   AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(ingestion_timestamp)           AS ingestion_date,
        observation_date,
        city                            AS location,
        temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed               AS windspeed_mps,
        'openmeteo'                     AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:26:50.415810 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 20 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m11:26:50.448735 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: There was an error when expiring table version 20 with error: An error occurred (EntityNotFoundException) when calling the DeleteTableVersion operation: Table version (20) not found
[0m11:26:50.672865 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 19 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m11:26:50.681801 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m11:26:50.683539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab35a60>]}
[0m11:26:50.685421 [info ] [Thread-1  ]: 3 of 11 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.61s]
[0m11:26:50.688949 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m11:26:50.706007 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m11:26:50.709006 [info ] [Thread-1  ]: 4 of 11 START sql view model silver.openweather_bronze ......................... [RUN]
[0m11:26:50.723128 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: There was an error when expiring table version 19 with error: An error occurred (EntityNotFoundException) when calling the DeleteTableVersion operation: Table version (19) not found
[0m11:26:50.719739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m11:26:50.730647 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m11:26:50.743225 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 58af8913-930a-49cb-a1d5-bc6a47f8f1df
[0m11:26:50.761047 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m11:26:50.761617 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m11:26:50.773261 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m11:26:50.773477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5140a0>]}
[0m11:26:50.777029 [info ] [Thread-1  ]: 3 of 11 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.87s]
[0m11:26:50.787441 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m11:26:50.791605 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m11:26:50.791560 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m11:26:50.793396 [info ] [Thread-1  ]: 4 of 11 START sql view model silver.openweather_bronze ......................... [RUN]
[0m11:26:50.794083 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m11:26:50.795332 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m11:26:50.797254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:50.800372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m11:26:50.801327 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m11:26:50.821349 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m11:26:50.823546 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m11:26:50.835349 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m11:26:50.837183 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m11:26:50.837799 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m11:26:50.838280 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:51.440147 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a6236bc8-e0c9-4120-be0a-4911d07f4991
[0m11:26:51.444331 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0fed7fc4-188e-42b6-a87c-3a296fd0fc81
[0m11:26:53.189285 [debug] [Thread-1  ]: SQL status: OK -1 in 2.351 seconds
[0m11:26:53.202994 [debug] [Thread-1  ]: SQL status: OK -1 in 2.406 seconds
[0m11:26:54.531667 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['24', '23', '22', '21', '20', '19']
[0m11:26:54.536779 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['20', '19']
[0m11:26:54.544165 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['24', '23', '22', '21', '20', '19']
[0m11:26:54.548650 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['20', '19']
[0m11:26:55.069107 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 20 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m11:26:55.089822 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: There was an error when expiring table version 20 with error: An error occurred (EntityNotFoundException) when calling the DeleteTableVersion operation: Table version (20) not found
[0m11:26:55.294864 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 19 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m11:26:55.303961 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m11:26:55.306117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd7c4f0>]}
[0m11:26:55.307908 [info ] [Thread-1  ]: 4 of 11 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.59s]
[0m11:26:55.309818 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m11:26:55.310753 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m11:26:55.313475 [info ] [Thread-1  ]: 5 of 11 START sql view model silver.sensor_bronze .............................. [RUN]
[0m11:26:55.318445 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m11:26:55.319229 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m11:26:55.328377 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m11:26:55.331744 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m11:26:55.536290 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: There was an error when expiring table version 19 with error: An error occurred (EntityNotFoundException) when calling the DeleteTableVersion operation: Table version (19) not found
[0m11:26:55.539867 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m11:26:55.540729 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff842074f0>]}
[0m11:26:55.541767 [info ] [Thread-1  ]: 4 of 11 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.75s]
[0m11:26:55.542494 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m11:26:55.543023 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m11:26:55.541156 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m11:26:55.544127 [info ] [Thread-1  ]: 5 of 11 START sql view model silver.sensor_bronze .............................. [RUN]
[0m11:26:55.546431 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m11:26:55.546972 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m11:26:55.548688 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m11:26:55.550443 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m11:26:55.550731 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:55.550161 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m11:26:55.557339 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m11:26:55.559784 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m11:26:55.561895 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m11:26:55.562147 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m11:26:55.562355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:26:56.176670 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4ee63978-06ec-445d-83e1-639268fe1a88
[0m11:26:56.193345 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1239d5c8-a05b-4b32-9267-7f85eaa285f9
[0m11:26:57.961207 [debug] [Thread-1  ]: SQL status: OK -1 in 2.396 seconds
[0m11:26:58.023246 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2b0cd482-ea7a-4619-b930-5cbd5d54aa9c
[0m11:26:58.398073 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID da3591c3-b432-4879-a79e-905f5cfb7293
[0m11:26:59.378332 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['23', '22', '21', '20', '19', '18']
[0m11:26:59.380511 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['19', '18']
[0m11:26:59.745872 [debug] [Thread-1  ]: SQL status: OK -1 in 4.195 seconds
[0m11:26:59.897366 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 19 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m11:27:00.115258 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 18 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m11:27:00.162567 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m11:27:00.172908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886ec4c0>]}
[0m11:27:00.177076 [info ] [Thread-1  ]: 5 of 11 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.63s]
[0m11:27:00.191031 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m11:27:00.201279 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m11:27:00.214759 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m11:27:00.284198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m11:27:00.286876 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m11:27:00.347896 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m11:27:00.353620 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m11:27:00.432150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:01.077473 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['23', '22', '21', '20']
[0m11:27:01.082309 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m11:27:01.089669 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m11:27:01.091699 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff791b12e0>]}
[0m11:27:01.093577 [info ] [Thread-1  ]: 5 of 11 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 5.78s]
[0m11:27:01.096267 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m11:27:01.100524 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m11:27:01.103179 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m11:27:01.105753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m11:27:01.107803 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m11:27:01.118167 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m11:27:01.119447 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m11:27:01.148538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:01.783629 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:27:01.786069 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:01.792164 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:27:02.315314 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:27:02.316611 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:02.320557 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:27:02.966837 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:27:02.969339 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:02.971340 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/bd474f3a-15a8-4f3e-b4ab-20d0b0383385
[0m11:27:03.445455 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:27:03.447374 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:03.448385 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/bd474f3a-15a8-4f3e-b4ab-20d0b0383385
[0m11:27:03.857419 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/bd474f3a-15a8-4f3e-b4ab-20d0b0383385', bucket='climate-energy-raw-data', prefix='silver/eia_silver/bd474f3a-15a8-4f3e-b4ab-20d0b0383385/'
[0m11:27:04.139243 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/bd474f3a-15a8-4f3e-b4ab-20d0b0383385', bucket='climate-energy-raw-data', prefix='silver/eia_silver/bd474f3a-15a8-4f3e-b4ab-20d0b0383385/'
[0m11:27:05.981626 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."eia_silver" does not exist and will not be deleted, ignoring
[0m11:27:05.990854 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m11:27:06.016288 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:27:06.018618 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:27:06.476323 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:27:06.477450 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/1d25918c-fb0c-4b05-baee-a92aad07de7d',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m11:27:06.501599 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:27:06.502617 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/8ef657f6-4698-48c2-ba5c-db2f625e99c7',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m11:27:06.978930 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3b1a129c-21c2-45d9-9190-c82a2fa56a9c
[0m11:27:07.005241 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0af670c6-331a-4a05-840c-9d558e8e7b52
[0m11:27:09.821971 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m11:27:09.830550 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:27:09.831413 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m11:27:10.087430 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ffbb4447-da1c-4af8-ab70-bc37ef09a84a
[0m11:27:11.958186 [debug] [Thread-1  ]: SQL status: OK -1 in 2.125 seconds
[0m11:27:11.968552 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m11:27:11.981367 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:27:11.982134 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m11:27:12.082734 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 37416aa2-0942-48c7-b1af-ee1921c1841d
[0m11:27:12.219009 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e074b137-d41e-41d2-a0a5-f8436cc6f222
[0m11:27:14.079123 [debug] [Thread-1  ]: SQL status: OK 2842 in 2.096 seconds
[0m11:27:14.090072 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m11:27:14.092279 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa00310>]}
[0m11:27:14.094160 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 13.83s]
[0m11:27:14.096066 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m11:27:14.099270 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m11:27:14.100712 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m11:27:14.106653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m11:27:14.107376 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m11:27:14.115516 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m11:27:14.117105 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m11:27:14.122556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:15.285646 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4e8bbe46-6a36-47cb-b66b-088883f1b488
[0m11:27:15.587722 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:27:15.589943 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:15.591185 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:27:16.906253 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:27:16.907597 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:16.908483 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/6ac3fcdc-23b7-40ea-bd18-70634e5b3a3c
[0m11:27:17.452651 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5567e141-c3d4-4614-979b-dfe6c48832bc
[0m11:27:17.544367 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/6ac3fcdc-23b7-40ea-bd18-70634e5b3a3c', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/6ac3fcdc-23b7-40ea-bd18-70634e5b3a3c/'
[0m11:27:19.774769 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m11:27:19.778488 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:27:20.491274 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:27:20.493528 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/8f1377c9-2fa0-4755-826b-fab1324eff82',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m11:27:21.043817 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3b2b2630-aeea-43b9-81fd-aca75377ea08
[0m11:27:22.853682 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m11:27:22.859186 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:27:22.860094 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m11:27:23.085291 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5155045a-9a5a-4d91-9edd-5ab61aa8df71
[0m11:27:24.990553 [debug] [Thread-1  ]: SQL status: OK -1 in 2.130 seconds
[0m11:27:24.992122 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m11:27:24.993469 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:27:24.993787 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m11:27:25.206752 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 06e2433c-91f0-4db9-b3c8-b44986cfd8f7
[0m11:27:25.589831 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 64054492-60d4-48a0-aa21-672e43a1e9a9
[0m11:27:27.015241 [debug] [Thread-1  ]: SQL status: OK 305 in 2.021 seconds
[0m11:27:27.017611 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m11:27:27.018156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c514100>]}
[0m11:27:27.018690 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 12.92s]
[0m11:27:27.019351 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m11:27:27.019885 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m11:27:27.020607 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m11:27:27.022809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m11:27:27.023124 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m11:27:27.026183 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m11:27:27.027143 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m11:27:27.029371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:28.267073 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:27:28.268203 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:28.269466 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:27:29.427372 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:27:29.427972 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:29.428448 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/987cbd42-062c-4968-b896-a36c2d0c5543
[0m11:27:29.942879 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/987cbd42-062c-4968-b896-a36c2d0c5543', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/987cbd42-062c-4968-b896-a36c2d0c5543/'
[0m11:27:32.034541 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m11:27:32.043576 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:27:32.548914 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:27:32.550980 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/a567541d-1c4f-42b7-a7e0-f30f200695b7',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m11:27:33.097223 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 95e291cf-b69d-460d-9770-d93f388b5caf
[0m11:27:36.039213 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m11:27:36.044584 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:27:36.045685 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m11:27:36.266055 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9c6bac98-4af6-499d-a4bc-fa00f839ab95
[0m11:27:37.687696 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID afdf4cb3-ae60-484a-8cf8-5e32578df16e
[0m11:27:37.988171 [debug] [Thread-1  ]: SQL status: OK -1 in 1.941 seconds
[0m11:27:37.992942 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m11:27:37.995745 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:27:37.996200 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m11:27:38.221594 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8b37db7a-2f64-4b7c-8b4a-27d58ac64c0b
[0m11:27:39.988003 [debug] [Thread-1  ]: SQL status: OK 12458 in 1.991 seconds
[0m11:27:39.997213 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m11:27:40.001184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff886ec4c0>]}
[0m11:27:40.004364 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 12.98s]
[0m11:27:40.008821 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m11:27:40.011008 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m11:27:40.013961 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m11:27:40.023056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m11:27:40.025007 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m11:27:40.046253 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m11:27:40.056322 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m11:27:40.072311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:42.278199 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:27:42.283030 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:42.289951 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:27:43.984636 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:27:43.999415 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:44.004087 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/f371c6c2-08f5-415a-888c-51adbe2d42a7
[0m11:27:45.295897 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/f371c6c2-08f5-415a-888c-51adbe2d42a7', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/f371c6c2-08f5-415a-888c-51adbe2d42a7/'
[0m11:27:47.406634 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m11:27:47.424023 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:27:48.001462 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:27:48.007277 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/8aee09ce-68d5-4226-b565-5423e8e7010e',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m11:27:48.921789 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5d5e5f8e-8e11-401b-8b65-96a01280011c
[0m11:27:51.081674 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m11:27:51.095336 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:27:51.098364 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m11:27:51.330215 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0e0965ee-e750-489a-b8d0-cdbc84eebff4
[0m11:27:53.170198 [debug] [Thread-1  ]: SQL status: OK -1 in 2.068 seconds
[0m11:27:53.185698 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m11:27:53.193351 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:27:53.194013 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m11:27:53.454431 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3c5e1b0c-423e-4f25-9bbf-4365a40e0119
[0m11:27:55.503570 [debug] [Thread-1  ]: SQL status: OK 473 in 2.308 seconds
[0m11:27:55.515892 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m11:27:55.518996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874a03a0>]}
[0m11:27:55.521739 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 15.50s]
[0m11:27:55.524262 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m11:27:55.525943 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m11:27:55.528957 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m11:27:55.536047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m11:27:55.537096 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m11:27:55.550380 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m11:27:55.551954 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m11:27:55.556137 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:57.071740 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:27:57.073020 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:57.074784 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:27:58.308422 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:27:58.308836 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:58.309140 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/a2081cd2-0fb0-4b61-b64e-e26cec7b8bed
[0m11:27:58.852264 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/a2081cd2-0fb0-4b61-b64e-e26cec7b8bed', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/a2081cd2-0fb0-4b61-b64e-e26cec7b8bed/'
[0m11:28:01.011666 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m11:28:01.016222 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:28:01.527780 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:28:01.530818 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/91b74c97-daac-41ef-aacf-0fd79d0e9b00',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m11:28:02.082907 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5fd7f538-9ce6-4904-bfc7-0025be25b43b
[0m11:28:05.007099 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m11:28:05.013518 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:28:05.014075 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m11:28:05.241093 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a734bfcb-2ca8-4671-ac44-92dfe7465e6b
[0m11:28:05.480985 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 542a8dab-8c07-45a9-8005-a0f0fcfbc924
[0m11:28:06.979333 [debug] [Thread-1  ]: SQL status: OK -1 in 1.965 seconds
[0m11:28:06.983341 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m11:28:06.985350 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:28:06.985678 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m11:28:07.201944 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5afa263e-4bc4-427f-ac2c-c80a05829df5
[0m11:28:09.001957 [debug] [Thread-1  ]: SQL status: OK 700 in 2.015 seconds
[0m11:28:09.012740 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m11:28:09.015504 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a32d160>]}
[0m11:28:09.018309 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 13.48s]
[0m11:28:09.020841 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m11:28:09.022565 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m11:28:09.024977 [info ] [Thread-1  ]: 11 of 11 START sql incremental model silver_gold.weather_data_gold ............. [RUN]
[0m11:28:09.031295 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m11:28:09.032283 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m11:28:09.046248 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:28:09.047763 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m11:28:09.093710 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:28:09.094258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:28:09.644487 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:28:09.646021 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."silver_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(ingestion_timestamp)           AS ingestion_date,
        observation_date,
        city                             AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather'                   AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(ingestion_timestamp)           AS ingestion_date,
        observation_date,
        city                            AS location,
        temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed               AS windspeed_mps,
        'openmeteo'                     AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:28:10.200386 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c2f19575-12ad-40cd-9817-5f171eef833e
[0m11:28:15.817411 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5cbfd35b-c8bd-4ce6-9248-8f896ef26fe2
[0m11:28:18.043283 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7768b785-7fba-4b05-989b-06f621d7ee38
[0m11:28:26.317703 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cca91e99-000f-4161-8ba7-741f31ddd51d
[0m11:28:27.669523 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 595fda7b-0431-4d21-9925-13f423d659ae
[0m11:28:40.679542 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e340a956-3c2d-4a3d-a23a-0860007795cd
[0m11:31:57.604801 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 88f6ea3a-e7df-42a5-8891-93b001ee6e16
[0m11:31:58.342394 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.eia_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/88f6ea3a-e7df-42a5-8891-93b001ee6e16' before retrying. Athena will not delete data in your account.
[0m11:31:58.347324 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m11:31:58.352123 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.eia_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/88f6ea3a-e7df-42a5-8891-93b001ee6e16' before retrying. Athena will not delete data in your account.
[0m11:31:58.367093 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 145, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.eia_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/88f6ea3a-e7df-42a5-8891-93b001ee6e16' before retrying. Athena will not delete data in your account.

[0m11:31:58.369205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2f95e0>]}
[0m11:31:58.372029 [error] [Thread-1  ]: 6 of 11 ERROR creating sql table model silver.eia_silver ....................... [[31mERROR[0m in 297.26s]
[0m11:31:58.373186 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m11:31:58.373936 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m11:31:58.375366 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m11:31:58.375992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m11:31:58.376373 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m11:31:58.385400 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m11:31:58.387849 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m11:31:58.391361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:32:03.005509 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:32:03.011225 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:32:03.017873 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:32:04.880541 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:32:04.882578 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:32:04.883265 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/8f1377c9-2fa0-4755-826b-fab1324eff82
[0m11:32:05.528233 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/8f1377c9-2fa0-4755-826b-fab1324eff82', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/8f1377c9-2fa0-4755-826b-fab1324eff82/'
[0m11:32:07.025470 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID adca70f9-db85-4bd6-8c31-b3064b2e2244
[0m11:32:07.988336 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 52969ec6-56c0-4b53-b565-b07956ed0749
[0m11:32:08.924343 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/adca70f9-db85-4bd6-8c31-b3064b2e2244' before retrying. Athena will not delete data in your account.
[0m11:32:08.928342 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m11:32:08.931624 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/adca70f9-db85-4bd6-8c31-b3064b2e2244' before retrying. Athena will not delete data in your account.
[0m11:32:08.942566 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 181, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/adca70f9-db85-4bd6-8c31-b3064b2e2244' before retrying. Athena will not delete data in your account.

[0m11:32:08.947035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ce51f60-8593-4b52-978b-debf4ac18d42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f47d130>]}
[0m11:32:08.950701 [error] [Thread-1  ]: 11 of 11 ERROR creating sql incremental model silver_gold.weather_data_gold .... [[31mERROR[0m in 239.92s]
[0m11:32:08.952135 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m11:32:08.965105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:08.965563 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m11:32:08.966558 [info ] [MainThread]: 
[0m11:32:08.967461 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 5 minutes and 36.94 seconds (336.94s).
[0m11:32:08.974319 [debug] [MainThread]: Command end result
[0m11:32:09.035429 [info ] [MainThread]: 
[0m11:32:09.036046 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:32:09.036333 [info ] [MainThread]: 
[0m11:32:09.036659 [error] [MainThread]:   COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/adca70f9-db85-4bd6-8c31-b3064b2e2244' before retrying. Athena will not delete data in your account.
[0m11:32:09.036920 [info ] [MainThread]: 
[0m11:32:09.037280 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m11:32:09.045584 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 339.30408, "process_user_time": 13.559285, "process_kernel_time": 1.610453, "process_mem_max_rss": "191780", "process_in_blocks": "10896", "process_out_blocks": "3757", "command_success": false}
[0m11:32:09.047340 [debug] [MainThread]: Command `dbt run` failed at 11:32:09.047202 after 339.31 seconds
[0m11:32:09.048884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2571c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af4a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85e5aca0>]}
[0m11:32:09.049199 [debug] [MainThread]: Flushing usage events
[0m11:32:09.590505 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m11:32:09.601155 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:32:10.462445 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/52969ec6-56c0-4b53-b565-b07956ed0749' before retrying. Athena will not delete data in your account.
[0m11:32:10.524293 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 11:26:49.349104 => 11:32:10.519029
[0m11:32:10.526668 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m11:32:10.540243 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/52969ec6-56c0-4b53-b565-b07956ed0749' before retrying. Athena will not delete data in your account.
[0m11:32:10.603160 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 154, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/52969ec6-56c0-4b53-b565-b07956ed0749' before retrying. Athena will not delete data in your account.

[0m11:32:10.611164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66969f1f-355c-41bf-b3f3-5d29b8aa6ca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937296d0>]}
[0m11:32:10.619427 [error] [Thread-1 (]: 1 of 6 ERROR creating sql incremental model silver_gold.weather_data_gold ...... [[31mERROR[0m in 321.27s]
[0m11:32:10.621486 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m11:32:10.642447 [debug] [Thread-1 (]: Began running node test.silver.accepted_values_weather_data_gold_source__openweather__openmeteo.b312da2c6c
[0m11:32:10.643773 [info ] [Thread-1 (]: 2 of 6 SKIP test accepted_values_weather_data_gold_source__openweather__openmeteo  [[33mSKIP[0m]
[0m11:32:10.644991 [debug] [Thread-1 (]: Finished running node test.silver.accepted_values_weather_data_gold_source__openweather__openmeteo.b312da2c6c
[0m11:32:10.645690 [debug] [Thread-1 (]: Began running node test.silver.dbt_utils_expression_is_true_weather_data_gold_temperature__temperature_BETWEEN_40_AND_60.a27391fc6b
[0m11:32:10.646352 [info ] [Thread-1 (]: 3 of 6 SKIP test dbt_utils_expression_is_true_weather_data_gold_temperature__temperature_BETWEEN_40_AND_60  [[33mSKIP[0m]
[0m11:32:10.646831 [debug] [Thread-1 (]: Finished running node test.silver.dbt_utils_expression_is_true_weather_data_gold_temperature__temperature_BETWEEN_40_AND_60.a27391fc6b
[0m11:32:10.647523 [debug] [Thread-1 (]: Began running node test.silver.dbt_utils_unique_combination_of_columns_weather_data_gold_ingestion_date__source.f6101e1dc2
[0m11:32:10.648091 [info ] [Thread-1 (]: 4 of 6 SKIP test dbt_utils_unique_combination_of_columns_weather_data_gold_ingestion_date__source  [[33mSKIP[0m]
[0m11:32:10.648429 [debug] [Thread-1 (]: Finished running node test.silver.dbt_utils_unique_combination_of_columns_weather_data_gold_ingestion_date__source.f6101e1dc2
[0m11:32:10.648752 [debug] [Thread-1 (]: Began running node test.silver.not_null_weather_data_gold_ingestion_date.360bc97368
[0m11:32:10.649077 [info ] [Thread-1 (]: 5 of 6 SKIP test not_null_weather_data_gold_ingestion_date ..................... [[33mSKIP[0m]
[0m11:32:10.649367 [debug] [Thread-1 (]: Finished running node test.silver.not_null_weather_data_gold_ingestion_date.360bc97368
[0m11:32:10.649653 [debug] [Thread-1 (]: Began running node test.silver.not_null_weather_data_gold_observation_date.fe2a199ec5
[0m11:32:10.650203 [info ] [Thread-1 (]: 6 of 6 SKIP test not_null_weather_data_gold_observation_date ................... [[33mSKIP[0m]
[0m11:32:10.650658 [debug] [Thread-1 (]: Finished running node test.silver.not_null_weather_data_gold_observation_date.fe2a199ec5
[0m11:32:10.656791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:10.657468 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m11:32:10.658476 [info ] [MainThread]: 
[0m11:32:10.659302 [info ] [MainThread]: Finished running 1 incremental model, 5 tests in 0 hours 5 minutes and 24.97 seconds (324.97s).
[0m11:32:10.662667 [debug] [MainThread]: Command end result
[0m11:32:10.707056 [info ] [MainThread]: 
[0m11:32:10.709972 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:32:10.710746 [info ] [MainThread]: 
[0m11:32:10.711654 [error] [MainThread]:   COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/52969ec6-56c0-4b53-b565-b07956ed0749' before retrying. Athena will not delete data in your account.
[0m11:32:10.712586 [info ] [MainThread]: 
[0m11:32:10.713211 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 TOTAL=6
[0m11:32:10.721272 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 326.61597, "process_user_time": 4.267485, "process_kernel_time": 0.855383, "process_mem_max_rss": "185420", "process_in_blocks": "68976", "process_out_blocks": "5168", "command_success": false}
[0m11:32:10.737079 [debug] [MainThread]: Command `dbt build` failed at 11:32:10.736280 after 326.63 seconds
[0m11:32:10.742804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fa1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19d5a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19d5790>]}
[0m11:32:10.743946 [debug] [MainThread]: Flushing usage events
[0m11:32:11.077130 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:32:11.082878 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/9569caa7-2f25-4d46-8e63-5d75dc84886e',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m11:32:13.924087 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 30eb0ab9-8d38-4e02-8441-f3293b241723
[0m11:32:17.864131 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m11:32:17.876548 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:32:17.877952 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m11:32:18.202037 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0dad10a4-ead9-4685-b4c7-a78fe13fd46b
[0m11:32:20.341945 [debug] [Thread-1  ]: SQL status: OK -1 in 2.444 seconds
[0m11:32:20.418525 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m11:32:20.425159 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:32:20.426749 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m11:32:20.694198 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 08cb6035-26d6-4a14-97d6-25abf476fb53
[0m11:32:22.637993 [debug] [Thread-1  ]: SQL status: OK 305 in 2.209 seconds
[0m11:32:22.652149 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m11:32:22.654397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc37ca0>]}
[0m11:32:22.656216 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 24.28s]
[0m11:32:22.657816 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m11:32:22.659605 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m11:32:22.661401 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m11:32:22.667346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m11:32:22.668659 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m11:32:22.677897 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m11:32:22.679277 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m11:32:22.682396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:32:24.102690 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:32:24.103344 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:32:24.103849 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:32:25.406894 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:32:25.408282 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:32:25.408797 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/a567541d-1c4f-42b7-a7e0-f30f200695b7
[0m11:32:26.156806 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/a567541d-1c4f-42b7-a7e0-f30f200695b7', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/a567541d-1c4f-42b7-a7e0-f30f200695b7/'
[0m11:32:28.640147 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m11:32:28.648013 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:32:29.289618 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:32:29.292172 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/eb251c8c-4bb9-47ba-92ef-ec46dd25ba69',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m11:32:29.907564 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 21fe5ad0-3fd9-49b3-b8c2-07fe97f64cce
[0m11:32:33.609556 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m11:32:33.620268 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:32:33.620916 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m11:32:33.973778 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 92a2d109-3087-49d1-8448-f3eeffd6b818
[0m11:32:36.261584 [debug] [Thread-1  ]: SQL status: OK -1 in 2.640 seconds
[0m11:32:36.265148 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m11:32:36.266747 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:32:36.267085 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m11:32:36.695888 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0f59ef73-6a33-4d85-befc-e46617e6827e
[0m11:32:38.854880 [debug] [Thread-1  ]: SQL status: OK 12458 in 2.585 seconds
[0m11:32:38.871774 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m11:32:38.874499 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff792ff220>]}
[0m11:32:38.876749 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 16.21s]
[0m11:32:38.878738 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m11:32:38.880400 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m11:32:38.882434 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m11:32:38.892397 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m11:32:38.893225 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m11:32:38.903460 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m11:32:38.906258 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m11:32:38.911460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:32:40.583320 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:32:40.585300 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:32:40.587520 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:32:41.923195 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:32:41.925388 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:32:41.928313 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/8aee09ce-68d5-4226-b565-5423e8e7010e
[0m11:32:42.659910 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/8aee09ce-68d5-4226-b565-5423e8e7010e', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/8aee09ce-68d5-4226-b565-5423e8e7010e/'
[0m11:32:44.946471 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m11:32:44.962806 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:32:45.496608 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:32:45.503248 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/7fc3761d-7297-48cb-bef0-1b6b438cdb6f',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m11:32:46.105802 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID be25cc91-9c89-4248-afc0-f5f5022d5001
[0m11:32:49.258973 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m11:32:49.265971 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:32:49.266816 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m11:32:49.491250 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3824d1b8-1a86-4a3f-b796-65a06d3df4ce
[0m11:32:51.401129 [debug] [Thread-1  ]: SQL status: OK -1 in 2.132 seconds
[0m11:32:51.412707 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m11:32:51.427871 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:32:51.428444 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m11:32:51.664615 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4e7de58c-ebd1-443a-94fa-4e714f26b7a8
[0m11:32:53.590165 [debug] [Thread-1  ]: SQL status: OK 473 in 2.161 seconds
[0m11:32:53.602934 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m11:32:53.605664 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4d9910>]}
[0m11:32:53.607516 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 14.72s]
[0m11:32:53.609020 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m11:32:53.610378 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m11:32:53.612377 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m11:32:53.619359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m11:32:53.620228 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m11:32:53.629321 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m11:32:53.630672 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m11:32:53.634430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:32:55.255170 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:32:55.255574 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:32:55.255897 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:32:56.501434 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:32:56.503123 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:32:56.503822 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/91b74c97-daac-41ef-aacf-0fd79d0e9b00
[0m11:32:57.152251 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/91b74c97-daac-41ef-aacf-0fd79d0e9b00', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/91b74c97-daac-41ef-aacf-0fd79d0e9b00/'
[0m11:32:59.439193 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m11:32:59.465719 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:33:00.131325 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:33:00.140229 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/de938a70-95cf-4179-a3ad-151977677bf9',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m11:33:01.345379 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3a08b92c-4247-415a-8fc0-62e39cddafe0
[0m11:33:04.373930 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m11:33:04.379045 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:33:04.379785 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m11:33:04.612577 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 54f9cb1f-86b7-4a8d-b2ef-4904434cc126
[0m11:33:06.644863 [debug] [Thread-1  ]: SQL status: OK -1 in 2.264 seconds
[0m11:33:06.652579 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m11:33:06.658884 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:33:06.659631 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m11:33:06.886857 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 709a8392-5d7e-4c74-a4f0-1929eb42a770
[0m11:33:08.773815 [debug] [Thread-1  ]: SQL status: OK 700 in 2.113 seconds
[0m11:33:08.779417 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m11:33:08.781361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcfe790>]}
[0m11:33:08.783116 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 15.17s]
[0m11:33:08.786965 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m11:33:08.789366 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m11:33:08.791487 [info ] [Thread-1  ]: 11 of 11 START sql incremental model silver_gold.weather_data_gold ............. [RUN]
[0m11:33:08.795424 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m11:33:08.796331 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m11:33:08.807505 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:33:08.808802 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m11:33:08.852344 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:33:08.852854 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:33:10.077385 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:33:10.078033 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."silver_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(ingestion_timestamp)           AS ingestion_date,
        observation_date,
        city                             AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather'                   AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(ingestion_timestamp)           AS ingestion_date,
        observation_date,
        city                            AS location,
        temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed               AS windspeed_mps,
        'openmeteo'                     AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:33:10.921086 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e1894b6b-0d36-4c33-9c93-fff5b17c4a0a
[0m11:33:15.486150 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0cfbed1b-cf69-4c8f-8c4d-e744c211d796
[0m11:33:20.078060 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 67934ef6-2a47-4074-9d43-6755eca3fce5
[0m11:33:29.784483 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b54f51a2-3ca5-4a63-9e5e-2ef50b7d1bf0
[0m11:34:04.860641 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 560ad509-23e6-4497-b19a-57f592f573d8
[0m11:34:44.723016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0f2290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a4dced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0ec750>]}


============================== 11:34:44.729700 | 15ad4b0e-8410-4477-897d-d05ba6038613 ==============================
[0m11:34:44.729700 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:34:44.730111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:34:44.730436 [info ] [MainThread]: dbt version: 1.7.9
[0m11:34:44.730667 [info ] [MainThread]: python version: 3.11.14
[0m11:34:44.730863 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m11:34:44.731185 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m11:34:45.002914 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m11:34:45.003535 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m11:34:45.004007 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m11:34:45.004599 [info ] [MainThread]: adapter type: athena
[0m11:34:45.004892 [info ] [MainThread]: adapter version: 1.7.2
[0m11:34:45.048982 [info ] [MainThread]: Configuration:
[0m11:34:45.049568 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:34:45.049861 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:34:45.050247 [info ] [MainThread]: Required dependencies:
[0m11:34:45.050614 [debug] [MainThread]: Executing "git --help"
[0m11:34:45.064130 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:34:45.064576 [debug] [MainThread]: STDERR: "b''"
[0m11:34:45.064850 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:34:45.065196 [info ] [MainThread]: Connection:
[0m11:34:45.065528 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m11:34:45.065754 [info ] [MainThread]:   work_group: None
[0m11:34:45.065974 [info ] [MainThread]:   region_name: us-east-1
[0m11:34:45.066337 [info ] [MainThread]:   database: AwsDataCatalog
[0m11:34:45.066618 [info ] [MainThread]:   schema: silver
[0m11:34:45.066890 [info ] [MainThread]:   poll_interval: 1.0
[0m11:34:45.067278 [info ] [MainThread]:   aws_profile_name: None
[0m11:34:45.067609 [info ] [MainThread]:   aws_access_key_id: None
[0m11:34:45.067872 [info ] [MainThread]:   aws_secret_access_key: None
[0m11:34:45.068389 [info ] [MainThread]:   aws_session_token: None
[0m11:34:45.068829 [info ] [MainThread]:   endpoint_url: None
[0m11:34:45.069143 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m11:34:45.069427 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m11:34:45.069728 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m11:34:45.070104 [info ] [MainThread]:   debug_query_state: False
[0m11:34:45.070461 [info ] [MainThread]:   seed_s3_upload_args: None
[0m11:34:45.070869 [info ] [MainThread]:   lf_tags_database: None
[0m11:34:45.071408 [info ] [MainThread]:   spark_work_group: None
[0m11:34:45.071956 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m11:34:45.072509 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m11:34:45.072737 [debug] [MainThread]: Using athena connection "debug"
[0m11:34:45.072939 [debug] [MainThread]: On debug: select 1 as id
[0m11:34:45.073162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:34:45.717515 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID a4a3a542-73e9-41ef-b7a5-72d6441a1cf3
[0m11:34:47.589927 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m11:34:47.591988 [debug] [MainThread]: On debug: Close
[0m11:34:47.592427 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:34:47.592856 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:34:47.594583 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.8944876, "process_user_time": 1.384812, "process_kernel_time": 0.424942, "process_mem_max_rss": "144028", "process_in_blocks": "18672", "process_out_blocks": "2213"}
[0m11:34:47.595179 [debug] [MainThread]: Command `dbt debug` succeeded at 11:34:47.595047 after 2.90 seconds
[0m11:34:47.596077 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:34:47.600678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89075190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891938d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892ad290>]}
[0m11:34:47.601856 [debug] [MainThread]: Flushing usage events
[0m11:34:57.948837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9871bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9871bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9871a5d0>]}


============================== 11:34:57.950713 | b0a34de6-fd34-4f76-99a0-b4f0016b0825 ==============================
[0m11:34:57.950713 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:34:57.951121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:34:58.196732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975ce910>]}
[0m11:34:58.238927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98563e10>]}
[0m11:34:58.239480 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m11:34:58.244045 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:34:58.276738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:58.277258 [debug] [MainThread]: Partial parsing: updated file: silver://models/gold/weather_data_gold.sql
[0m11:34:58.484913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972f8410>]}
[0m11:34:58.492769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973d0590>]}
[0m11:34:58.493148 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m11:34:58.493483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9736d550>]}
[0m11:34:58.495008 [info ] [MainThread]: 
[0m11:34:58.495700 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:34:58.496763 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:34:58.497099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:59.301610 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:34:59.304096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:59.892534 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:34:59.895761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m11:34:59.896446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:01.713149 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:35:01.716647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_silver_gold)
[0m11:35:01.721432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:02.941749 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m11:35:02.944861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff952237d0>]}
[0m11:35:02.946470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:35:02.947154 [info ] [MainThread]: 
[0m11:35:02.950280 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m11:35:02.951731 [info ] [Thread-1 (]: 1 of 11 START sql view model silver.eia_bronze ................................. [RUN]
[0m11:35:02.953468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now model.silver.eia_bronze)
[0m11:35:02.954522 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m11:35:02.963574 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m11:35:02.965576 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 11:35:02.954947 => 11:35:02.965353
[0m11:35:02.966017 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m11:35:02.989174 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m11:35:02.990384 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m11:35:02.990674 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m11:35:02.990946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:03.601219 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 805247aa-d8d2-4551-96c5-8b93d08ac171
[0m11:35:05.428606 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:35:06.758044 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['24', '23', '22', '21', '20']
[0m11:35:06.759724 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['20']
[0m11:35:07.273710 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 20 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m11:35:07.284731 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 11:35:02.966272 => 11:35:07.284404
[0m11:35:07.285668 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m11:35:07.287119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f95990>]}
[0m11:35:07.288172 [info ] [Thread-1 (]: 1 of 11 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.33s]
[0m11:35:07.289535 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m11:35:07.290432 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m11:35:07.291336 [info ] [Thread-1 (]: 2 of 11 START sql view model silver.noaa_bronze ................................ [RUN]
[0m11:35:07.293770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m11:35:07.294390 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m11:35:07.297829 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m11:35:07.299883 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 11:35:07.294808 => 11:35:07.299531
[0m11:35:07.300516 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m11:35:07.303833 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m11:35:07.305144 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m11:35:07.306476 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m11:35:07.307440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:07.889269 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d0623779-87f3-410d-9783-e9cc34836771
[0m11:35:09.662224 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:35:11.096999 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['25', '24', '23', '22', '21']
[0m11:35:11.099853 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['21']
[0m11:35:11.643420 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 21 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m11:35:11.649041 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 11:35:07.300830 => 11:35:11.648654
[0m11:35:11.649765 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m11:35:11.651346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f3bcd0>]}
[0m11:35:11.653078 [info ] [Thread-1 (]: 2 of 11 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.36s]
[0m11:35:11.654243 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m11:35:11.655375 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m11:35:11.657880 [info ] [Thread-1 (]: 3 of 11 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m11:35:11.661259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m11:35:11.661901 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m11:35:11.669901 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m11:35:11.671866 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 11:35:11.662229 => 11:35:11.671546
[0m11:35:11.672486 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m11:35:11.676431 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m11:35:11.677381 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m11:35:11.677681 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m11:35:11.677958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:12.525742 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d1f27a0a-1e01-47fe-a778-c4a7c1f33c7e
[0m11:35:14.306413 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m11:35:15.496163 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['25', '24', '23', '22', '21']
[0m11:35:15.498450 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['21']
[0m11:35:16.048486 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 21 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m11:35:16.051836 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 11:35:11.672878 => 11:35:16.051593
[0m11:35:16.052286 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m11:35:16.053204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e2d710>]}
[0m11:35:16.053951 [info ] [Thread-1 (]: 3 of 11 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.39s]
[0m11:35:16.054679 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m11:35:16.055138 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m11:35:16.056074 [info ] [Thread-1 (]: 4 of 11 START sql view model silver.openweather_bronze ......................... [RUN]
[0m11:35:16.058402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m11:35:16.058758 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m11:35:16.062256 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m11:35:16.063191 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 11:35:16.058988 => 11:35:16.063058
[0m11:35:16.063439 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m11:35:16.065811 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m11:35:16.066618 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m11:35:16.066944 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m11:35:16.067253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:16.713890 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 911c061b-fd5c-4ec4-93d8-dc921393d7e6
[0m11:35:18.486127 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:35:19.878944 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['25', '24', '23', '22', '21']
[0m11:35:19.880010 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['21']
[0m11:35:20.434748 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 21 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m11:35:20.455490 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 11:35:16.063595 => 11:35:20.454746
[0m11:35:20.457317 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m11:35:20.461252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971afa90>]}
[0m11:35:20.464964 [info ] [Thread-1 (]: 4 of 11 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.40s]
[0m11:35:20.469164 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m11:35:20.473134 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m11:35:20.493435 [info ] [Thread-1 (]: 5 of 11 START sql view model silver.sensor_bronze .............................. [RUN]
[0m11:35:20.505229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m11:35:20.513109 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m11:35:20.544618 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m11:35:20.548635 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 11:35:20.514430 => 11:35:20.548201
[0m11:35:20.549941 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m11:35:20.578117 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m11:35:20.589534 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m11:35:20.592608 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m11:35:20.593812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:21.234356 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c70e9b6f-8042-4578-8380-01a39045d84b
[0m11:35:23.116760 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m11:35:24.412034 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['24', '23', '22', '21', '20']
[0m11:35:24.413410 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['20']
[0m11:35:24.921357 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 20 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m11:35:24.924787 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 11:35:20.550614 => 11:35:24.924430
[0m11:35:24.925287 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m11:35:24.926751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97056b90>]}
[0m11:35:24.927881 [info ] [Thread-1 (]: 5 of 11 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.43s]
[0m11:35:24.928667 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m11:35:24.929334 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m11:35:24.930439 [info ] [Thread-1 (]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m11:35:24.932254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m11:35:24.932743 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m11:35:24.945491 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m11:35:24.947872 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 11:35:24.933030 => 11:35:24.947634
[0m11:35:24.948297 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m11:35:24.979869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:26.347773 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m11:35:26.348267 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:35:26.349665 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m11:35:27.458908 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m11:35:27.461382 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:35:27.462405 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/1d25918c-fb0c-4b05-baee-a92aad07de7d
[0m11:35:28.305995 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/1d25918c-fb0c-4b05-baee-a92aad07de7d', bucket='climate-energy-raw-data', prefix='silver/eia_silver/1d25918c-fb0c-4b05-baee-a92aad07de7d/'
[0m11:35:30.542410 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m11:35:30.593351 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:35:31.223002 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:35:31.224393 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/5d0f59b0-b93f-4bd8-88ff-843d5af9494f',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m11:35:31.740446 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cf06f4eb-3525-4176-a864-8c8b0844e730
[0m11:35:33.478423 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m11:35:33.483312 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m11:35:33.484216 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m11:35:33.758117 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 359011d0-6e93-4130-8d29-23463750555b
[0m11:35:35.543121 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:35:35.550200 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m11:35:35.553783 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m11:35:35.554626 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m11:35:35.767862 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 22a31dd5-fc68-409f-967e-85e20568c94b
[0m11:35:37.505182 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m11:35:37.513876 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 11:35:24.948491 => 11:35:37.513064
[0m11:35:37.514981 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m11:35:37.517827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d58f50>]}
[0m11:35:37.519881 [info ] [Thread-1 (]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 12.59s]
[0m11:35:37.521462 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m11:35:37.522548 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m11:35:37.523836 [info ] [Thread-1 (]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m11:35:37.527064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m11:35:37.527868 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m11:35:37.539086 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m11:35:37.541440 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 11:35:37.528397 => 11:35:37.541165
[0m11:35:37.542916 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m11:35:37.549159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:39.057011 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m11:35:39.058797 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:35:39.060159 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m11:35:40.021481 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6da13572-4476-4b40-a9b3-92c0411cb6b2
[0m11:35:40.155526 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m11:35:40.156953 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:35:40.157870 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/9569caa7-2f25-4d46-8e63-5d75dc84886e
[0m11:35:40.999808 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/9569caa7-2f25-4d46-8e63-5d75dc84886e', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/9569caa7-2f25-4d46-8e63-5d75dc84886e/'
[0m11:35:41.384403 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/6da13572-4476-4b40-a9b3-92c0411cb6b2' before retrying. Athena will not delete data in your account.
[0m11:35:41.387210 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m11:35:41.390563 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/6da13572-4476-4b40-a9b3-92c0411cb6b2' before retrying. Athena will not delete data in your account.
[0m11:35:41.394627 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 181, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/6da13572-4476-4b40-a9b3-92c0411cb6b2' before retrying. Athena will not delete data in your account.

[0m11:35:41.397950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896d8d65-f449-4596-a9b7-21af307b91dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78fa4eb0>]}
[0m11:35:41.401187 [error] [Thread-1  ]: 11 of 11 ERROR creating sql incremental model silver_gold.weather_data_gold .... [[31mERROR[0m in 152.60s]
[0m11:35:41.402668 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m11:35:41.410145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:41.410679 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m11:35:41.411529 [info ] [MainThread]: 
[0m11:35:41.412400 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 9 minutes and 8.14 seconds (548.14s).
[0m11:35:41.415920 [debug] [MainThread]: Command end result
[0m11:35:41.611636 [info ] [MainThread]: 
[0m11:35:41.612948 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:35:41.614532 [info ] [MainThread]: 
[0m11:35:41.616688 [error] [MainThread]:   TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.eia_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/88f6ea3a-e7df-42a5-8891-93b001ee6e16' before retrying. Athena will not delete data in your account.
[0m11:35:41.617970 [info ] [MainThread]: 
[0m11:35:41.618421 [error] [MainThread]:   COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/6da13572-4476-4b40-a9b3-92c0411cb6b2' before retrying. Athena will not delete data in your account.
[0m11:35:41.619108 [info ] [MainThread]: 
[0m11:35:41.619679 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=0 TOTAL=11
[0m11:35:41.621869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 550.38995, "process_user_time": 12.548844, "process_kernel_time": 1.569124, "process_mem_max_rss": "183216", "process_in_blocks": "440", "process_out_blocks": "3249", "command_success": false}
[0m11:35:41.622405 [debug] [MainThread]: Command `dbt run` failed at 11:35:41.622317 after 550.39 seconds
[0m11:35:41.622777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9a2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3ce400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b355250>]}
[0m11:35:41.623086 [debug] [MainThread]: Flushing usage events
[0m11:35:43.156869 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m11:35:43.161419 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:35:43.680303 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:35:43.687535 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/de416694-d70e-4a1c-91fe-99fdd14ddca8',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m11:35:44.223745 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bf0a17c8-cc2d-40da-827d-47d0763129c2
[0m11:35:47.237295 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m11:35:47.241673 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m11:35:47.242689 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m11:35:47.533760 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID dbda3130-7e15-4a57-8040-8b1ecb5586ac
[0m11:35:49.261773 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:35:49.264265 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m11:35:49.265737 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m11:35:49.266268 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m11:35:49.507278 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7d12bbc2-ee4c-4c79-ba76-15048281ed8b
[0m11:35:51.322550 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m11:35:51.330784 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 11:35:37.543300 => 11:35:51.330458
[0m11:35:51.331519 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m11:35:51.332881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a7ba50>]}
[0m11:35:51.333858 [info ] [Thread-1 (]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 13.81s]
[0m11:35:51.334783 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m11:35:51.335743 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m11:35:51.337129 [info ] [Thread-1 (]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m11:35:51.341476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m11:35:51.341988 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m11:35:51.350354 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m11:35:51.353254 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 11:35:51.342244 => 11:35:51.352813
[0m11:35:51.353994 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m11:35:51.367192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:52.772510 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m11:35:52.773348 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:35:52.774083 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m11:35:53.925606 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m11:35:53.926291 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:35:53.926850 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/eb251c8c-4bb9-47ba-92ef-ec46dd25ba69
[0m11:35:54.505687 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/eb251c8c-4bb9-47ba-92ef-ec46dd25ba69', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/eb251c8c-4bb9-47ba-92ef-ec46dd25ba69/'
[0m11:35:56.492028 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m11:35:56.497940 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:35:57.043889 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:35:57.045692 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/8d2cfff9-2840-4a29-a612-7f45d4cc792d',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m11:35:57.572103 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ec747e9c-447e-4c48-9840-64b698a0d46d
[0m11:36:00.593721 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m11:36:00.595440 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m11:36:00.595914 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m11:36:00.906761 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 38ee8ac6-b318-4c2c-a73d-748a172534da
[0m11:36:02.728119 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:36:02.738335 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m11:36:02.740124 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m11:36:02.740482 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m11:36:02.959773 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 55d6e57f-cf51-44ea-8055-e37f5e749fc7
[0m11:36:04.768130 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m11:36:04.777782 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 11:35:51.356603 => 11:36:04.777011
[0m11:36:04.779160 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m11:36:04.782470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97555c10>]}
[0m11:36:04.784687 [info ] [Thread-1 (]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 13.44s]
[0m11:36:04.786201 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m11:36:04.787378 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m11:36:04.788848 [info ] [Thread-1 (]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m11:36:04.793652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m11:36:04.794418 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m11:36:04.809946 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m11:36:04.812433 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 11:36:04.794905 => 11:36:04.812142
[0m11:36:04.813023 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m11:36:04.817464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:06.166103 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m11:36:06.167618 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:36:06.168937 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m11:36:07.417942 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m11:36:07.418633 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:36:07.419051 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/7fc3761d-7297-48cb-bef0-1b6b438cdb6f
[0m11:36:08.112027 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/7fc3761d-7297-48cb-bef0-1b6b438cdb6f', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/7fc3761d-7297-48cb-bef0-1b6b438cdb6f/'
[0m11:36:10.490477 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m11:36:10.499247 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:36:11.152551 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:36:11.156624 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/dc523f09-1ae5-4aac-aec6-6da3a7187b0a',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m11:36:11.682141 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ef59a5c6-e12b-451a-bc94-5e4f3eab4791
[0m11:36:14.604774 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m11:36:14.607717 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m11:36:14.608589 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m11:36:14.915561 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4dc6a61e-ae76-42f3-ba3a-005d23675d69
[0m11:36:16.665849 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:36:16.674167 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m11:36:16.678056 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m11:36:16.678845 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m11:36:16.896108 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 39ef65f7-d86c-4855-b9f7-d22d5564a3c4
[0m11:36:18.687496 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m11:36:18.695444 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 11:36:04.813321 => 11:36:18.694708
[0m11:36:18.696727 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m11:36:18.699494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94043cd0>]}
[0m11:36:18.701408 [info ] [Thread-1 (]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 13.91s]
[0m11:36:18.703654 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m11:36:18.706208 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m11:36:18.708483 [info ] [Thread-1 (]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m11:36:18.711806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m11:36:18.712446 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m11:36:18.721241 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m11:36:18.723140 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 11:36:18.712872 => 11:36:18.722942
[0m11:36:18.723565 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m11:36:18.727142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:20.330197 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m11:36:20.339862 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:36:20.362324 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m11:36:21.670465 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m11:36:21.672624 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:36:21.674025 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/de938a70-95cf-4179-a3ad-151977677bf9
[0m11:36:22.420279 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/de938a70-95cf-4179-a3ad-151977677bf9', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/de938a70-95cf-4179-a3ad-151977677bf9/'
[0m11:36:24.400414 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m11:36:24.409752 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:36:24.905632 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:36:24.908660 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/d8c5f629-632f-4b5e-bb61-34856da3869f',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m11:36:25.451423 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5c06012d-1589-4e4d-8549-44d2b292ce1a
[0m11:36:28.410291 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m11:36:28.414974 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m11:36:28.416213 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m11:36:28.703300 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 45d9e125-519d-4a24-b79b-c1cd92f72765
[0m11:36:30.521878 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:36:30.532430 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m11:36:30.536880 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m11:36:30.538393 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m11:36:30.771924 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3445d69f-f7c7-48be-99b5-7cc043329f6c
[0m11:36:32.585221 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m11:36:32.592588 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 11:36:18.723865 => 11:36:32.592069
[0m11:36:32.593603 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m11:36:32.595867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e7eb90>]}
[0m11:36:32.597916 [info ] [Thread-1 (]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 13.89s]
[0m11:36:32.599325 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m11:36:32.600421 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m11:36:32.601653 [info ] [Thread-1 (]: 11 of 11 START sql incremental model silver_gold.weather_data_gold ............. [RUN]
[0m11:36:32.605626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m11:36:32.606161 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m11:36:32.621971 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:36:32.624637 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 11:36:32.606704 => 11:36:32.624395
[0m11:36:32.625041 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m11:36:32.684367 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:36:32.685113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:33.278187 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:36:33.279055 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."silver_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(ingestion_timestamp) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        date(ingestion_timestamp) AS ingestion_date,
        observation_date,
        city AS location,
        temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:36:33.805158 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a87db6ca-d8f6-459b-9cb8-dec1863b0362
[0m11:36:41.419022 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4cfef0db-6f7b-4533-b4df-856e26031d56
[0m11:36:55.521307 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4551dd16-30cb-4b72-bd4a-75eb52e3aa30
[0m11:37:21.236329 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3c9dccfd-e4c6-440b-9719-208c20036c95
[0m11:37:24.721073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b62190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00062b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0006880>]}


============================== 11:37:24.728022 | 7302f9b0-a79b-4278-8bff-8fe663d187d6 ==============================
[0m11:37:24.728022 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:37:24.728432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:37:25.176335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa190c430>]}
[0m11:37:25.209604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01f2280>]}
[0m11:37:25.210215 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:37:25.221401 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:37:25.326397 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:37:25.327030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c33f40>]}
[0m11:37:26.275386 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:37:26.276138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa002c910>]}
[0m11:37:26.482457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa001a3d0>]}
[0m11:37:26.568710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da8a1f0>]}
[0m11:37:26.569138 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 450 macros
[0m11:37:26.569523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da71b80>]}
[0m11:37:26.571667 [info ] [MainThread]: 
[0m11:37:26.572312 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:37:26.577199 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:37:26.577533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:28.606549 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:37:28.615915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:29.453564 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:37:29.459185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m11:37:29.459858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:31.444023 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:37:31.456869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_silver_gold)
[0m11:37:31.466643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:32.839128 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m11:37:32.841866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea00160>]}
[0m11:37:32.843574 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:32.844122 [info ] [MainThread]: 
[0m11:37:32.867144 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m11:37:32.868568 [info ] [Thread-1  ]: 1 of 11 START sql view model silver.eia_bronze ................................. [RUN]
[0m11:37:32.869525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now model.silver.eia_bronze)
[0m11:37:32.870687 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m11:37:32.886210 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m11:37:32.890205 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m11:37:32.913052 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m11:37:32.914273 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m11:37:32.914524 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m11:37:32.914752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:33.665997 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b6acf71c-7127-4f49-87f5-85a6092584b2
[0m11:37:35.760393 [debug] [Thread-1  ]: SQL status: OK -1 in 2.838 seconds
[0m11:37:37.144285 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['25', '24', '23', '22', '21']
[0m11:37:37.149420 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['21']
[0m11:37:37.959729 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 21 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m11:37:38.004162 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m11:37:38.007875 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f6a490>]}
[0m11:37:38.009500 [info ] [Thread-1  ]: 1 of 11 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 5.14s]
[0m11:37:38.010629 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m11:37:38.011623 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m11:37:38.012922 [info ] [Thread-1  ]: 2 of 11 START sql view model silver.noaa_bronze ................................ [RUN]
[0m11:37:38.021989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m11:37:38.022703 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m11:37:38.028629 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m11:37:38.030084 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m11:37:38.033161 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m11:37:38.034864 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m11:37:38.035310 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m11:37:38.035772 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:38.704469 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d789f244-2947-44eb-8dbd-06341830e0da
[0m11:37:40.511029 [debug] [Thread-1  ]: SQL status: OK -1 in 2.474 seconds
[0m11:37:41.741312 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['26', '25', '24', '23', '22']
[0m11:37:41.745173 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['22']
[0m11:37:42.399745 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 22 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m11:37:42.415917 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m11:37:42.418808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f6a700>]}
[0m11:37:42.421309 [info ] [Thread-1  ]: 2 of 11 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.40s]
[0m11:37:42.423327 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m11:37:42.424876 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m11:37:42.427141 [info ] [Thread-1  ]: 3 of 11 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m11:37:42.431673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m11:37:42.432523 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m11:37:42.442120 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m11:37:42.444008 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m11:37:42.448257 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m11:37:42.449598 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m11:37:42.449986 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m11:37:42.450428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:43.140211 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ecf313d3-24ff-4237-ba21-dbe793292e39
[0m11:37:44.864433 [debug] [Thread-1  ]: SQL status: OK -1 in 2.413 seconds
[0m11:37:46.077344 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['26', '25', '24', '23', '22']
[0m11:37:46.080462 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['22']
[0m11:37:46.641644 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 22 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m11:37:46.650370 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m11:37:46.651547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea000d0>]}
[0m11:37:46.652858 [info ] [Thread-1  ]: 3 of 11 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.22s]
[0m11:37:46.654686 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m11:37:46.655557 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m11:37:46.656855 [info ] [Thread-1  ]: 4 of 11 START sql view model silver.openweather_bronze ......................... [RUN]
[0m11:37:46.659625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m11:37:46.660320 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m11:37:46.665728 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m11:37:46.667530 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m11:37:46.671836 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m11:37:46.673080 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m11:37:46.673579 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m11:37:46.674043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:47.283414 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 33672f99-fc99-4479-b27f-30bf8156bcdc
[0m11:37:49.057772 [debug] [Thread-1  ]: SQL status: OK -1 in 2.384 seconds
[0m11:37:50.288469 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['26', '25', '24', '23', '22']
[0m11:37:50.291423 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['22']
[0m11:37:51.063524 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 22 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m11:37:51.087020 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m11:37:51.094345 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f7d0a0>]}
[0m11:37:51.114875 [info ] [Thread-1  ]: 4 of 11 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.43s]
[0m11:37:51.123670 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m11:37:51.124541 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m11:37:51.125775 [info ] [Thread-1  ]: 5 of 11 START sql view model silver.sensor_bronze .............................. [RUN]
[0m11:37:51.128613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m11:37:51.129704 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m11:37:51.141055 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m11:37:51.142652 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m11:37:51.148609 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m11:37:51.149763 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m11:37:51.150044 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m11:37:51.150632 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:51.882015 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b2134ca0-fb48-4c0a-9d41-a431d885c124
[0m11:37:53.646066 [debug] [Thread-1  ]: SQL status: OK -1 in 2.495 seconds
[0m11:37:54.931291 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['25', '24', '23', '22', '21']
[0m11:37:54.935599 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['21']
[0m11:37:55.514049 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 21 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m11:37:55.518110 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m11:37:55.518942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d86c10>]}
[0m11:37:55.519819 [info ] [Thread-1  ]: 5 of 11 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.39s]
[0m11:37:55.520680 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m11:37:55.521384 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m11:37:55.522133 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m11:37:55.524020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m11:37:55.524429 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m11:37:55.528483 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m11:37:55.529475 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m11:37:55.569058 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:56.816110 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:37:56.816520 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:37:56.817851 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:37:57.942056 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:37:57.943303 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:37:57.943786 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/5d0f59b0-b93f-4bd8-88ff-843d5af9494f
[0m11:37:58.553670 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/5d0f59b0-b93f-4bd8-88ff-843d5af9494f', bucket='climate-energy-raw-data', prefix='silver/eia_silver/5d0f59b0-b93f-4bd8-88ff-843d5af9494f/'
[0m11:38:00.990517 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m11:38:01.038721 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:38:01.538907 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:38:01.542543 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/df5b39bc-e4b7-4dcf-9aeb-d4d7fb5ef113',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m11:38:02.112152 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ca6f23ac-a717-4494-be63-40b702094f46
[0m11:38:05.055950 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m11:38:05.064849 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:38:05.065749 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m11:38:05.276834 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b3b4beac-75f6-4367-872f-e440a13cd34c
[0m11:38:07.017472 [debug] [Thread-1  ]: SQL status: OK -1 in 1.950 seconds
[0m11:38:07.024894 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m11:38:07.029043 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:38:07.029815 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m11:38:07.318280 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ed3f464e-2892-486c-a298-0ebf9c10d0e1
[0m11:38:09.112625 [debug] [Thread-1  ]: SQL status: OK 2842 in 2.082 seconds
[0m11:38:09.120319 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m11:38:09.121963 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9df148e0>]}
[0m11:38:09.124794 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 13.60s]
[0m11:38:09.129053 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m11:38:09.132134 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m11:38:09.134733 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m11:38:09.144458 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m11:38:09.145592 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m11:38:09.155624 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m11:38:09.157010 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m11:38:09.162551 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:38:10.455785 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:38:10.480694 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:38:10.483237 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:38:11.205785 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d38e35f9-81b3-41e7-8e1b-b76e39b5a4f7
[0m11:38:11.674893 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:38:11.676292 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:38:11.677912 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/de416694-d70e-4a1c-91fe-99fdd14ddca8
[0m11:38:12.253132 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/de416694-d70e-4a1c-91fe-99fdd14ddca8', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/de416694-d70e-4a1c-91fe-99fdd14ddca8/'
[0m11:38:14.387386 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m11:38:14.394993 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:38:14.962157 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:38:14.964894 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/d1baab83-4c0a-4209-b691-ba78e63a9f3d',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m11:38:15.525101 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5d89e406-ce00-412c-94cb-148a4b52f802
[0m11:38:17.307829 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m11:38:17.311530 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:38:17.312742 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m11:38:17.557663 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 533b093e-cd81-4e20-8759-eb43681f04d6
[0m11:38:19.766810 [debug] [Thread-1  ]: SQL status: OK -1 in 2.453 seconds
[0m11:38:19.773567 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m11:38:19.776648 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:38:19.777398 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m11:38:20.064090 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID db247808-ae99-411d-aad1-4386f82a0154
[0m11:38:22.169646 [debug] [Thread-1  ]: SQL status: OK 305 in 2.389 seconds
[0m11:38:22.184049 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m11:38:22.189366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea000d0>]}
[0m11:38:22.191431 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 13.05s]
[0m11:38:22.192718 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m11:38:22.193771 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m11:38:22.196007 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m11:38:22.200511 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m11:38:22.201156 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m11:38:22.210250 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m11:38:22.217123 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m11:38:22.221437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:38:24.874917 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:38:24.877021 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:38:24.878328 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:38:26.518000 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:38:26.520093 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:38:26.521626 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/8d2cfff9-2840-4a29-a612-7f45d4cc792d
[0m11:38:27.144812 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/8d2cfff9-2840-4a29-a612-7f45d4cc792d', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/8d2cfff9-2840-4a29-a612-7f45d4cc792d/'
[0m11:38:29.226730 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m11:38:29.232145 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:38:29.769465 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:38:29.770503 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/43d563c9-63cb-48d1-8fd7-1e0e8865c1d9',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m11:38:30.404563 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 99f200db-9fde-4347-a72a-3c7a78070603
[0m11:38:33.388028 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m11:38:33.391478 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:38:33.392112 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m11:38:33.603108 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c6082271-ffd3-457d-870f-d1b86784653d
[0m11:38:35.384233 [debug] [Thread-1  ]: SQL status: OK -1 in 1.992 seconds
[0m11:38:35.390978 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m11:38:35.394493 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:38:35.395337 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m11:38:35.629404 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5953f503-cad4-4357-85ae-96fb9fb3b4c8
[0m11:38:37.452865 [debug] [Thread-1  ]: SQL status: OK 12458 in 2.056 seconds
[0m11:38:37.462203 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m11:38:37.464801 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f7d0d0>]}
[0m11:38:37.467348 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 15.27s]
[0m11:38:37.469730 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m11:38:37.471321 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m11:38:37.473306 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m11:38:37.477136 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m11:38:37.477939 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m11:38:37.487547 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m11:38:37.489169 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m11:38:37.493366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:38:38.901623 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:38:38.903262 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:38:38.904607 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:38:40.081785 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:38:40.082473 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:38:40.082796 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/dc523f09-1ae5-4aac-aec6-6da3a7187b0a
[0m11:38:40.787145 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/dc523f09-1ae5-4aac-aec6-6da3a7187b0a', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/dc523f09-1ae5-4aac-aec6-6da3a7187b0a/'
[0m11:38:42.915676 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m11:38:42.924696 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:38:43.432434 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:38:43.433592 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/fa718095-8175-48aa-b889-e16870416ab6',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m11:38:43.978197 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1f3a2a3a-7273-4e0b-8f06-3bfb3abdc471
[0m11:38:48.195423 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m11:38:48.204878 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:38:48.205642 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m11:38:48.436552 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1e2478af-c133-485c-9921-4536129cf82b
[0m11:38:50.181636 [debug] [Thread-1  ]: SQL status: OK -1 in 1.975 seconds
[0m11:38:50.187183 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m11:38:50.189482 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:38:50.189838 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m11:38:50.446390 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 45aa8ef7-009a-4fd0-80c1-d209ad12e580
[0m11:38:52.349918 [debug] [Thread-1  ]: SQL status: OK 473 in 2.157 seconds
[0m11:38:52.371757 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m11:38:52.374277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f7d0d0>]}
[0m11:38:52.376580 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 14.90s]
[0m11:38:52.378437 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m11:38:52.379868 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m11:38:52.382007 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m11:38:52.387177 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m11:38:52.387920 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m11:38:52.397545 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m11:38:52.400087 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m11:38:52.404173 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:38:53.739928 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:38:53.740579 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:38:53.740970 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:38:54.931278 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:38:54.931738 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:38:54.932039 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/d8c5f629-632f-4b5e-bb61-34856da3869f
[0m11:38:55.578495 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/d8c5f629-632f-4b5e-bb61-34856da3869f', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/d8c5f629-632f-4b5e-bb61-34856da3869f/'
[0m11:38:57.643207 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m11:38:57.650336 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:38:58.292544 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:38:58.294491 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/c6ea3bb2-2a11-4aed-8f15-74d15cc8348c',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m11:38:58.924439 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 25cf929f-dad0-4411-9c31-e30a3e80c0e9
[0m11:39:01.869731 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m11:39:01.878586 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:39:01.879362 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m11:39:02.100301 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5fa1c1b3-a14c-4988-b8a2-30184fb5a960
[0m11:39:03.829659 [debug] [Thread-1  ]: SQL status: OK -1 in 1.951 seconds
[0m11:39:03.832875 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m11:39:03.834406 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:39:03.834692 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m11:39:04.037048 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID dcca6fd5-c86c-4f7a-8ffc-7abddfaee053
[0m11:39:05.870447 [debug] [Thread-1  ]: SQL status: OK 700 in 2.034 seconds
[0m11:39:05.879063 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m11:39:05.880376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8cd970>]}
[0m11:39:05.881671 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 13.50s]
[0m11:39:05.882848 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m11:39:05.883662 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m11:39:05.884677 [info ] [Thread-1  ]: 11 of 11 START sql incremental model silver_gold.weather_data_gold ............. [RUN]
[0m11:39:05.888581 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m11:39:05.889082 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m11:39:05.900085 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:39:05.901330 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m11:39:05.938134 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:39:05.938686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:39:06.502956 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:39:06.503877 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."silver_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(ingestion_timestamp) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        date(ingestion_timestamp) AS ingestion_date,
        observation_date,
        city AS location,
        temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:39:07.079155 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b3991867-d61b-42bc-b201-185ffaab851f
[0m11:39:13.374625 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6f315f9d-cde0-43d1-9a47-4c0cfc70b59f
[0m11:39:26.443282 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 60b42d2e-45ee-4150-b478-f24e49812f51
[0m11:39:40.860771 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ca886a6a-9aad-440b-aee7-63d3d7e299aa
[0m11:39:43.545430 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c3e50a69-ed16-45ef-a034-7aaae2e6ee8f
[0m11:39:50.418868 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 21f9054b-2bea-4180-bd65-ebc088eb7673
[0m11:39:51.891366 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/21f9054b-2bea-4180-bd65-ebc088eb7673' before retrying. Athena will not delete data in your account.
[0m11:39:51.895548 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 11:36:32.625323 => 11:39:51.894820
[0m11:39:51.896782 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m11:39:51.906204 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/21f9054b-2bea-4180-bd65-ebc088eb7673' before retrying. Athena will not delete data in your account.
[0m11:39:51.920672 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 154, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/21f9054b-2bea-4180-bd65-ebc088eb7673' before retrying. Athena will not delete data in your account.

[0m11:39:51.923354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0a34de6-fd34-4f76-99a0-b4f0016b0825', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f26ed0>]}
[0m11:39:51.926101 [error] [Thread-1 (]: 11 of 11 ERROR creating sql incremental model silver_gold.weather_data_gold .... [[31mERROR[0m in 199.32s]
[0m11:39:51.927123 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m11:39:51.979666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:51.988897 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m11:39:51.989574 [info ] [MainThread]: 
[0m11:39:51.995203 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 4 minutes and 53.49 seconds (293.49s).
[0m11:39:52.000325 [debug] [MainThread]: Command end result
[0m11:39:52.024632 [info ] [MainThread]: 
[0m11:39:52.025057 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:39:52.025486 [info ] [MainThread]: 
[0m11:39:52.025785 [error] [MainThread]:   COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/21f9054b-2bea-4180-bd65-ebc088eb7673' before retrying. Athena will not delete data in your account.
[0m11:39:52.026175 [info ] [MainThread]: 
[0m11:39:52.026568 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m11:39:52.030933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 294.115, "process_user_time": 9.217794, "process_kernel_time": 0.963738, "process_mem_max_rss": "189704", "process_in_blocks": "5384", "process_out_blocks": "3081", "command_success": false}
[0m11:39:52.032667 [debug] [MainThread]: Command `dbt run` failed at 11:39:52.032379 after 294.12 seconds
[0m11:39:52.034082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98717850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98715950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d3e4d0>]}
[0m11:39:52.034412 [debug] [MainThread]: Flushing usage events
[0m11:40:59.667407 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID eaba236c-338e-496b-b111-8f562d286850
[0m11:41:01.050860 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/eaba236c-338e-496b-b111-8f562d286850' before retrying. Athena will not delete data in your account.
[0m11:41:01.063066 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m11:41:01.076047 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/eaba236c-338e-496b-b111-8f562d286850' before retrying. Athena will not delete data in your account.
[0m11:41:01.089427 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 181, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/eaba236c-338e-496b-b111-8f562d286850' before retrying. Athena will not delete data in your account.

[0m11:41:01.093474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7302f9b0-a79b-4278-8bff-8fe663d187d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9de9c670>]}
[0m11:41:01.096930 [error] [Thread-1  ]: 11 of 11 ERROR creating sql incremental model silver_gold.weather_data_gold .... [[31mERROR[0m in 115.21s]
[0m11:41:01.098812 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m11:41:01.110492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:01.111519 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m11:41:01.112953 [info ] [MainThread]: 
[0m11:41:01.115271 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 3 minutes and 34.54 seconds (214.54s).
[0m11:41:01.118698 [debug] [MainThread]: Command end result
[0m11:41:01.264527 [info ] [MainThread]: 
[0m11:41:01.265582 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:01.267020 [info ] [MainThread]: 
[0m11:41:01.269085 [error] [MainThread]:   COLUMN_NOT_FOUND: line 26:6: Column 'temperature_c' cannot be resolved or requester is not authorized to access requested resources. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/eaba236c-338e-496b-b111-8f562d286850' before retrying. Athena will not delete data in your account.
[0m11:41:01.270646 [info ] [MainThread]: 
[0m11:41:01.271579 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m11:41:01.277838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 216.58629, "process_user_time": 11.412943, "process_kernel_time": 1.690844, "process_mem_max_rss": "186564", "process_out_blocks": "3234", "command_success": false, "process_in_blocks": "0"}
[0m11:41:01.286395 [debug] [MainThread]: Command `dbt run` failed at 11:41:01.286174 after 216.60 seconds
[0m11:41:01.288172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b62190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01f2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ffda30>]}
[0m11:41:01.290091 [debug] [MainThread]: Flushing usage events
[0m11:41:23.784894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86778f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a1ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a1b2d0>]}


============================== 11:41:23.787392 | 83dcd3dc-7fa7-4c8e-8795-1a854ab33095 ==============================
[0m11:41:23.787392 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:41:23.788384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:41:23.789097 [info ] [MainThread]: dbt version: 1.7.9
[0m11:41:23.790122 [info ] [MainThread]: python version: 3.11.14
[0m11:41:23.791609 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m11:41:23.792261 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m11:41:24.053312 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m11:41:24.055814 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m11:41:24.059444 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m11:41:24.060105 [info ] [MainThread]: adapter type: athena
[0m11:41:24.060535 [info ] [MainThread]: adapter version: 1.7.2
[0m11:41:24.103901 [info ] [MainThread]: Configuration:
[0m11:41:24.104775 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:41:24.105151 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:41:24.105528 [info ] [MainThread]: Required dependencies:
[0m11:41:24.105976 [debug] [MainThread]: Executing "git --help"
[0m11:41:24.108340 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:41:24.108885 [debug] [MainThread]: STDERR: "b''"
[0m11:41:24.109108 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:41:24.109402 [info ] [MainThread]: Connection:
[0m11:41:24.109862 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m11:41:24.110222 [info ] [MainThread]:   work_group: None
[0m11:41:24.110627 [info ] [MainThread]:   region_name: us-east-1
[0m11:41:24.110979 [info ] [MainThread]:   database: AwsDataCatalog
[0m11:41:24.111280 [info ] [MainThread]:   schema: silver
[0m11:41:24.111687 [info ] [MainThread]:   poll_interval: 1.0
[0m11:41:24.111975 [info ] [MainThread]:   aws_profile_name: None
[0m11:41:24.112230 [info ] [MainThread]:   aws_access_key_id: None
[0m11:41:24.112566 [info ] [MainThread]:   aws_secret_access_key: None
[0m11:41:24.112805 [info ] [MainThread]:   aws_session_token: None
[0m11:41:24.113093 [info ] [MainThread]:   endpoint_url: None
[0m11:41:24.113408 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m11:41:24.113655 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m11:41:24.113998 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m11:41:24.114271 [info ] [MainThread]:   debug_query_state: False
[0m11:41:24.114869 [info ] [MainThread]:   seed_s3_upload_args: None
[0m11:41:24.115197 [info ] [MainThread]:   lf_tags_database: None
[0m11:41:24.115669 [info ] [MainThread]:   spark_work_group: None
[0m11:41:24.116518 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m11:41:24.117882 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m11:41:24.118240 [debug] [MainThread]: Using athena connection "debug"
[0m11:41:24.118456 [debug] [MainThread]: On debug: select 1 as id
[0m11:41:24.118727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:24.779444 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID c01de6e4-edc6-4261-a7a7-49d37c9c5856
[0m11:41:24.903534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e57160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3005e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3002b0>]}


============================== 11:41:24.908180 | bdb343cb-cfe6-4101-8643-76a162816faa ==============================
[0m11:41:24.908180 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:41:24.908667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:41:25.336990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaddded00>]}
[0m11:41:25.387769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb15b3250>]}
[0m11:41:25.388699 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:41:25.404696 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:41:25.504859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:25.505526 [debug] [MainThread]: Partial parsing: updated file: silver://models/gold/weather_data_gold.sql
[0m11:41:25.633839 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:41:25.634337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface90ca0>]}
[0m11:41:25.745400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaccc3ee0>]}
[0m11:41:25.819979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc5fcd0>]}
[0m11:41:25.820361 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 450 macros
[0m11:41:25.820557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad12bc10>]}
[0m11:41:25.821732 [info ] [MainThread]: 
[0m11:41:25.822183 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:41:25.826513 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:41:25.826809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:26.485137 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:41:26.487173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:26.651526 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m11:41:26.654904 [debug] [MainThread]: On debug: Close
[0m11:41:26.655769 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:41:26.656534 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:41:26.658784 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.9100401, "process_user_time": 1.591764, "process_kernel_time": 0.23299, "process_mem_max_rss": "144192", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m11:41:26.659646 [debug] [MainThread]: Command `dbt debug` succeeded at 11:41:26.659415 after 2.91 seconds
[0m11:41:26.660394 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:41:26.665315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83850a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827bc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a06710>]}
[0m11:41:26.665989 [debug] [MainThread]: Flushing usage events
[0m11:41:27.048816 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:41:27.052856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m11:41:27.053361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:28.529835 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:41:28.532536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_silver_gold)
[0m11:41:28.536753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:29.838400 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m11:41:29.839796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf11910>]}
[0m11:41:29.840575 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:29.841552 [info ] [MainThread]: 
[0m11:41:29.849137 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m11:41:29.850664 [info ] [Thread-1  ]: 1 of 11 START sql view model silver.eia_bronze ................................. [RUN]
[0m11:41:29.854000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now model.silver.eia_bronze)
[0m11:41:29.856084 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m11:41:29.866952 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m11:41:29.868676 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m11:41:29.916323 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m11:41:29.918128 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m11:41:29.918709 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m11:41:29.919351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:30.511200 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9f93fe30-66ff-459d-b0f3-8b0abe8e7bd1
[0m11:41:31.374075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987e6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98b09250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987e7c10>]}


============================== 11:41:31.375995 | c511a588-30be-4e14-af42-11343d3b2184 ==============================
[0m11:41:31.375995 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:41:31.376452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:41:31.667373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977ce3d0>]}
[0m11:41:31.713041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9865dc90>]}
[0m11:41:31.713822 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m11:41:31.720567 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m11:41:31.734634 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:41:31.735609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97583e50>]}
[0m11:41:32.324233 [debug] [Thread-1  ]: SQL status: OK -1 in 2.405 seconds
[0m11:41:32.451094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff976c8f50>]}
[0m11:41:32.459022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97590a50>]}
[0m11:41:32.459388 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m11:41:32.459793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973fcb10>]}
[0m11:41:32.461490 [info ] [MainThread]: 
[0m11:41:32.462141 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:41:32.463668 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:41:32.463990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:33.046776 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:41:33.048380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:33.453506 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['26', '25', '24', '23', '22']
[0m11:41:33.514708 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['22']
[0m11:41:33.724683 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:41:33.727633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver_gold)
[0m11:41:33.728672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:34.048075 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 22 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m11:41:34.065089 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m11:41:34.067990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf11280>]}
[0m11:41:34.070387 [info ] [Thread-1  ]: 1 of 11 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.21s]
[0m11:41:34.078668 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m11:41:34.083760 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m11:41:34.086573 [info ] [Thread-1  ]: 2 of 11 START sql view model silver.noaa_bronze ................................ [RUN]
[0m11:41:34.092034 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m11:41:34.092590 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m11:41:34.097007 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m11:41:34.098281 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m11:41:34.101017 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m11:41:34.101832 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m11:41:34.102097 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m11:41:34.102332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:34.822938 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ef48108b-a334-45c9-a3e6-5f11187e58aa
[0m11:41:34.919956 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m11:41:34.921644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now list_AwsDataCatalog_silver)
[0m11:41:34.922120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:36.296594 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:41:36.300372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97784250>]}
[0m11:41:36.301572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:36.302096 [info ] [MainThread]: 
[0m11:41:36.304796 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m11:41:36.305419 [info ] [Thread-1 (]: 1 of 11 START sql view model silver.eia_bronze ................................. [RUN]
[0m11:41:36.306293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m11:41:36.306605 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m11:41:36.314268 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m11:41:36.315840 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 11:41:36.306802 => 11:41:36.315624
[0m11:41:36.316199 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m11:41:36.339579 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m11:41:36.340864 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m11:41:36.341222 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m11:41:36.341514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:36.614486 [debug] [Thread-1  ]: SQL status: OK -1 in 2.511 seconds
[0m11:41:36.905609 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2ea90547-3039-496a-b86a-12d55b76e9f3
[0m11:41:37.823613 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['27', '26', '25', '24', '23']
[0m11:41:37.826733 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['23']
[0m11:41:38.390370 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 23 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m11:41:38.394315 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m11:41:38.395357 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf110a0>]}
[0m11:41:38.396389 [info ] [Thread-1  ]: 2 of 11 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.31s]
[0m11:41:38.397866 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m11:41:38.398550 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m11:41:38.399207 [info ] [Thread-1  ]: 3 of 11 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m11:41:38.401267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m11:41:38.401686 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m11:41:38.405556 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m11:41:38.406745 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m11:41:38.409388 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m11:41:38.410246 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m11:41:38.410545 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m11:41:38.410878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:38.694773 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:41:39.041860 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5f0f9e52-bfc7-4aaa-85f2-dd381a276d49
[0m11:41:39.767719 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['27', '26', '25', '24', '23']
[0m11:41:39.770241 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['23']
[0m11:41:40.269672 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 23 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m11:41:40.284017 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 11:41:36.316402 => 11:41:40.283645
[0m11:41:40.285083 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m11:41:40.286732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ff5350>]}
[0m11:41:40.287722 [info ] [Thread-1 (]: 1 of 11 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 3.98s]
[0m11:41:40.288959 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m11:41:40.289742 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m11:41:40.291640 [info ] [Thread-1 (]: 2 of 11 START sql view model silver.noaa_bronze ................................ [RUN]
[0m11:41:40.295487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m11:41:40.296693 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m11:41:40.305099 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m11:41:40.308785 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 11:41:40.297367 => 11:41:40.308247
[0m11:41:40.310565 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m11:41:40.323682 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m11:41:40.327834 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m11:41:40.329420 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m11:41:40.331472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:40.959808 [debug] [Thread-1  ]: SQL status: OK -1 in 2.549 seconds
[0m11:41:41.426329 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b74d6a8d-f78b-4422-b06b-26301cb531f1
[0m11:41:42.092408 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['27', '26', '25', '24', '23']
[0m11:41:42.094465 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['23']
[0m11:41:42.589661 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 23 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m11:41:42.593647 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m11:41:42.594605 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacdccee0>]}
[0m11:41:42.595498 [info ] [Thread-1  ]: 3 of 11 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.19s]
[0m11:41:42.596589 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m11:41:42.597351 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m11:41:42.598751 [info ] [Thread-1  ]: 4 of 11 START sql view model silver.openweather_bronze ......................... [RUN]
[0m11:41:42.601163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m11:41:42.601613 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m11:41:42.606839 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m11:41:42.608115 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m11:41:42.611309 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m11:41:42.612010 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m11:41:42.612259 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m11:41:42.612542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:43.165451 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m11:41:43.269452 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d82719a7-b206-4021-bc70-eec363d70de3
[0m11:41:44.251537 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['28', '27', '26', '25', '24']
[0m11:41:44.255578 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['24']
[0m11:41:44.774046 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 24 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m11:41:44.782268 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 11:41:40.311699 => 11:41:44.781712
[0m11:41:44.784164 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m11:41:44.786406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97677650>]}
[0m11:41:44.788262 [info ] [Thread-1 (]: 2 of 11 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.49s]
[0m11:41:44.789581 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m11:41:44.790469 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m11:41:44.792037 [info ] [Thread-1 (]: 3 of 11 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m11:41:44.794843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m11:41:44.795655 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m11:41:44.802676 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m11:41:44.804581 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 11:41:44.796163 => 11:41:44.804279
[0m11:41:44.805150 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m11:41:44.809303 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m11:41:44.811112 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m11:41:44.811705 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m11:41:44.812315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:44.977498 [debug] [Thread-1  ]: SQL status: OK -1 in 2.365 seconds
[0m11:41:45.349709 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 17080298-5b96-4bb8-ba09-855add0cf383
[0m11:41:46.249959 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['27', '26', '25', '24', '23']
[0m11:41:46.254958 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['23']
[0m11:41:46.794285 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 23 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m11:41:46.799676 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m11:41:46.800863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa609e20>]}
[0m11:41:46.802087 [info ] [Thread-1  ]: 4 of 11 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.20s]
[0m11:41:46.803440 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m11:41:46.804289 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m11:41:46.805462 [info ] [Thread-1  ]: 5 of 11 START sql view model silver.sensor_bronze .............................. [RUN]
[0m11:41:46.808088 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m11:41:46.808671 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m11:41:46.814039 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m11:41:46.816779 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m11:41:46.820797 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m11:41:46.822067 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m11:41:46.822500 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m11:41:46.822955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:47.086038 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:41:47.393386 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 32fa238d-7928-457b-ade6-ba063d703da5
[0m11:41:48.326461 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['28', '27', '26', '25', '24']
[0m11:41:48.328636 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['24']
[0m11:41:48.814450 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 24 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m11:41:48.817426 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 11:41:44.805544 => 11:41:48.817232
[0m11:41:48.817919 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m11:41:48.818737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97604450>]}
[0m11:41:48.819313 [info ] [Thread-1 (]: 3 of 11 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.03s]
[0m11:41:48.820073 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m11:41:48.820685 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m11:41:48.821335 [info ] [Thread-1 (]: 4 of 11 START sql view model silver.openweather_bronze ......................... [RUN]
[0m11:41:48.823113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m11:41:48.823518 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m11:41:48.826074 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m11:41:48.827228 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 11:41:48.823789 => 11:41:48.827079
[0m11:41:48.827531 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m11:41:48.829892 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m11:41:48.830861 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m11:41:48.831185 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m11:41:48.831507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:49.106952 [debug] [Thread-1  ]: SQL status: OK -1 in 2.284 seconds
[0m11:41:49.379487 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d1d0ccea-dcb7-4ad5-ae31-99958b5245f5
[0m11:41:50.287822 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['26', '25', '24', '23', '22']
[0m11:41:50.292437 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['22']
[0m11:41:51.032243 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 22 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m11:41:51.057174 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m11:41:51.060066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad2566d0>]}
[0m11:41:51.062507 [info ] [Thread-1  ]: 5 of 11 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.25s]
[0m11:41:51.075593 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m11:41:51.076618 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m11:41:51.078896 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m11:41:51.093093 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m11:41:51.096747 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m11:41:51.117789 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m11:41:51.119369 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m11:41:51.160147 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:51.159720 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:41:52.373854 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['28', '27', '26', '25', '24']
[0m11:41:52.377447 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['24']
[0m11:41:52.604725 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:41:52.606182 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:41:52.609889 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:41:52.852136 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 24 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m11:41:52.858470 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 11:41:48.827743 => 11:41:52.857838
[0m11:41:52.859407 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m11:41:52.861788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a24b90>]}
[0m11:41:52.863521 [info ] [Thread-1 (]: 4 of 11 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.04s]
[0m11:41:52.864576 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m11:41:52.865511 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m11:41:52.867036 [info ] [Thread-1 (]: 5 of 11 START sql view model silver.sensor_bronze .............................. [RUN]
[0m11:41:52.869817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m11:41:52.870514 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m11:41:52.885182 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m11:41:52.886564 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 11:41:52.870960 => 11:41:52.886380
[0m11:41:52.886934 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m11:41:52.892564 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m11:41:52.893878 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m11:41:52.894291 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m11:41:52.894910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:53.624340 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f55e7904-fb3e-40ed-b916-9e84140d5392
[0m11:41:53.706506 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:41:53.706984 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:41:53.707345 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/df5b39bc-e4b7-4dcf-9aeb-d4d7fb5ef113
[0m11:41:54.313403 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/df5b39bc-e4b7-4dcf-9aeb-d4d7fb5ef113', bucket='climate-energy-raw-data', prefix='silver/eia_silver/df5b39bc-e4b7-4dcf-9aeb-d4d7fb5ef113/'
[0m11:41:55.386097 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:41:56.284863 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m11:41:56.341201 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:41:56.580655 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['27', '26', '25', '24', '23']
[0m11:41:56.582681 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['23']
[0m11:41:56.813477 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:41:56.814773 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/f384ddd2-4abf-4933-90b2-abfe5be59b65',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m11:41:57.091251 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 23 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m11:41:57.096079 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 11:41:52.887179 => 11:41:57.095684
[0m11:41:57.096943 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m11:41:57.098174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94670e50>]}
[0m11:41:57.099103 [info ] [Thread-1 (]: 5 of 11 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.23s]
[0m11:41:57.100114 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m11:41:57.100924 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m11:41:57.103313 [info ] [Thread-1 (]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m11:41:57.105165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m11:41:57.105836 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m11:41:57.115507 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m11:41:57.119690 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 11:41:57.106238 => 11:41:57.119435
[0m11:41:57.120031 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m11:41:57.150858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:57.333424 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f40caa7e-238a-4ece-b907-97436a4fa96c
[0m11:41:58.323246 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."eia_silver" does not exists - Ignoring
[0m11:41:58.326834 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."eia_silver" does not exist - Ignoring
[0m11:41:58.330170 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m11:41:59.593179 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m11:41:59.594482 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:41:59.595133 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/f384ddd2-4abf-4933-90b2-abfe5be59b65
[0m11:42:00.281946 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m11:42:00.292620 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:42:00.293318 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m11:42:00.312370 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/f384ddd2-4abf-4933-90b2-abfe5be59b65', bucket='climate-energy-raw-data', prefix='silver/eia_silver/f384ddd2-4abf-4933-90b2-abfe5be59b65/'
[0m11:42:00.546846 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6e612b84-f203-4c72-8825-62213a2859f0
[0m11:42:02.259702 [debug] [Thread-1  ]: SQL status: OK -1 in 1.965 seconds
[0m11:42:02.273022 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m11:42:02.279951 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:42:02.280909 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m11:42:02.508723 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f7214c1b-3632-4389-8b03-2e5a5e20077e
[0m11:42:02.517282 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m11:42:02.562752 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:42:03.041239 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:42:03.045710 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/82c433eb-122c-4f4c-922d-5f6f25d0dd4a',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m11:42:03.626529 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 47e1b107-e5c6-4fc4-a9a0-cdc7fddc7c8a
[0m11:42:04.296840 [debug] [Thread-1  ]: SQL status: OK 2842 in 2.015 seconds
[0m11:42:04.301370 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m11:42:04.302624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacdea280>]}
[0m11:42:04.303803 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 13.21s]
[0m11:42:04.305038 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m11:42:04.305996 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m11:42:04.306948 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m11:42:04.309932 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m11:42:04.310361 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m11:42:04.315768 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m11:42:04.316670 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m11:42:04.319393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:42:05.347753 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m11:42:05.350635 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m11:42:05.351063 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m11:42:05.618593 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:42:05.619751 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:42:05.618666 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3c31a0d7-95af-40ea-830a-92c0e563a332
[0m11:42:05.621198 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:42:06.777035 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:42:06.778199 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:42:06.779060 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/d1baab83-4c0a-4209-b691-ba78e63a9f3d
[0m11:42:07.314993 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/d1baab83-4c0a-4209-b691-ba78e63a9f3d', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/d1baab83-4c0a-4209-b691-ba78e63a9f3d/'
[0m11:42:07.324256 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:42:07.332192 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m11:42:07.334424 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m11:42:07.334803 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m11:42:07.529333 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2a947d9f-1f6b-47ac-8373-bf0df6b2bf5f
[0m11:42:09.288875 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m11:42:09.293801 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 11:41:57.120204 => 11:42:09.293407
[0m11:42:09.294488 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m11:42:09.295988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97431610>]}
[0m11:42:09.297191 [info ] [Thread-1 (]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 12.19s]
[0m11:42:09.298101 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m11:42:09.299374 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m11:42:09.302151 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m11:42:09.303086 [info ] [Thread-1 (]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m11:42:09.306560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m11:42:09.307179 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m11:42:09.307268 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:42:09.314957 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m11:42:09.316339 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 11:42:09.307501 => 11:42:09.316190
[0m11:42:09.316692 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m11:42:09.321275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:09.862322 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:42:09.865198 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/3d809ae2-75c7-4e42-9b55-88535de451e7',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m11:42:10.434505 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c9ae9200-c454-4217-86ad-9df8864ce3a3
[0m11:42:10.493522 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."noaa_silver" does not exists - Ignoring
[0m11:42:10.503511 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."noaa_silver" does not exist - Ignoring
[0m11:42:10.508429 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m11:42:11.701265 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m11:42:11.703111 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:42:11.704238 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/3d809ae2-75c7-4e42-9b55-88535de451e7
[0m11:42:12.242129 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m11:42:12.252529 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:42:12.256268 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m11:42:12.479400 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 298fbc28-dce1-45be-91ee-79ba4b507e69
[0m11:42:12.527501 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/3d809ae2-75c7-4e42-9b55-88535de451e7', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/3d809ae2-75c7-4e42-9b55-88535de451e7/'
[0m11:42:14.188111 [debug] [Thread-1  ]: SQL status: OK -1 in 1.929 seconds
[0m11:42:14.196122 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m11:42:14.200739 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:42:14.201613 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m11:42:14.404292 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m11:42:14.406303 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:42:14.414087 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0cac7352-49e1-4f74-9f42-9dd0c9c2a807
[0m11:42:14.909898 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:42:14.911360 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/dc81c3e0-f06f-493e-aebb-f911e7e10fc6',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m11:42:15.421333 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 32c3a113-d246-4e9b-91d4-9f156e339aed
[0m11:42:16.206026 [debug] [Thread-1  ]: SQL status: OK 305 in 2.003 seconds
[0m11:42:16.215746 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m11:42:16.218506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacdccee0>]}
[0m11:42:16.221325 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 11.91s]
[0m11:42:16.226470 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m11:42:16.228457 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m11:42:16.231636 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m11:42:16.238135 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m11:42:16.239340 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m11:42:16.249450 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m11:42:16.252271 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m11:42:16.259020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:42:17.491861 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:42:17.493145 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:42:17.494696 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:42:18.308047 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m11:42:18.311708 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m11:42:18.312467 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m11:42:18.564225 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3fe9b912-7414-46ba-a70a-7edd6b5bfbd0
[0m11:42:18.671601 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:42:18.672308 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:42:18.672976 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/43d563c9-63cb-48d1-8fd7-1e0e8865c1d9
[0m11:42:19.388532 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/43d563c9-63cb-48d1-8fd7-1e0e8865c1d9', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/43d563c9-63cb-48d1-8fd7-1e0e8865c1d9/'
[0m11:42:20.246838 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:42:20.251046 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m11:42:20.253338 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m11:42:20.253947 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m11:42:20.559856 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID db1a543c-1dfb-4cba-a7d7-ff3d6f455977
[0m11:42:21.466439 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m11:42:21.473603 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:42:21.993068 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:42:21.994866 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/cf5c13f1-ed93-4b94-8db3-feac243b9d2a',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m11:42:22.372246 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m11:42:22.378477 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 11:42:09.317613 => 11:42:22.378153
[0m11:42:22.379327 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m11:42:22.380783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b872d0>]}
[0m11:42:22.383378 [info ] [Thread-1 (]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 13.08s]
[0m11:42:22.385049 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m11:42:22.385765 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m11:42:22.386669 [info ] [Thread-1 (]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m11:42:22.389316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m11:42:22.389733 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m11:42:22.396017 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m11:42:22.397222 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 11:42:22.389965 => 11:42:22.397087
[0m11:42:22.397504 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m11:42:22.400895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:22.555039 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 733bdb52-c49a-4a98-8a7c-29042fa61899
[0m11:42:23.598100 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver" does not exists - Ignoring
[0m11:42:23.600856 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver" does not exist - Ignoring
[0m11:42:23.601881 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m11:42:24.712585 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m11:42:24.713109 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:42:24.713415 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/cf5c13f1-ed93-4b94-8db3-feac243b9d2a
[0m11:42:25.358355 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/cf5c13f1-ed93-4b94-8db3-feac243b9d2a', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/cf5c13f1-ed93-4b94-8db3-feac243b9d2a/'
[0m11:42:25.457929 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m11:42:25.465508 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:42:25.466169 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m11:42:25.705454 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3035c310-620f-4c6b-b61e-ac8422acb9fe
[0m11:42:27.387523 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m11:42:27.395871 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:42:27.514626 [debug] [Thread-1  ]: SQL status: OK -1 in 2.048 seconds
[0m11:42:27.520384 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m11:42:27.524341 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:42:27.524891 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m11:42:27.772849 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3acb9c63-d147-4197-b317-92ecba825f9c
[0m11:42:27.952352 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:42:27.955447 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/7de73c55-dcf7-4478-a78b-b230df846808',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m11:42:28.563377 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d4c5da80-3914-48bd-8d68-b5eaa5712d9f
[0m11:42:29.686742 [debug] [Thread-1  ]: SQL status: OK 12458 in 2.161 seconds
[0m11:42:29.692284 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m11:42:29.693663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca348e0>]}
[0m11:42:29.694894 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 13.46s]
[0m11:42:29.696221 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m11:42:29.697165 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m11:42:29.698377 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m11:42:29.702020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m11:42:29.702677 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m11:42:29.713049 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m11:42:29.714110 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m11:42:29.716939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:42:43.537385 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m11:42:43.546152 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m11:42:43.546910 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m11:42:43.992009 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 85eb1c6c-3b99-4f1b-9f0a-c1b2a426889c
[0m11:42:44.305561 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:42:44.307369 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:42:44.309512 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:42:46.683251 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m11:42:46.685123 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m11:42:46.686973 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m11:42:46.687508 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m11:42:47.143266 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b0f06159-d277-4e3f-9859-5fe8255cbfb7
[0m11:42:47.446443 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:42:47.447546 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:42:47.448684 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/fa718095-8175-48aa-b889-e16870416ab6
[0m11:42:48.189259 [debug] [Thread-1 (]: SQL status: OK 12458 in 1.0 seconds
[0m11:42:48.198456 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 11:42:22.397702 => 11:42:48.198025
[0m11:42:48.199710 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m11:42:48.201139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97621bd0>]}
[0m11:42:48.202132 [info ] [Thread-1 (]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 25.81s]
[0m11:42:48.203332 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m11:42:48.204143 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m11:42:48.205018 [info ] [Thread-1 (]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m11:42:48.208703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m11:42:48.209370 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m11:42:48.214107 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m11:42:48.215696 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 11:42:48.209789 => 11:42:48.215448
[0m11:42:48.216171 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m11:42:48.222287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:48.676459 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/fa718095-8175-48aa-b889-e16870416ab6', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/fa718095-8175-48aa-b889-e16870416ab6/'
[0m11:42:50.285603 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m11:42:50.286491 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:42:50.287079 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m11:42:52.054135 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m11:42:52.060804 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:42:52.209373 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openweather_silver" does not exists - Ignoring
[0m11:42:52.211555 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openweather_silver" does not exist - Ignoring
[0m11:42:52.830383 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:42:52.832636 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/596feb32-c9db-41c1-9bc3-45bc5bbe5b59',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m11:42:53.579824 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c351bea9-7388-444f-8a42-56f6048af7b6
[0m11:42:53.892861 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openweather_silver" does not exist and will not be deleted, ignoring
[0m11:42:53.896911 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:42:54.892186 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:42:54.893494 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/dd4bb379-8b04-4ee5-8bb4-869197b00ada',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m11:42:55.654643 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m11:42:55.657927 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:42:55.659027 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m11:42:55.687080 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 42ce0472-64b5-40d1-87ff-4a0c77e0c191
[0m11:42:55.954012 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6a2c32d7-8017-49d7-af18-ea3328fb2ae9
[0m11:42:57.802030 [debug] [Thread-1  ]: SQL status: OK -1 in 2.141 seconds
[0m11:42:57.807642 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m11:42:57.810072 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:42:57.810568 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m11:42:58.050221 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 10e9b81c-c994-44e2-850b-1daa20bd6814
[0m11:43:00.171539 [debug] [Thread-1  ]: SQL status: OK 473 in 2.360 seconds
[0m11:43:00.178216 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m11:43:00.180287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacfcda00>]}
[0m11:43:00.182291 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 30.48s]
[0m11:43:00.184384 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m11:43:00.185882 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m11:43:00.187980 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m11:43:00.196659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m11:43:00.197589 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m11:43:00.202987 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m11:43:00.204831 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m11:43:00.208884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:01.661287 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:43:01.664716 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:43:01.672401 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:43:02.994932 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:43:02.996188 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:43:02.996823 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/c6ea3bb2-2a11-4aed-8f15-74d15cc8348c
[0m11:43:03.463770 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a7eae2e7-7e2d-4fb0-84c7-e2157e95a9a4
[0m11:43:03.694888 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/c6ea3bb2-2a11-4aed-8f15-74d15cc8348c', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/c6ea3bb2-2a11-4aed-8f15-74d15cc8348c/'
[0m11:43:06.429716 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m11:43:06.442226 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:43:07.317356 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:43:07.319929 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/4783b755-1cb5-4b4b-8e44-990cbc025985',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m11:43:07.929898 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 206addd9-3529-4b33-88b9-ef472a83f566
[0m11:43:09.719462 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m11:43:09.721578 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:43:09.721923 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m11:43:09.963936 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 56b39466-5c75-4044-a3b7-af59c1fc9aab
[0m11:43:11.826649 [debug] [Thread-1  ]: SQL status: OK -1 in 2.101 seconds
[0m11:43:11.846636 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m11:43:11.850137 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:43:11.850741 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m11:43:12.102235 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4da18063-fad3-4d6d-b8ee-c97dba833797
[0m11:43:14.102670 [debug] [Thread-1  ]: SQL status: OK 700 in 2.251 seconds
[0m11:43:14.106738 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m11:43:14.107951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaacb6160>]}
[0m11:43:14.109058 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 13.92s]
[0m11:43:14.110221 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m11:43:14.111194 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m11:43:14.112205 [info ] [Thread-1  ]: 11 of 11 START sql incremental model silver_gold.weather_data_gold ............. [RUN]
[0m11:43:14.115669 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m11:43:14.116038 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m11:43:14.123345 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:43:14.124670 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m11:43:14.158831 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:43:14.159348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:14.996059 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:43:14.998110 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."silver_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(ingestion_timestamp) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        date(ingestion_timestamp) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:43:15.686859 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b4a19895-b4c5-4faf-8849-c49ef777db3a
[0m11:43:17.214610 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c4e21071-d462-48a2-9629-2bba71f75a45
[0m11:43:23.055500 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b38d3ff8-d47f-43eb-a90e-0fb658fce9a1
[0m11:43:34.170999 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0190ecf7-b46c-4d60-b796-329ea2e5d9d5
[0m11:43:42.895321 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 02849efb-5693-4539-897e-803c31a53b0c
[0m11:43:45.693389 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID bab4b1b4-93e0-4993-a21f-86879a5c19da
[0m11:44:00.129642 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 28ff1d4b-c590-42ba-8913-84ff48996070
[0m11:45:06.112915 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 488c9d82-6993-446a-9c3f-30430299da5d
[0m11:45:37.243240 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fa0addad-a034-4e49-86fd-5d308a236ffa
[0m11:45:38.587716 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-17T17:25:31.818726. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/fa0addad-a034-4e49-86fd-5d308a236ffa' before retrying. Athena will not delete data in your account.
[0m11:45:38.591394 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m11:45:38.594837 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-17T17:25:31.818726. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/fa0addad-a034-4e49-86fd-5d308a236ffa' before retrying. Athena will not delete data in your account.
[0m11:45:38.602059 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 181, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1288, in run_query_with_partitions_limit_catching
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1284, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1365, in _run_query
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1362, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 219, in execute
    return inner()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 325, in iter
    raise retry_exc.reraise()
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 158, in reraise
    raise self.last_attempt.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 217, in inner
    return execute_with_iceberg_retries()  # type: ignore
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 289, in wrapped_f
    return self(f, *args, **kw)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 379, in __call__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 314, in iter
    return fut.result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.8/site-packages/tenacity/__init__.py", line 382, in __call__
    result = fn(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/connections.py", line 215, in execute_with_iceberg_retries
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-17T17:25:31.818726. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/fa0addad-a034-4e49-86fd-5d308a236ffa' before retrying. Athena will not delete data in your account.

[0m11:45:38.604802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb343cb-cfe6-4101-8643-76a162816faa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab0661f0>]}
[0m11:45:38.607621 [error] [Thread-1  ]: 11 of 11 ERROR creating sql incremental model silver_gold.weather_data_gold .... [[31mERROR[0m in 144.49s]
[0m11:45:38.608770 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m11:45:38.614496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:38.615003 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m11:45:38.615790 [info ] [MainThread]: 
[0m11:45:38.616394 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 4 minutes and 12.79 seconds (252.79s).
[0m11:45:38.619313 [debug] [MainThread]: Command end result
[0m11:45:38.665174 [info ] [MainThread]: 
[0m11:45:38.665614 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:45:38.665907 [info ] [MainThread]: 
[0m11:45:38.666324 [error] [MainThread]:   INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-17T17:25:31.818726. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/fa0addad-a034-4e49-86fd-5d308a236ffa' before retrying. Athena will not delete data in your account.
[0m11:45:38.666566 [info ] [MainThread]: 
[0m11:45:38.667014 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m11:45:38.669475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 253.81447, "process_user_time": 10.019913, "process_kernel_time": 0.829416, "process_mem_max_rss": "185276", "process_out_blocks": "3238", "command_success": false, "process_in_blocks": "0"}
[0m11:45:38.670213 [debug] [MainThread]: Command `dbt run` failed at 11:45:38.670147 after 253.82 seconds
[0m11:45:38.670622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e57160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa0bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0cc640>]}
[0m11:45:38.670860 [debug] [MainThread]: Flushing usage events
[0m11:46:04.103670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68e2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d402e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d40880>]}


============================== 11:46:04.107985 | 6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6 ==============================
[0m11:46:04.107985 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:46:04.108430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:46:04.436010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa228b250>]}
[0m11:46:04.465716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5fd6100>]}
[0m11:46:04.466292 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:46:04.478818 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:46:04.547335 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m11:46:04.547741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa59a3f40>]}
[0m11:46:05.317098 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:46:05.317606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa229ac40>]}
[0m11:46:05.483085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d94100>]}
[0m11:46:05.556281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25e9220>]}
[0m11:46:05.556625 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 450 macros
[0m11:46:05.556863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25ddc70>]}
[0m11:46:05.557939 [info ] [MainThread]: 
[0m11:46:05.558307 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:46:05.562473 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:46:05.562778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:06.257480 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:46:06.258704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:06.888138 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:46:06.892756 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver_gold'
[0m11:46:06.893601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:08.255434 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m11:46:08.260400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now list_AwsDataCatalog_silver)
[0m11:46:08.263049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:09.705849 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:46:09.715488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18bb100>]}
[0m11:46:09.718191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:09.719444 [info ] [MainThread]: 
[0m11:46:09.733491 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m11:46:09.734755 [info ] [Thread-1  ]: 1 of 11 START sql view model silver.eia_bronze ................................. [RUN]
[0m11:46:09.735781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m11:46:09.736310 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m11:46:09.749260 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m11:46:09.751550 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m11:46:09.773981 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m11:46:09.775380 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m11:46:09.775655 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m11:46:09.775900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:46:11.690055 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a8e36a99-4ba1-451c-ae92-8225fb6dcd1b
[0m11:46:13.567801 [debug] [Thread-1  ]: SQL status: OK -1 in 3.791 seconds
[0m11:46:14.755311 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['28', '27', '26', '25', '24']
[0m11:46:14.757647 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['24']
[0m11:46:15.404781 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 24 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m11:46:15.424526 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m11:46:15.427657 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a405730>]}
[0m11:46:15.429111 [info ] [Thread-1  ]: 1 of 11 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 5.69s]
[0m11:46:15.430547 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m11:46:15.431480 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m11:46:15.432748 [info ] [Thread-1  ]: 2 of 11 START sql view model silver.noaa_bronze ................................ [RUN]
[0m11:46:15.436107 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m11:46:15.436601 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m11:46:15.441578 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m11:46:15.442912 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m11:46:15.445920 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m11:46:15.447570 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m11:46:15.448294 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m11:46:15.449087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:46:16.091223 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ba69dbe5-29c0-479c-be4f-810915e059c5
[0m11:46:17.877217 [debug] [Thread-1  ]: SQL status: OK -1 in 2.428 seconds
[0m11:46:19.149556 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['29', '28', '27', '26', '25']
[0m11:46:19.153576 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['25']
[0m11:46:19.735890 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 25 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m11:46:19.743702 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m11:46:19.745489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa298d250>]}
[0m11:46:19.747235 [info ] [Thread-1  ]: 2 of 11 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.31s]
[0m11:46:19.749100 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m11:46:19.749937 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m11:46:19.750905 [info ] [Thread-1  ]: 3 of 11 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m11:46:19.754850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m11:46:19.755546 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m11:46:19.761566 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m11:46:19.763372 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m11:46:19.767683 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m11:46:19.769043 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m11:46:19.769529 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m11:46:19.769960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:46:20.527362 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 370f86ff-e028-48db-84b8-24cce2fe53f4
[0m11:46:22.338074 [debug] [Thread-1  ]: SQL status: OK -1 in 2.567 seconds
[0m11:46:23.670476 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['29', '28', '27', '26', '25']
[0m11:46:23.672913 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['25']
[0m11:46:24.373634 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 25 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m11:46:24.383468 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m11:46:24.385289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2a44520>]}
[0m11:46:24.386912 [info ] [Thread-1  ]: 3 of 11 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.63s]
[0m11:46:24.388400 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m11:46:24.389470 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m11:46:24.391017 [info ] [Thread-1  ]: 4 of 11 START sql view model silver.openweather_bronze ......................... [RUN]
[0m11:46:24.395058 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m11:46:24.395762 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m11:46:24.401700 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m11:46:24.402781 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m11:46:24.405413 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m11:46:24.406099 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m11:46:24.406394 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m11:46:24.406657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:46:25.506705 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID dbda3d1c-30c5-4636-92d7-05bfb38232dc
[0m11:46:26.120400 [debug] [Thread-1  ]: SQL status: OK -1 in 1.713 seconds
[0m11:46:27.456993 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['29', '28', '27', '26', '25']
[0m11:46:27.458852 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['25']
[0m11:46:27.968777 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 25 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m11:46:27.977494 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m11:46:27.978951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a988e80>]}
[0m11:46:27.980683 [info ] [Thread-1  ]: 4 of 11 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 3.59s]
[0m11:46:27.982602 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m11:46:27.983729 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m11:46:27.984760 [info ] [Thread-1  ]: 5 of 11 START sql view model silver.sensor_bronze .............................. [RUN]
[0m11:46:27.988876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m11:46:27.989511 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m11:46:27.995753 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m11:46:27.997601 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m11:46:28.001809 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m11:46:28.003150 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m11:46:28.003564 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m11:46:28.003988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:46:28.802806 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID af255d93-8e30-4c0b-8526-f8e13f8a89aa
[0m11:46:30.637115 [debug] [Thread-1  ]: SQL status: OK -1 in 2.632 seconds
[0m11:46:32.014975 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['28', '27', '26', '25', '24']
[0m11:46:32.018618 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['24']
[0m11:46:32.604564 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 24 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m11:46:32.617592 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m11:46:32.625976 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a405040>]}
[0m11:46:32.628577 [info ] [Thread-1  ]: 5 of 11 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.64s]
[0m11:46:32.630754 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m11:46:32.632524 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m11:46:32.634696 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m11:46:32.639442 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m11:46:32.640113 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m11:46:32.649518 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m11:46:32.651713 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m11:46:32.689552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:46:34.039716 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:46:34.040984 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:46:34.044621 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:46:35.303248 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:46:35.304636 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:46:35.305623 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/82c433eb-122c-4f4c-922d-5f6f25d0dd4a
[0m11:46:35.986522 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/82c433eb-122c-4f4c-922d-5f6f25d0dd4a', bucket='climate-energy-raw-data', prefix='silver/eia_silver/82c433eb-122c-4f4c-922d-5f6f25d0dd4a/'
[0m11:46:38.289163 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m11:46:38.325237 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:46:38.844219 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:46:38.845744 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/e31f03a9-ec4c-43c7-8f25-ee859f00a3c1',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m11:46:39.447382 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9df1de43-0c07-449d-8e3a-29559b0171b3
[0m11:46:41.236610 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m11:46:41.241904 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:46:41.242194 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m11:46:41.462769 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c3aa181f-4246-4620-bf5c-a0e4d591068f
[0m11:46:43.252815 [debug] [Thread-1  ]: SQL status: OK -1 in 2.009 seconds
[0m11:46:43.261106 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m11:46:43.266094 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:46:43.266938 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m11:46:43.522196 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1c71e524-5722-4ef0-8e02-69dd4854e6b2
[0m11:46:44.006782 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1129248a-dc95-459b-a8ac-dc121cdd22d6
[0m11:46:51.547663 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.openweather_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/1129248a-dc95-459b-a8ac-dc121cdd22d6' before retrying. Athena will not delete data in your account.
[0m11:46:51.555224 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 11:42:48.216433 => 11:46:51.554162
[0m11:46:51.556784 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m11:46:51.571107 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.openweather_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/1129248a-dc95-459b-a8ac-dc121cdd22d6' before retrying. Athena will not delete data in your account.
[0m11:46:51.592618 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.openweather_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/1129248a-dc95-459b-a8ac-dc121cdd22d6' before retrying. Athena will not delete data in your account.

[0m11:46:51.603698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b01a90>]}
[0m11:46:51.598694 [debug] [Thread-1  ]: SQL status: OK 2842 in 8.323 seconds
[0m11:46:51.622953 [error] [Thread-1 (]: 9 of 11 ERROR creating sql table model silver.openweather_silver ............... [[31mERROR[0m in 243.39s]
[0m11:46:51.625264 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m11:46:51.648491 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m11:46:51.658249 [info ] [Thread-1 (]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m11:46:51.662907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m11:46:51.665234 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m11:46:51.665674 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m11:46:51.675292 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99474fd0>]}
[0m11:46:51.683599 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 19.03s]
[0m11:46:51.699052 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m11:46:51.704158 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m11:46:51.712068 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m11:46:51.715906 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m11:46:51.714120 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m11:46:51.718182 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m11:46:51.728211 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 11:46:51.670585 => 11:46:51.725924
[0m11:46:51.730226 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m11:46:51.743454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:51.769827 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m11:46:51.780550 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m11:46:51.792672 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:46:54.375353 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:46:54.473630 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:46:54.480100 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:46:54.931312 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m11:46:54.941776 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:46:54.955714 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m11:46:56.233728 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:46:56.236862 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:46:56.238449 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/dc81c3e0-f06f-493e-aebb-f911e7e10fc6
[0m11:46:56.592050 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m11:46:56.594860 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:46:56.595818 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/4783b755-1cb5-4b4b-8e44-990cbc025985
[0m11:46:57.038462 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/dc81c3e0-f06f-493e-aebb-f911e7e10fc6', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/dc81c3e0-f06f-493e-aebb-f911e7e10fc6/'
[0m11:46:57.277965 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/4783b755-1cb5-4b4b-8e44-990cbc025985', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/4783b755-1cb5-4b4b-8e44-990cbc025985/'
[0m11:46:59.333302 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m11:46:59.347709 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:46:59.544228 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m11:46:59.557771 [debug] [Thread-1 (]: Skip partitioning: False
[0m11:46:59.943685 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:46:59.945785 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/eb92f034-a353-44dd-a1f1-29b867b9de8b',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m11:47:00.307871 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:47:00.310169 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/ab16c9c7-14db-4917-8c09-a685c97eaa0f',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m11:47:00.596607 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a6d6a5b8-55f7-4ca0-9696-0b941bda6a94
[0m11:47:01.002675 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 542eb637-90d6-4591-bdef-cba251b2dc89
[0m11:47:02.519460 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m11:47:02.530203 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:47:02.530737 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m11:47:02.777486 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 903600bf-8226-4461-9a8c-431487294f68
[0m11:47:04.407969 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m11:47:04.417862 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m11:47:04.418519 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m11:47:04.753042 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8df36aaa-6cd2-484a-871e-2e9142e358bb
[0m11:47:04.766800 [debug] [Thread-1  ]: SQL status: OK -1 in 2.236 seconds
[0m11:47:04.776946 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m11:47:04.784129 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:47:04.784562 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m11:47:05.025896 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 98451f57-4840-4451-a616-c0ab774dc075
[0m11:47:06.649448 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m11:47:06.668454 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m11:47:06.671856 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m11:47:06.672457 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m11:47:06.944141 [debug] [Thread-1  ]: SQL status: OK 305 in 2.158 seconds
[0m11:47:06.955048 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m11:47:06.957243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a495d60>]}
[0m11:47:06.960228 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 15.24s]
[0m11:47:06.964680 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m11:47:06.966251 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m11:47:06.968073 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m11:47:06.976506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m11:47:06.977275 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m11:47:06.988400 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m11:47:06.990081 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m11:47:06.994886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:47:07.096443 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 70a016da-3105-4e42-813c-0b4f42264c25
[0m11:47:09.501767 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:47:09.503946 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:47:09.505689 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:47:09.648669 [debug] [Thread-1 (]: SQL status: OK 700 in 3.0 seconds
[0m11:47:09.662847 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 11:46:51.732160 => 11:47:09.661905
[0m11:47:09.663905 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m11:47:09.666359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c511a588-30be-4e14-af42-11343d3b2184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fbb9450>]}
[0m11:47:09.668150 [info ] [Thread-1 (]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 18.01s]
[0m11:47:09.669682 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m11:47:09.670703 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m11:47:09.672259 [info ] [Thread-1 (]: 11 of 11 SKIP relation silver_gold.weather_data_gold ........................... [[33mSKIP[0m]
[0m11:47:09.672891 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m11:47:09.679182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:09.680027 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m11:47:09.689049 [info ] [MainThread]: 
[0m11:47:09.689702 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 5 minutes and 37.23 seconds (337.23s).
[0m11:47:09.691836 [debug] [MainThread]: Command end result
[0m11:47:09.718148 [info ] [MainThread]: 
[0m11:47:09.718535 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:47:09.718868 [info ] [MainThread]: 
[0m11:47:09.719163 [error] [MainThread]:   TABLE_ALREADY_EXISTS: line 1:1: Destination table 'awsdatacatalog.silver.openweather_silver' already exists. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/1129248a-dc95-459b-a8ac-dc121cdd22d6' before retrying. Athena will not delete data in your account.
[0m11:47:09.719489 [info ] [MainThread]: 
[0m11:47:09.719837 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=1 TOTAL=11
[0m11:47:09.723635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 338.38266, "process_user_time": 11.094655, "process_kernel_time": 1.082045, "process_mem_max_rss": "195332", "process_out_blocks": "3063", "command_success": false, "process_in_blocks": "0"}
[0m11:47:09.724874 [debug] [MainThread]: Command `dbt run` failed at 11:47:09.724680 after 338.38 seconds
[0m11:47:09.728417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f6b5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f520a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da09610>]}
[0m11:47:09.729772 [debug] [MainThread]: Flushing usage events
[0m11:47:16.041335 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:47:35.110979 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:47:35.117116 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:47:35.120831 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/7de73c55-dcf7-4478-a78b-b230df846808
[0m11:47:36.991756 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/7de73c55-dcf7-4478-a78b-b230df846808', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/7de73c55-dcf7-4478-a78b-b230df846808/'
[0m11:47:47.217827 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m11:47:47.227875 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:47:48.656454 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:47:48.661259 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/8e5e00d0-b00b-496e-b09f-ced96f398311',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m11:47:49.577019 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8e0d8797-eee1-4fad-82b7-678505493225
[0m11:47:53.976206 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m11:47:53.982172 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:47:53.982642 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m11:47:54.803405 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ef6859f3-90b5-47c2-a431-cd4bf62bb9c5
[0m11:48:00.499784 [debug] [Thread-1  ]: SQL status: OK -1 in 6.513 seconds
[0m11:48:00.532408 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m11:48:00.550070 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:48:00.551295 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m11:48:00.993100 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a9047f93-ad24-4aec-a77d-6b32eba4111e
[0m11:48:03.538317 [debug] [Thread-1  ]: SQL status: OK 12458 in 2.985 seconds
[0m11:48:03.549227 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m11:48:03.551278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a495e20>]}
[0m11:48:03.553311 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 56.58s]
[0m11:48:03.555037 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m11:48:03.556309 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m11:48:03.557783 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m11:48:03.562184 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m11:48:03.562807 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m11:48:03.571176 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m11:48:03.573797 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m11:48:03.579085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:48:05.038813 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:48:05.040252 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:48:05.041987 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:48:06.927906 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:48:06.930430 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:48:06.931845 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/596feb32-c9db-41c1-9bc3-45bc5bbe5b59
[0m11:48:08.016878 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/596feb32-c9db-41c1-9bc3-45bc5bbe5b59', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/596feb32-c9db-41c1-9bc3-45bc5bbe5b59/'
[0m11:48:11.473176 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m11:48:11.481838 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:48:12.030638 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:48:12.034834 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/8994a39e-f57a-40c1-ba8c-4ed35f8d73e4',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m11:48:12.784141 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b6111b56-c3bd-4979-8f71-1014c73f4a97
[0m11:48:16.538542 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m11:48:16.549055 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:48:16.549575 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m11:48:16.773105 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID dd5b8722-1e97-4ccf-a728-7ab06d0ee044
[0m11:48:18.961978 [debug] [Thread-1  ]: SQL status: OK -1 in 2.412 seconds
[0m11:48:18.965689 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m11:48:18.967320 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:48:18.967581 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m11:48:19.928394 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 02f1565b-ea61-4a63-8f53-6f55db08023b
[0m11:48:21.733001 [debug] [Thread-1  ]: SQL status: OK 473 in 2.764 seconds
[0m11:48:21.745202 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m11:48:21.746802 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25e9340>]}
[0m11:48:21.747906 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 18.19s]
[0m11:48:21.749024 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m11:48:21.749905 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m11:48:21.751635 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m11:48:21.756192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m11:48:21.756613 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m11:48:21.768081 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m11:48:21.770005 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m11:48:21.772967 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:50:09.961475 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m11:50:09.970675 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
Could not connect to the endpoint URL: "https://glue.us-east-1.amazonaws.com/"
[0m11:50:09.990135 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -5] No address associated with hostname

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/retry.py", line 525, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/packages/six.py", line 770, in reraise
    raise value
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 404, in _make_request
    self._validate_conn(conn)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1058, in _validate_conn
    conn.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 363, in connect
    self.sock = conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPSConnection object at 0xffff9be40d90>: Failed to establish a new connection: [Errno -5] No address associated with hostname

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 143, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 23, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 357, in get_glue_table_type
    table = self.get_glue_table(relation)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 344, in get_glue_table
    table = glue_client.get_table(CatalogId=catalog_id, DatabaseName=relation.schema, Name=relation.identifier)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 231, in _send_request
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 493, in send
    raise EndpointConnectionError(endpoint_url=request.url, error=e)
botocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: "https://glue.us-east-1.amazonaws.com/"

[0m11:50:09.993219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be40f40>]}
[0m11:50:09.996643 [error] [Thread-1  ]: 10 of 11 ERROR creating sql table model silver.sensor_silver ................... [[31mERROR[0m in 108.24s]
[0m11:50:09.997913 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m11:50:09.999074 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m11:50:10.000884 [info ] [Thread-1  ]: 11 of 11 START sql incremental model silver_gold.weather_data_gold ............. [RUN]
[0m11:50:10.001743 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m11:50:10.002243 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m11:50:10.020016 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:50:10.023100 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m11:50:10.071043 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:50:10.071631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:50:42.341468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81599370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa40940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa406a0>]}


============================== 11:50:42.355691 | 43c2c4f5-9c47-43b7-88e4-e58b8ace92f4 ==============================
[0m11:50:42.355691 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:50:42.356270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:50:42.903984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43c2c4f5-9c47-43b7-88e4-e58b8ace92f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8121c4c0>]}
[0m11:50:42.935593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43c2c4f5-9c47-43b7-88e4-e58b8ace92f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cb0250>]}
[0m11:50:42.936240 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:50:42.958742 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:50:43.059821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:50:43.060181 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:50:43.094322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43c2c4f5-9c47-43b7-88e4-e58b8ace92f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d6adc40>]}
[0m11:50:43.182124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43c2c4f5-9c47-43b7-88e4-e58b8ace92f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5e9760>]}
[0m11:50:43.182624 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 450 macros
[0m11:50:43.182955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43c2c4f5-9c47-43b7-88e4-e58b8ace92f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d619370>]}
[0m11:50:43.184416 [info ] [MainThread]: 
[0m11:50:43.184916 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:50:43.189697 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:50:43.190106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:49.004004 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m11:50:49.012859 [error] [Thread-1  ]: [31mUnhandled error while executing [0m
Could not connect to the endpoint URL: "https://climate-energy-raw-data.s3.amazonaws.com/?list-type=2&prefix=gold%2Fweather_data%2F&encoding-type=url"
[0m11:50:49.017201 [debug] [Thread-1  ]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -5] No address associated with hostname

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/retry.py", line 525, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/packages/six.py", line 770, in reraise
    raise value
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 404, in _make_request
    self._validate_conn(conn)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1058, in _validate_conn
    conn.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 363, in connect
    self.sock = conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPSConnection object at 0xffff99890970>: Failed to establish a new connection: [Errno -5] No address associated with hostname

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 368, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/base.py", line 415, in run
    return self.execute(compiled_node, manifest)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 298, in execute
    result = MacroGenerator(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 181, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 84, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/clients/jinja.py", line 322, in call_macro
    return macro(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 90, in macro
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 497, in delete_from_s3
    if self._s3_path_exists(bucket_name, prefix):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 546, in _s3_path_exists
    response = s3_client.list_objects_v2(Bucket=s3_bucket, Prefix=s3_prefix)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 231, in _send_request
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 493, in send
    raise EndpointConnectionError(endpoint_url=request.url, error=e)
botocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: "https://climate-energy-raw-data.s3.amazonaws.com/?list-type=2&prefix=gold%2Fweather_data%2F&encoding-type=url"

[0m11:50:49.020752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ff2f7d6-7dc9-40a2-8882-4f9e708a0eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a4180a0>]}
[0m11:50:49.024304 [error] [Thread-1  ]: 11 of 11 ERROR creating sql incremental model silver_gold.weather_data_gold .... [[31mERROR[0m in 39.02s]
[0m11:50:49.025861 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m11:50:49.035434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:49.036668 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m11:50:49.037138 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m11:50:49.045013 [info ] [MainThread]: 
[0m11:50:49.045794 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 4 minutes and 43.49 seconds (283.49s).
[0m11:50:49.049073 [debug] [MainThread]: Command end result
[0m11:50:49.107511 [info ] [MainThread]: 
[0m11:50:49.108795 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:50:49.109173 [info ] [MainThread]: 
[0m11:50:49.109896 [error] [MainThread]:   Could not connect to the endpoint URL: "https://glue.us-east-1.amazonaws.com/"
[0m11:50:49.111324 [info ] [MainThread]: 
[0m11:50:49.111839 [error] [MainThread]:   Could not connect to the endpoint URL: "https://climate-energy-raw-data.s3.amazonaws.com/?list-type=2&prefix=gold%2Fweather_data%2F&encoding-type=url"
[0m11:50:49.112732 [info ] [MainThread]: 
[0m11:50:49.113058 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=0 TOTAL=11
[0m11:50:49.115449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 285.06552, "process_user_time": 11.811966, "process_kernel_time": 1.370362, "process_mem_max_rss": "198444", "process_in_blocks": "328", "process_out_blocks": "3242", "command_success": false}
[0m11:50:49.116403 [debug] [MainThread]: Command `dbt run` failed at 11:50:49.116309 after 285.07 seconds
[0m11:50:49.116889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68e2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa289f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5fd6100>]}
[0m11:50:49.117271 [debug] [MainThread]: Flushing usage events
[0m11:50:53.135031 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m11:51:21.069788 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:51:21.083678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:58.653718 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:51:58.664866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:58.665760 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m11:51:58.667356 [info ] [MainThread]: 
[0m11:51:58.668587 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 15.48 seconds (75.48s).
[0m11:51:58.680333 [error] [MainThread]: Encountered an error:
Could not connect to the endpoint URL: "https://glue.us-east-1.amazonaws.com/"
[0m11:51:58.692199 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/connection.py", line 72, in create_connection
    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):
  File "/usr/local/lib/python3.8/socket.py", line 918, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -5] No address associated with hostname

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 464, in send
    urllib_response = conn.urlopen(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/util/retry.py", line 525, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/packages/six.py", line 770, in reraise
    raise value
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 404, in _make_request
    self._validate_conn(conn)
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1058, in _validate_conn
    conn.connect()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 363, in connect
    self.sock = conn = self._new_conn()
  File "/home/airflow/.local/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPSConnection object at 0xffff7c4d0700>: Failed to establish a new connection: [Errno -5] No address associated with hostname

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 989, in _make_api_call
    http, parsed_response = self._make_request(
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1015, in _make_request
    return self._endpoint.make_request(operation_model, request_dict)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 119, in make_request
    return self._send_request(request_dict, operation_model)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 231, in _send_request
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 281, in _do_get_response
    http_response = self._send(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/endpoint.py", line 377, in _send
    return self.http_session.send(request)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 493, in send
    raise EndpointConnectionError(endpoint_url=request.url, error=e)
botocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: "https://glue.us-east-1.amazonaws.com/"

[0m11:51:58.695633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 76.39768, "process_user_time": 2.156104, "process_kernel_time": 0.691277, "process_mem_max_rss": "159096", "process_in_blocks": "128", "process_out_blocks": "1079", "command_success": false}
[0m11:51:58.697210 [debug] [MainThread]: Command `dbt run` failed at 11:51:58.697036 after 76.40 seconds
[0m11:51:58.698188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81599370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d686be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77587af0>]}
[0m11:51:58.698838 [debug] [MainThread]: Flushing usage events
[0m11:52:02.716765 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m12:12:45.509490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e319370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c780940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7806a0>]}


============================== 12:12:45.516536 | fd4f53aa-ffaa-462b-a8b3-048e2d87f92c ==============================
[0m12:12:45.516536 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:12:45.517280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:12:45.508976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5e971c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4300190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4300af0>]}


============================== 12:12:45.518413 | 70636fa7-3e55-4d45-b23d-9129721581e5 ==============================
[0m12:12:45.518413 [info ] [MainThread]: Running with dbt=1.8.7
[0m12:12:45.519385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:12:46.302389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70636fa7-3e55-4d45-b23d-9129721581e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e0d9a0>]}
[0m12:12:46.304425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd4f53aa-ffaa-462b-a8b3-048e2d87f92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e00d4c0>]}
[0m12:12:46.367027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70636fa7-3e55-4d45-b23d-9129721581e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb431ad60>]}
[0m12:12:46.369805 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m12:12:46.368908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd4f53aa-ffaa-462b-a8b3-048e2d87f92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbaf250>]}
[0m12:12:46.375190 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m12:12:46.401185 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:12:46.403089 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m12:12:46.600573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:46.601206 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:46.602833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:46.606194 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:46.664643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70636fa7-3e55-4d45-b23d-9129721581e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1fadbb0>]}
[0m12:12:46.670446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd4f53aa-ffaa-462b-a8b3-048e2d87f92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a42dc40>]}
[0m12:12:46.879263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70636fa7-3e55-4d45-b23d-9129721581e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1eeb6d0>]}
[0m12:12:46.883653 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 450 macros
[0m12:12:46.886398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70636fa7-3e55-4d45-b23d-9129721581e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f192e0>]}
[0m12:12:46.890830 [info ] [MainThread]: 
[0m12:12:46.893175 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m12:12:46.897344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd4f53aa-ffaa-462b-a8b3-048e2d87f92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a36b760>]}
[0m12:12:46.898896 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 450 macros
[0m12:12:46.901122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd4f53aa-ffaa-462b-a8b3-048e2d87f92c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a39a370>]}
[0m12:12:46.908949 [info ] [MainThread]: 
[0m12:12:46.910759 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m12:12:46.913718 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m12:12:46.915699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:46.924491 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m12:12:46.925217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:58.538144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab21d090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab21ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab21e650>]}


============================== 14:51:58.541492 | 75e19d11-0a25-43d4-8b47-9c464dd20662 ==============================
[0m14:51:58.541492 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:51:58.542308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:51:58.542631 [info ] [MainThread]: dbt version: 1.7.9
[0m14:51:58.542912 [info ] [MainThread]: python version: 3.11.14
[0m14:51:58.543275 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:51:58.543570 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m14:51:58.841506 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m14:51:58.842057 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m14:51:58.842466 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m14:51:58.842870 [info ] [MainThread]: adapter type: athena
[0m14:51:58.843210 [info ] [MainThread]: adapter version: 1.7.2
[0m14:51:58.880441 [info ] [MainThread]: Configuration:
[0m14:51:58.880859 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:51:58.881271 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:51:58.881737 [info ] [MainThread]: Required dependencies:
[0m14:51:58.882262 [debug] [MainThread]: Executing "git --help"
[0m14:51:58.902533 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:51:58.903010 [debug] [MainThread]: STDERR: "b''"
[0m14:51:58.903241 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:51:58.903499 [info ] [MainThread]: Connection:
[0m14:51:58.903822 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m14:51:58.904103 [info ] [MainThread]:   work_group: None
[0m14:51:58.904366 [info ] [MainThread]:   region_name: us-east-1
[0m14:51:58.904596 [info ] [MainThread]:   database: AwsDataCatalog
[0m14:51:58.904870 [info ] [MainThread]:   schema: silver
[0m14:51:58.905112 [info ] [MainThread]:   poll_interval: 1.0
[0m14:51:58.905341 [info ] [MainThread]:   aws_profile_name: None
[0m14:51:58.905588 [info ] [MainThread]:   aws_access_key_id: None
[0m14:51:58.905800 [info ] [MainThread]:   aws_secret_access_key: None
[0m14:51:58.906092 [info ] [MainThread]:   aws_session_token: None
[0m14:51:58.906813 [info ] [MainThread]:   endpoint_url: None
[0m14:51:58.907243 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m14:51:58.907712 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m14:51:58.908055 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m14:51:58.908892 [info ] [MainThread]:   debug_query_state: False
[0m14:51:58.909395 [info ] [MainThread]:   seed_s3_upload_args: None
[0m14:51:58.909877 [info ] [MainThread]:   lf_tags_database: None
[0m14:51:58.910199 [info ] [MainThread]:   spark_work_group: None
[0m14:51:58.910472 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:51:58.910917 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m14:51:58.911137 [debug] [MainThread]: Using athena connection "debug"
[0m14:51:58.911327 [debug] [MainThread]: On debug: select 1 as id
[0m14:51:58.911541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:59.705613 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID b129eae0-f8fb-4dd2-916d-1212a5284f91
[0m14:52:01.461524 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m14:52:01.468452 [debug] [MainThread]: On debug: Close
[0m14:52:01.469952 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:52:01.471055 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:52:01.474677 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.963883, "process_user_time": 1.566871, "process_kernel_time": 1.215499, "process_mem_max_rss": "143860", "process_in_blocks": "16088", "process_out_blocks": "13"}
[0m14:52:01.476059 [debug] [MainThread]: Command `dbt debug` succeeded at 14:52:01.475658 after 2.97 seconds
[0m14:52:01.477048 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:52:01.485589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab058690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac415c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa113c50>]}
[0m14:52:01.486731 [debug] [MainThread]: Flushing usage events
[0m14:52:06.794437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8b22fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e09250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d3d590>]}


============================== 14:52:06.796869 | 56874178-3ccc-4d7e-ac92-ed2eb71151ce ==============================
[0m14:52:06.796869 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:52:06.797363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:07.055032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a7c1d0>]}
[0m14:52:07.099932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7bd5990>]}
[0m14:52:07.100512 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:52:07.105688 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:52:07.122971 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:52:07.123453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb78a1b50>]}
[0m14:52:07.950646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb77e7b50>]}
[0m14:52:07.960000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7991750>]}
[0m14:52:07.960393 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m14:52:07.960716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb776f9d0>]}
[0m14:52:07.962219 [info ] [MainThread]: 
[0m14:52:07.962974 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:52:07.964394 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:52:07.964741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:08.639167 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:52:08.644148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:09.323648 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:52:09.328726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m14:52:09.329689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:10.925888 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m14:52:10.930566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_silver_gold)
[0m14:52:10.933905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:12.321200 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m14:52:12.324487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf804bd0>]}
[0m14:52:12.326756 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:12.327741 [info ] [MainThread]: 
[0m14:52:12.332385 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m14:52:12.333576 [info ] [Thread-1 (]: 1 of 11 START sql view model silver.eia_bronze ................................. [RUN]
[0m14:52:12.335075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now model.silver.eia_bronze)
[0m14:52:12.335705 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m14:52:12.348505 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m14:52:12.351981 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 14:52:12.336142 => 14:52:12.351121
[0m14:52:12.354911 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m14:52:12.399810 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m14:52:12.403223 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m14:52:12.403646 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m14:52:12.404012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:13.001399 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 015d20c8-4c8f-4254-9ad9-3d9a08093fe9
[0m14:52:14.690365 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:52:16.149526 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['29', '28', '27', '26', '25']
[0m14:52:16.151916 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['25']
[0m14:52:16.714572 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 25 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m14:52:16.739294 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 14:52:12.357060 => 14:52:16.738668
[0m14:52:16.740214 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m14:52:16.742849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4af1750>]}
[0m14:52:16.744932 [info ] [Thread-1 (]: 1 of 11 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.41s]
[0m14:52:16.746277 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m14:52:16.747225 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m14:52:16.749259 [info ] [Thread-1 (]: 2 of 11 START sql view model silver.noaa_bronze ................................ [RUN]
[0m14:52:16.753850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m14:52:16.754606 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m14:52:16.765303 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m14:52:16.769202 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 14:52:16.754954 => 14:52:16.768913
[0m14:52:16.770115 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m14:52:16.777059 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m14:52:16.778219 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m14:52:16.778572 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m14:52:16.778900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:17.577725 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f7a178bb-2f78-4ccc-92dd-23ddf7b58f9c
[0m14:52:19.293545 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m14:52:20.646308 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['30', '29', '28', '27', '26']
[0m14:52:20.649756 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['26']
[0m14:52:21.205111 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 26 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m14:52:21.212453 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 14:52:16.771408 => 14:52:21.211913
[0m14:52:21.213232 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m14:52:21.215030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f40390>]}
[0m14:52:21.217702 [info ] [Thread-1 (]: 2 of 11 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.46s]
[0m14:52:21.219837 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m14:52:21.221355 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m14:52:21.222803 [info ] [Thread-1 (]: 3 of 11 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m14:52:21.225874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m14:52:21.226438 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m14:52:21.236993 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m14:52:21.238564 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 14:52:21.226636 => 14:52:21.238337
[0m14:52:21.238934 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m14:52:21.242790 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m14:52:21.244812 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m14:52:21.246135 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m14:52:21.248505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:21.914435 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID dc9481ec-566d-4ab0-a51d-7a0dc12370ac
[0m14:52:23.585892 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:52:25.113488 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['30', '29', '28', '27', '26']
[0m14:52:25.116839 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['26']
[0m14:52:25.678305 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 26 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m14:52:25.684859 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 14:52:21.239202 => 14:52:25.684443
[0m14:52:25.685696 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m14:52:25.687142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf2d3b50>]}
[0m14:52:25.688231 [info ] [Thread-1 (]: 3 of 11 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.46s]
[0m14:52:25.689240 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m14:52:25.689990 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m14:52:25.691067 [info ] [Thread-1 (]: 4 of 11 START sql view model silver.openweather_bronze ......................... [RUN]
[0m14:52:25.693727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m14:52:25.694131 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m14:52:25.704983 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m14:52:25.707005 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 14:52:25.694324 => 14:52:25.706793
[0m14:52:25.707468 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m14:52:25.711833 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m14:52:25.713112 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m14:52:25.713464 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m14:52:25.714109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:26.369832 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6d3d8ada-a3f0-4236-bdf7-66e2e2d28d2d
[0m14:52:28.043268 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:52:29.977687 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['30', '29', '28', '27', '26']
[0m14:52:29.981126 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['26']
[0m14:52:30.558712 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 26 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m14:52:30.567599 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 14:52:25.707940 => 14:52:30.566913
[0m14:52:30.568462 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m14:52:30.571136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafb97dd0>]}
[0m14:52:30.576410 [info ] [Thread-1 (]: 4 of 11 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.88s]
[0m14:52:30.577787 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m14:52:30.578835 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m14:52:30.580645 [info ] [Thread-1 (]: 5 of 11 START sql view model silver.sensor_bronze .............................. [RUN]
[0m14:52:30.585015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m14:52:30.585661 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m14:52:30.603847 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m14:52:30.607354 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 14:52:30.585983 => 14:52:30.606952
[0m14:52:30.607793 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m14:52:30.625201 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m14:52:30.629130 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m14:52:30.630033 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m14:52:30.630556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:31.433982 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b9f9be7f-2b27-409a-8649-65f7ad25f98f
[0m14:52:33.127769 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:52:35.106300 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['29', '28', '27', '26', '25']
[0m14:52:35.110563 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['25']
[0m14:52:35.670026 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 25 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m14:52:35.687341 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 14:52:30.608083 => 14:52:35.686395
[0m14:52:35.688793 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m14:52:35.692316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ff8210>]}
[0m14:52:35.694825 [info ] [Thread-1 (]: 5 of 11 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 5.11s]
[0m14:52:35.696489 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m14:52:35.698246 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m14:52:35.702092 [info ] [Thread-1 (]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m14:52:35.707495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m14:52:35.708486 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m14:52:35.730302 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m14:52:35.732645 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 14:52:35.708855 => 14:52:35.732417
[0m14:52:35.733108 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m14:52:35.763373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:37.717511 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m14:52:37.719632 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:52:37.724344 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:52:39.610160 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m14:52:39.613155 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:52:39.614643 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/e31f03a9-ec4c-43c7-8f25-ee859f00a3c1
[0m14:52:41.078142 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/e31f03a9-ec4c-43c7-8f25-ee859f00a3c1', bucket='climate-energy-raw-data', prefix='silver/eia_silver/e31f03a9-ec4c-43c7-8f25-ee859f00a3c1/'
[0m14:52:44.448329 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m14:52:44.491887 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:52:45.092919 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:52:45.096502 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/5fd3e508-8d37-4934-b6f9-922e2116522d',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m14:52:45.645220 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 58deaadf-3832-48c0-9db9-af48f1fadd0d
[0m14:52:47.305412 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m14:52:47.310984 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m14:52:47.311453 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m14:52:47.564069 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9e8a8d2b-9494-4917-bd55-8a09c2ca373f
[0m14:52:49.209139 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:52:49.218130 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m14:52:49.222169 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m14:52:49.223059 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m14:52:49.445910 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7353d835-ec0e-4f75-b36b-7bf7445ebfdf
[0m14:52:51.148751 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m14:52:51.162378 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 14:52:35.733385 => 14:52:51.161660
[0m14:52:51.163356 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m14:52:51.165640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb798e610>]}
[0m14:52:51.167501 [info ] [Thread-1 (]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 15.46s]
[0m14:52:51.168882 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m14:52:51.169946 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m14:52:51.171080 [info ] [Thread-1 (]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m14:52:51.175708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m14:52:51.176318 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m14:52:51.189486 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m14:52:51.191322 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 14:52:51.176648 => 14:52:51.190984
[0m14:52:51.191898 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m14:52:51.197322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:53.128616 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m14:52:53.130170 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:52:53.132140 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:52:55.017911 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m14:52:55.021088 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:52:55.021782 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/eb92f034-a353-44dd-a1f1-29b867b9de8b
[0m14:52:55.887420 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/eb92f034-a353-44dd-a1f1-29b867b9de8b', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/eb92f034-a353-44dd-a1f1-29b867b9de8b/'
[0m14:52:58.608164 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m14:52:58.622470 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:52:59.170214 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:52:59.172588 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/ceff251e-5d01-41fc-af63-5ee67084cde0',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m14:52:59.756687 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID be30be20-2df8-4923-9616-f029070bf19d
[0m14:53:02.800971 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m14:53:02.803715 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m14:53:02.804182 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m14:53:03.093964 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID aaa9445f-f2ff-402e-9e22-bb7404712940
[0m14:53:04.751144 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:53:04.794059 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m14:53:04.816124 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m14:53:04.819457 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m14:53:05.023557 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 20f0a1df-5144-42a9-9a43-64c5ec02fa71
[0m14:53:06.734046 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m14:53:06.744168 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 14:52:51.192231 => 14:53:06.743139
[0m14:53:06.745357 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m14:53:06.748180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb792af10>]}
[0m14:53:06.750472 [info ] [Thread-1 (]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 15.58s]
[0m14:53:06.753349 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m14:53:06.755868 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m14:53:06.757194 [info ] [Thread-1 (]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m14:53:06.761641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m14:53:06.762337 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m14:53:06.781276 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m14:53:06.783151 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 14:53:06.762677 => 14:53:06.782872
[0m14:53:06.783766 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m14:53:06.788585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:08.749553 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m14:53:08.751355 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:53:08.753460 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:53:10.632735 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m14:53:10.635469 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:53:10.636661 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/8e5e00d0-b00b-496e-b09f-ced96f398311
[0m14:53:11.981630 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/8e5e00d0-b00b-496e-b09f-ced96f398311', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/8e5e00d0-b00b-496e-b09f-ced96f398311/'
[0m14:53:15.524168 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m14:53:15.550590 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:53:16.796915 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:53:16.801835 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/aa63adef-ef1d-4e77-af17-ba567d14ba04',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m14:53:17.420104 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 36d08104-57fc-49a0-b6a7-7acc685ed74f
[0m14:53:20.524176 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m14:53:20.531555 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:53:20.532537 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m14:53:20.823435 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3eaead73-900e-453b-8168-c2a1a43cc999
[0m14:53:22.726497 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:53:22.731323 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m14:53:22.734523 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:53:22.735332 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m14:53:22.926904 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 17f79def-2bb8-4a16-b12c-393cd76f55eb
[0m14:53:24.610110 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m14:53:24.613308 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 14:53:06.784263 => 14:53:24.613076
[0m14:53:24.613774 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m14:53:24.614878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b278d0>]}
[0m14:53:24.615565 [info ] [Thread-1 (]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 17.86s]
[0m14:53:24.616213 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m14:53:24.616736 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m14:53:24.617273 [info ] [Thread-1 (]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m14:53:24.619339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m14:53:24.619680 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m14:53:24.623073 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m14:53:24.623969 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 14:53:24.619859 => 14:53:24.623851
[0m14:53:24.624219 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m14:53:24.626308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:26.925033 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m14:53:26.930026 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:53:26.933866 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:53:29.002817 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m14:53:29.004295 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:53:29.005483 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/8994a39e-f57a-40c1-ba8c-4ed35f8d73e4
[0m14:53:29.646758 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/8994a39e-f57a-40c1-ba8c-4ed35f8d73e4', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/8994a39e-f57a-40c1-ba8c-4ed35f8d73e4/'
[0m14:53:32.473963 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m14:53:32.489697 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:53:33.022630 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:53:33.026323 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/cf1db300-1e16-4661-8336-d8c90b472615',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m14:53:33.597250 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID eb4b043c-f938-4af6-8911-c775910e2ec1
[0m14:53:36.424969 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m14:53:36.427853 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m14:53:36.428313 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m14:53:36.677958 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 188c7760-5627-43d5-9ff2-b682daa47601
[0m14:53:38.323922 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:53:38.331860 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m14:53:38.336339 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m14:53:38.337180 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m14:53:38.537019 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ef27133c-a6d5-4a57-9176-39af943a9e62
[0m14:53:40.494065 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m14:53:40.500610 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 14:53:24.624394 => 14:53:40.500164
[0m14:53:40.501781 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m14:53:40.503522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb63b0d10>]}
[0m14:53:40.504938 [info ] [Thread-1 (]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 15.89s]
[0m14:53:40.506758 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m14:53:40.507737 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m14:53:40.509035 [info ] [Thread-1 (]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m14:53:40.512740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m14:53:40.513511 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m14:53:40.519260 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m14:53:40.521793 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 14:53:40.513971 => 14:53:40.521558
[0m14:53:40.522316 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m14:53:40.525980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:42.462551 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m14:53:42.463377 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:53:42.463972 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:53:44.275333 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m14:53:44.277713 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:53:44.278911 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/ab16c9c7-14db-4917-8c09-a685c97eaa0f
[0m14:53:45.579797 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/ab16c9c7-14db-4917-8c09-a685c97eaa0f', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/ab16c9c7-14db-4917-8c09-a685c97eaa0f/'
[0m14:53:49.025953 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m14:53:49.032702 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:53:50.192356 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:53:50.195856 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/e90f26fb-a161-4db2-91c1-7be2d883d5d8',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m14:53:50.781338 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ef35e29e-861d-4a25-a272-7fb48f55fefa
[0m14:53:53.596409 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m14:53:53.601180 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m14:53:53.602808 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m14:53:53.866405 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5c73dc4d-577f-4bc4-9c8e-2eb05140685b
[0m14:53:55.535833 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:53:55.560215 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m14:53:55.573975 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m14:53:55.575541 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m14:53:55.771328 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bc989129-d81c-4b44-a6d2-b213299e6342
[0m14:53:57.456263 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m14:53:57.470037 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 14:53:40.522666 => 14:53:57.468851
[0m14:53:57.471675 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m14:53:57.475372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec4be10>]}
[0m14:53:57.477992 [info ] [Thread-1 (]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 16.96s]
[0m14:53:57.479937 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m14:53:57.483495 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m14:53:57.486950 [info ] [Thread-1 (]: 11 of 11 START sql incremental model silver_gold.weather_data_gold ............. [RUN]
[0m14:53:57.497087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m14:53:57.498612 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m14:53:57.516348 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m14:53:57.518773 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 14:53:57.499105 => 14:53:57.518555
[0m14:53:57.519417 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m14:53:57.565605 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:53:57.566961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:59.048444 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:53:59.050268 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."silver_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(ingestion_timestamp) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        date(ingestion_timestamp) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m14:53:59.649400 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7953e619-7469-4892-b8a8-a0a079ba8593
[0m14:54:08.323304 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 973a9ba1-c010-49cc-bc45-3affb1979038
[0m14:54:21.868572 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1bafe4d8-68e0-46eb-af7e-ca51b7c730c3
[0m14:54:47.389743 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6fd60b58-aa27-46ba-a939-1541cc48c423
[0m14:55:37.379838 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1fc780f2-56d0-4053-a745-740da674d49f
[0m14:57:15.460166 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2e5fe428-d503-4d40-ac58-1924ebcaed41
[0m14:57:16.790001 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-17T17:25:31.818726. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/2e5fe428-d503-4d40-ac58-1924ebcaed41' before retrying. Athena will not delete data in your account.
[0m14:57:16.794892 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 14:53:57.519747 => 14:57:16.791795
[0m14:57:16.796967 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m14:57:16.800781 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-17T17:25:31.818726. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/2e5fe428-d503-4d40-ac58-1924ebcaed41' before retrying. Athena will not delete data in your account.
[0m14:57:16.815244 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 154, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-17T17:25:31.818726. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/2e5fe428-d503-4d40-ac58-1924ebcaed41' before retrying. Athena will not delete data in your account.

[0m14:57:16.817258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56874178-3ccc-4d7e-ac92-ed2eb71151ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7327ed0>]}
[0m14:57:16.819203 [error] [Thread-1 (]: 11 of 11 ERROR creating sql incremental model silver_gold.weather_data_gold .... [[31mERROR[0m in 199.33s]
[0m14:57:16.820056 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m14:57:16.828515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:16.828978 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m14:57:16.829561 [info ] [MainThread]: 
[0m14:57:16.830067 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 5 minutes and 8.87 seconds (308.87s).
[0m14:57:16.832700 [debug] [MainThread]: Command end result
[0m14:57:16.855614 [info ] [MainThread]: 
[0m14:57:16.856120 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:57:16.856519 [info ] [MainThread]: 
[0m14:57:16.856838 [error] [MainThread]:   INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-17T17:25:31.818726. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/2e5fe428-d503-4d40-ac58-1924ebcaed41' before retrying. Athena will not delete data in your account.
[0m14:57:16.857116 [info ] [MainThread]: 
[0m14:57:16.857582 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m14:57:16.860342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 310.0948, "process_user_time": 10.206849, "process_kernel_time": 1.265278, "process_mem_max_rss": "195976", "process_in_blocks": "392", "process_out_blocks": "3079", "command_success": false}
[0m14:57:16.860936 [debug] [MainThread]: Command `dbt run` failed at 14:57:16.860855 after 310.10 seconds
[0m14:57:16.861543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8ba690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbddd5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaecede10>]}
[0m14:57:16.861857 [debug] [MainThread]: Flushing usage events
[0m14:59:38.672623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d23f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d23990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d22290>]}


============================== 14:59:38.674515 | 6e9c10ce-748f-47b8-ac1f-fabcad1eecb2 ==============================
[0m14:59:38.674515 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:59:38.674913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:59:38.675279 [info ] [MainThread]: dbt version: 1.7.9
[0m14:59:38.675639 [info ] [MainThread]: python version: 3.11.14
[0m14:59:38.675921 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:59:38.676207 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m14:59:38.895389 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m14:59:38.895891 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m14:59:38.896277 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m14:59:38.896711 [info ] [MainThread]: adapter type: athena
[0m14:59:38.896960 [info ] [MainThread]: adapter version: 1.7.2
[0m14:59:38.932492 [info ] [MainThread]: Configuration:
[0m14:59:38.932918 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:59:38.933247 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:59:38.933559 [info ] [MainThread]: Required dependencies:
[0m14:59:38.933953 [debug] [MainThread]: Executing "git --help"
[0m14:59:38.935467 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:59:38.935749 [debug] [MainThread]: STDERR: "b''"
[0m14:59:38.935940 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:59:38.936175 [info ] [MainThread]: Connection:
[0m14:59:38.936471 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m14:59:38.936766 [info ] [MainThread]:   work_group: None
[0m14:59:38.937038 [info ] [MainThread]:   region_name: us-east-1
[0m14:59:38.937299 [info ] [MainThread]:   database: AwsDataCatalog
[0m14:59:38.937588 [info ] [MainThread]:   schema: silver
[0m14:59:38.937820 [info ] [MainThread]:   poll_interval: 1.0
[0m14:59:38.938137 [info ] [MainThread]:   aws_profile_name: None
[0m14:59:38.938461 [info ] [MainThread]:   aws_access_key_id: None
[0m14:59:38.938721 [info ] [MainThread]:   aws_secret_access_key: None
[0m14:59:38.938970 [info ] [MainThread]:   aws_session_token: None
[0m14:59:38.939213 [info ] [MainThread]:   endpoint_url: None
[0m14:59:38.939469 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m14:59:38.939783 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m14:59:38.940045 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m14:59:38.940306 [info ] [MainThread]:   debug_query_state: False
[0m14:59:38.940576 [info ] [MainThread]:   seed_s3_upload_args: None
[0m14:59:38.940825 [info ] [MainThread]:   lf_tags_database: None
[0m14:59:38.941012 [info ] [MainThread]:   spark_work_group: None
[0m14:59:38.941242 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:59:38.941599 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m14:59:38.941882 [debug] [MainThread]: Using athena connection "debug"
[0m14:59:38.942062 [debug] [MainThread]: On debug: select 1 as id
[0m14:59:38.942241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:39.594269 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID cad9a8ae-204e-4b5a-a724-c5dbb18eb46b
[0m14:59:41.342987 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m14:59:41.346001 [debug] [MainThread]: On debug: Close
[0m14:59:41.346973 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:59:41.347935 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:59:41.349995 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.697697, "process_user_time": 1.319973, "process_kernel_time": 0.179404, "process_mem_max_rss": "144264", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m14:59:41.351028 [debug] [MainThread]: Command `dbt debug` succeeded at 14:59:41.350812 after 2.70 seconds
[0m14:59:41.351758 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:59:41.354772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4009290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3789d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b23e90>]}
[0m14:59:41.355705 [debug] [MainThread]: Flushing usage events
[0m15:00:27.451238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f44c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f44d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f452e50>]}


============================== 15:00:27.471857 | 6e94276c-8493-4413-baa0-466536f5254b ==============================
[0m15:00:27.471857 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:00:27.473948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:00:27.474753 [info ] [MainThread]: dbt version: 1.7.9
[0m15:00:27.475275 [info ] [MainThread]: python version: 3.11.14
[0m15:00:27.475779 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m15:00:27.476316 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m15:00:27.901446 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m15:00:27.902207 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m15:00:27.902718 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m15:00:27.903510 [info ] [MainThread]: adapter type: athena
[0m15:00:27.903798 [info ] [MainThread]: adapter version: 1.7.2
[0m15:00:27.951788 [info ] [MainThread]: Configuration:
[0m15:00:27.952408 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:00:27.952934 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:00:27.953399 [info ] [MainThread]: Required dependencies:
[0m15:00:27.953818 [debug] [MainThread]: Executing "git --help"
[0m15:00:27.958620 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:00:27.959056 [debug] [MainThread]: STDERR: "b''"
[0m15:00:27.959354 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:00:27.959743 [info ] [MainThread]: Connection:
[0m15:00:27.960164 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m15:00:27.960610 [info ] [MainThread]:   work_group: None
[0m15:00:27.960964 [info ] [MainThread]:   region_name: us-east-1
[0m15:00:27.961415 [info ] [MainThread]:   database: AwsDataCatalog
[0m15:00:27.961752 [info ] [MainThread]:   schema: silver
[0m15:00:27.962070 [info ] [MainThread]:   poll_interval: 1.0
[0m15:00:27.962535 [info ] [MainThread]:   aws_profile_name: None
[0m15:00:27.962811 [info ] [MainThread]:   aws_access_key_id: None
[0m15:00:27.963062 [info ] [MainThread]:   aws_secret_access_key: None
[0m15:00:27.963513 [info ] [MainThread]:   aws_session_token: None
[0m15:00:27.963802 [info ] [MainThread]:   endpoint_url: None
[0m15:00:27.964175 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m15:00:27.964598 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m15:00:27.964932 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m15:00:27.965853 [info ] [MainThread]:   debug_query_state: False
[0m15:00:27.966752 [info ] [MainThread]:   seed_s3_upload_args: None
[0m15:00:27.967558 [info ] [MainThread]:   lf_tags_database: None
[0m15:00:27.968642 [info ] [MainThread]:   spark_work_group: None
[0m15:00:27.969363 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:00:27.970310 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m15:00:27.970635 [debug] [MainThread]: Using athena connection "debug"
[0m15:00:27.970870 [debug] [MainThread]: On debug: select 1 as id
[0m15:00:27.971149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:28.710046 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID f4f7f64f-2360-4255-a873-704422e65ca8
[0m15:00:30.642020 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m15:00:30.654996 [debug] [MainThread]: On debug: Close
[0m15:00:30.659029 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:00:30.668597 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:00:30.672510 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.2529917, "process_user_time": 2.270837, "process_kernel_time": 0.591364, "process_mem_max_rss": "143984", "process_in_blocks": "1008", "process_out_blocks": "2213"}
[0m15:00:30.678798 [debug] [MainThread]: Command `dbt debug` succeeded at 15:00:30.677634 after 3.26 seconds
[0m15:00:30.682675 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:00:30.711656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4506d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e53edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6ac890>]}
[0m15:00:30.713072 [debug] [MainThread]: Flushing usage events
[0m15:00:38.253469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae113310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb28190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae113050>]}


============================== 15:00:38.257040 | b27c3fd7-14c2-4cde-b6da-cdb6649b7660 ==============================
[0m15:00:38.257040 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:00:38.257601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:38.632727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacfcae50>]}
[0m15:00:38.711353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface9c350>]}
[0m15:00:38.712306 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:00:38.720935 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:00:38.744909 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:00:38.745969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3f9c50>]}
[0m15:00:39.658537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd013d0>]}
[0m15:00:39.668280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacd1ca10>]}
[0m15:00:39.668965 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m15:00:39.669457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf07b10>]}
[0m15:00:39.671052 [info ] [MainThread]: 
[0m15:00:39.671709 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:00:39.672878 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:00:39.673241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:40.373347 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:00:40.375506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:41.081040 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:00:41.083422 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver'
[0m15:00:41.083893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:42.575057 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:00:42.577427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_silver_gold)
[0m15:00:42.580777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:44.016225 [debug] [ThreadPool]: On list_AwsDataCatalog_silver_gold: Close
[0m15:00:44.017908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad14bd90>]}
[0m15:00:44.018984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:44.019574 [info ] [MainThread]: 
[0m15:00:44.021823 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m15:00:44.022430 [info ] [Thread-1 (]: 1 of 11 START sql view model silver.eia_bronze ................................. [RUN]
[0m15:00:44.023112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver_gold, now model.silver.eia_bronze)
[0m15:00:44.023415 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m15:00:44.029644 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:00:44.032158 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 15:00:44.023618 => 15:00:44.031837
[0m15:00:44.032707 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m15:00:44.068089 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:00:44.069864 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m15:00:44.070210 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:00:44.070565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:44.715610 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c6c4d0a6-10bf-4b01-a49b-b5315b52d509
[0m15:00:46.445320 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:00:47.688495 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['30', '29', '28', '27', '26']
[0m15:00:47.690989 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['26']
[0m15:00:48.261954 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 26 of table "AwsDataCatalog"."silver"."eia_bronze" 
[0m15:00:48.282756 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 15:00:44.033111 => 15:00:48.282086
[0m15:00:48.283773 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m15:00:48.286355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4534750>]}
[0m15:00:48.288468 [info ] [Thread-1 (]: 1 of 11 OK created sql view model silver.eia_bronze ............................ [[32mOK -1[0m in 4.26s]
[0m15:00:48.289884 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m15:00:48.291342 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m15:00:48.295246 [info ] [Thread-1 (]: 2 of 11 START sql view model silver.noaa_bronze ................................ [RUN]
[0m15:00:48.298794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:00:48.299312 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m15:00:48.305504 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:00:48.308367 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 15:00:48.299662 => 15:00:48.308045
[0m15:00:48.308891 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m15:00:48.314482 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:00:48.315838 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m15:00:48.316270 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:00:48.316710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:49.123981 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e9f2baf1-809a-4cc1-89d9-e86c69133ca2
[0m15:00:50.963948 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:00:52.192012 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['31', '30', '29', '28', '27']
[0m15:00:52.193551 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['27']
[0m15:00:52.775363 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 27 of table "AwsDataCatalog"."silver"."noaa_bronze" 
[0m15:00:52.781828 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 15:00:48.309345 => 15:00:52.781256
[0m15:00:52.782581 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m15:00:52.784957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa603f9d0>]}
[0m15:00:52.786695 [info ] [Thread-1 (]: 2 of 11 OK created sql view model silver.noaa_bronze ........................... [[32mOK -1[0m in 4.49s]
[0m15:00:52.788019 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m15:00:52.789036 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m15:00:52.791317 [info ] [Thread-1 (]: 3 of 11 START sql view model silver.openmeteo_bronze ........................... [RUN]
[0m15:00:52.794153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:00:52.794689 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m15:00:52.803346 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:00:52.804980 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 15:00:52.795011 => 15:00:52.804798
[0m15:00:52.805389 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m15:00:52.810706 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:00:52.812086 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:00:52.812504 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:00:52.812940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:53.460913 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3431ec9e-e863-482f-b95e-6e91e48780df
[0m15:00:55.296597 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:00:56.802508 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['31', '30', '29', '28', '27']
[0m15:00:56.805276 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['27']
[0m15:00:57.412087 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 27 of table "AwsDataCatalog"."silver"."openmeteo_bronze" 
[0m15:00:57.418944 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 15:00:52.805699 => 15:00:57.418548
[0m15:00:57.419965 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m15:00:57.421564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bdf63d0>]}
[0m15:00:57.422866 [info ] [Thread-1 (]: 3 of 11 OK created sql view model silver.openmeteo_bronze ...................... [[32mOK -1[0m in 4.63s]
[0m15:00:57.424448 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m15:00:57.425223 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m15:00:57.426342 [info ] [Thread-1 (]: 4 of 11 START sql view model silver.openweather_bronze ......................... [RUN]
[0m15:00:57.429066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:00:57.429712 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m15:00:57.434155 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:00:57.436213 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 15:00:57.430147 => 15:00:57.435985
[0m15:00:57.436751 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m15:00:57.440337 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:00:57.441871 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m15:00:57.442546 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:00:57.443582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:58.057894 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d0365c3f-658c-45cf-abb7-7cc59cdbe4c2
[0m15:00:59.847139 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:01:01.231159 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['31', '30', '29', '28', '27']
[0m15:01:01.235335 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['27']
[0m15:01:02.249697 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 27 of table "AwsDataCatalog"."silver"."openweather_bronze" 
[0m15:01:02.265139 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 15:00:57.437055 => 15:01:02.264211
[0m15:01:02.266647 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m15:01:02.269650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9203d0>]}
[0m15:01:02.272245 [info ] [Thread-1 (]: 4 of 11 OK created sql view model silver.openweather_bronze .................... [[32mOK -1[0m in 4.84s]
[0m15:01:02.274162 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m15:01:02.275894 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m15:01:02.278219 [info ] [Thread-1 (]: 5 of 11 START sql view model silver.sensor_bronze .............................. [RUN]
[0m15:01:02.282806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:01:02.283467 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m15:01:02.293462 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:01:02.295708 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 15:01:02.283885 => 15:01:02.295453
[0m15:01:02.296261 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m15:01:02.300588 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:01:02.301897 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m15:01:02.302303 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."silver"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:01:02.302772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:03.108072 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d6336e37-82c7-4f96-bbb2-edad1541c9d5
[0m15:01:04.786178 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:01:06.207733 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['30', '29', '28', '27', '26']
[0m15:01:06.213317 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['26']
[0m15:01:06.934817 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 26 of table "AwsDataCatalog"."silver"."sensor_bronze" 
[0m15:01:06.947613 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 15:01:02.296655 => 15:01:06.947145
[0m15:01:06.948443 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m15:01:06.950579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad0f390>]}
[0m15:01:06.952174 [info ] [Thread-1 (]: 5 of 11 OK created sql view model silver.sensor_bronze ......................... [[32mOK -1[0m in 4.67s]
[0m15:01:06.953239 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m15:01:06.954202 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:01:06.956116 [info ] [Thread-1 (]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m15:01:06.959399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:01:06.960001 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:01:06.969994 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:01:06.971788 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:01:06.960275 => 15:01:06.971633
[0m15:01:06.972119 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:01:07.003604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:08.453652 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:01:08.455725 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:08.459491 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:01:09.799779 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:01:09.801652 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:09.803529 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/5fd3e508-8d37-4934-b6f9-922e2116522d
[0m15:01:10.813258 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/5fd3e508-8d37-4934-b6f9-922e2116522d', bucket='climate-energy-raw-data', prefix='silver/eia_silver/5fd3e508-8d37-4934-b6f9-922e2116522d/'
[0m15:01:13.314218 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:01:13.356249 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:01:13.952261 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:01:13.954976 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/95f2d887-0aa0-4dfa-a217-234fdfbe86ce',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."eia_bronze"
[0m15:01:14.588982 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 00dd25a6-c7f5-495d-b5ee-ce70e33dd558
[0m15:01:16.348030 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:01:16.356987 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:01:16.357844 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:01:16.689347 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID fd9b4515-047f-433d-b47b-02c4ba22789f
[0m15:01:18.396030 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:01:18.404343 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:01:18.408606 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:01:18.409306 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:01:18.615213 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8acbc329-b077-4b6c-a0f9-16247cd964ee
[0m15:01:20.397026 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m15:01:20.407505 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 15:01:06.972367 => 15:01:20.406662
[0m15:01:20.409085 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m15:01:20.412259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac107910>]}
[0m15:01:20.414422 [info ] [Thread-1 (]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 13.45s]
[0m15:01:20.416171 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m15:01:20.419992 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m15:01:20.423021 [info ] [Thread-1 (]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:01:20.426746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:01:20.427443 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m15:01:20.439477 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:01:20.441810 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 15:01:20.427835 => 15:01:20.441576
[0m15:01:20.442478 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m15:01:20.450485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:21.824733 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:01:21.826683 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:21.828647 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:01:23.138817 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:01:23.139365 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:23.139784 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/ceff251e-5d01-41fc-af63-5ee67084cde0
[0m15:01:23.799065 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/ceff251e-5d01-41fc-af63-5ee67084cde0', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/ceff251e-5d01-41fc-af63-5ee67084cde0/'
[0m15:01:26.632560 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:01:26.645210 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:01:27.355573 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:01:27.357468 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/f32dc4c3-50fd-4aca-8b52-7dee9e6dd565',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:01:28.034438 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 01efed80-94a2-4f9b-a912-0fcda3958337
[0m15:01:30.848302 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:01:30.866097 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:01:30.866924 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:01:31.185043 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 915a7bd2-37b5-4014-89e0-0f273ec1c1a3
[0m15:01:32.949761 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:01:32.958793 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:01:32.963597 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:01:32.964397 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:01:33.163271 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f5357143-3ac6-4229-9d74-1a330e3f3db7
[0m15:01:34.936960 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m15:01:34.972984 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 15:01:20.443001 => 15:01:34.972121
[0m15:01:34.974063 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m15:01:34.980037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6102090>]}
[0m15:01:34.987638 [info ] [Thread-1 (]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 14.55s]
[0m15:01:34.990908 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m15:01:34.992931 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m15:01:34.995619 [info ] [Thread-1 (]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m15:01:35.007763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:01:35.009212 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m15:01:35.024284 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:01:35.029787 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 15:01:35.009504 => 15:01:35.028672
[0m15:01:35.031294 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m15:01:35.052452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:37.003810 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:01:37.006560 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:37.015233 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:01:38.559696 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:01:38.561945 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:38.563061 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/aa63adef-ef1d-4e77-af17-ba567d14ba04
[0m15:01:39.138314 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/aa63adef-ef1d-4e77-af17-ba567d14ba04', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/aa63adef-ef1d-4e77-af17-ba567d14ba04/'
[0m15:01:41.926172 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:01:41.929171 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:01:43.343571 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:01:43.347547 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/92d66536-9928-4875-8ace-92d1ff8381fd',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openmeteo_bronze"
[0m15:01:44.035379 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 926ad0f4-3f71-4543-ae9a-b7fb09a97927
[0m15:01:46.886653 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m15:01:46.894998 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:01:46.895882 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:01:47.196552 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 55913807-22ce-408b-ad9f-86e62e39120e
[0m15:01:48.859964 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:01:48.864974 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:01:48.868016 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:01:48.868660 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m15:01:49.076609 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 08c7db7f-9b78-46bd-96e4-2ec0e45460b3
[0m15:01:50.877865 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m15:01:50.886854 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 15:01:35.034211 => 15:01:50.884966
[0m15:01:50.888674 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m15:01:50.891759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f21190>]}
[0m15:01:50.893043 [info ] [Thread-1 (]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 15.89s]
[0m15:01:50.894133 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m15:01:50.894914 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m15:01:50.896048 [info ] [Thread-1 (]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m15:01:50.899267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:01:50.899825 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m15:01:50.906553 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:01:50.911206 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 15:01:50.900084 => 15:01:50.910927
[0m15:01:50.912456 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m15:01:50.920256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:52.409642 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:01:52.410877 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:52.411606 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:01:53.718664 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:01:53.719537 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:53.720205 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/cf1db300-1e16-4661-8336-d8c90b472615
[0m15:01:55.203211 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/cf1db300-1e16-4661-8336-d8c90b472615', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/cf1db300-1e16-4661-8336-d8c90b472615/'
[0m15:01:58.467863 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:01:58.477740 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:01:59.716213 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:01:59.719450 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/38841a04-f4a8-44f2-bb03-74bfa6b0ad64',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."openweather_bronze"
[0m15:02:00.429672 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0c96dea5-9490-46d5-9ce7-ee05e7bb4272
[0m15:02:03.247837 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m15:02:03.253466 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:02:03.254573 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:02:03.522410 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d3053f52-980a-44d1-abd9-b10294f8371a
[0m15:02:05.234077 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:02:05.238380 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:02:05.240521 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:02:05.240978 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m15:02:05.457383 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 20839d67-f8f6-4354-a7cc-21d34c6437b4
[0m15:02:07.195859 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m15:02:07.205563 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 15:01:50.913137 => 15:02:07.204852
[0m15:02:07.206721 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m15:02:07.209634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999446d0>]}
[0m15:02:07.211852 [info ] [Thread-1 (]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 16.31s]
[0m15:02:07.213404 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m15:02:07.214540 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m15:02:07.216733 [info ] [Thread-1 (]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m15:02:07.221285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:02:07.221969 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m15:02:07.236895 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:02:07.238975 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 15:02:07.222362 => 15:02:07.238782
[0m15:02:07.239385 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m15:02:07.243443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:09.621630 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:02:09.623640 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:02:09.624818 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:02:11.618311 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:02:11.619201 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:02:11.619874 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/e90f26fb-a161-4db2-91c1-7be2d883d5d8
[0m15:02:13.011591 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/e90f26fb-a161-4db2-91c1-7be2d883d5d8', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/e90f26fb-a161-4db2-91c1-7be2d883d5d8/'
[0m15:02:16.931019 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:02:16.949408 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:02:18.421725 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:02:18.423752 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/507591dc-a1c3-402f-8b1c-92c56e8c3918',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."silver"."sensor_bronze"
[0m15:02:19.111755 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 309e23fd-a37f-485d-8191-781d7a1fed85
[0m15:02:21.911464 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m15:02:21.915057 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:02:21.916131 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:02:22.203004 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e2a93923-e940-4c5c-92c9-180743b2e2e4
[0m15:02:23.930289 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:02:23.938222 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:02:23.942832 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:02:23.943594 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m15:02:24.143922 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e53f2fd3-c100-4a3b-8310-7deed6be8858
[0m15:02:25.879169 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m15:02:25.887589 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 15:02:07.239646 => 15:02:25.887127
[0m15:02:25.888593 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m15:02:25.890808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf266d0>]}
[0m15:02:25.892377 [info ] [Thread-1 (]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 18.67s]
[0m15:02:25.893402 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m15:02:25.894258 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m15:02:25.895314 [info ] [Thread-1 (]: 11 of 11 START sql incremental model silver_gold.weather_data_gold ............. [RUN]
[0m15:02:25.898160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:02:25.898605 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m15:02:25.915082 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:02:25.916819 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 15:02:25.898944 => 15:02:25.916566
[0m15:02:25.917308 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m15:02:25.968274 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:02:25.969185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:27.417628 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:02:27.421052 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."silver_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(ingestion_timestamp) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        date(ingestion_timestamp) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:02:28.195027 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8080fc07-e1ce-4bd9-9e2e-4fd08a3fc2e8
[0m15:02:35.801625 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a3380e2c-710f-4977-a306-3d2e0a35257b
[0m15:02:49.402995 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1bf8bb76-9949-4d68-affe-70c053e55725
[0m15:03:15.076784 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID de5567a1-5b5c-40fa-9fd6-d5820630d336
[0m15:04:05.851594 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3c11806a-931c-4898-95a4-5907065d12a3
[0m15:05:45.051138 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f908b4ad-2eba-4c1a-b7a1-c5dd9230b5c9
[0m15:05:47.541581 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/f908b4ad-2eba-4c1a-b7a1-c5dd9230b5c9' before retrying. Athena will not delete data in your account.
[0m15:05:47.547262 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 15:02:25.917599 => 15:05:47.545551
[0m15:05:47.551441 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m15:05:47.560991 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/f908b4ad-2eba-4c1a-b7a1-c5dd9230b5c9' before retrying. Athena will not delete data in your account.
[0m15:05:47.583694 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 154, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/f908b4ad-2eba-4c1a-b7a1-c5dd9230b5c9' before retrying. Athena will not delete data in your account.

[0m15:05:47.585308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27c3fd7-14c2-4cde-b6da-cdb6649b7660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac5e0250>]}
[0m15:05:47.587494 [error] [Thread-1 (]: 11 of 11 ERROR creating sql incremental model silver_gold.weather_data_gold .... [[31mERROR[0m in 201.69s]
[0m15:05:47.589360 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m15:05:47.626696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:47.628611 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m15:05:47.628932 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:05:47.632545 [info ] [MainThread]: 
[0m15:05:47.635160 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 5 minutes and 7.96 seconds (307.96s).
[0m15:05:47.642143 [debug] [MainThread]: Command end result
[0m15:05:47.692242 [info ] [MainThread]: 
[0m15:05:47.694664 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:05:47.695578 [info ] [MainThread]: 
[0m15:05:47.696485 [error] [MainThread]:   INVALID_CAST_ARGUMENT: Value cannot be cast to date: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/f908b4ad-2eba-4c1a-b7a1-c5dd9230b5c9' before retrying. Athena will not delete data in your account.
[0m15:05:47.697216 [info ] [MainThread]: 
[0m15:05:47.697964 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m15:05:47.706989 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 309.48877, "process_user_time": 10.303388, "process_kernel_time": 1.469872, "process_mem_max_rss": "208484", "process_out_blocks": "3079", "command_success": false, "process_in_blocks": "0"}
[0m15:05:47.707801 [debug] [MainThread]: Command `dbt run` failed at 15:05:47.707680 after 309.49 seconds
[0m15:05:47.708718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3f9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4ec710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb32f9350>]}
[0m15:05:47.709022 [debug] [MainThread]: Flushing usage events
[0m15:14:18.244682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913f9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b48ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f56490>]}


============================== 15:14:18.250568 | 2e519ec7-4532-431e-bb40-1c95cc6b4cfe ==============================
[0m15:14:18.250568 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:14:18.251884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --profile gold', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:14:18.665324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f95cd0>]}
[0m15:14:18.708173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9009eb90>]}
[0m15:14:18.709189 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:14:18.716671 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m15:14:18.738400 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:14:18.739378 [debug] [MainThread]: previous checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, current checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39
[0m15:14:18.739772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900781d0>]}
[0m15:14:19.626830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fdb9910>]}
[0m15:14:19.640976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe22050>]}
[0m15:14:19.641467 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m15:14:19.643207 [info ] [MainThread]: 
[0m15:14:19.643892 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:14:19.645064 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:14:19.645400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:20.457322 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:14:20.461599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:21.227391 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:14:21.232036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now create_AwsDataCatalog_gold)
[0m15:14:21.234236 [debug] [ThreadPool]: Creating schema "database: "AwsDataCatalog"
schema: "gold"
"
[0m15:14:21.250254 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_gold"
[0m15:14:21.250896 [debug] [ThreadPool]: On create_AwsDataCatalog_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "connection_name": "create_AwsDataCatalog_gold"} */
create schema if not exists `AwsDataCatalog`.`gold`
  
[0m15:14:21.251382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:22.077707 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Athena query ID 38485b07-3853-4213-9edb-616d7199a750
[0m15:14:23.936142 [debug] [ThreadPool]: SQL status: OK -1 in 3.0 seconds
[0m15:14:23.941746 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Lakeformation is disabled for "AwsDataCatalog"."gold"
[0m15:14:23.942615 [debug] [ThreadPool]: On create_AwsDataCatalog_gold: Close
[0m15:14:23.946966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AwsDataCatalog_gold, now create_AwsDataCatalog_gold_gold)
[0m15:14:23.948066 [debug] [ThreadPool]: Creating schema "database: "AwsDataCatalog"
schema: "gold_gold"
"
[0m15:14:23.951783 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_gold_gold"
[0m15:14:23.952220 [debug] [ThreadPool]: On create_AwsDataCatalog_gold_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "connection_name": "create_AwsDataCatalog_gold_gold"} */
create schema if not exists `AwsDataCatalog`.`gold_gold`
  
[0m15:14:23.952578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:24.692787 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Athena query ID c7e821ae-f9c2-40c3-8b95-41e0f5699a24
[0m15:14:26.651981 [debug] [ThreadPool]: SQL status: OK -1 in 3.0 seconds
[0m15:14:26.656310 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Lakeformation is disabled for "AwsDataCatalog"."gold_gold"
[0m15:14:26.657195 [debug] [ThreadPool]: On create_AwsDataCatalog_gold_gold: Close
[0m15:14:26.661887 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_gold'
[0m15:14:26.662776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:27.997976 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:14:28.000506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_gold_gold)
[0m15:14:28.001326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:29.345297 [debug] [ThreadPool]: On list_AwsDataCatalog_gold_gold: Close
[0m15:14:29.346344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe1ca10>]}
[0m15:14:29.347264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:29.347820 [info ] [MainThread]: 
[0m15:14:29.349601 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m15:14:29.350066 [info ] [Thread-1 (]: 1 of 16 START sql view model gold.eia_bronze ................................... [RUN]
[0m15:14:29.350737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold_gold, now model.silver.eia_bronze)
[0m15:14:29.351008 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m15:14:29.356084 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:14:29.357980 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 15:14:29.351204 => 15:14:29.357784
[0m15:14:29.358384 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m15:14:29.376674 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:14:29.378057 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m15:14:29.378463 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:14:29.378786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:30.197175 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 47efdd92-4609-4204-9b62-27345c684507
[0m15:14:31.908455 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:14:33.187835 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:14:33.191562 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:14:33.204943 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 15:14:29.358699 => 15:14:33.204487
[0m15:14:33.205834 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m15:14:33.208125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd95b50>]}
[0m15:14:33.209770 [info ] [Thread-1 (]: 1 of 16 OK created sql view model gold.eia_bronze .............................. [[32mOK -1[0m in 3.86s]
[0m15:14:33.211018 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m15:14:33.212185 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m15:14:33.214083 [info ] [Thread-1 (]: 2 of 16 START sql view model gold.noaa_bronze .................................. [RUN]
[0m15:14:33.222334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:14:33.223489 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m15:14:33.233090 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:14:33.235787 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 15:14:33.224196 => 15:14:33.235554
[0m15:14:33.236240 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m15:14:33.241433 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:14:33.242742 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m15:14:33.243176 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:14:33.243645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:33.863328 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID edaa1c90-b190-443e-8c6e-2317c06e3455
[0m15:14:35.968283 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:14:37.207527 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:14:37.211527 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:14:37.215071 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 15:14:33.236514 => 15:14:37.214600
[0m15:14:37.215886 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m15:14:37.217602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca9b8d0>]}
[0m15:14:37.219039 [info ] [Thread-1 (]: 2 of 16 OK created sql view model gold.noaa_bronze ............................. [[32mOK -1[0m in 4.00s]
[0m15:14:37.220509 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m15:14:37.221329 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m15:14:37.222540 [info ] [Thread-1 (]: 3 of 16 START sql view model gold.openmeteo_bronze ............................. [RUN]
[0m15:14:37.225797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:14:37.226427 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m15:14:37.237124 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:14:37.241267 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 15:14:37.226846 => 15:14:37.240886
[0m15:14:37.241781 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m15:14:37.246802 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:14:37.248572 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:14:37.249071 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:14:37.249551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:37.894433 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 482193dc-63dd-4820-a4a3-971c64d65ff3
[0m15:14:39.587796 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:14:40.848802 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:14:40.852581 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:14:40.857947 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 15:14:37.242094 => 15:14:40.857423
[0m15:14:40.858947 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m15:14:40.861229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e918fd0>]}
[0m15:14:40.862452 [info ] [Thread-1 (]: 3 of 16 OK created sql view model gold.openmeteo_bronze ........................ [[32mOK -1[0m in 3.64s]
[0m15:14:40.863717 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m15:14:40.864633 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m15:14:40.866192 [info ] [Thread-1 (]: 4 of 16 START sql view model gold.openweather_bronze ........................... [RUN]
[0m15:14:40.869580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:14:40.870313 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m15:14:40.875249 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:14:40.876852 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 15:14:40.870747 => 15:14:40.876609
[0m15:14:40.877455 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m15:14:40.882790 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:14:40.884459 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m15:14:40.884946 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:14:40.885452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:41.698261 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 79af1c30-5f2e-44d6-a467-2cde81aa7643
[0m15:14:43.359700 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:14:44.659411 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:14:44.661844 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:14:44.663928 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 15:14:40.877864 => 15:14:44.663684
[0m15:14:44.664375 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m15:14:44.665259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8693c590>]}
[0m15:14:44.666028 [info ] [Thread-1 (]: 4 of 16 OK created sql view model gold.openweather_bronze ...................... [[32mOK -1[0m in 3.80s]
[0m15:14:44.666774 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m15:14:44.667448 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m15:14:44.668108 [info ] [Thread-1 (]: 5 of 16 START sql view model gold.sensor_bronze ................................ [RUN]
[0m15:14:44.670446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:14:44.671413 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m15:14:44.678095 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:14:44.679999 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 15:14:44.671850 => 15:14:44.679714
[0m15:14:44.681996 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m15:14:44.687433 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:14:44.689479 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m15:14:44.690374 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:14:44.690994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:45.348418 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c370e5a3-159d-4ae2-8ff6-4a04e04be1dc
[0m15:14:47.297137 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:14:48.534026 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:14:48.535539 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:14:48.536642 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 15:14:44.682535 => 15:14:48.536502
[0m15:14:48.537009 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m15:14:48.537723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cfe3710>]}
[0m15:14:48.538277 [info ] [Thread-1 (]: 5 of 16 OK created sql view model gold.sensor_bronze ........................... [[32mOK -1[0m in 3.87s]
[0m15:14:48.538878 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m15:14:48.539284 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:14:48.539821 [info ] [Thread-1 (]: 6 of 16 START sql table model gold.eia_silver .................................. [RUN]
[0m15:14:48.541466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:14:48.541813 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:14:48.544051 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:14:48.545349 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:14:48.542005 => 15:14:48.545212
[0m15:14:48.545635 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:14:48.593669 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:14:48.595377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:49.232343 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:14:49.234453 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."gold"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold/eia_silver/2e4c36ff-26bc-4134-8c0e-4312a9c9190f',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."eia_bronze"
[0m15:14:49.818457 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2736463c-80e5-427d-9bb2-7ba5f25b68b1
[0m15:14:52.658131 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:14:52.680798 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:14:52.681970 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`gold`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:14:52.937845 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b1089fb9-174c-46c3-bda9-e54948d6e6b2
[0m15:14:54.618880 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:14:54.625724 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:14:54.628715 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:14:54.629219 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:14:54.819103 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ddb55fc3-74bb-43d9-952b-d85258242c8d
[0m15:14:56.532484 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m15:14:56.548348 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 15:14:48.545843 => 15:14:56.546946
[0m15:14:56.550245 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m15:14:56.553761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf6a250>]}
[0m15:14:56.556041 [info ] [Thread-1 (]: 6 of 16 OK created sql table model gold.eia_silver ............................. [[32mOK 2842[0m in 8.01s]
[0m15:14:56.557578 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m15:14:56.558981 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m15:14:56.560706 [info ] [Thread-1 (]: 7 of 16 START sql table model gold.noaa_silver ................................. [RUN]
[0m15:14:56.568108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:14:56.568842 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m15:14:56.579713 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:14:56.582867 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 15:14:56.569204 => 15:14:56.582544
[0m15:14:56.583421 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m15:14:56.587207 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:14:56.587914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:57.356350 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:14:57.358709 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."gold"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold/noaa_silver/128dbb5c-6d73-4d9d-a3ad-b1695efd6334',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:14:57.914591 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d7e1affb-2068-4054-a539-28503876038c
[0m15:15:00.772191 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:15:00.777943 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:15:00.778924 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`gold`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:15:01.067942 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e93c8f6f-0c3e-42ac-82c1-fbb4bfd3894f
[0m15:15:02.811426 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:15:02.817339 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:15:02.821452 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:15:02.822206 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:15:03.029053 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b0051040-a161-443b-a82d-2a5bf1c63626
[0m15:15:04.889401 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m15:15:04.900582 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 15:14:56.583716 => 15:15:04.899759
[0m15:15:04.902087 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m15:15:04.905858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c342510>]}
[0m15:15:04.908109 [info ] [Thread-1 (]: 7 of 16 OK created sql table model gold.noaa_silver ............................ [[32mOK 305[0m in 8.34s]
[0m15:15:04.909815 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m15:15:04.911026 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m15:15:04.912600 [info ] [Thread-1 (]: 8 of 16 START sql table model gold.openmeteo_silver ............................ [RUN]
[0m15:15:04.919205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:15:04.919953 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m15:15:04.932121 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:15:04.934636 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 15:15:04.920365 => 15:15:04.934237
[0m15:15:04.935283 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m15:15:04.940782 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:15:04.941470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:06.509433 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:15:06.515323 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."gold"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold/openmeteo_silver/3b8e7350-1d23-490c-a16c-5dd7935af4c4',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."openmeteo_bronze"
[0m15:15:07.144740 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b06c4022-e852-434d-a24f-846043cccf43
[0m15:15:09.962343 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m15:15:09.971192 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:15:09.972379 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`gold`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:15:10.249177 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 229bc6de-219a-44bf-a581-63e5480b490d
[0m15:15:12.154319 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:15:12.158866 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:15:12.163342 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:15:12.164342 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m15:15:12.408927 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 51735521-a4c7-4c68-881e-805f255f53ee
[0m15:15:14.102784 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m15:15:14.108251 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 15:15:04.935652 => 15:15:14.107847
[0m15:15:14.109260 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m15:15:14.110647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cca9cd0>]}
[0m15:15:14.112014 [info ] [Thread-1 (]: 8 of 16 OK created sql table model gold.openmeteo_silver ....................... [[32mOK 12458[0m in 9.20s]
[0m15:15:14.113744 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m15:15:14.114567 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m15:15:14.115291 [info ] [Thread-1 (]: 9 of 16 START sql table model gold.openweather_silver .......................... [RUN]
[0m15:15:14.117642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:15:14.118197 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m15:15:14.123937 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:15:14.126756 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 15:15:14.118555 => 15:15:14.126430
[0m15:15:14.127222 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m15:15:14.130493 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:15:14.131188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:15.408518 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:15:15.416027 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."gold"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold/openweather_silver/b907a1fc-d512-44f5-88ad-bc353535f579',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."openweather_bronze"
[0m15:15:16.007250 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f023540a-0562-41bb-98dd-36f3927cdfe4
[0m15:15:18.866364 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m15:15:18.871484 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:15:18.871913 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`gold`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:15:19.137293 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c55a8b1d-8a42-4186-a424-8bc80a923bc4
[0m15:15:20.828282 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:15:20.835687 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:15:20.840099 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:15:20.841159 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m15:15:21.033420 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 41a31dc8-5c57-475c-ad30-e23b8d55f1c8
[0m15:15:22.749977 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m15:15:22.760515 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 15:15:14.127479 => 15:15:22.759500
[0m15:15:22.762101 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m15:15:22.765580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fe20390>]}
[0m15:15:22.767921 [info ] [Thread-1 (]: 9 of 16 OK created sql table model gold.openweather_silver ..................... [[32mOK 473[0m in 8.65s]
[0m15:15:22.769747 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m15:15:22.771115 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m15:15:22.773807 [info ] [Thread-1 (]: 10 of 16 START sql table model gold.sensor_silver .............................. [RUN]
[0m15:15:22.780467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:15:22.781292 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m15:15:22.796703 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:15:22.799391 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 15:15:22.781771 => 15:15:22.799159
[0m15:15:22.799896 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m15:15:22.806278 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:15:22.807441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:23.627648 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:15:23.628914 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."gold"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold/sensor_silver/3b365876-c9a1-4cd4-a209-f645efc4ae46',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."sensor_bronze"
[0m15:15:24.190549 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f9e353b9-aeb4-47f0-b8f4-5c834580efe7
[0m15:15:27.029964 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m15:15:27.038463 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:15:27.039021 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`gold`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:15:27.344377 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 368017c5-8211-45b1-9ee6-42c9c8dd2cd6
[0m15:15:29.039641 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:15:29.051240 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:15:29.056310 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:15:29.057243 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m15:15:29.255078 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1b8ea03f-2aae-4c35-8fb4-1621a478534c
[0m15:15:31.068401 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m15:15:31.081258 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 15:15:22.800219 => 15:15:31.080287
[0m15:15:31.082648 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m15:15:31.087122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e519ec7-4532-431e-bb40-1c95cc6b4cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbaa890>]}
[0m15:15:31.089679 [info ] [Thread-1 (]: 10 of 16 OK created sql table model gold.sensor_silver ......................... [[32mOK 700[0m in 8.31s]
[0m15:15:31.092338 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m15:15:31.097328 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m15:15:31.099297 [info ] [Thread-1 (]: 11 of 16 START sql incremental model gold_gold.weather_data_gold ............... [RUN]
[0m15:15:31.119767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:15:31.121307 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m15:15:31.143130 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:15:31.147466 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 15:15:31.122253 => 15:15:31.147233
[0m15:15:31.147859 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m15:15:31.210100 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:15:31.210878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:31.844091 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:15:31.845252 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."gold"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."gold"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:15:32.415584 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 346cb67d-57ec-42e4-b072-058a572e3131
[0m15:15:39.962215 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f242e531-835d-4ed4-9d34-a64fdc7f2070
[0m15:15:53.532522 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 71d6aab2-4379-400c-92ec-7fab7097e7f9
[0m15:16:19.060906 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 219a33ff-9398-4d24-a40e-76e0f2344db3
[0m15:17:09.032047 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d4ca5f4f-3d32-402b-be94-1dc542c7f4d4
[0m15:18:12.767402 [error] [MainThread]: CANCEL query create_AwsDataCatalog_gold_gold ................................... [[31mCANCEL[0m]
[0m15:18:12.772766 [error] [MainThread]: CANCEL query model.silver.weather_data_gold .................................... [[31mCANCEL[0m]
[0m15:18:14.006866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:14.007977 [debug] [MainThread]: Connection 'create_AwsDataCatalog_gold_gold' was properly closed.
[0m15:18:14.008870 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was left open.
[0m15:18:14.010186 [debug] [MainThread]: On model.silver.weather_data_gold: Close
[0m15:18:14.024745 [info ] [MainThread]: 
[0m15:18:14.029713 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 3 minutes and 54.38 seconds (234.38s).
[0m15:18:14.033607 [error] [MainThread]: Encountered an error:

[0m15:18:14.046496 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 272, in run_queue
    node = self.job_queue.get()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/queue.py", line 171, in get
    self.not_empty.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 220, in build
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:18:14.051195 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 235.84465, "process_user_time": 8.685147, "process_kernel_time": 1.539127, "process_mem_max_rss": "207016", "process_in_blocks": "272", "process_out_blocks": "4291", "command_success": false}
[0m15:18:14.052533 [debug] [MainThread]: Command `dbt build` failed at 15:18:14.052251 after 235.85 seconds
[0m15:18:14.055266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f551d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb42b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fea6f90>]}
[0m15:18:14.057120 [debug] [MainThread]: Flushing usage events
[0m15:18:57.038653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb991e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9b8a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb974a410>]}


============================== 15:18:57.042374 | 3afdf801-d6bc-4c9c-9c2a-0600176aeeae ==============================
[0m15:18:57.042374 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:57.044192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profile gold', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:57.045279 [info ] [MainThread]: dbt version: 1.7.9
[0m15:18:57.046282 [info ] [MainThread]: python version: 3.11.14
[0m15:18:57.047048 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m15:18:57.047707 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m15:18:57.322811 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m15:18:57.323378 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m15:18:57.323760 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m15:18:57.324232 [info ] [MainThread]: adapter type: athena
[0m15:18:57.324507 [info ] [MainThread]: adapter version: 1.7.2
[0m15:18:57.363123 [info ] [MainThread]: Configuration:
[0m15:18:57.363779 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:18:57.364469 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:18:57.364884 [info ] [MainThread]: Required dependencies:
[0m15:18:57.365243 [debug] [MainThread]: Executing "git --help"
[0m15:18:57.378782 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:18:57.379248 [debug] [MainThread]: STDERR: "b''"
[0m15:18:57.379475 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:18:57.379740 [info ] [MainThread]: Connection:
[0m15:18:57.380157 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results_gold/
[0m15:18:57.380498 [info ] [MainThread]:   work_group: None
[0m15:18:57.380874 [info ] [MainThread]:   region_name: us-east-1
[0m15:18:57.381272 [info ] [MainThread]:   database: AwsDataCatalog
[0m15:18:57.381506 [info ] [MainThread]:   schema: gold
[0m15:18:57.381760 [info ] [MainThread]:   poll_interval: 1.0
[0m15:18:57.382031 [info ] [MainThread]:   aws_profile_name: None
[0m15:18:57.382335 [info ] [MainThread]:   aws_access_key_id: None
[0m15:18:57.382616 [info ] [MainThread]:   aws_secret_access_key: None
[0m15:18:57.382895 [info ] [MainThread]:   aws_session_token: None
[0m15:18:57.383124 [info ] [MainThread]:   endpoint_url: None
[0m15:18:57.383452 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/gold/
[0m15:18:57.383674 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m15:18:57.383932 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m15:18:57.384208 [info ] [MainThread]:   debug_query_state: False
[0m15:18:57.384483 [info ] [MainThread]:   seed_s3_upload_args: None
[0m15:18:57.385162 [info ] [MainThread]:   lf_tags_database: None
[0m15:18:57.385461 [info ] [MainThread]:   spark_work_group: None
[0m15:18:57.385781 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:18:57.386402 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m15:18:57.387534 [debug] [MainThread]: Using athena connection "debug"
[0m15:18:57.387976 [debug] [MainThread]: On debug: select 1 as id
[0m15:18:57.388332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:58.047760 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 26c2af37-2e06-4022-9fdd-9cd91af9b645
[0m15:18:59.894298 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m15:18:59.912522 [debug] [MainThread]: On debug: Close
[0m15:18:59.914788 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:18:59.916072 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:18:59.924954 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.9151714, "process_user_time": 1.976212, "process_kernel_time": 0.47755, "process_mem_max_rss": "143948", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m15:18:59.926991 [debug] [MainThread]: Command `dbt debug` succeeded at 15:18:59.926562 after 2.92 seconds
[0m15:18:59.929058 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:18:59.976097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb97748d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9774650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb876c410>]}
[0m15:18:59.977519 [debug] [MainThread]: Flushing usage events
[0m15:19:23.160874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fab5dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8faaf990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fab6a90>]}


============================== 15:19:23.162940 | d48aa21e-608e-431c-b993-6f93eae803b6 ==============================
[0m15:19:23.162940 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:19:23.163437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profile gold', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:23.400312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e95e5d0>]}
[0m15:19:23.440027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea6b8d0>]}
[0m15:19:23.440537 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:19:23.445509 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m15:19:23.452041 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:19:23.452418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e779910>]}
[0m15:19:24.177009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e63ef90>]}
[0m15:19:24.184704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e980dd0>]}
[0m15:19:24.185008 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m15:19:24.185318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df08350>]}
[0m15:19:24.186709 [info ] [MainThread]: 
[0m15:19:24.187478 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:19:24.189111 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:19:24.189657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:24.933866 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:19:24.937252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:25.745417 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:19:25.747721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m15:19:25.748215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:27.298133 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:19:27.300704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_gold_gold)
[0m15:19:27.304043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:28.894428 [debug] [ThreadPool]: On list_AwsDataCatalog_gold_gold: Close
[0m15:19:28.896846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e744810>]}
[0m15:19:28.898539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:28.899201 [info ] [MainThread]: 
[0m15:19:28.901588 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m15:19:28.902341 [info ] [Thread-1 (]: 1 of 11 START sql view model gold.eia_bronze ................................... [RUN]
[0m15:19:28.903707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold_gold, now model.silver.eia_bronze)
[0m15:19:28.904946 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m15:19:28.911585 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:19:28.912979 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 15:19:28.905408 => 15:19:28.912822
[0m15:19:28.913318 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m15:19:28.931506 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:19:28.933043 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m15:19:28.933398 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:19:28.933763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:29.607089 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2e8be77d-1513-4c7c-aefe-67ff96952b4d
[0m15:19:31.347534 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:19:32.739747 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m15:19:32.743922 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:19:32.756643 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 15:19:28.913521 => 15:19:32.756151
[0m15:19:32.757490 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m15:19:32.759345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86d577d0>]}
[0m15:19:32.760813 [info ] [Thread-1 (]: 1 of 11 OK created sql view model gold.eia_bronze .............................. [[32mOK -1[0m in 3.86s]
[0m15:19:32.762342 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m15:19:32.763610 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m15:19:32.765923 [info ] [Thread-1 (]: 2 of 11 START sql view model gold.noaa_bronze .................................. [RUN]
[0m15:19:32.768745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:19:32.769431 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m15:19:32.774370 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:19:32.776365 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 15:19:32.769782 => 15:19:32.776134
[0m15:19:32.776783 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m15:19:32.780205 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:19:32.781554 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m15:19:32.781990 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:19:32.782392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:33.616569 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e088c3fa-4d19-4880-9d35-3ad09ab3828a
[0m15:19:35.565711 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:19:37.223236 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m15:19:37.230646 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:19:37.249061 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 15:19:32.777025 => 15:19:37.248092
[0m15:19:37.250343 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m15:19:37.265404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8776c1d0>]}
[0m15:19:37.267953 [info ] [Thread-1 (]: 2 of 11 OK created sql view model gold.noaa_bronze ............................. [[32mOK -1[0m in 4.49s]
[0m15:19:37.269611 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m15:19:37.271472 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m15:19:37.274669 [info ] [Thread-1 (]: 3 of 11 START sql view model gold.openmeteo_bronze ............................. [RUN]
[0m15:19:37.281999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:19:37.282804 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m15:19:37.302504 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:19:37.310822 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 15:19:37.283089 => 15:19:37.310187
[0m15:19:37.315121 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m15:19:37.327840 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:19:37.330715 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:19:37.331515 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:19:37.331951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:38.382995 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 15f2cc9e-cdcf-4e61-bf16-3cb3ae8a9a0f
[0m15:19:40.170068 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:19:52.202875 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m15:19:52.223902 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:19:52.241558 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 15:19:37.315960 => 15:19:52.240640
[0m15:19:52.242938 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m15:19:52.245680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e342e50>]}
[0m15:19:52.250013 [info ] [Thread-1 (]: 3 of 11 OK created sql view model gold.openmeteo_bronze ........................ [[32mOK -1[0m in 14.97s]
[0m15:19:52.251940 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m15:19:52.254950 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m15:19:52.257480 [info ] [Thread-1 (]: 4 of 11 START sql view model gold.openweather_bronze ........................... [RUN]
[0m15:19:52.265202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:19:52.265870 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m15:19:52.285715 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:19:52.289980 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 15:19:52.266122 => 15:19:52.289413
[0m15:19:52.290495 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m15:19:52.294889 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:19:52.298188 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m15:19:52.299020 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:19:52.299462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:53.018197 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5dfd7ff3-f00d-41dc-bdc6-a3751aa375c8
[0m15:19:54.886925 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:19:56.443083 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m15:19:56.459433 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:19:56.466056 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 15:19:52.290825 => 15:19:56.465619
[0m15:19:56.467326 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m15:19:56.470693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876c4d50>]}
[0m15:19:56.471977 [info ] [Thread-1 (]: 4 of 11 OK created sql view model gold.openweather_bronze ...................... [[32mOK -1[0m in 4.21s]
[0m15:19:56.472844 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m15:19:56.473798 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m15:19:56.476507 [info ] [Thread-1 (]: 5 of 11 START sql view model gold.sensor_bronze ................................ [RUN]
[0m15:19:56.484515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:19:56.485190 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m15:19:56.494346 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:19:56.497487 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 15:19:56.485407 => 15:19:56.497087
[0m15:19:56.498222 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m15:19:56.502001 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:19:56.503506 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m15:19:56.504235 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:19:56.504559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:57.736422 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4fd05446-495e-4588-9e49-755a9fde8f62
[0m15:19:59.509208 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:20:00.896959 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m15:20:00.899096 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:20:00.907292 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 15:19:56.498460 => 15:20:00.902565
[0m15:20:00.909527 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m15:20:00.911542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86a66c10>]}
[0m15:20:00.913871 [info ] [Thread-1 (]: 5 of 11 OK created sql view model gold.sensor_bronze ........................... [[32mOK -1[0m in 4.43s]
[0m15:20:00.915166 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m15:20:00.916128 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:20:00.917535 [info ] [Thread-1 (]: 6 of 11 START sql table model gold.eia_silver .................................. [RUN]
[0m15:20:00.921391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:20:00.922781 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:20:00.943881 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:20:00.964310 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:20:00.923362 => 15:20:00.961752
[0m15:20:00.965510 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:20:01.052592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:02.531074 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:20:02.534977 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:20:02.545782 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:20:03.967183 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:20:03.974747 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:20:03.975623 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."eia_silver" is stored in s3://climate-energy-raw-data/gold/gold/eia_silver/2e4c36ff-26bc-4134-8c0e-4312a9c9190f
[0m15:20:05.049273 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/gold/eia_silver/2e4c36ff-26bc-4134-8c0e-4312a9c9190f', bucket='climate-energy-raw-data', prefix='gold/gold/eia_silver/2e4c36ff-26bc-4134-8c0e-4312a9c9190f/'
[0m15:20:07.610736 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."eia_silver"
[0m15:20:07.639534 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:20:08.218230 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:20:08.220381 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."gold"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold/eia_silver/9d9ba0e7-9de7-405b-9844-f4118082134f',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."eia_bronze"
[0m15:20:08.849674 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f698f4ac-e5b1-468b-92a8-a3267505bc6b
[0m15:20:11.688586 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:20:11.706232 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:20:11.707865 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`gold`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:20:11.998286 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f10c4c54-3e77-4127-8dc2-fc181c8f37dd
[0m15:20:13.652922 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:20:13.658790 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:20:13.660831 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:20:13.661153 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:20:13.860948 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 617d9670-0d52-4b5c-89e4-2ed0ed1656ec
[0m15:20:15.732638 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m15:20:15.754074 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 15:20:00.965850 => 15:20:15.753214
[0m15:20:15.755169 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m15:20:15.758643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ecf710>]}
[0m15:20:15.765078 [info ] [Thread-1 (]: 6 of 11 OK created sql table model gold.eia_silver ............................. [[32mOK 2842[0m in 14.84s]
[0m15:20:15.770452 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m15:20:15.773364 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m15:20:15.776326 [info ] [Thread-1 (]: 7 of 11 START sql table model gold.noaa_silver ................................. [RUN]
[0m15:20:15.785616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:20:15.786383 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m15:20:15.799635 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:20:15.801811 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 15:20:15.786822 => 15:20:15.801615
[0m15:20:15.802060 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m15:20:15.804872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:17.241460 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:20:17.245815 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:20:17.251736 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:20:18.455297 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:20:18.457281 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:20:18.459424 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."noaa_silver" is stored in s3://climate-energy-raw-data/gold/gold/noaa_silver/128dbb5c-6d73-4d9d-a3ad-b1695efd6334
[0m15:20:19.269657 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/gold/noaa_silver/128dbb5c-6d73-4d9d-a3ad-b1695efd6334', bucket='climate-energy-raw-data', prefix='gold/gold/noaa_silver/128dbb5c-6d73-4d9d-a3ad-b1695efd6334/'
[0m15:20:21.418909 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."noaa_silver"
[0m15:20:21.423862 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:20:22.632064 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:20:22.632772 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."gold"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold/noaa_silver/4921219f-226c-472e-bf54-9fc81d9825ce',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:20:23.238625 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID edcb4294-42a1-4b2b-82e0-4baaa3032fff
[0m15:20:26.082138 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:20:26.086031 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:20:26.087234 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`gold`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:20:26.339053 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8219c287-7763-47e5-ba3d-565d34e46b1e
[0m15:20:28.044162 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:20:28.052365 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:20:28.054694 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:20:28.055122 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:20:28.234610 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3d99aa87-8158-42cd-bada-96e502a3d05e
[0m15:20:29.963619 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m15:20:29.973640 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 15:20:15.802237 => 15:20:29.972877
[0m15:20:29.975197 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m15:20:29.979002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87681790>]}
[0m15:20:29.981683 [info ] [Thread-1 (]: 7 of 11 OK created sql table model gold.noaa_silver ............................ [[32mOK 305[0m in 14.20s]
[0m15:20:29.984165 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m15:20:29.985819 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m15:20:29.987534 [info ] [Thread-1 (]: 8 of 11 START sql table model gold.openmeteo_silver ............................ [RUN]
[0m15:20:29.998732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:20:29.999740 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m15:20:30.011223 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:20:30.013166 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 15:20:30.000198 => 15:20:30.012943
[0m15:20:30.013689 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m15:20:30.018198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:31.548841 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:20:31.550369 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:20:31.551816 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:20:32.717600 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:20:32.721960 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:20:32.722363 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."openmeteo_silver" is stored in s3://climate-energy-raw-data/gold/gold/openmeteo_silver/3b8e7350-1d23-490c-a16c-5dd7935af4c4
[0m15:20:33.981642 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/gold/openmeteo_silver/3b8e7350-1d23-490c-a16c-5dd7935af4c4', bucket='climate-energy-raw-data', prefix='gold/gold/openmeteo_silver/3b8e7350-1d23-490c-a16c-5dd7935af4c4/'
[0m15:20:37.398829 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."openmeteo_silver"
[0m15:20:37.411487 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:20:38.012453 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:20:38.016393 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."gold"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold/openmeteo_silver/2d85a2fe-a660-4c8d-b7d6-abf81dd923e3',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."openmeteo_bronze"
[0m15:20:38.620258 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2a702102-d2f8-4dfd-8839-7c3861eda408
[0m15:20:41.491744 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m15:20:41.495676 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:20:41.497258 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`gold`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:20:41.772856 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a7c782ad-9ed9-4e19-9bad-75d254400057
[0m15:20:43.692984 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:20:43.697655 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:20:43.701086 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:20:43.701994 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m15:20:43.897822 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a83b8a1d-1b00-471d-8464-732e3f2550cf
[0m15:20:45.607542 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m15:20:45.613986 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 15:20:30.014063 => 15:20:45.613560
[0m15:20:45.614720 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m15:20:45.616060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f8f110>]}
[0m15:20:45.617250 [info ] [Thread-1 (]: 8 of 11 OK created sql table model gold.openmeteo_silver ....................... [[32mOK 12458[0m in 15.63s]
[0m15:20:45.618037 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m15:20:45.619572 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m15:20:45.620334 [info ] [Thread-1 (]: 9 of 11 START sql table model gold.openweather_silver .......................... [RUN]
[0m15:20:45.623365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:20:45.623846 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m15:20:45.629836 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:20:45.643569 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 15:20:45.624043 => 15:20:45.643252
[0m15:20:45.644133 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m15:20:45.647236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:47.026081 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:20:47.027050 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:20:47.028134 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:20:48.224113 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:20:48.224953 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:20:48.225504 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."openweather_silver" is stored in s3://climate-energy-raw-data/gold/gold/openweather_silver/b907a1fc-d512-44f5-88ad-bc353535f579
[0m15:20:48.796316 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/gold/openweather_silver/b907a1fc-d512-44f5-88ad-bc353535f579', bucket='climate-energy-raw-data', prefix='gold/gold/openweather_silver/b907a1fc-d512-44f5-88ad-bc353535f579/'
[0m15:20:51.423846 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."openweather_silver"
[0m15:20:51.432023 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:20:51.982967 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:20:51.988994 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."gold"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold/openweather_silver/080f4f0c-f72a-41f6-939a-306432eb72d1',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."openweather_bronze"
[0m15:20:52.572173 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7a292748-31ee-4e4a-bcb2-501611af99c7
[0m15:20:55.382276 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m15:20:55.400891 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:20:55.402574 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`gold`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:20:55.665196 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6a1e21ba-337a-48ca-a417-0f593e30265c
[0m15:20:57.327710 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:20:57.338542 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:20:57.340825 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:20:57.341194 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m15:20:57.543239 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 120e4c19-acbb-437f-8215-be6ccd201ad7
[0m15:20:59.428063 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m15:20:59.431341 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 15:20:45.644358 => 15:20:59.431070
[0m15:20:59.432078 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m15:20:59.433251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f8e910>]}
[0m15:20:59.434230 [info ] [Thread-1 (]: 9 of 11 OK created sql table model gold.openweather_silver ..................... [[32mOK 473[0m in 13.81s]
[0m15:20:59.435289 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m15:20:59.436050 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m15:20:59.436945 [info ] [Thread-1 (]: 10 of 11 START sql table model gold.sensor_silver .............................. [RUN]
[0m15:20:59.439884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:20:59.440482 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m15:20:59.445496 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:20:59.447415 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 15:20:59.440793 => 15:20:59.447142
[0m15:20:59.447874 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m15:20:59.450788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:00.770915 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:21:00.772173 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:21:00.773660 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:21:01.979454 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:21:01.980693 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:21:01.981426 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."sensor_silver" is stored in s3://climate-energy-raw-data/gold/gold/sensor_silver/3b365876-c9a1-4cd4-a209-f645efc4ae46
[0m15:21:03.246991 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/gold/sensor_silver/3b365876-c9a1-4cd4-a209-f645efc4ae46', bucket='climate-energy-raw-data', prefix='gold/gold/sensor_silver/3b365876-c9a1-4cd4-a209-f645efc4ae46/'
[0m15:21:06.378848 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."sensor_silver"
[0m15:21:06.386487 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:21:07.579512 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:21:07.582474 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."gold"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold/sensor_silver/ee9822cb-a578-4d1d-b88f-4f0142cc623f',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."sensor_bronze"
[0m15:21:08.156547 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7d827773-b05a-4046-a2fd-7a434ecd4bbd
[0m15:21:10.950553 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m15:21:10.954712 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:21:10.955666 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`gold`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:21:11.210807 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9e973943-7dfa-406b-aa6c-65d608a3f3cf
[0m15:21:12.844012 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:21:12.852649 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:21:12.857378 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:21:12.858388 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m15:21:13.082829 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 02904b5e-99f9-4b1c-a25e-d425e58f45d0
[0m15:21:14.775044 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m15:21:14.784769 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 15:20:59.448180 => 15:21:14.783642
[0m15:21:14.786219 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m15:21:14.789640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3f0310>]}
[0m15:21:14.791646 [info ] [Thread-1 (]: 10 of 11 OK created sql table model gold.sensor_silver ......................... [[32mOK 700[0m in 15.35s]
[0m15:21:14.793078 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m15:21:14.794142 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m15:21:14.795619 [info ] [Thread-1 (]: 11 of 11 START sql incremental model gold_gold.weather_data_gold ............... [RUN]
[0m15:21:14.800191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:21:14.800996 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m15:21:14.814358 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:21:14.816521 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 15:21:14.801438 => 15:21:14.816269
[0m15:21:14.816979 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m15:21:14.853645 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:21:14.854216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:16.431805 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:21:16.438970 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."gold"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."gold"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:21:17.007918 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4d498494-410f-450e-bd87-388aec048c11
[0m15:21:24.518660 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 81885724-993f-437a-accd-b0b9062fb861
[0m15:21:38.053000 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2dc84253-dbbd-404d-a1b7-3a189d5ca260
[0m15:22:03.578666 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 39f7bde3-50d1-4926-b20b-5263488758ed
[0m15:22:53.478362 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7bf11b35-eb2e-4754-9a55-5e3ef3f28f60
[0m15:24:32.667358 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 25c38309-25f2-4f1f-868a-1389c52526e1
[0m15:24:35.147793 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/25c38309-25f2-4f1f-868a-1389c52526e1' before retrying. Athena will not delete data in your account.
[0m15:24:35.152079 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 15:21:14.817275 => 15:24:35.151117
[0m15:24:35.153521 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m15:24:35.159394 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/25c38309-25f2-4f1f-868a-1389c52526e1' before retrying. Athena will not delete data in your account.
[0m15:24:35.181325 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 154, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/25c38309-25f2-4f1f-868a-1389c52526e1' before retrying. Athena will not delete data in your account.

[0m15:24:35.186930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd48aa21e-608e-431c-b993-6f93eae803b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c45f550>]}
[0m15:24:35.193471 [error] [Thread-1 (]: 11 of 11 ERROR creating sql incremental model gold_gold.weather_data_gold ...... [[31mERROR[0m in 200.39s]
[0m15:24:35.197808 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m15:24:35.210102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:35.210898 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:24:35.215656 [info ] [MainThread]: 
[0m15:24:35.219102 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 5 minutes and 11.02 seconds (311.02s).
[0m15:24:35.225502 [debug] [MainThread]: Command end result
[0m15:24:35.280359 [info ] [MainThread]: 
[0m15:24:35.282412 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:24:35.283052 [info ] [MainThread]: 
[0m15:24:35.283975 [error] [MainThread]:   INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/25c38309-25f2-4f1f-868a-1389c52526e1' before retrying. Athena will not delete data in your account.
[0m15:24:35.284634 [info ] [MainThread]: 
[0m15:24:35.285114 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m15:24:35.297853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 312.16672, "process_user_time": 11.667526, "process_kernel_time": 1.545219, "process_mem_max_rss": "193936", "process_out_blocks": "3077", "command_success": false, "process_in_blocks": "0"}
[0m15:24:35.298778 [debug] [MainThread]: Command `dbt run` failed at 15:24:35.298682 after 312.17 seconds
[0m15:24:35.299561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f30ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cf98d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8736b310>]}
[0m15:24:35.299956 [debug] [MainThread]: Flushing usage events
[0m15:27:46.697914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a5d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a5fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a5fa10>]}


============================== 15:27:46.701423 | ef52931c-e0c5-466e-b6e7-ddf934085a54 ==============================
[0m15:27:46.701423 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:27:46.702105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profile gold', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:27:46.987610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ad5c50>]}
[0m15:27:47.029056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a78a90>]}
[0m15:27:47.029561 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:27:47.034459 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m15:27:47.069054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m15:27:47.069544 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/noaa_silver.sql
[0m15:27:47.069813 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/sensor_silver.sql
[0m15:27:47.070054 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/openweather_silver.sql
[0m15:27:47.070297 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/openmeteo_silver.sql
[0m15:27:47.070535 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/eia_silver.sql
[0m15:27:47.155942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7937950>]}
[0m15:27:47.165381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7b89f50>]}
[0m15:27:47.165727 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m15:27:47.166098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a49010>]}
[0m15:27:47.167570 [info ] [MainThread]: 
[0m15:27:47.168183 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:27:47.169360 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:27:47.169758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:48.143012 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:27:48.145241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:48.865248 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:27:48.868352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:49.511675 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:27:49.515045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now create_AwsDataCatalog_gold_silver)
[0m15:27:49.517443 [debug] [ThreadPool]: Creating schema "database: "AwsDataCatalog"
schema: "gold_silver"
"
[0m15:27:49.536291 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_gold_silver"
[0m15:27:49.537075 [debug] [ThreadPool]: On create_AwsDataCatalog_gold_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "connection_name": "create_AwsDataCatalog_gold_silver"} */
create schema if not exists `AwsDataCatalog`.`gold_silver`
  
[0m15:27:49.537491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:50.398177 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Athena query ID 6217493d-bab5-4b4d-815f-16c5b5b09645
[0m15:27:52.105473 [debug] [ThreadPool]: SQL status: OK -1 in 3.0 seconds
[0m15:27:52.110329 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Lakeformation is disabled for "AwsDataCatalog"."gold_silver"
[0m15:27:52.112499 [debug] [ThreadPool]: On create_AwsDataCatalog_gold_silver: Close
[0m15:27:52.120323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AwsDataCatalog_gold_silver, now list_AwsDataCatalog_gold)
[0m15:27:52.121262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:53.643865 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:27:53.647270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_gold_gold)
[0m15:27:53.650464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:55.067896 [debug] [ThreadPool]: On list_AwsDataCatalog_gold_gold: Close
[0m15:27:55.070341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold_gold, now list_AwsDataCatalog_gold_silver)
[0m15:27:55.071214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:56.341251 [debug] [ThreadPool]: On list_AwsDataCatalog_gold_silver: Close
[0m15:27:56.342462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee96a50>]}
[0m15:27:56.343459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:56.344026 [info ] [MainThread]: 
[0m15:27:56.346898 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m15:27:56.347633 [info ] [Thread-1 (]: 1 of 11 START sql view model gold.eia_bronze ................................... [RUN]
[0m15:27:56.348929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold_silver, now model.silver.eia_bronze)
[0m15:27:56.349555 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m15:27:56.356707 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:27:56.359354 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 15:27:56.349933 => 15:27:56.359103
[0m15:27:56.359783 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m15:27:56.377294 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:27:56.378892 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m15:27:56.379327 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."eia_bronze"
  as
    select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:27:56.379600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:57.062113 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 21cf5c69-1d7b-4147-9266-0dfc55bccdea
[0m15:27:58.772443 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:00.022064 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m15:28:00.025014 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:28:00.049022 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 15:27:56.360083 => 15:28:00.048327
[0m15:28:00.053686 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m15:28:00.056075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb408f050>]}
[0m15:28:00.058168 [info ] [Thread-1 (]: 1 of 11 OK created sql view model gold.eia_bronze .............................. [[32mOK -1[0m in 3.71s]
[0m15:28:00.059559 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m15:28:00.060427 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m15:28:00.063467 [info ] [Thread-1 (]: 2 of 11 START sql view model gold.noaa_bronze .................................. [RUN]
[0m15:28:00.070655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:28:00.071423 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m15:28:00.098589 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:28:00.111051 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 15:28:00.071765 => 15:28:00.110014
[0m15:28:00.114335 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m15:28:00.125432 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:28:00.130192 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m15:28:00.131574 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."noaa_bronze"
  as
    select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:28:00.132553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:00.750332 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f43b6a03-f302-4292-8a02-cf483e3bd1ed
[0m15:28:02.414711 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:03.876572 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m15:28:03.878253 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:28:03.880460 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 15:28:00.117350 => 15:28:03.880147
[0m15:28:03.880927 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m15:28:03.881822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb444fd10>]}
[0m15:28:03.882481 [info ] [Thread-1 (]: 2 of 11 OK created sql view model gold.noaa_bronze ............................. [[32mOK -1[0m in 3.82s]
[0m15:28:03.883258 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m15:28:03.883766 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m15:28:03.884424 [info ] [Thread-1 (]: 3 of 11 START sql view model gold.openmeteo_bronze ............................. [RUN]
[0m15:28:03.887014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:28:03.887758 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m15:28:03.890953 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:28:03.892255 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 15:28:03.888339 => 15:28:03.892105
[0m15:28:03.892570 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m15:28:03.894568 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:28:03.895309 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:28:03.895635 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."openmeteo_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:28:03.895940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:04.523123 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 021dc9e6-8030-401f-878e-c396a289607b
[0m15:28:06.214457 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:07.508724 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m15:28:07.516439 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:28:07.523565 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 15:28:03.892774 => 15:28:07.523380
[0m15:28:07.552836 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m15:28:07.560551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4020490>]}
[0m15:28:07.572169 [info ] [Thread-1 (]: 3 of 11 OK created sql view model gold.openmeteo_bronze ........................ [[32mOK -1[0m in 3.67s]
[0m15:28:07.574006 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m15:28:07.575746 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m15:28:07.583655 [info ] [Thread-1 (]: 4 of 11 START sql view model gold.openweather_bronze ........................... [RUN]
[0m15:28:07.594328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:28:07.596553 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m15:28:07.619802 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:28:07.626911 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 15:28:07.599449 => 15:28:07.626375
[0m15:28:07.628789 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m15:28:07.644098 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:28:07.651173 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m15:28:07.656921 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."openweather_bronze"
  as
    select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:28:07.659196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:08.475729 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9abb4da8-e2a1-4bf3-b69a-1f69fd90295d
[0m15:28:10.178134 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:28:11.457081 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m15:28:11.460782 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:28:11.465478 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 15:28:07.630239 => 15:28:11.464839
[0m15:28:11.466493 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m15:28:11.468786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7b24750>]}
[0m15:28:11.470745 [info ] [Thread-1 (]: 4 of 11 OK created sql view model gold.openweather_bronze ...................... [[32mOK -1[0m in 3.88s]
[0m15:28:11.472213 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m15:28:11.473282 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m15:28:11.474736 [info ] [Thread-1 (]: 5 of 11 START sql view model gold.sensor_bronze ................................ [RUN]
[0m15:28:11.477963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:28:11.478868 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m15:28:11.486728 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:28:11.489186 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 15:28:11.479367 => 15:28:11.488868
[0m15:28:11.490120 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m15:28:11.494211 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:28:11.496723 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m15:28:11.497362 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."gold"."sensor_bronze"
  as
    select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:28:11.497898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:12.119725 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2129466e-1a21-44d1-8849-6ba2cac9bb00
[0m15:28:13.796082 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:15.237372 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m15:28:15.239719 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:28:15.241729 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 15:28:11.490719 => 15:28:15.241477
[0m15:28:15.242323 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m15:28:15.243412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef62d90>]}
[0m15:28:15.244233 [info ] [Thread-1 (]: 5 of 11 OK created sql view model gold.sensor_bronze ........................... [[32mOK -1[0m in 3.77s]
[0m15:28:15.245192 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m15:28:15.245762 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:28:15.246555 [info ] [Thread-1 (]: 6 of 11 START sql table model gold_silver.eia_silver ........................... [RUN]
[0m15:28:15.248767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:28:15.249334 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:28:15.253248 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:28:15.255067 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:28:15.249734 => 15:28:15.254862
[0m15:28:15.255494 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:28:15.298301 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:28:15.298806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:16.559467 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:28:16.562573 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."gold_silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold_silver/eia_silver/e402b97e-e110-4750-a074-fefdce0e34b4',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."eia_bronze"
[0m15:28:17.166964 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3ebc80ec-6897-4010-9ea3-784fa35d9e55
[0m15:28:20.006978 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:28:20.029633 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:28:20.030613 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`gold_silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:28:20.309416 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 816851ab-efad-4a3c-8d69-075d09f05c87
[0m15:28:21.943955 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:21.949369 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:28:21.952748 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:28:21.953028 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:28:22.139450 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c3af2ed7-95e9-4c02-8bab-9f8e59d39ebb
[0m15:28:23.828193 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m15:28:23.838262 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 15:28:15.255812 => 15:28:23.837216
[0m15:28:23.840089 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m15:28:23.843181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a4bd90>]}
[0m15:28:23.845587 [info ] [Thread-1 (]: 6 of 11 OK created sql table model gold_silver.eia_silver ...................... [[32mOK 2842[0m in 8.60s]
[0m15:28:23.847286 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m15:28:23.848724 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m15:28:23.850407 [info ] [Thread-1 (]: 7 of 11 START sql table model gold_silver.noaa_silver .......................... [RUN]
[0m15:28:23.856370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:28:23.857300 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m15:28:23.866099 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:28:23.868497 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 15:28:23.857728 => 15:28:23.868228
[0m15:28:23.869202 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m15:28:23.873398 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:28:23.874198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:24.599455 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:28:24.600987 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."gold_silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold_silver/noaa_silver/8bf1b944-0b7e-4994-8d7c-4d4dafbcdbcb',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:28:25.141267 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 45d5755b-bcdf-4029-8cc0-a2bc7764d037
[0m15:28:26.809939 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:28:26.815300 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:28:26.816935 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`gold_silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:28:27.083286 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID efc81fc3-7ae0-4163-8156-f65f00c8f2a0
[0m15:28:28.736211 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:28.742640 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:28:28.747496 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:28:28.748405 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:28:28.952989 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 071c2c93-8361-4bbd-85a1-428db0c0cb6f
[0m15:28:30.728191 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m15:28:30.739177 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 15:28:23.870075 => 15:28:30.738377
[0m15:28:30.740377 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m15:28:30.742985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4995dd0>]}
[0m15:28:30.745086 [info ] [Thread-1 (]: 7 of 11 OK created sql table model gold_silver.noaa_silver ..................... [[32mOK 305[0m in 6.89s]
[0m15:28:30.746749 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m15:28:30.748321 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m15:28:30.751209 [info ] [Thread-1 (]: 8 of 11 START sql table model gold_silver.openmeteo_silver ..................... [RUN]
[0m15:28:30.758826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:28:30.759818 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m15:28:30.772516 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:28:30.774386 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 15:28:30.760454 => 15:28:30.773979
[0m15:28:30.775509 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m15:28:30.782652 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:28:30.783361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:32.140027 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:28:32.141359 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."gold_silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold_silver/openmeteo_silver/015d97c1-dd0c-4833-b998-33ebb73803bf',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."openmeteo_bronze"
[0m15:28:32.697918 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bb56c97d-1270-49b5-b660-3ff306fbcab4
[0m15:28:35.486057 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m15:28:35.490651 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:28:35.492428 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`gold_silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:28:35.743388 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9d4fa015-7bcc-4796-84f7-590e0f4852d2
[0m15:28:37.395066 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:37.401668 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:28:37.414756 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:28:37.416645 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m15:28:37.620418 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 841a7733-2c25-4c91-89ff-473aae4896a4
[0m15:28:39.322242 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m15:28:39.327171 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 15:28:30.776183 => 15:28:39.326789
[0m15:28:39.327914 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m15:28:39.329252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaff13510>]}
[0m15:28:39.330526 [info ] [Thread-1 (]: 8 of 11 OK created sql table model gold_silver.openmeteo_silver ................ [[32mOK 12458[0m in 8.58s]
[0m15:28:39.331510 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m15:28:39.332189 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m15:28:39.333242 [info ] [Thread-1 (]: 9 of 11 START sql table model gold_silver.openweather_silver ................... [RUN]
[0m15:28:39.336504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:28:39.336998 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m15:28:39.346753 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:28:39.349108 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 15:28:39.337202 => 15:28:39.348704
[0m15:28:39.349781 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m15:28:39.354089 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:28:39.354942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:40.769383 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:28:40.770984 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."gold_silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold_silver/openweather_silver/51457e90-72e0-4734-9ce2-5db9ba51cf5c',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."openweather_bronze"
[0m15:28:41.344673 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 67211bf2-a4a2-4b60-8f8b-d2d063e093b9
[0m15:28:44.204210 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m15:28:44.208282 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:28:44.209179 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`gold_silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:28:44.456926 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 34d72c5a-4388-4a2b-9a3a-3920df4d9066
[0m15:28:46.103487 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:46.109858 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:28:46.112010 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:28:46.112424 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m15:28:46.309651 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2b778fc4-2082-48fa-be67-c00698daafa4
[0m15:28:48.095104 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m15:28:48.105016 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 15:28:39.349982 => 15:28:48.104404
[0m15:28:48.106374 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m15:28:48.108205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf53ce90>]}
[0m15:28:48.110250 [info ] [Thread-1 (]: 9 of 11 OK created sql table model gold_silver.openweather_silver .............. [[32mOK 473[0m in 8.77s]
[0m15:28:48.111788 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m15:28:48.112711 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m15:28:48.114220 [info ] [Thread-1 (]: 10 of 11 START sql table model gold_silver.sensor_silver ....................... [RUN]
[0m15:28:48.118070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:28:48.118669 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m15:28:48.128491 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:28:48.130655 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 15:28:48.118907 => 15:28:48.130373
[0m15:28:48.131359 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m15:28:48.138593 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:28:48.139451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:49.621952 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:28:49.624047 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."gold_silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold_silver/sensor_silver/155f2635-5708-44fb-b25b-121e779f2993',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold"."sensor_bronze"
[0m15:28:50.190893 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0d509b95-747d-4003-bcba-b01b1298dc84
[0m15:28:52.962801 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m15:28:52.964001 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:28:52.964282 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`gold_silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:28:53.238257 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 99521bd6-fbf8-4dd7-9397-22ef8f03a55d
[0m15:28:54.943286 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:28:54.950391 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:28:54.956862 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:28:54.957798 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m15:28:55.156313 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3dd5cf93-3c57-455b-8581-ab9088dc8a14
[0m15:28:56.851567 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m15:28:56.862757 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 15:28:48.131770 => 15:28:56.861544
[0m15:28:56.864006 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m15:28:56.866964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b07810>]}
[0m15:28:56.869864 [info ] [Thread-1 (]: 10 of 11 OK created sql table model gold_silver.sensor_silver .................. [[32mOK 700[0m in 8.75s]
[0m15:28:56.871674 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m15:28:56.873076 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m15:28:56.874539 [info ] [Thread-1 (]: 11 of 11 START sql incremental model gold_gold.weather_data_gold ............... [RUN]
[0m15:28:56.881396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:28:56.882368 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m15:28:56.898832 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:28:56.900613 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 15:28:56.882836 => 15:28:56.900373
[0m15:28:56.901032 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m15:28:56.938776 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:28:56.941048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:58.194948 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:28:58.198337 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."gold_silver"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."gold_silver"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:28:58.759449 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 400716eb-dc18-47c4-98af-82a3a10f0ce9
[0m15:29:06.316926 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 699a92c1-bd14-4145-9e40-ba7092154070
[0m15:29:19.900902 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f0dcb5ea-c688-4bdb-b9d8-be463817807b
[0m15:29:45.471719 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 545122de-876f-4a4b-9856-c0775359c125
[0m15:30:35.397505 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 69ba90c5-faa4-44f4-b6a6-0caff9b3c785
[0m15:32:13.382971 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c29bea77-4c89-4327-862c-31c5d4e58dc3
[0m15:32:15.880112 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/c29bea77-4c89-4327-862c-31c5d4e58dc3' before retrying. Athena will not delete data in your account.
[0m15:32:15.885931 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 15:28:56.901273 => 15:32:15.884551
[0m15:32:15.887728 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m15:32:15.892147 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/c29bea77-4c89-4327-862c-31c5d4e58dc3' before retrying. Athena will not delete data in your account.
[0m15:32:15.907388 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 154, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/c29bea77-4c89-4327-862c-31c5d4e58dc3' before retrying. Athena will not delete data in your account.

[0m15:32:15.909454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef52931c-e0c5-466e-b6e7-ddf934085a54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4bbbed0>]}
[0m15:32:15.916982 [error] [Thread-1 (]: 11 of 11 ERROR creating sql incremental model gold_gold.weather_data_gold ...... [[31mERROR[0m in 199.03s]
[0m15:32:15.920051 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m15:32:15.941337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:15.943587 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:32:15.947194 [info ] [MainThread]: 
[0m15:32:15.949162 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 4 minutes and 28.78 seconds (268.78s).
[0m15:32:15.956882 [debug] [MainThread]: Command end result
[0m15:32:16.002496 [info ] [MainThread]: 
[0m15:32:16.003451 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:32:16.004031 [info ] [MainThread]: 
[0m15:32:16.004926 [error] [MainThread]:   INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/c29bea77-4c89-4327-862c-31c5d4e58dc3' before retrying. Athena will not delete data in your account.
[0m15:32:16.005594 [info ] [MainThread]: 
[0m15:32:16.006435 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m15:32:16.011488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 269.34317, "process_user_time": 7.100556, "process_kernel_time": 0.828803, "process_mem_max_rss": "194020", "process_out_blocks": "3079", "command_success": false, "process_in_blocks": "0"}
[0m15:32:16.013858 [debug] [MainThread]: Command `dbt run` failed at 15:32:16.013420 after 269.35 seconds
[0m15:32:16.019605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbdeb9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbdeb9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb79fac50>]}
[0m15:32:16.020549 [debug] [MainThread]: Flushing usage events
[0m15:34:19.053880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d25750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d24850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7344b50>]}


============================== 15:34:19.055935 | 68985750-eba2-4094-a049-4e9b5a14d8f2 ==============================
[0m15:34:19.055935 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:34:19.056909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:34:19.103084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68985750-eba2-4094-a049-4e9b5a14d8f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bed710>]}
[0m15:34:19.132684 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10068354, "process_user_time": 0.966314, "process_kernel_time": 0.154209, "process_mem_max_rss": "103192", "process_out_blocks": "2", "process_in_blocks": "0"}
[0m15:34:19.133160 [debug] [MainThread]: Command `dbt clean` succeeded at 15:34:19.133050 after 0.10 seconds
[0m15:34:19.133595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa672c090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b6c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b6cc10>]}
[0m15:34:19.134000 [debug] [MainThread]: Flushing usage events
[0m15:34:32.919625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8bd1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa88af910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8bd1750>]}


============================== 15:34:32.921867 | 3342febd-ced1-49b1-99cd-f3e1a40dfe2a ==============================
[0m15:34:32.921867 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:34:32.922308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profile gold', 'send_anonymous_usage_stats': 'True'}
[0m15:34:33.174918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7747590>]}
[0m15:34:33.215189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa78b97d0>]}
[0m15:34:33.215707 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:34:33.220054 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m15:34:33.220749 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:34:33.221097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa78a3950>]}
[0m15:34:33.845055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7432c50>]}
[0m15:34:33.893139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa782f550>]}
[0m15:34:33.893466 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 427 macros, 0 groups, 0 semantic models
[0m15:34:33.893746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa86fd2d0>]}
[0m15:34:33.895081 [info ] [MainThread]: 
[0m15:34:33.895665 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:34:33.896653 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:34:33.896949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:34.581823 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:34:34.584224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:35.639071 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:34:35.642667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:36.322932 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:34:36.324194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now create_AwsDataCatalog_gold_bronze)
[0m15:34:36.324858 [debug] [ThreadPool]: Creating schema "database: "AwsDataCatalog"
schema: "gold_bronze"
"
[0m15:34:36.332483 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_gold_bronze"
[0m15:34:36.332949 [debug] [ThreadPool]: On create_AwsDataCatalog_gold_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "connection_name": "create_AwsDataCatalog_gold_bronze"} */
create schema if not exists `AwsDataCatalog`.`gold_bronze`
  
[0m15:34:36.333275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:37.079320 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Athena query ID 07891a83-3f8c-4b1d-8fc2-a7a331e7473e
[0m15:34:38.746869 [debug] [ThreadPool]: SQL status: OK -1 in 2.0 seconds
[0m15:34:38.751905 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Lakeformation is disabled for "AwsDataCatalog"."gold_bronze"
[0m15:34:38.752723 [debug] [ThreadPool]: On create_AwsDataCatalog_gold_bronze: Close
[0m15:34:38.757754 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_gold_gold'
[0m15:34:38.758375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:40.196087 [debug] [ThreadPool]: On list_AwsDataCatalog_gold_gold: Close
[0m15:34:40.199693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold_gold, now list_AwsDataCatalog_gold_bronze)
[0m15:34:40.200605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:41.445769 [debug] [ThreadPool]: On list_AwsDataCatalog_gold_bronze: Close
[0m15:34:41.446722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold_bronze, now list_AwsDataCatalog_gold_silver)
[0m15:34:41.447034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:42.816579 [debug] [ThreadPool]: On list_AwsDataCatalog_gold_silver: Close
[0m15:34:42.820959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f985a50>]}
[0m15:34:42.823124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:34:42.824235 [info ] [MainThread]: 
[0m15:34:42.828128 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m15:34:42.829236 [info ] [Thread-1 (]: 1 of 11 START sql view model gold_bronze.eia_bronze ............................ [RUN]
[0m15:34:42.830742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold_silver, now model.silver.eia_bronze)
[0m15:34:42.831394 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m15:34:42.843588 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:34:42.848865 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 15:34:42.831857 => 15:34:42.848441
[0m15:34:42.849880 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m15:34:42.886741 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:34:42.889086 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m15:34:42.889381 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."gold_bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:34:42.889683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:43.483250 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 04a76c43-98cd-4ae6-b1f1-b8e97d856c63
[0m15:34:45.126236 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:34:46.392140 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:34:46.397204 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:34:46.410911 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 15:34:42.850636 => 15:34:46.410382
[0m15:34:46.411883 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m15:34:46.413787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa41d7550>]}
[0m15:34:46.415312 [info ] [Thread-1 (]: 1 of 11 OK created sql view model gold_bronze.eia_bronze ....................... [[32mOK -1[0m in 3.58s]
[0m15:34:46.416826 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m15:34:46.417710 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m15:34:46.419276 [info ] [Thread-1 (]: 2 of 11 START sql view model gold_bronze.noaa_bronze ........................... [RUN]
[0m15:34:46.422618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:34:46.423291 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m15:34:46.428403 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:34:46.430197 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 15:34:46.423714 => 15:34:46.429996
[0m15:34:46.430637 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m15:34:46.434173 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:34:46.435772 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m15:34:46.436702 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."gold_bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:34:46.437622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:47.196702 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b8816618-2135-475b-aeef-41a33ef8f304
[0m15:34:48.857991 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:34:50.213232 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:34:50.309641 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:34:50.418591 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 15:34:46.430923 => 15:34:50.416006
[0m15:34:50.424792 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m15:34:50.450591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8bf550>]}
[0m15:34:50.459267 [info ] [Thread-1 (]: 2 of 11 OK created sql view model gold_bronze.noaa_bronze ...................... [[32mOK -1[0m in 4.02s]
[0m15:34:50.470877 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m15:34:50.487328 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m15:34:50.518983 [info ] [Thread-1 (]: 3 of 11 START sql view model gold_bronze.openmeteo_bronze ...................... [RUN]
[0m15:34:50.613344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:34:50.616329 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m15:34:50.668684 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:34:50.684744 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 15:34:50.617114 => 15:34:50.683907
[0m15:34:50.686038 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m15:34:50.718639 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:34:50.764526 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:34:50.781545 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."gold_bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:34:50.788330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:51.891320 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID adb00c01-af29-4eaf-95f7-bd04ab87acd1
[0m15:34:53.974780 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:34:55.331759 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:34:55.335971 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:34:55.339249 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 15:34:50.688469 => 15:34:55.338865
[0m15:34:55.340152 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m15:34:55.341777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa74331d0>]}
[0m15:34:55.343275 [info ] [Thread-1 (]: 3 of 11 OK created sql view model gold_bronze.openmeteo_bronze ................. [[32mOK -1[0m in 4.82s]
[0m15:34:55.345009 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m15:34:55.346189 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m15:34:55.347445 [info ] [Thread-1 (]: 4 of 11 START sql view model gold_bronze.openweather_bronze .................... [RUN]
[0m15:34:55.353159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:34:55.354028 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m15:34:55.359126 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:34:55.361397 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 15:34:55.354494 => 15:34:55.361125
[0m15:34:55.361921 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m15:34:55.365688 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:34:55.368313 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m15:34:55.368839 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."gold_bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:34:55.369387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:55.976515 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 550e20a5-e2c2-4066-862f-ea195edfe1f8
[0m15:34:57.651747 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:34:58.945924 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:34:58.947721 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:34:58.950905 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 15:34:55.362255 => 15:34:58.950633
[0m15:34:58.951455 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m15:34:58.952470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40f51d0>]}
[0m15:34:58.953255 [info ] [Thread-1 (]: 4 of 11 OK created sql view model gold_bronze.openweather_bronze ............... [[32mOK -1[0m in 3.60s]
[0m15:34:58.953958 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m15:34:58.954471 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m15:34:58.955251 [info ] [Thread-1 (]: 5 of 11 START sql view model gold_bronze.sensor_bronze ......................... [RUN]
[0m15:34:58.958292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:34:58.958902 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m15:34:58.962633 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:34:58.965051 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 15:34:58.959161 => 15:34:58.964768
[0m15:34:58.965481 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m15:34:58.967918 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:34:58.969613 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m15:34:58.970011 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."gold_bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:34:58.970500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:59.737470 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8ac85877-c912-40dd-b8f4-b3c1320a2035
[0m15:35:01.419699 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:35:02.724624 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:35:02.726600 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:35:02.728563 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 15:34:58.965698 => 15:35:02.728310
[0m15:35:02.729212 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m15:35:02.730133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7458050>]}
[0m15:35:02.730854 [info ] [Thread-1 (]: 5 of 11 OK created sql view model gold_bronze.sensor_bronze .................... [[32mOK -1[0m in 3.77s]
[0m15:35:02.731619 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m15:35:02.732138 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:35:02.733033 [info ] [Thread-1 (]: 6 of 11 START sql table model gold_silver.eia_silver ........................... [RUN]
[0m15:35:02.736021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:35:02.736437 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:35:02.739634 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:35:02.741061 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:35:02.736665 => 15:35:02.740866
[0m15:35:02.741377 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:35:02.766100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:04.134685 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:35:04.136145 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:04.140338 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:35:05.317950 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:35:05.318509 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:05.318808 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold_silver"."eia_silver" is stored in s3://climate-energy-raw-data/gold/gold_silver/eia_silver/e402b97e-e110-4750-a074-fefdce0e34b4
[0m15:35:06.621904 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/gold_silver/eia_silver/e402b97e-e110-4750-a074-fefdce0e34b4', bucket='climate-energy-raw-data', prefix='gold/gold_silver/eia_silver/e402b97e-e110-4750-a074-fefdce0e34b4/'
[0m15:35:09.532665 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold_silver"."eia_silver"
[0m15:35:09.585710 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:35:10.757869 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:35:10.760282 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."gold_silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold_silver/eia_silver/6fa5ef43-08f2-467f-848f-2cd556b91bef',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold_bronze"."eia_bronze"
[0m15:35:11.313353 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 37c58619-343e-45a5-afa8-026f72111151
[0m15:35:14.122450 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:35:14.131005 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:35:14.132197 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`gold_silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:35:14.384718 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID fd51b177-4863-4416-8ca2-346e5f9282ab
[0m15:35:16.028838 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:35:16.037831 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:35:16.042477 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:35:16.043264 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:35:16.232189 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID af5b7623-d7a5-4fbc-884d-aa9090f4f626
[0m15:35:17.962271 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m15:35:17.967875 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 15:35:02.741567 => 15:35:17.967447
[0m15:35:17.968554 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m15:35:17.970270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa44816d0>]}
[0m15:35:17.971444 [info ] [Thread-1 (]: 6 of 11 OK created sql table model gold_silver.eia_silver ...................... [[32mOK 2842[0m in 15.24s]
[0m15:35:17.972293 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m15:35:17.972911 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m15:35:17.973784 [info ] [Thread-1 (]: 7 of 11 START sql table model gold_silver.noaa_silver .......................... [RUN]
[0m15:35:17.976876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:35:17.977288 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m15:35:17.982473 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:35:17.983583 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 15:35:17.977529 => 15:35:17.983460
[0m15:35:17.983845 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m15:35:17.986474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:19.269327 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:35:19.270667 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:19.271862 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:35:20.489119 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:35:20.490207 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:20.491137 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold_silver"."noaa_silver" is stored in s3://climate-energy-raw-data/gold/gold_silver/noaa_silver/8bf1b944-0b7e-4994-8d7c-4d4dafbcdbcb
[0m15:35:21.323056 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/gold_silver/noaa_silver/8bf1b944-0b7e-4994-8d7c-4d4dafbcdbcb', bucket='climate-energy-raw-data', prefix='gold/gold_silver/noaa_silver/8bf1b944-0b7e-4994-8d7c-4d4dafbcdbcb/'
[0m15:35:23.465542 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold_silver"."noaa_silver"
[0m15:35:23.468019 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:35:24.000432 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:35:24.002575 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."gold_silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold_silver/noaa_silver/57f78f7b-df60-450f-b68d-6a4ec1aa76e7',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold_bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:35:24.567643 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e50a1429-943e-4655-bced-132674d1ff75
[0m15:35:27.356221 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:35:27.359822 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:35:27.360716 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`gold_silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:35:27.620372 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d2b49e1d-cbb7-4f8a-a348-e195c019d07f
[0m15:35:29.268495 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:35:29.274108 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:35:29.282781 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:35:29.284816 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:35:29.473507 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 167a6e0b-3fbf-4e38-977f-4be88fc107ef
[0m15:35:31.160398 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m15:35:31.175015 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 15:35:17.984099 => 15:35:31.174332
[0m15:35:31.176025 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m15:35:31.179023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d15fd10>]}
[0m15:35:31.181132 [info ] [Thread-1 (]: 7 of 11 OK created sql table model gold_silver.noaa_silver ..................... [[32mOK 305[0m in 13.20s]
[0m15:35:31.182536 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m15:35:31.183586 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m15:35:31.185149 [info ] [Thread-1 (]: 8 of 11 START sql table model gold_silver.openmeteo_silver ..................... [RUN]
[0m15:35:31.192306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:35:31.192955 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m15:35:31.208776 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:35:31.210342 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 15:35:31.193294 => 15:35:31.210174
[0m15:35:31.210664 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m15:35:31.214124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:32.510449 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:35:32.512533 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:32.514527 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:35:33.709930 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:35:33.710868 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:33.711775 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold_silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/gold/gold_silver/openmeteo_silver/015d97c1-dd0c-4833-b998-33ebb73803bf
[0m15:35:34.284598 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/gold_silver/openmeteo_silver/015d97c1-dd0c-4833-b998-33ebb73803bf', bucket='climate-energy-raw-data', prefix='gold/gold_silver/openmeteo_silver/015d97c1-dd0c-4833-b998-33ebb73803bf/'
[0m15:35:36.521458 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold_silver"."openmeteo_silver"
[0m15:35:36.527288 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:35:37.782835 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:35:37.790886 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."gold_silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold_silver/openmeteo_silver/a3d2e728-48c5-421f-b4be-bf64a14f5ee9',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold_bronze"."openmeteo_bronze"
[0m15:35:38.374528 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8391983f-4fff-40e5-8296-7dc921cbdd51
[0m15:35:41.180080 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m15:35:41.184552 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:35:41.185371 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`gold_silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:35:41.443999 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a373a26a-809b-4148-b3d9-383c2b65a33e
[0m15:35:43.351897 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:35:43.356008 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:35:43.358875 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:35:43.359657 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m15:35:43.548331 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0fde1480-633a-4081-af58-d3ca91eb4f47
[0m15:35:45.257029 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m15:35:45.262680 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 15:35:31.210900 => 15:35:45.262276
[0m15:35:45.263519 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m15:35:45.264481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa78cac10>]}
[0m15:35:45.265267 [info ] [Thread-1 (]: 8 of 11 OK created sql table model gold_silver.openmeteo_silver ................ [[32mOK 12458[0m in 14.08s]
[0m15:35:45.266007 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m15:35:45.266623 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m15:35:45.267134 [info ] [Thread-1 (]: 9 of 11 START sql table model gold_silver.openweather_silver ................... [RUN]
[0m15:35:45.269459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:35:45.270012 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m15:35:45.273101 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:35:45.274282 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 15:35:45.270230 => 15:35:45.274105
[0m15:35:45.274589 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m15:35:45.276585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:46.504189 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:35:46.504918 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:46.505712 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:35:47.698451 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:35:47.700250 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:47.701847 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold_silver"."openweather_silver" is stored in s3://climate-energy-raw-data/gold/gold_silver/openweather_silver/51457e90-72e0-4734-9ce2-5db9ba51cf5c
[0m15:35:49.119102 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/gold_silver/openweather_silver/51457e90-72e0-4734-9ce2-5db9ba51cf5c', bucket='climate-energy-raw-data', prefix='gold/gold_silver/openweather_silver/51457e90-72e0-4734-9ce2-5db9ba51cf5c/'
[0m15:35:52.131447 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold_silver"."openweather_silver"
[0m15:35:52.142468 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:35:53.380311 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:35:53.384269 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."gold_silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold_silver/openweather_silver/17742881-ff80-406e-8f57-b6e87dfeda8c',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold_bronze"."openweather_bronze"
[0m15:35:53.942208 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e6539e63-36e4-4d28-8732-6b2b34d8480c
[0m15:35:56.717996 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m15:35:56.719622 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:35:56.720058 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`gold_silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:35:56.981825 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7bc24f06-5661-4566-a949-cb4ca94281df
[0m15:35:58.619865 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:35:58.627474 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:35:58.630935 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:35:58.631820 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m15:35:58.818737 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 166a0eaf-a300-470d-aa61-6a81b029c03e
[0m15:36:00.539545 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m15:36:00.545927 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 15:35:45.274814 => 15:36:00.544399
[0m15:36:00.546770 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m15:36:00.548337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e2d2a50>]}
[0m15:36:00.549753 [info ] [Thread-1 (]: 9 of 11 OK created sql table model gold_silver.openweather_silver .............. [[32mOK 473[0m in 15.28s]
[0m15:36:00.550567 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m15:36:00.551259 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m15:36:00.552588 [info ] [Thread-1 (]: 10 of 11 START sql table model gold_silver.sensor_silver ....................... [RUN]
[0m15:36:00.559042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:36:00.559966 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m15:36:00.569304 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:36:00.571209 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 15:36:00.560286 => 15:36:00.570991
[0m15:36:00.571574 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m15:36:00.574490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:02.161298 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:36:02.162480 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:36:02.163537 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:36:03.369236 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:36:03.370008 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:36:03.370415 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold_silver"."sensor_silver" is stored in s3://climate-energy-raw-data/gold/gold_silver/sensor_silver/155f2635-5708-44fb-b25b-121e779f2993
[0m15:36:04.574328 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/gold_silver/sensor_silver/155f2635-5708-44fb-b25b-121e779f2993', bucket='climate-energy-raw-data', prefix='gold/gold_silver/sensor_silver/155f2635-5708-44fb-b25b-121e779f2993/'
[0m15:36:07.256769 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold_silver"."sensor_silver"
[0m15:36:07.259837 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:36:07.874658 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:36:07.890452 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."gold_silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/gold_silver/sensor_silver/2178a1ef-747d-4f04-8feb-ce8fc3863012',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."gold_bronze"."sensor_bronze"
[0m15:36:08.744599 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d75118b0-8102-4b0a-9a14-85a9b3146e21
[0m15:36:10.520739 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m15:36:10.528232 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:36:10.529114 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`gold_silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:36:10.788586 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8ff5c2d4-380e-4cca-af6f-ca0c01023991
[0m15:36:12.439847 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:36:12.444854 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:36:12.448964 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:36:12.449665 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m15:36:12.640355 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ec206014-bf35-4c24-913d-e97278ed4c10
[0m15:36:14.331210 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m15:36:14.341631 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 15:36:00.571834 => 15:36:14.340361
[0m15:36:14.343029 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m15:36:14.346856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3342febd-ced1-49b1-99cd-f3e1a40dfe2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbca990>]}
[0m15:36:14.349565 [info ] [Thread-1 (]: 10 of 11 OK created sql table model gold_silver.sensor_silver .................. [[32mOK 700[0m in 13.79s]
[0m15:36:14.351325 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m15:36:14.352718 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m15:36:14.354468 [info ] [Thread-1 (]: 11 of 11 START sql incremental model gold_gold.weather_data_gold ............... [RUN]
[0m15:36:14.360021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:36:14.360736 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m15:36:14.374761 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:36:14.377278 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 15:36:14.361210 => 15:36:14.377068
[0m15:36:14.377654 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m15:36:14.414062 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:36:14.414639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:15.145874 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:36:15.147584 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold_gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."gold_silver"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."gold_silver"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:36:15.607821 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d5469de8-1e79-4810-8801-f9e8c64cb118
[0m15:36:23.149535 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID daec1b14-fbc8-4c7b-b570-9dd859a716c5
[0m15:36:36.709906 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d4da748f-b0b4-4f1d-b7cd-4cae24c147f6
[0m15:37:03.428012 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0dea28da-5132-4f3d-9eb0-8810eec7b96e
[0m15:37:49.664660 [error] [MainThread]: CANCEL query create_AwsDataCatalog_gold_bronze ................................. [[31mCANCEL[0m]
[0m15:37:49.668753 [error] [MainThread]: CANCEL query model.silver.weather_data_gold .................................... [[31mCANCEL[0m]
[0m15:37:49.947714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:49.948838 [debug] [MainThread]: Connection 'create_AwsDataCatalog_gold_bronze' was properly closed.
[0m15:37:49.949508 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was left open.
[0m15:37:49.950369 [debug] [MainThread]: On model.silver.weather_data_gold: Close
[0m15:37:49.977513 [info ] [MainThread]: 
[0m15:37:49.979875 [info ] [MainThread]: Finished running 5 view models, 5 table models in 0 hours 3 minutes and 16.08 seconds (196.08s).
[0m15:37:49.984186 [error] [MainThread]: Encountered an error:

[0m15:37:50.021382 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:37:50.031428 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 197.13751, "process_user_time": 10.286468, "process_kernel_time": 1.180936, "process_mem_max_rss": "209108", "process_out_blocks": "2101", "command_success": false, "process_in_blocks": "0"}
[0m15:37:50.034597 [debug] [MainThread]: Command `dbt run` failed at 15:37:50.033150 after 197.14 seconds
[0m15:37:50.037961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadaf9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6971910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa614e4d0>]}
[0m15:37:50.040281 [debug] [MainThread]: Flushing usage events
[0m15:38:00.763100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f58590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f5af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f5b010>]}


============================== 15:38:00.765152 | c08c45cb-bc78-4178-9435-cc17328f3468 ==============================
[0m15:38:00.765152 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:38:00.765623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:38:00.813940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c08c45cb-bc78-4178-9435-cc17328f3468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff880000d0>]}
[0m15:38:00.826472 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.0903035, "process_user_time": 1.075749, "process_kernel_time": 0.221596, "process_mem_max_rss": "103196", "process_out_blocks": "2", "process_in_blocks": "0"}
[0m15:38:00.827666 [debug] [MainThread]: Command `dbt clean` succeeded at 15:38:00.827207 after 0.09 seconds
[0m15:38:00.828510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f58590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d374990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d375250>]}
[0m15:38:00.829162 [debug] [MainThread]: Flushing usage events
[0m15:38:06.198297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3837dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a17bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a16d90>]}


============================== 15:38:06.207384 | 36a12452-8e05-417c-b417-17903bc740cf ==============================
[0m15:38:06.207384 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:38:06.209532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profile gold', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:38:06.696900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28a68d0>]}
[0m15:38:06.763947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3892e10>]}
[0m15:38:06.764747 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:38:06.772046 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m15:38:06.774265 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:38:06.775040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb27a46d0>]}
[0m15:38:08.076903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb21978d0>]}
[0m15:38:08.093187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2162b10>]}
[0m15:38:08.093693 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m15:38:08.094793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb25287d0>]}
[0m15:38:08.097947 [info ] [MainThread]: 
[0m15:38:08.099127 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:38:08.101440 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:38:08.101941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:09.086590 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:38:09.090454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:09.690553 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:38:09.694177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:10.366835 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:38:10.368053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now create_AwsDataCatalog_bronze)
[0m15:38:10.368845 [debug] [ThreadPool]: Creating schema "database: "AwsDataCatalog"
schema: "bronze"
"
[0m15:38:10.376413 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_bronze"
[0m15:38:10.377038 [debug] [ThreadPool]: On create_AwsDataCatalog_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "connection_name": "create_AwsDataCatalog_bronze"} */
create schema if not exists `AwsDataCatalog`.`bronze`
  
[0m15:38:10.377422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:11.065070 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Athena query ID 2054a0cb-2f96-4d61-b02d-41abf3a10017
[0m15:38:12.758594 [debug] [ThreadPool]: SQL status: OK -1 in 2.0 seconds
[0m15:38:12.760803 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Lakeformation is disabled for "AwsDataCatalog"."bronze"
[0m15:38:12.761329 [debug] [ThreadPool]: On create_AwsDataCatalog_bronze: Close
[0m15:38:12.763503 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_gold'
[0m15:38:12.763959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:14.272155 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:38:14.279041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m15:38:14.282774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:15.717512 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:38:15.719122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m15:38:15.720810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:17.091370 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m15:38:17.094926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb261df10>]}
[0m15:38:17.097012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:17.098184 [info ] [MainThread]: 
[0m15:38:17.102745 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m15:38:17.103956 [info ] [Thread-1 (]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m15:38:17.105406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.eia_bronze)
[0m15:38:17.106150 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m15:38:17.123703 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:38:17.127969 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 15:38:17.106685 => 15:38:17.127503
[0m15:38:17.128726 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m15:38:17.231500 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:38:17.234451 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m15:38:17.234815 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:38:17.235143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:17.859381 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0fd2433f-accb-4127-a612-a6e01dd98886
[0m15:38:19.599803 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:38:20.938198 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:38:20.944490 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:38:20.965302 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 15:38:17.129067 => 15:38:20.964595
[0m15:38:20.966326 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m15:38:20.968877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2988b10>]}
[0m15:38:20.971135 [info ] [Thread-1 (]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 3.86s]
[0m15:38:20.972694 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m15:38:20.973844 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m15:38:20.975729 [info ] [Thread-1 (]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m15:38:20.979713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:38:20.980588 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m15:38:20.986888 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:38:20.989736 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 15:38:20.981026 => 15:38:20.989435
[0m15:38:20.990255 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m15:38:20.993984 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:38:20.995972 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m15:38:20.996536 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:38:20.997763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:21.859094 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 76a9995e-a29c-486f-a884-b0511c4d897e
[0m15:38:23.513263 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:38:24.784648 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:38:24.788869 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:38:24.791753 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 15:38:20.990557 => 15:38:24.791423
[0m15:38:24.792572 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m15:38:24.794161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa943ec10>]}
[0m15:38:24.795394 [info ] [Thread-1 (]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.82s]
[0m15:38:24.796948 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m15:38:24.797902 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m15:38:24.799196 [info ] [Thread-1 (]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m15:38:24.802019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:38:24.802826 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m15:38:24.807229 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:38:24.809168 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 15:38:24.803287 => 15:38:24.808905
[0m15:38:24.809666 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m15:38:24.812926 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:38:24.814449 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:38:24.815026 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:38:24.815549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:25.475390 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5cb274c6-1338-477f-94f3-cb66ee712f6d
[0m15:38:27.301863 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:38:28.603293 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:38:28.607659 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:38:28.610417 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 15:38:24.810011 => 15:38:28.610118
[0m15:38:28.611062 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m15:38:28.612476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9c93c10>]}
[0m15:38:28.613599 [info ] [Thread-1 (]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 3.81s]
[0m15:38:28.614569 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m15:38:28.615343 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m15:38:28.616378 [info ] [Thread-1 (]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m15:38:28.619632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:38:28.620114 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m15:38:28.624464 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:38:28.626034 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 15:38:28.620410 => 15:38:28.625855
[0m15:38:28.626431 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m15:38:28.629552 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:38:28.630852 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m15:38:28.631268 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:38:28.631746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:29.263127 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 01bade0a-0120-4136-937e-6ac9eb046ff1
[0m15:38:30.958231 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:38:32.190178 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:38:32.193210 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:38:32.198268 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 15:38:28.626709 => 15:38:32.197694
[0m15:38:32.199059 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m15:38:32.201576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9621f10>]}
[0m15:38:32.203870 [info ] [Thread-1 (]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.58s]
[0m15:38:32.205264 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m15:38:32.206310 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m15:38:32.208002 [info ] [Thread-1 (]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m15:38:32.212109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:38:32.212721 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m15:38:32.230631 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:38:32.232028 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 15:38:32.213043 => 15:38:32.231874
[0m15:38:32.232386 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m15:38:32.236007 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:38:32.236968 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m15:38:32.237297 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:38:32.237635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:33.120254 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 48860610-5f9c-4a14-966c-a4982870b6d5
[0m15:38:34.831781 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m15:38:36.033242 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m15:38:36.037173 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:38:36.046469 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 15:38:32.232627 => 15:38:36.045864
[0m15:38:36.047423 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m15:38:36.050190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8269490>]}
[0m15:38:36.053185 [info ] [Thread-1 (]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 3.84s]
[0m15:38:36.056260 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m15:38:36.058421 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:38:36.060152 [info ] [Thread-1 (]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m15:38:36.068796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:38:36.070899 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:38:36.210139 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:38:36.213975 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:38:36.075629 => 15:38:36.213692
[0m15:38:36.214506 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:38:36.250457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:37.827608 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:38:37.909443 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:38:37.919075 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:38:39.143855 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:38:39.145053 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:38:39.146008 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/95f2d887-0aa0-4dfa-a217-234fdfbe86ce
[0m15:38:39.787483 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/95f2d887-0aa0-4dfa-a217-234fdfbe86ce', bucket='climate-energy-raw-data', prefix='silver/eia_silver/95f2d887-0aa0-4dfa-a217-234fdfbe86ce/'
[0m15:38:41.849765 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:38:41.885070 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:38:42.402139 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:38:42.404189 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/silver/eia_silver/f84c2fbe-3687-451c-a067-4941d5be2598',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m15:38:42.984663 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7d291b66-a692-4862-bcbb-3b929a6efd75
[0m15:38:44.615934 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:38:44.618525 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:38:44.618879 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:38:44.876653 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9e21909b-31e8-4160-a6a4-7abf9126cb81
[0m15:38:46.543962 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:38:46.565885 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:38:46.571769 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:38:46.574380 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:38:46.791743 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7c776310-90e5-4aac-bb0d-035c4608e573
[0m15:38:48.515869 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m15:38:48.541900 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 15:38:36.214821 => 15:38:48.537329
[0m15:38:48.543337 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m15:38:48.547194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2583010>]}
[0m15:38:48.552402 [info ] [Thread-1 (]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 12.49s]
[0m15:38:48.554104 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m15:38:48.555287 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m15:38:48.556593 [info ] [Thread-1 (]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:38:48.564295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:38:48.564979 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m15:38:48.577456 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:38:48.582293 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 15:38:48.565264 => 15:38:48.581861
[0m15:38:48.582932 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m15:38:48.592583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:50.131829 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:38:50.136253 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:38:50.141872 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:38:51.398893 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:38:51.400964 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:38:51.402663 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/f32dc4c3-50fd-4aca-8b52-7dee9e6dd565
[0m15:38:53.085912 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/f32dc4c3-50fd-4aca-8b52-7dee9e6dd565', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/f32dc4c3-50fd-4aca-8b52-7dee9e6dd565/'
[0m15:38:55.329428 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:38:55.342146 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:38:55.908149 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:38:55.913756 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/silver/noaa_silver/9c0b8795-b2bd-4ac6-a659-0afdc60554f2',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:38:56.583586 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID dcd7a41a-47f9-41e1-9055-6d65d995c307
[0m15:38:58.270238 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:38:58.278043 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:38:58.278622 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:38:58.534042 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 91043417-6806-42ea-a29f-e2cbd55180d8
[0m15:39:00.340580 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:39:00.350267 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:39:00.358863 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:39:00.360004 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:39:00.567230 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c2504330-6dcd-4b56-8498-ec3a0c572f89
[0m15:39:02.306924 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m15:39:02.322323 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 15:38:48.583131 => 15:39:02.321018
[0m15:39:02.323650 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m15:39:02.332561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa99ec310>]}
[0m15:39:02.335455 [info ] [Thread-1 (]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 13.77s]
[0m15:39:02.337211 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m15:39:02.338702 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m15:39:02.340623 [info ] [Thread-1 (]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m15:39:02.355456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:39:02.356605 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m15:39:02.384408 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:39:02.388095 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 15:39:02.357020 => 15:39:02.387530
[0m15:39:02.388710 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m15:39:02.399242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:03.754465 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:39:03.756312 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:03.758167 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:39:04.971952 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:39:04.983852 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:04.988597 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/92d66536-9928-4875-8ace-92d1ff8381fd
[0m15:39:05.617995 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/92d66536-9928-4875-8ace-92d1ff8381fd', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/92d66536-9928-4875-8ace-92d1ff8381fd/'
[0m15:39:07.686666 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:39:07.692124 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:39:08.463092 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:39:08.464298 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/silver/openmeteo_silver/d1f0bc28-f52d-498a-aee3-3aae20594568',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m15:39:09.026736 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8c01b67c-a844-4f68-b3a8-d3d0e44ccbc6
[0m15:39:11.865539 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m15:39:11.872389 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:39:11.873208 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:39:12.155024 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f23e0222-18b0-4ec4-bd1c-e1dc2a7d03fc
[0m15:39:13.813202 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:39:13.820192 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:39:13.823110 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:39:13.823763 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m15:39:14.018853 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e3957d74-2706-4cfb-b9a6-30fe4f550599
[0m15:39:15.731877 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m15:39:15.743208 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 15:39:02.388977 => 15:39:15.742136
[0m15:39:15.744588 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m15:39:15.748672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1dfc3d0>]}
[0m15:39:15.751484 [info ] [Thread-1 (]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 13.41s]
[0m15:39:15.753231 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m15:39:15.754506 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m15:39:15.756474 [info ] [Thread-1 (]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m15:39:15.768633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:39:15.769485 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m15:39:15.780881 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:39:15.782513 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 15:39:15.769959 => 15:39:15.782330
[0m15:39:15.782941 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m15:39:15.788789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:17.150877 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:39:17.152339 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:17.153561 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:39:18.369869 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:39:18.371387 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:18.372274 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/38841a04-f4a8-44f2-bb03-74bfa6b0ad64
[0m15:39:19.684684 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/38841a04-f4a8-44f2-bb03-74bfa6b0ad64', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/38841a04-f4a8-44f2-bb03-74bfa6b0ad64/'
[0m15:39:22.863544 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:39:22.865736 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:39:24.068486 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:39:24.070598 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/silver/openweather_silver/f3b632bd-6385-4d19-a855-7335418dc4b5',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m15:39:24.679205 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1d98272b-8538-4e0a-bce0-ec54d6c89a95
[0m15:39:27.515290 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m15:39:27.517171 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:39:27.517706 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:39:27.802626 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bcf2489e-eac8-4389-aa58-41dbaede845f
[0m15:39:29.458498 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:39:29.463828 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:39:29.466368 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:39:29.467037 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m15:39:29.696942 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID eba6694a-ca7e-4df7-bbc0-847f9bca8994
[0m15:39:31.398487 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m15:39:31.406796 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 15:39:15.783275 => 15:39:31.405683
[0m15:39:31.408360 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m15:39:31.411740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad5c910>]}
[0m15:39:31.413462 [info ] [Thread-1 (]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 15.65s]
[0m15:39:31.415090 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m15:39:31.416753 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m15:39:31.418988 [info ] [Thread-1 (]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m15:39:31.422300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:39:31.423184 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m15:39:31.439923 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:39:31.442428 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 15:39:31.423766 => 15:39:31.442196
[0m15:39:31.442904 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m15:39:31.447509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:33.651314 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:39:33.652740 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:33.654707 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:39:35.476797 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:39:35.477388 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:35.477737 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/507591dc-a1c3-402f-8b1c-92c56e8c3918
[0m15:39:36.077715 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/507591dc-a1c3-402f-8b1c-92c56e8c3918', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/507591dc-a1c3-402f-8b1c-92c56e8c3918/'
[0m15:39:39.664290 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:39:39.677407 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:39:41.035346 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:39:41.036824 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/silver/sensor_silver/71b1f3f3-3393-4cde-9d78-fb3ded62632a',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m15:39:41.590648 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 27e7dc11-86ef-4a22-9b8a-034485671857
[0m15:39:45.575335 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m15:39:45.579275 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:39:45.580114 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:39:45.888170 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d9ba21ed-3649-49b8-8746-59ce56248eea
[0m15:39:47.527003 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:39:47.533408 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:39:47.535521 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:39:47.535908 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m15:39:47.739674 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e61b06b9-9124-41d0-9a93-9e924a9cbca3
[0m15:39:49.478861 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m15:39:49.490845 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 15:39:31.443220 => 15:39:49.489354
[0m15:39:49.492358 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m15:39:49.499593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb21b3510>]}
[0m15:39:49.502317 [info ] [Thread-1 (]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 18.08s]
[0m15:39:49.504204 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m15:39:49.505688 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m15:39:49.507708 [info ] [Thread-1 (]: 11 of 11 START sql incremental model gold.weather_data_gold .................... [RUN]
[0m15:39:49.514917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:39:49.516201 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m15:39:49.537268 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:39:49.541399 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 15:39:49.516695 => 15:39:49.541045
[0m15:39:49.541894 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m15:39:49.579292 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:39:49.580283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:51.502922 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:39:51.510631 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      partitioning=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:39:52.082747 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID afeecf4d-562b-40e2-b14b-c77ff1ec8531
[0m15:40:00.802866 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a5a39d6c-e986-4292-9d05-a12cd44166ba
[0m15:40:15.482358 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 26732480-56bb-478b-97f0-5a0cabcec33c
[0m15:40:42.162840 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4a08cb76-c33c-4137-b4b3-d88d3fdb8602
[0m15:41:32.154156 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 69f52982-452b-4fcd-9a89-bfb0ad709fd7
[0m15:43:10.646333 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f6217cd3-2c19-4b50-b7f1-29f02e3d4062
[0m15:43:12.433688 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/f6217cd3-2c19-4b50-b7f1-29f02e3d4062' before retrying. Athena will not delete data in your account.
[0m15:43:12.496354 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 15:39:49.542171 => 15:43:12.482238
[0m15:43:12.504895 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m15:43:12.594687 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/f6217cd3-2c19-4b50-b7f1-29f02e3d4062' before retrying. Athena will not delete data in your account.
[0m15:43:12.761851 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 154, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/f6217cd3-2c19-4b50-b7f1-29f02e3d4062' before retrying. Athena will not delete data in your account.

[0m15:43:12.774453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36a12452-8e05-417c-b417-17903bc740cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00b3b90>]}
[0m15:43:12.782448 [error] [Thread-1 (]: 11 of 11 ERROR creating sql incremental model gold.weather_data_gold ........... [[31mERROR[0m in 203.26s]
[0m15:43:12.787680 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m15:43:12.883674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:12.889948 [debug] [MainThread]: Connection 'create_AwsDataCatalog_bronze' was properly closed.
[0m15:43:12.892894 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:43:12.945538 [info ] [MainThread]: 
[0m15:43:12.949665 [info ] [MainThread]: Finished running 5 view models, 5 table models, 1 incremental model in 0 hours 5 minutes and 4.84 seconds (304.84s).
[0m15:43:12.970691 [debug] [MainThread]: Command end result
[0m15:43:13.114823 [info ] [MainThread]: 
[0m15:43:13.117575 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:43:13.118548 [info ] [MainThread]: 
[0m15:43:13.121245 [error] [MainThread]:   INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/f6217cd3-2c19-4b50-b7f1-29f02e3d4062' before retrying. Athena will not delete data in your account.
[0m15:43:13.123600 [info ] [MainThread]: 
[0m15:43:13.128486 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m15:43:13.166379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 307.01288, "process_user_time": 13.797003, "process_kernel_time": 1.404836, "process_mem_max_rss": "208808", "process_out_blocks": "3090", "command_success": false, "process_in_blocks": "0"}
[0m15:43:13.177084 [debug] [MainThread]: Command `dbt run` failed at 15:43:13.171717 after 307.02 seconds
[0m15:43:13.182326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c64b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c655d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a1c410>]}
[0m15:43:13.183740 [debug] [MainThread]: Flushing usage events
[0m15:46:12.118655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1638d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b093d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa16390d0>]}


============================== 15:46:12.121318 | cfe854a1-ac36-4520-b3d6-ab3a1da47011 ==============================
[0m15:46:12.121318 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:46:12.121872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'send_anonymous_usage_stats': 'True'}
[0m15:46:12.497946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfe854a1-ac36-4520-b3d6-ab3a1da47011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa06b66d0>]}
[0m15:46:12.556010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfe854a1-ac36-4520-b3d6-ab3a1da47011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b09290>]}
[0m15:46:12.556660 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:46:12.563311 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m15:46:12.585375 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:46:12.585941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cfe854a1-ac36-4520-b3d6-ab3a1da47011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa056c650>]}
[0m15:46:13.413445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfe854a1-ac36-4520-b3d6-ab3a1da47011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa04a1610>]}
[0m15:46:13.440548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfe854a1-ac36-4520-b3d6-ab3a1da47011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa04a1f50>]}
[0m15:46:13.441112 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m15:46:13.441860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfe854a1-ac36-4520-b3d6-ab3a1da47011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0631310>]}
[0m15:46:13.443806 [info ] [MainThread]: 
[0m15:46:13.444840 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:46:13.447030 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:46:13.447555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:14.290006 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:46:14.297763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m15:46:14.298621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:15.832549 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m15:46:15.839201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m15:46:15.845580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:17.364519 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:46:17.368987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m15:46:17.371964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:21.184365 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:46:21.199619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfe854a1-ac36-4520-b3d6-ab3a1da47011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0443750>]}
[0m15:46:21.203256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:21.204517 [info ] [MainThread]: 
[0m15:46:21.210287 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m15:46:21.211557 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m15:46:21.213283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.weather_data_gold)
[0m15:46:21.213808 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m15:46:21.227537 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:46:21.232061 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 15:46:21.214250 => 15:46:21.231634
[0m15:46:21.232498 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m15:46:21.271184 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:46:21.271865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:22.574112 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:46:22.575922 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
    
),

openmeteo AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
    
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:46:23.220624 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f0f28c18-91ef-40fc-8e25-94fdde7ea1af
[0m15:46:30.749238 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d838414e-886c-43ad-830b-41e07043ba09
[0m15:46:44.290603 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bc8f3a97-0d49-4d47-8688-bdcea5dd2495
[0m15:47:09.856001 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID dade0aa6-c894-4c71-bdee-4683d09a202e
[0m15:47:13.077762 [error] [MainThread]: CANCEL query model.silver.weather_data_gold .................................... [[31mCANCEL[0m]
[0m15:47:13.350461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:13.351268 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was left open.
[0m15:47:13.351943 [debug] [MainThread]: On model.silver.weather_data_gold: Close
[0m15:47:13.353109 [info ] [MainThread]: 
[0m15:47:13.354190 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 59.91 seconds (59.91s).
[0m15:47:13.355658 [error] [MainThread]: Encountered an error:

[0m15:47:13.368375 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:47:13.372673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 61.280422, "process_user_time": 5.138082, "process_kernel_time": 1.034867, "process_mem_max_rss": "187208", "process_out_blocks": "1990", "command_success": false, "process_in_blocks": "0"}
[0m15:47:13.373574 [debug] [MainThread]: Command `dbt run` failed at 15:47:13.373414 after 61.28 seconds
[0m15:47:13.374419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b093d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b096d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb2d710>]}
[0m15:47:13.375808 [debug] [MainThread]: Flushing usage events
[0m15:47:43.630041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81deb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83457510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81deaf50>]}


============================== 15:47:43.632404 | 2d0923d0-0a7d-4692-86ea-b8506d6885c2 ==============================
[0m15:47:43.632404 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:47:43.633010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:47:44.061855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d0923d0-0a7d-4692-86ea-b8506d6885c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d7e690>]}
[0m15:47:44.112123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d0923d0-0a7d-4692-86ea-b8506d6885c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80df57d0>]}
[0m15:47:44.112931 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:47:44.120200 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m15:47:44.150223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:44.150818 [debug] [MainThread]: Partial parsing: updated file: silver://models/gold/weather_data_gold.sql
[0m15:47:44.307785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d0923d0-0a7d-4692-86ea-b8506d6885c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a18090>]}
[0m15:47:44.316864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d0923d0-0a7d-4692-86ea-b8506d6885c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ce4890>]}
[0m15:47:44.317281 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m15:47:44.317627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d0923d0-0a7d-4692-86ea-b8506d6885c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80507c50>]}
[0m15:47:44.319230 [info ] [MainThread]: 
[0m15:47:44.319868 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:47:44.320860 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:47:44.321169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:45.074015 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:47:45.080049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m15:47:45.081041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:46.556177 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:47:46.557849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m15:47:46.561018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:48.038307 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:47:48.041432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m15:47:48.044530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:49.364680 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m15:47:49.368888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d0923d0-0a7d-4692-86ea-b8506d6885c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b172d0>]}
[0m15:47:49.370822 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:49.371913 [info ] [MainThread]: 
[0m15:47:49.375663 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m15:47:49.376879 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m15:47:49.378598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.weather_data_gold)
[0m15:47:49.379808 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m15:47:49.391771 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:47:49.393996 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 15:47:49.380409 => 15:47:49.393710
[0m15:47:49.394547 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m15:47:49.442999 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:47:49.443554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:50.152128 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:47:50.167650 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:47:50.767590 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d3e910c8-1035-4fac-bcd6-31cda3605f5a
[0m15:47:58.515618 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 65af7dee-efb7-4659-bcec-2c96ad077349
[0m15:48:12.186461 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b451120f-d33a-48e9-8c89-e2a32085116d
[0m15:48:37.715625 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5d3495d2-077d-410a-9498-95bdaef6f5d6
[0m15:48:39.396098 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":0,"data_scanned_in_bytes":0}
[0m15:48:39.417561 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m15:48:39.418291 [debug] [Thread-1 (]: On model.silver.weather_data_gold: alter table `AwsDataCatalog`.`gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m15:48:39.703946 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 867237fe-a572-4627-b94d-c9039da8dd2c
[0m15:48:41.423125 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:48:41.436169 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m15:48:41.443294 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m15:48:41.444188 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":0,"data_scanned_in_bytes":0}';
[0m15:48:41.678033 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cd6dbc23-c4be-4786-81ba-6017f747e61b
[0m15:48:43.402291 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m15:48:43.433378 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 15:47:49.394975 => 15:48:43.432413
[0m15:48:43.434657 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m15:48:43.437527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d0923d0-0a7d-4692-86ea-b8506d6885c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80cb73d0>]}
[0m15:48:43.440363 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 0[0m in 54.06s]
[0m15:48:43.442055 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m15:48:43.451785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:43.452681 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:48:43.460012 [info ] [MainThread]: 
[0m15:48:43.462308 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 59.14 seconds (59.14s).
[0m15:48:43.463985 [debug] [MainThread]: Command end result
[0m15:48:43.489814 [info ] [MainThread]: 
[0m15:48:43.490518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:48:43.491175 [info ] [MainThread]: 
[0m15:48:43.491691 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:48:43.494873 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 59.891712, "process_user_time": 3.337984, "process_kernel_time": 0.502228, "process_mem_max_rss": "184080", "process_out_blocks": "2955", "process_in_blocks": "0"}
[0m15:48:43.496448 [debug] [MainThread]: Command `dbt run` succeeded at 15:48:43.496279 after 59.89 seconds
[0m15:48:43.497403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831f5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87028c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87029a50>]}
[0m15:48:43.498046 [debug] [MainThread]: Flushing usage events
[0m15:50:01.645312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61ef210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61eed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa61ece50>]}


============================== 15:50:01.647202 | 799a1354-3e77-4e78-a22a-6b9e36438376 ==============================
[0m15:50:01.647202 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:50:01.648064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:50:01.915384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5096b50>]}
[0m15:50:01.958952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa606a790>]}
[0m15:50:01.959445 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m15:50:01.964817 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m15:50:01.974289 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:50:01.974719 [debug] [MainThread]: previous checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, current checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387
[0m15:50:01.975029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa512ad90>]}
[0m15:50:02.655038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4d15d10>]}
[0m15:50:02.665261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4932b50>]}
[0m15:50:02.665614 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m15:50:02.665940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa503af50>]}
[0m15:50:02.667292 [info ] [MainThread]: 
[0m15:50:02.667900 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:50:02.669175 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:50:02.669484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:03.499933 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:50:03.507418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m15:50:03.508421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:05.197585 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:50:05.200150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m15:50:05.202625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:06.627380 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:50:06.631860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m15:50:06.636461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:08.052529 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m15:50:08.056255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d4d4510>]}
[0m15:50:08.057951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:08.058976 [info ] [MainThread]: 
[0m15:50:08.062908 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m15:50:08.063944 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m15:50:08.065335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.eia_silver)
[0m15:50:08.065967 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m15:50:08.077207 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:50:08.079966 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 15:50:08.066413 => 15:50:08.079595
[0m15:50:08.080521 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m15:50:08.115846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:09.348462 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:50:09.350740 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:50:09.354578 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:50:10.858295 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m15:50:10.861625 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:50:10.863474 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/gold/silver/eia_silver/f84c2fbe-3687-451c-a067-4941d5be2598
[0m15:50:11.512028 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:50:13.197503 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:50:13.253266 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:50:13.777264 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:50:13.780112 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/cf59567b-41ed-4990-b84d-bcfef5d84c49',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m15:50:14.368520 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8a95a726-7097-4f24-896c-387fb4b59a13
[0m15:50:17.145615 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:50:17.152910 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:50:17.153706 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:50:17.401065 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8375745c-f0d7-4dd5-83d8-09f198f0a6f4
[0m15:50:19.056495 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:50:19.064317 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:50:19.067765 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m15:50:19.068603 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:50:19.268349 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 405953a8-1256-494f-9ad7-d5e57033a366
[0m15:50:20.987453 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m15:50:21.003961 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 15:50:08.080920 => 15:50:21.003535
[0m15:50:21.005128 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m15:50:21.007285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4082610>]}
[0m15:50:21.010274 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.eia_silver ............................ [[32mOK 2842[0m in 12.94s]
[0m15:50:21.011681 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m15:50:21.012509 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m15:50:21.013662 [info ] [Thread-1 (]: 2 of 5 START sql table model silver.noaa_silver ................................ [RUN]
[0m15:50:21.018024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:50:21.018602 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m15:50:21.023826 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:50:21.025621 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 15:50:21.018910 => 15:50:21.025420
[0m15:50:21.026102 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m15:50:21.034776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:22.561638 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:50:22.564421 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:50:22.566136 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:50:24.389414 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m15:50:24.391355 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:50:24.392411 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/gold/silver/noaa_silver/9c0b8795-b2bd-4ac6-a659-0afdc60554f2
[0m15:50:24.953949 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:50:26.371127 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:50:26.376196 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:50:26.924015 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:50:26.925841 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/3d442a4b-ae70-4311-9580-665e8cc9e128',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:50:27.475668 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b7e620ce-7ec0-4ae5-b74b-3c74c2ccfcc5
[0m15:50:29.187279 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:50:29.188924 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:50:29.189318 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:50:29.458111 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2c067242-5dc7-4550-ac05-7156eae7eb3a
[0m15:50:31.143143 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:50:31.151832 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:50:31.156174 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m15:50:31.156551 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:50:31.356302 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e3fd20c6-0b2d-4583-9469-4718debcd219
[0m15:50:33.023882 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m15:50:33.034792 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 15:50:21.026322 => 15:50:33.033615
[0m15:50:33.036031 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m15:50:33.039727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d81d790>]}
[0m15:50:33.042651 [info ] [Thread-1 (]: 2 of 5 OK created sql table model silver.noaa_silver ........................... [[32mOK 305[0m in 12.02s]
[0m15:50:33.044472 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m15:50:33.045856 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m15:50:33.048953 [info ] [Thread-1 (]: 3 of 5 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m15:50:33.056963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:50:33.057972 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m15:50:33.071993 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:50:33.073931 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 15:50:33.058571 => 15:50:33.073703
[0m15:50:33.074342 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m15:50:33.079009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:34.577658 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:50:34.580074 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:50:34.582327 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:50:35.760508 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m15:50:35.760994 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:50:35.761333 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/gold/silver/openmeteo_silver/d1f0bc28-f52d-498a-aee3-3aae20594568
[0m15:50:36.292580 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:50:37.876905 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:50:37.883091 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:50:38.404401 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:50:38.407032 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/beb8dc83-86b3-4174-a40b-70567ef5e514',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m15:50:39.002747 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 05ce4b70-5fbb-4277-9643-ac09c9789e5a
[0m15:50:41.798655 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m15:50:41.803839 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:50:41.804496 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:50:42.061172 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 03b42df0-1a9f-4e52-ab10-b106ac47afcf
[0m15:50:43.696837 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:50:43.716545 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:50:43.720263 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m15:50:43.720906 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m15:50:43.913566 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5ddb9b61-813c-4427-8993-9fdfa84dd0ee
[0m15:50:45.611179 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m15:50:45.620935 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 15:50:33.074631 => 15:50:45.619989
[0m15:50:45.622594 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m15:50:45.625882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d25f990>]}
[0m15:50:45.631227 [info ] [Thread-1 (]: 3 of 5 OK created sql table model silver.openmeteo_silver ...................... [[32mOK 12458[0m in 12.57s]
[0m15:50:45.634470 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m15:50:45.635768 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m15:50:45.637283 [info ] [Thread-1 (]: 4 of 5 START sql table model silver.openweather_silver ......................... [RUN]
[0m15:50:45.643607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:50:45.644246 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m15:50:45.655873 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:50:45.657398 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 15:50:45.644651 => 15:50:45.657208
[0m15:50:45.657902 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m15:50:45.663119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:47.196716 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:50:47.198567 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:50:47.200664 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:50:48.365940 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m15:50:48.367521 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:50:48.368520 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/gold/silver/openweather_silver/f3b632bd-6385-4d19-a855-7335418dc4b5
[0m15:50:48.949662 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:50:50.572878 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:50:50.580019 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:50:51.114482 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:50:51.117649 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/cabb5cdb-f968-480b-bbb5-0de4c8c4aedc',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m15:50:51.685716 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4238b992-760d-40c5-a3e3-878fd547c6ab
[0m15:50:54.471683 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m15:50:54.476653 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:50:54.477550 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:50:54.756184 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID def40710-fa29-42b3-875b-a3a665240bee
[0m15:50:56.401283 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:50:56.415928 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:50:56.421745 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m15:50:56.422745 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m15:50:56.620096 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID aae9d8f7-829b-4483-8cb0-7ee57f146efa
[0m15:50:58.297519 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m15:50:58.309926 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 15:50:45.658482 => 15:50:58.308847
[0m15:50:58.311224 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m15:50:58.314757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d2583d0>]}
[0m15:50:58.317424 [info ] [Thread-1 (]: 4 of 5 OK created sql table model silver.openweather_silver .................... [[32mOK 473[0m in 12.68s]
[0m15:50:58.319276 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m15:50:58.320832 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m15:50:58.325900 [info ] [Thread-1 (]: 5 of 5 START sql table model silver.sensor_silver .............................. [RUN]
[0m15:50:58.332387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:50:58.333116 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m15:50:58.350040 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:50:58.352178 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 15:50:58.333565 => 15:50:58.351912
[0m15:50:58.352833 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m15:50:58.360562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:59.759220 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:50:59.760746 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:50:59.762555 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m15:51:01.176827 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m15:51:01.179967 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:51:01.180628 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/gold/silver/sensor_silver/71b1f3f3-3393-4cde-9d78-fb3ded62632a
[0m15:51:01.733960 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:51:03.269453 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:51:03.286091 [debug] [Thread-1 (]: Skip partitioning: False
[0m15:51:03.819514 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:51:03.824713 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/fea799a7-e9d4-468d-8203-61a6d3e81b5a',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m15:51:04.393485 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e3251f07-dfb2-4e4f-9fab-5bb7999c8656
[0m15:51:07.170921 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m15:51:07.172446 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:51:07.172854 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:51:07.434388 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2c0b33a9-45c0-4d2c-a334-65a8fb0f3f50
[0m15:51:09.073574 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m15:51:09.080479 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:51:09.082776 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m15:51:09.083169 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m15:51:09.327980 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID dd2da481-963a-4deb-b88b-8f9203cf8d9d
[0m15:51:11.062623 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m15:51:11.072685 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 15:50:58.353302 => 15:51:11.071079
[0m15:51:11.073895 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m15:51:11.076357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '799a1354-3e77-4e78-a22a-6b9e36438376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa450b650>]}
[0m15:51:11.078304 [info ] [Thread-1 (]: 5 of 5 OK created sql table model silver.sensor_silver ......................... [[32mOK 700[0m in 12.75s]
[0m15:51:11.080166 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m15:51:11.087204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:11.088414 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m15:51:11.096735 [info ] [MainThread]: 
[0m15:51:11.097597 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 8.43 seconds (68.43s).
[0m15:51:11.099668 [debug] [MainThread]: Command end result
[0m15:51:11.139661 [info ] [MainThread]: 
[0m15:51:11.140272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:11.140749 [info ] [MainThread]: 
[0m15:51:11.141260 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:51:11.143569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 69.52292, "process_user_time": 6.777305, "process_kernel_time": 0.93124, "process_mem_max_rss": "186840", "process_out_blocks": "3001", "process_in_blocks": "0"}
[0m15:51:11.144251 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:11.144102 after 69.52 seconds
[0m15:51:11.144900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6505510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c05a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa783a850>]}
[0m15:51:11.145280 [debug] [MainThread]: Flushing usage events
[0m16:01:57.966206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface38650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad309250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface38990>]}


============================== 16:01:57.969151 | b6824cd6-0d67-4100-b0fd-8f7b7414274f ==============================
[0m16:01:57.969151 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:01:57.969757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:01:58.293644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6824cd6-0d67-4100-b0fd-8f7b7414274f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabf7e690>]}
[0m16:01:58.336822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6824cd6-0d67-4100-b0fd-8f7b7414274f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabfd0890>]}
[0m16:01:58.337381 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:01:58.343461 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m16:01:58.353358 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:01:58.353937 [debug] [MainThread]: previous checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, current checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a
[0m16:01:58.354385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6824cd6-0d67-4100-b0fd-8f7b7414274f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface33290>]}
[0m16:01:59.158395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6824cd6-0d67-4100-b0fd-8f7b7414274f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabdd62d0>]}
[0m16:01:59.176022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6824cd6-0d67-4100-b0fd-8f7b7414274f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac033dd0>]}
[0m16:01:59.176803 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m16:01:59.177421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6824cd6-0d67-4100-b0fd-8f7b7414274f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac018390>]}
[0m16:01:59.179332 [info ] [MainThread]: 
[0m16:01:59.180286 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:01:59.182416 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:01:59.183303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:59.923104 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:01:59.925346 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_bronze'
[0m16:01:59.925820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:01.303966 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:02:01.305125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m16:02:01.306146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:02.807935 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:02:02.811591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m16:02:02.815227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:04.380782 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:02:04.387399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6824cd6-0d67-4100-b0fd-8f7b7414274f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb48a50>]}
[0m16:02:04.389208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:04.390087 [info ] [MainThread]: 
[0m16:02:04.393409 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m16:02:04.394398 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m16:02:04.395846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.weather_data_gold)
[0m16:02:04.396544 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m16:02:04.410480 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m16:02:04.415371 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 16:02:04.397202 => 16:02:04.413838
[0m16:02:04.416420 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m16:02:04.447430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:05.690042 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold
[0m16:02:05.692298 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:02:05.696153 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:02:06.913516 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold
[0m16:02:06.914642 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:02:06.915197 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m16:02:08.186400 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:02:09.677172 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m16:02:09.716003 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:02:10.905985 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:02:10.910361 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        cast(cast(ingestion_timestamp as timestamp) as date) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m16:02:11.550257 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0acbad49-3b12-4b00-a01a-45c92463aa4c
[0m16:02:19.095984 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID dc8bed58-af5f-47ba-a734-6c06c250c9bb
[0m16:02:32.676775 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 61670416-312a-4a16-ae67-7d970d5fc99d
[0m16:02:58.257672 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c044d602-e97b-4cf5-a55b-ab4b267d81cb
[0m16:03:48.219803 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d0136e5e-e040-49f9-8e73-88fc7601c72e
[0m16:05:26.166317 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID afd02a4e-2940-48c9-9656-478feb145739
[0m16:05:27.513384 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/afd02a4e-2940-48c9-9656-478feb145739' before retrying. Athena will not delete data in your account.
[0m16:05:27.517621 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 16:02:04.416953 => 16:05:27.516582
[0m16:05:27.518868 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m16:05:27.526297 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/afd02a4e-2940-48c9-9656-478feb145739' before retrying. Athena will not delete data in your account.
[0m16:05:27.547498 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/afd02a4e-2940-48c9-9656-478feb145739' before retrying. Athena will not delete data in your account.

[0m16:05:27.550783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6824cd6-0d67-4100-b0fd-8f7b7414274f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30ca710>]}
[0m16:05:27.553210 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model gold.weather_data_gold ................... [[31mERROR[0m in 203.15s]
[0m16:05:27.554401 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m16:05:27.563176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:27.563654 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m16:05:27.563856 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m16:05:27.565310 [info ] [MainThread]: 
[0m16:05:27.565785 [info ] [MainThread]: Finished running 1 table model in 0 hours 3 minutes and 28.39 seconds (208.39s).
[0m16:05:27.567833 [debug] [MainThread]: Command end result
[0m16:05:27.610260 [info ] [MainThread]: 
[0m16:05:27.611326 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:05:27.611819 [info ] [MainThread]: 
[0m16:05:27.612168 [error] [MainThread]:   INVALID_CAST_ARGUMENT: Value cannot be cast to timestamp: 2026-01-20T17:21:17.101973. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/afd02a4e-2940-48c9-9656-478feb145739' before retrying. Athena will not delete data in your account.
[0m16:05:27.612535 [info ] [MainThread]: 
[0m16:05:27.612942 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:05:27.620339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 209.68575, "process_user_time": 3.981795, "process_kernel_time": 1.12602, "process_mem_max_rss": "200908", "process_out_blocks": "2960", "command_success": false, "process_in_blocks": "0"}
[0m16:05:27.623445 [debug] [MainThread]: Command `dbt run` failed at 16:05:27.623167 after 209.69 seconds
[0m16:05:27.628419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2229510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33c5ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacff3910>]}
[0m16:05:27.629956 [debug] [MainThread]: Flushing usage events
[0m16:11:56.951865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f1f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f17c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f17210>]}


============================== 16:11:56.955422 | 1deed357-e6da-48e6-8430-84cf9ad3cc4e ==============================
[0m16:11:56.955422 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:11:56.957157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:11:57.334762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f5e690>]}
[0m16:11:57.388524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d9f850>]}
[0m16:11:57.389553 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:11:57.395616 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m16:11:57.407916 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:11:57.408424 [debug] [MainThread]: previous checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, current checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387
[0m16:11:57.408765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e1b710>]}
[0m16:11:58.193301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91daf710>]}
[0m16:11:58.201067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fd4a50>]}
[0m16:11:58.201489 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m16:11:58.201904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917225d0>]}
[0m16:11:58.203540 [info ] [MainThread]: 
[0m16:11:58.204173 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:11:58.205047 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:11:58.205330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:58.932807 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:11:58.937008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m16:11:58.937934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:00.426348 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:12:00.429072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m16:12:00.432438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:01.718744 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Schema 'gold' does not exist - Ignoring: An error occurred (EntityNotFoundException) when calling the GetTables operation: Database gold not found.
[0m16:12:01.722190 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:12:01.724745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m16:12:01.725634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:03.187038 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:12:03.190496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900902d0>]}
[0m16:12:03.192337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:12:03.193296 [info ] [MainThread]: 
[0m16:12:03.196974 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m16:12:03.197927 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m16:12:03.199537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.eia_silver)
[0m16:12:03.200300 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m16:12:03.211546 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m16:12:03.215165 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 16:12:03.200689 => 16:12:03.214758
[0m16:12:03.215765 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m16:12:03.251174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:04.467334 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m16:12:04.469659 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:12:04.473778 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:12:05.675412 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m16:12:05.677193 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:12:05.678002 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/cf59567b-41ed-4990-b84d-bcfef5d84c49
[0m16:12:07.018022 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/cf59567b-41ed-4990-b84d-bcfef5d84c49', bucket='climate-energy-raw-data', prefix='silver/eia_silver/cf59567b-41ed-4990-b84d-bcfef5d84c49/'
[0m16:12:10.047407 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m16:12:10.104104 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:12:11.295973 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:12:11.297957 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/20a37f8e-e465-4931-9802-25d60214f1c0',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m16:12:11.942765 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 537739a9-89e9-408b-a6e9-89f7066b0e0f
[0m16:12:14.727919 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m16:12:14.745671 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m16:12:14.746651 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m16:12:15.000686 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6c7dd31d-0f94-49de-b2b6-568c09e91dad
[0m16:12:16.693434 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:12:16.699683 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m16:12:16.701978 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m16:12:16.702246 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m16:12:16.925380 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5f23f388-a9e0-4abd-87d7-e1a668d3de09
[0m16:12:18.640258 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m16:12:18.667596 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 16:12:03.216109 => 16:12:18.666784
[0m16:12:18.668679 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m16:12:18.671152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad2a490>]}
[0m16:12:18.673783 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.eia_silver ............................ [[32mOK 2842[0m in 15.47s]
[0m16:12:18.675458 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m16:12:18.676621 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m16:12:18.678420 [info ] [Thread-1 (]: 2 of 5 START sql table model silver.noaa_silver ................................ [RUN]
[0m16:12:18.684921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m16:12:18.685716 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m16:12:18.698773 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m16:12:18.701204 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 16:12:18.686096 => 16:12:18.700910
[0m16:12:18.701708 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m16:12:18.706188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:20.185396 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m16:12:20.188020 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:12:20.189340 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:12:21.468793 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m16:12:21.469831 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:12:21.470696 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/3d442a4b-ae70-4311-9580-665e8cc9e128
[0m16:12:22.730026 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/3d442a4b-ae70-4311-9580-665e8cc9e128', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/3d442a4b-ae70-4311-9580-665e8cc9e128/'
[0m16:12:24.890455 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m16:12:24.897588 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:12:25.440562 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:12:25.443067 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/f2cd3c5f-5a33-4338-8329-9d74c2541f64',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m16:12:26.008045 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 493b5cbe-baa2-46d4-ad5a-b8e39a752094
[0m16:12:28.803575 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m16:12:28.825144 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m16:12:28.826021 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m16:12:29.080469 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a9d977c0-c5b2-49e6-b4ef-20e33be10906
[0m16:12:30.707811 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:12:30.719219 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m16:12:30.723507 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m16:12:30.724285 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m16:12:30.911638 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5b92acc8-a746-491d-8e28-d75f42e62890
[0m16:12:32.623691 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m16:12:32.632690 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 16:12:18.702038 => 16:12:32.631825
[0m16:12:32.633928 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m16:12:32.637326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8946d5d0>]}
[0m16:12:32.640234 [info ] [Thread-1 (]: 2 of 5 OK created sql table model silver.noaa_silver ........................... [[32mOK 305[0m in 13.96s]
[0m16:12:32.641758 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m16:12:32.643146 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m16:12:32.644707 [info ] [Thread-1 (]: 3 of 5 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m16:12:32.651152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m16:12:32.651727 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m16:12:32.672344 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m16:12:32.674004 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 16:12:32.652121 => 16:12:32.673804
[0m16:12:32.674380 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m16:12:32.677831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:34.143913 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m16:12:34.144515 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:12:34.144941 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:12:35.299816 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m16:12:35.301218 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:12:35.302127 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/beb8dc83-86b3-4174-a40b-70567ef5e514
[0m16:12:35.896540 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/beb8dc83-86b3-4174-a40b-70567ef5e514', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/beb8dc83-86b3-4174-a40b-70567ef5e514/'
[0m16:12:38.206802 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m16:12:38.222248 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:12:39.436908 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:12:39.440015 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/fa32a8f9-b5d0-47cc-8b71-82ae855b77c7',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m16:12:40.029736 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 22ce8a4d-e5f4-479a-b692-1010dee76349
[0m16:12:42.861469 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m16:12:42.868120 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m16:12:42.869095 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m16:12:43.142550 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d30e5c38-7ea1-405b-a8f5-9460ef8dbdc9
[0m16:12:44.810205 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:12:44.819827 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m16:12:44.824673 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m16:12:44.825478 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m16:12:45.023627 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 96238ff9-46e9-4999-a40f-4f8c49b8718b
[0m16:12:46.843542 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m16:12:46.855859 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 16:12:32.674668 => 16:12:46.855352
[0m16:12:46.857073 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m16:12:46.859489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907f04d0>]}
[0m16:12:46.861460 [info ] [Thread-1 (]: 3 of 5 OK created sql table model silver.openmeteo_silver ...................... [[32mOK 12458[0m in 14.21s]
[0m16:12:46.862578 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m16:12:46.863962 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m16:12:46.865231 [info ] [Thread-1 (]: 4 of 5 START sql table model silver.openweather_silver ......................... [RUN]
[0m16:12:46.869992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m16:12:46.870843 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m16:12:46.879648 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m16:12:46.883749 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 16:12:46.871209 => 16:12:46.883414
[0m16:12:46.884744 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m16:12:46.893119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:48.572777 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m16:12:48.575819 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:12:48.577765 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:12:49.816873 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m16:12:49.819556 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:12:49.820666 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/cabb5cdb-f968-480b-bbb5-0de4c8c4aedc
[0m16:12:51.095758 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/cabb5cdb-f968-480b-bbb5-0de4c8c4aedc', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/cabb5cdb-f968-480b-bbb5-0de4c8c4aedc/'
[0m16:12:53.974829 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m16:12:53.983518 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:12:54.549954 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:12:54.552246 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/804e43f8-8175-4ef7-ad4f-ec1e4f7ee0ea',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m16:12:55.123129 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7f330e01-feb9-4a56-8688-3579240071f1
[0m16:12:58.005660 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m16:12:58.017713 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m16:12:58.018801 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m16:12:58.323040 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3c755200-9823-4906-81f1-b9dea202804e
[0m16:12:59.946351 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:12:59.955166 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m16:12:59.956827 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m16:12:59.957095 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m16:13:00.159230 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0bc17fff-344f-4772-8f5a-6ed4b450d7b2
[0m16:13:01.879120 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m16:13:01.892517 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 16:12:46.885480 => 16:13:01.891475
[0m16:13:01.893954 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m16:13:01.897211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895dd290>]}
[0m16:13:01.900201 [info ] [Thread-1 (]: 4 of 5 OK created sql table model silver.openweather_silver .................... [[32mOK 473[0m in 15.03s]
[0m16:13:01.902031 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m16:13:01.904019 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m16:13:01.908744 [info ] [Thread-1 (]: 5 of 5 START sql table model silver.sensor_silver .............................. [RUN]
[0m16:13:01.919156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m16:13:01.919962 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m16:13:01.944927 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m16:13:01.948273 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 16:13:01.920469 => 16:13:01.948025
[0m16:13:01.953948 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m16:13:02.042830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:03.512186 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m16:13:03.514300 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:13:03.515546 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:13:04.723443 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m16:13:04.724510 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:13:04.725377 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/fea799a7-e9d4-468d-8203-61a6d3e81b5a
[0m16:13:05.318503 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/fea799a7-e9d4-468d-8203-61a6d3e81b5a', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/fea799a7-e9d4-468d-8203-61a6d3e81b5a/'
[0m16:13:07.484408 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m16:13:07.489219 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:13:08.033675 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:13:08.035743 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/3f209d17-1246-452b-896b-bc85f593d932',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m16:13:08.610513 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 98671727-40ad-4c92-8c99-54a099d86841
[0m16:13:11.406642 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m16:13:11.412869 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m16:13:11.413878 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m16:13:11.666607 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 39ff2499-98e2-4fdc-8c11-a09167026e28
[0m16:13:13.316218 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:13:13.324946 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m16:13:13.329709 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m16:13:13.330514 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m16:13:13.536235 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 46cf2c4d-82e1-42a9-9391-2ec17736ea7f
[0m16:13:15.266446 [debug] [Thread-1 (]: SQL status: OK 700 in 2.0 seconds
[0m16:13:15.277844 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 16:13:01.967678 => 16:13:15.276742
[0m16:13:15.279612 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m16:13:15.283101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1deed357-e6da-48e6-8430-84cf9ad3cc4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b43c50>]}
[0m16:13:15.286997 [info ] [Thread-1 (]: 5 of 5 OK created sql table model silver.sensor_silver ......................... [[32mOK 700[0m in 13.37s]
[0m16:13:15.289810 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m16:13:15.300530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:15.301573 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m16:13:15.310950 [info ] [MainThread]: 
[0m16:13:15.312975 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 17.11 seconds (77.11s).
[0m16:13:15.319337 [debug] [MainThread]: Command end result
[0m16:13:15.348522 [info ] [MainThread]: 
[0m16:13:15.349151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:15.349624 [info ] [MainThread]: 
[0m16:13:15.350008 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:13:15.355238 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 78.451744, "process_user_time": 7.51721, "process_kernel_time": 1.216034, "process_mem_max_rss": "187760", "process_out_blocks": "2998", "process_in_blocks": "0"}
[0m16:13:15.358493 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:15.358278 after 78.46 seconds
[0m16:13:15.361593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93905b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981e8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980aafd0>]}
[0m16:13:15.363185 [debug] [MainThread]: Flushing usage events
[0m16:13:23.378588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9980d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9980dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9980dc50>]}


============================== 16:13:23.380301 | 9303e7cf-bd2f-421c-98a5-40200d9f00d8 ==============================
[0m16:13:23.380301 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:13:23.380787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:13:23.636334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9303e7cf-bd2f-421c-98a5-40200d9f00d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993a6690>]}
[0m16:13:23.678636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9303e7cf-bd2f-421c-98a5-40200d9f00d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993a6690>]}
[0m16:13:23.679209 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:13:23.685035 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m16:13:23.701363 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:13:23.701894 [debug] [MainThread]: previous checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, current checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a
[0m16:13:23.702234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9303e7cf-bd2f-421c-98a5-40200d9f00d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98423350>]}
[0m16:13:24.437811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9303e7cf-bd2f-421c-98a5-40200d9f00d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981857d0>]}
[0m16:13:24.448478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9303e7cf-bd2f-421c-98a5-40200d9f00d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9794b3d0>]}
[0m16:13:24.448886 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m16:13:24.449238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9303e7cf-bd2f-421c-98a5-40200d9f00d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9819d310>]}
[0m16:13:24.450468 [info ] [MainThread]: 
[0m16:13:24.451057 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:13:24.451882 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:13:24.452156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:25.105082 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:13:25.108041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now create_AwsDataCatalog_gold)
[0m16:13:25.111292 [debug] [ThreadPool]: Creating schema "database: "AwsDataCatalog"
schema: "gold"
"
[0m16:13:25.124808 [debug] [ThreadPool]: Using athena connection "create_AwsDataCatalog_gold"
[0m16:13:25.125476 [debug] [ThreadPool]: On create_AwsDataCatalog_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "connection_name": "create_AwsDataCatalog_gold"} */
create schema if not exists `AwsDataCatalog`.`gold`
  
[0m16:13:25.125962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:25.801897 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Athena query ID 5d5341b7-3de8-46e6-8556-6201981f52da
[0m16:13:27.697379 [debug] [ThreadPool]: SQL status: OK -1 in 3.0 seconds
[0m16:13:27.701647 [debug] [ThreadPool]: dbt.adapters.athena.constants adapter: Lakeformation is disabled for "AwsDataCatalog"."gold"
[0m16:13:27.703771 [debug] [ThreadPool]: On create_AwsDataCatalog_gold: Close
[0m16:13:27.711670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m16:13:27.712649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:29.190761 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:13:29.192720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m16:13:29.196376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:30.776049 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:13:30.779423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m16:13:30.781265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:32.076056 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:13:32.079393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9303e7cf-bd2f-421c-98a5-40200d9f00d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957c6750>]}
[0m16:13:32.082606 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:13:32.084094 [info ] [MainThread]: 
[0m16:13:32.095416 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m16:13:32.096706 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m16:13:32.098388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.weather_data_gold)
[0m16:13:32.099079 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m16:13:32.130326 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m16:13:32.134931 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 16:13:32.099668 => 16:13:32.133395
[0m16:13:32.136177 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m16:13:32.190180 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:13:32.190730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:32.795063 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:13:32.797414 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m16:13:33.362597 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4080b0f3-dfc1-41e2-acfd-0b50eb5a00ef
[0m16:13:35.237825 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12931,"data_scanned_in_bytes":88741}
[0m16:13:35.241488 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m16:13:35.242145 [debug] [Thread-1 (]: On model.silver.weather_data_gold: alter table `AwsDataCatalog`.`gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m16:13:35.522965 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ed60a59c-b7a4-43df-8494-792f44b99f4d
[0m16:13:37.367403 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:13:37.423919 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m16:13:37.443365 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m16:13:37.445039 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":12931,"data_scanned_in_bytes":88741}';
[0m16:13:37.651572 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d4beaa81-61c4-4e3a-8345-221490a1b53d
[0m16:13:39.380216 [debug] [Thread-1 (]: SQL status: OK 12931 in 2.0 seconds
[0m16:13:39.410140 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 16:13:32.137143 => 16:13:39.409707
[0m16:13:39.410933 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m16:13:39.412576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9303e7cf-bd2f-421c-98a5-40200d9f00d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98431610>]}
[0m16:13:39.414025 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 12931[0m in 7.31s]
[0m16:13:39.415472 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m16:13:39.423774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:39.424861 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m16:13:39.430177 [info ] [MainThread]: 
[0m16:13:39.431903 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.98 seconds (14.98s).
[0m16:13:39.437248 [debug] [MainThread]: Command end result
[0m16:13:39.479653 [info ] [MainThread]: 
[0m16:13:39.482147 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:39.485811 [info ] [MainThread]: 
[0m16:13:39.486601 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:13:39.496920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.13733, "process_user_time": 3.752343, "process_kernel_time": 0.415555, "process_mem_max_rss": "189884", "process_out_blocks": "2948", "process_in_blocks": "0"}
[0m16:13:39.498343 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:39.497980 after 16.14 seconds
[0m16:13:39.500591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7d5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7d4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7d5890>]}
[0m16:13:39.502065 [debug] [MainThread]: Flushing usage events
[0m16:22:14.683589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d59b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d701550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc1ccd0>]}


============================== 16:22:14.751095 | 28305074-33a1-4a97-9a5f-33c2e4b35292 ==============================
[0m16:22:14.751095 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:22:14.751556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:22:15.981434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28305074-33a1-4a97-9a5f-33c2e4b35292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789d1dc0>]}
[0m16:22:16.011545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28305074-33a1-4a97-9a5f-33c2e4b35292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b554250>]}
[0m16:22:16.012128 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m16:22:16.030378 [debug] [MainThread]: checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, vars: {}, profile: gold, target: , version: 1.8.7
[0m16:22:16.113378 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:22:16.113878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '28305074-33a1-4a97-9a5f-33c2e4b35292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c12c970>]}
[0m16:22:17.569467 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:22:17.570169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '28305074-33a1-4a97-9a5f-33c2e4b35292', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff789c5400>]}
[0m16:22:17.812459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28305074-33a1-4a97-9a5f-33c2e4b35292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78d2b7f0>]}
[0m16:22:17.922214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28305074-33a1-4a97-9a5f-33c2e4b35292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78c929d0>]}
[0m16:22:17.922572 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m16:22:17.922798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28305074-33a1-4a97-9a5f-33c2e4b35292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78c000d0>]}
[0m16:22:17.924283 [info ] [MainThread]: 
[0m16:22:17.924698 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:22:17.926121 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:22:17.926973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:19.163263 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:22:19.175768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m16:22:19.176263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:20.605481 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:22:20.607999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m16:22:20.609285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:22.111022 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:22:22.119235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m16:22:22.128996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:23.265451 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:22:23.270311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28305074-33a1-4a97-9a5f-33c2e4b35292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ebc0a0>]}
[0m16:22:23.272234 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:22:23.272810 [info ] [MainThread]: 
[0m16:22:23.291721 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m16:22:23.292735 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m16:22:23.293455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.weather_data_gold)
[0m16:22:23.293792 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m16:22:23.306978 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m16:22:23.309677 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m16:22:23.336249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:22:24.578582 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m16:22:24.579836 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:22:24.583559 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:22:25.531729 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m16:22:25.532647 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:22:25.533013 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m16:22:26.120288 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m16:22:28.125852 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m16:22:28.180509 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:22:28.610988 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:22:28.613148 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m16:22:29.216173 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ec98aea7-a520-40bb-8401-596bd4a5b8e2
[0m16:22:31.991840 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12931,"data_scanned_in_bytes":88741}
[0m16:22:32.013185 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m16:22:32.013978 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m16:22:32.207779 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 352e9cd8-827c-4c9a-97f0-647aaa09a2e4
[0m16:22:33.916294 [debug] [Thread-1  ]: SQL status: OK -1 in 1.900 seconds
[0m16:22:33.932783 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m16:22:33.937314 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m16:22:33.938010 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":12931,"data_scanned_in_bytes":88741}';
[0m16:22:34.150261 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 82868cc0-1376-4fd4-94ce-4408a826df5a
[0m16:22:35.888036 [debug] [Thread-1  ]: SQL status: OK 12931 in 1.949 seconds
[0m16:22:35.914715 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m16:22:35.918580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28305074-33a1-4a97-9a5f-33c2e4b35292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ebc0a0>]}
[0m16:22:35.920503 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 12931[0m in 12.62s]
[0m16:22:35.922412 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m16:22:35.928472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:35.929123 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m16:22:35.931853 [info ] [MainThread]: 
[0m16:22:35.932407 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 18.01 seconds (18.01s).
[0m16:22:35.933843 [debug] [MainThread]: Command end result
[0m16:22:35.977763 [info ] [MainThread]: 
[0m16:22:35.978178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:35.978423 [info ] [MainThread]: 
[0m16:22:35.978736 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:22:35.981050 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.348993, "process_user_time": 5.007482, "process_kernel_time": 2.872595, "process_mem_max_rss": "178688", "process_out_blocks": "9516", "process_in_blocks": "0"}
[0m16:22:35.981654 [debug] [MainThread]: Command `dbt run` succeeded at 16:22:35.981585 after 21.35 seconds
[0m16:22:35.982021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d59b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c145160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b554250>]}
[0m16:22:35.982283 [debug] [MainThread]: Flushing usage events
[0m16:26:07.852054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc1171c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc831d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaccbf40>]}


============================== 16:26:07.867512 | 8a75b0eb-2c07-4ec7-a515-13d34f19c235 ==============================
[0m16:26:07.867512 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:26:07.868079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:26:08.397024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbd9c460>]}
[0m16:26:08.433075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a74f10>]}
[0m16:26:08.433855 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m16:26:08.454020 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:26:08.536927 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:26:08.537396 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2
[0m16:26:08.537622 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:26:08.537825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb1ed0a0>]}
[0m16:26:09.322080 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:26:09.322607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8393b50>]}
[0m16:26:09.537512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8042820>]}
[0m16:26:09.622353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d02400>]}
[0m16:26:09.622779 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m16:26:09.623036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d94460>]}
[0m16:26:09.624266 [info ] [MainThread]: 
[0m16:26:09.624667 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:26:09.629432 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:26:09.629829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:10.253015 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:26:10.256469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:10.885863 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:26:10.887366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:11.410376 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:26:11.419736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m16:26:11.420733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:12.577894 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:26:12.578866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m16:26:12.579519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:13.955195 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:26:13.959181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m16:26:13.961013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:15.238844 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:26:15.244620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8182b20>]}
[0m16:26:15.246624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:26:15.247491 [info ] [MainThread]: 
[0m16:26:15.271559 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m16:26:15.272625 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m16:26:15.273319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m16:26:15.273673 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m16:26:15.289716 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m16:26:15.292258 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m16:26:15.310966 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m16:26:15.312672 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m16:26:15.313008 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m16:26:15.313298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:15.866948 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID edf2c340-c9c4-4d09-86d9-3c7afc0e1cfe
[0m16:26:17.632049 [debug] [Thread-1  ]: SQL status: OK -1 in 2.317 seconds
[0m16:26:18.833904 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m16:26:18.837454 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m16:26:18.849138 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m16:26:18.851594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9548b50>]}
[0m16:26:18.852763 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 3.58s]
[0m16:26:18.854226 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m16:26:18.855046 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m16:26:18.856362 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m16:26:18.860865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m16:26:18.861628 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m16:26:18.866440 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m16:26:18.867946 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m16:26:18.870914 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m16:26:18.871962 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m16:26:18.872329 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m16:26:18.872644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:19.370773 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 42b98d39-034b-4159-86d3-40e982c7c409
[0m16:26:21.082413 [debug] [Thread-1  ]: SQL status: OK -1 in 2.208 seconds
[0m16:26:22.147881 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m16:26:22.151860 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m16:26:22.158247 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m16:26:22.160955 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb802a340>]}
[0m16:26:22.163912 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.30s]
[0m16:26:22.167202 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m16:26:22.170183 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m16:26:22.174663 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m16:26:22.178469 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m16:26:22.179172 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m16:26:22.191162 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m16:26:22.192918 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m16:26:22.201111 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m16:26:22.202209 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m16:26:22.202600 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m16:26:22.203057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:22.727037 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7bb00247-8d25-4717-ac91-a02338ee60ee
[0m16:26:24.465148 [debug] [Thread-1  ]: SQL status: OK -1 in 2.258 seconds
[0m16:26:25.812878 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m16:26:25.816706 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m16:26:25.819398 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m16:26:25.820756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc864c40>]}
[0m16:26:25.822509 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 3.64s]
[0m16:26:25.824456 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m16:26:25.825991 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m16:26:25.827653 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m16:26:25.831036 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m16:26:25.831811 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m16:26:25.840126 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m16:26:25.843935 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m16:26:25.847821 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m16:26:25.849086 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m16:26:25.849556 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m16:26:25.849999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:26.352899 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 44739b13-2cc6-43c8-8714-9d9f95ecb2bf
[0m16:26:28.064817 [debug] [Thread-1  ]: SQL status: OK -1 in 2.212 seconds
[0m16:26:29.165491 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m16:26:29.169385 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m16:26:29.176681 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m16:26:29.179786 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb955e2b0>]}
[0m16:26:29.182706 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.35s]
[0m16:26:29.185331 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m16:26:29.186965 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m16:26:29.188916 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m16:26:29.193641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m16:26:29.194547 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m16:26:29.209047 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m16:26:29.212050 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m16:26:29.216240 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m16:26:29.218170 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m16:26:29.218549 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m16:26:29.218962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:29.722867 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3c2e075c-aec8-4c91-a32e-f1298e16771c
[0m16:26:31.425087 [debug] [Thread-1  ]: SQL status: OK -1 in 2.206 seconds
[0m16:26:32.727614 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m16:26:32.729973 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m16:26:32.731579 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m16:26:32.732229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc859430>]}
[0m16:26:32.732973 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 3.54s]
[0m16:26:32.733674 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m16:26:32.734269 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m16:26:32.735137 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m16:26:32.736955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m16:26:32.737354 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m16:26:32.745279 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m16:26:32.746958 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m16:26:32.772900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:33.768895 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m16:26:33.769757 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:26:33.773674 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:26:34.756169 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m16:26:34.757028 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:26:34.757782 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/20a37f8e-e465-4931-9802-25d60214f1c0
[0m16:26:35.275476 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/20a37f8e-e465-4931-9802-25d60214f1c0', bucket='climate-energy-raw-data', prefix='silver/eia_silver/20a37f8e-e465-4931-9802-25d60214f1c0/'
[0m16:26:37.337865 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m16:26:37.372526 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:26:37.800235 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:26:37.803464 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/e5b164ba-32d9-4afe-84e5-c155534380cf',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m16:26:38.303795 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d61bf2c2-6f9b-4d59-a0f1-8fb440bcb47c
[0m16:26:41.095147 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m16:26:41.105106 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m16:26:41.105912 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m16:26:41.300098 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a3034e11-34cd-45d1-989c-c8be83f9cef4
[0m16:26:42.965884 [debug] [Thread-1  ]: SQL status: OK -1 in 1.859 seconds
[0m16:26:42.968912 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m16:26:42.970993 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m16:26:42.971292 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m16:26:43.244866 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 234cd486-b196-4e30-80dd-45b0edd7475b
[0m16:26:44.944373 [debug] [Thread-1  ]: SQL status: OK 2842 in 1.973 seconds
[0m16:26:44.948388 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m16:26:44.950154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb49d1100>]}
[0m16:26:44.951652 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 12.21s]
[0m16:26:44.952988 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m16:26:44.954022 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m16:26:44.955178 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m16:26:44.958319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m16:26:44.958876 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m16:26:44.970677 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m16:26:44.973819 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m16:26:44.979301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:46.239081 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m16:26:46.240554 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:26:46.241953 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:26:47.287155 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m16:26:47.290002 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:26:47.290667 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/f2cd3c5f-5a33-4338-8329-9d74c2541f64
[0m16:26:47.819379 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/f2cd3c5f-5a33-4338-8329-9d74c2541f64', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/f2cd3c5f-5a33-4338-8329-9d74c2541f64/'
[0m16:26:49.655334 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m16:26:49.664741 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:26:50.089194 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:26:50.095500 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/b824d209-8d50-484a-b003-33f4d5e37c8b',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m16:26:50.607759 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2ca0ded5-a3d3-40fa-80e5-67686c741b12
[0m16:26:52.266116 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m16:26:52.271653 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m16:26:52.272960 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m16:26:52.497262 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7e8e07b8-8dcc-4948-bbfa-3fbaddad33e4
[0m16:26:54.133393 [debug] [Thread-1  ]: SQL status: OK -1 in 1.859 seconds
[0m16:26:54.139452 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m16:26:54.142923 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m16:26:54.143484 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m16:26:54.340245 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f1f8ad4a-c51a-4dfc-8b37-6b9811e151b1
[0m16:26:56.048533 [debug] [Thread-1  ]: SQL status: OK 305 in 1.903 seconds
[0m16:26:56.060674 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m16:26:56.063578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb955e1f0>]}
[0m16:26:56.066819 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 11.11s]
[0m16:26:56.069829 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m16:26:56.071739 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m16:26:56.073785 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m16:26:56.085955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m16:26:56.087196 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m16:26:56.100739 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m16:26:56.102688 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m16:26:56.106793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:57.497860 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m16:26:57.499171 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:26:57.500013 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:26:58.443971 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m16:26:58.445234 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:26:58.446481 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/fa32a8f9-b5d0-47cc-8b71-82ae855b77c7
[0m16:26:58.944567 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/fa32a8f9-b5d0-47cc-8b71-82ae855b77c7', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/fa32a8f9-b5d0-47cc-8b71-82ae855b77c7/'
[0m16:27:00.809989 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m16:27:00.825617 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:27:01.255215 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:27:01.257384 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/7117759b-8318-469d-bb5a-ab0dffef6a8c',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m16:27:01.751515 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6a4d3410-c80d-4c65-8f99-36ae657bc902
[0m16:27:04.555399 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m16:27:04.565835 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m16:27:04.566442 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m16:27:04.754950 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9b7cd37b-1531-4ab2-b801-2b27778ea51e
[0m16:27:06.394639 [debug] [Thread-1  ]: SQL status: OK -1 in 1.827 seconds
[0m16:27:06.403742 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m16:27:06.409833 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m16:27:06.411090 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m16:27:06.609156 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ff4fd7e2-a062-4349-80ce-332ea0b5fc6c
[0m16:27:08.374547 [debug] [Thread-1  ]: SQL status: OK 12458 in 1.960 seconds
[0m16:27:08.389326 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m16:27:08.391839 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf1f0640>]}
[0m16:27:08.394257 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 12.32s]
[0m16:27:08.396408 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m16:27:08.398023 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m16:27:08.399565 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m16:27:08.403857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m16:27:08.404543 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m16:27:08.424407 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m16:27:08.425931 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m16:27:08.430092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:27:09.452831 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m16:27:09.455763 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:27:09.456433 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:27:10.534266 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m16:27:10.535331 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:27:10.535771 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/804e43f8-8175-4ef7-ad4f-ec1e4f7ee0ea
[0m16:27:11.001825 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/804e43f8-8175-4ef7-ad4f-ec1e4f7ee0ea', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/804e43f8-8175-4ef7-ad4f-ec1e4f7ee0ea/'
[0m16:27:13.145620 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m16:27:13.151233 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:27:13.599136 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:27:13.603612 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/dae57d6d-2cdb-44a4-b5c9-12dff8504c62',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m16:27:14.087643 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID dfaf63ea-d9af-46fa-adeb-6a46ba63e596
[0m16:27:17.004350 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m16:27:17.013054 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m16:27:17.013796 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m16:27:17.203372 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 71e2e9d7-074a-452e-a5bd-ea34286b0947
[0m16:27:18.856537 [debug] [Thread-1  ]: SQL status: OK -1 in 1.842 seconds
[0m16:27:18.861355 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m16:27:18.864969 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m16:27:18.865492 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m16:27:19.071194 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b93ac292-faf5-4ae9-a7ea-30b0c0ef03a3
[0m16:27:20.828088 [debug] [Thread-1  ]: SQL status: OK 473 in 1.962 seconds
[0m16:27:20.833805 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m16:27:20.843661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb230c40>]}
[0m16:27:20.846809 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 12.44s]
[0m16:27:20.849428 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m16:27:20.850723 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m16:27:20.852230 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m16:27:20.856802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m16:27:20.857544 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m16:27:20.875800 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m16:27:20.877338 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m16:27:20.886004 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:27:22.003825 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m16:27:22.004932 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:27:22.006031 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:27:23.023640 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m16:27:23.024706 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:27:23.025087 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/3f209d17-1246-452b-896b-bc85f593d932
[0m16:27:23.504600 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/3f209d17-1246-452b-896b-bc85f593d932', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/3f209d17-1246-452b-896b-bc85f593d932/'
[0m16:27:25.484445 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m16:27:25.500807 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:27:25.947500 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:27:25.950898 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/7a1a9030-c750-4daf-a0e5-a492925bb119',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m16:27:26.421452 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fc3f175a-eb4c-47c8-a67f-89cbb92d83c5
[0m16:27:28.138026 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m16:27:28.141258 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m16:27:28.141828 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m16:27:28.348022 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c484d0cd-9d76-4027-a2ec-c709fb700ac4
[0m16:27:30.039585 [debug] [Thread-1  ]: SQL status: OK -1 in 1.896 seconds
[0m16:27:30.058283 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m16:27:30.061295 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m16:27:30.061691 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m16:27:30.271837 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4554f683-51d2-4517-9325-6648b89c6ccb
[0m16:27:31.973406 [debug] [Thread-1  ]: SQL status: OK 700 in 1.911 seconds
[0m16:27:31.984887 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m16:27:31.987757 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb848c430>]}
[0m16:27:31.997465 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 11.13s]
[0m16:27:31.999700 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m16:27:32.001541 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m16:27:32.003356 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m16:27:32.010415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m16:27:32.011465 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m16:27:32.028820 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m16:27:32.030320 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m16:27:32.033797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:27:33.294992 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m16:27:33.297144 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:27:33.298171 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:27:34.303468 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m16:27:34.304059 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:27:34.304407 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m16:27:34.786867 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m16:27:36.655419 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m16:27:36.692756 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:27:37.261735 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:27:37.266752 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m16:27:37.760960 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c6d8abd2-0ad1-4328-a597-7290c3d460f3
[0m16:27:39.445812 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12931,"data_scanned_in_bytes":88741}
[0m16:27:39.448906 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m16:27:39.449433 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m16:27:39.647971 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 297d9204-92bd-4eb3-a143-ffb4b931cca1
[0m16:27:41.332270 [debug] [Thread-1  ]: SQL status: OK -1 in 1.882 seconds
[0m16:27:41.337060 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m16:27:41.341709 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m16:27:41.342394 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":12931,"data_scanned_in_bytes":88741}';
[0m16:27:41.539672 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5f3a6aa1-74f1-4a8b-890b-8ec19d7972f6
[0m16:27:43.236456 [debug] [Thread-1  ]: SQL status: OK 12931 in 1.893 seconds
[0m16:27:43.246277 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m16:27:43.249586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a75b0eb-2c07-4ec7-a515-13d34f19c235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc864c40>]}
[0m16:27:43.252711 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 12931[0m in 11.24s]
[0m16:27:43.255213 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m16:27:43.262463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:43.263032 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m16:27:43.265908 [info ] [MainThread]: 
[0m16:27:43.266639 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 33.64 seconds (93.64s).
[0m16:27:43.270772 [debug] [MainThread]: Command end result
[0m16:27:43.325199 [info ] [MainThread]: 
[0m16:27:43.325608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:27:43.326087 [info ] [MainThread]: 
[0m16:27:43.327096 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m16:27:43.334102 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 95.54041, "process_user_time": 12.140806, "process_kernel_time": 1.960834, "process_mem_max_rss": "192704", "process_in_blocks": "6088", "process_out_blocks": "3224"}
[0m16:27:43.335047 [debug] [MainThread]: Command `dbt run` succeeded at 16:27:43.334934 after 95.54 seconds
[0m16:27:43.335560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc1171c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbca72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb95bc730>]}
[0m16:27:43.335812 [debug] [MainThread]: Flushing usage events
[0m16:28:08.811508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2e2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9746340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97465b0>]}


============================== 16:28:08.817429 | efb6fb30-c312-44b1-8288-1e2cef931ba0 ==============================
[0m16:28:08.817429 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:28:08.817945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:28:09.190698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efb6fb30-c312-44b1-8288-1e2cef931ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c9e910>]}
[0m16:28:09.232159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efb6fb30-c312-44b1-8288-1e2cef931ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c09520>]}
[0m16:28:09.233415 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m16:28:09.258269 [debug] [MainThread]: checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, vars: {}, profile: gold, target: , version: 1.8.7
[0m16:28:09.389592 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:28:09.390258 [debug] [MainThread]: previous checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m16:28:09.390739 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:28:09.391189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'efb6fb30-c312-44b1-8288-1e2cef931ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa39cf40>]}
[0m16:28:10.246714 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:28:10.247282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'efb6fb30-c312-44b1-8288-1e2cef931ba0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa750beb0>]}
[0m16:28:10.427798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efb6fb30-c312-44b1-8288-1e2cef931ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6ff48b0>]}
[0m16:28:10.512792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efb6fb30-c312-44b1-8288-1e2cef931ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6ec43d0>]}
[0m16:28:10.513335 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m16:28:10.513618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb6fb30-c312-44b1-8288-1e2cef931ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f56490>]}
[0m16:28:10.514814 [info ] [MainThread]: 
[0m16:28:10.515260 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:28:10.516149 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:28:10.516457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:11.050997 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:28:11.065566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m16:28:11.066230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:12.229613 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:28:12.232932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m16:28:12.234350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:13.247084 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:28:13.248412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m16:28:13.249180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:14.499849 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:28:14.507614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb6fb30-c312-44b1-8288-1e2cef931ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9746fd0>]}
[0m16:28:14.510264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:28:14.511529 [info ] [MainThread]: 
[0m16:28:14.533108 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m16:28:14.534696 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m16:28:14.536165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.weather_data_gold)
[0m16:28:14.538701 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m16:28:14.560220 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m16:28:14.566985 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m16:28:14.632712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:28:15.858226 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m16:28:15.859116 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:28:15.861735 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:28:16.871467 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m16:28:16.878802 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:28:16.884559 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m16:28:17.503299 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m16:28:19.414225 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m16:28:19.438964 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:28:19.838851 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:28:19.840086 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m16:28:20.304923 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 740b319b-d3a8-4da3-85f3-3ac79513076b
[0m16:28:21.970810 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12931,"data_scanned_in_bytes":88741}
[0m16:28:21.989482 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m16:28:21.990511 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m16:28:22.195938 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e6b3beff-ad0e-45f1-b19f-6e37b9641e11
[0m16:28:23.865355 [debug] [Thread-1  ]: SQL status: OK -1 in 1.873 seconds
[0m16:28:23.872952 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m16:28:23.875929 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m16:28:23.876404 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":12931,"data_scanned_in_bytes":88741}';
[0m16:28:24.082167 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 03a1878f-0ca7-44bf-89e5-5073f1a1062e
[0m16:28:25.776718 [debug] [Thread-1  ]: SQL status: OK 12931 in 1.900 seconds
[0m16:28:25.792274 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m16:28:25.794510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efb6fb30-c312-44b1-8288-1e2cef931ba0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa3b3c40>]}
[0m16:28:25.796448 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 12931[0m in 11.26s]
[0m16:28:25.797572 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m16:28:25.803104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:25.803572 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m16:28:25.805255 [info ] [MainThread]: 
[0m16:28:25.805708 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m16:28:25.806781 [debug] [MainThread]: Command end result
[0m16:28:25.860431 [info ] [MainThread]: 
[0m16:28:25.861427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:25.861886 [info ] [MainThread]: 
[0m16:28:25.863195 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:28:25.865623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.084757, "process_user_time": 4.104356, "process_kernel_time": 0.454318, "process_mem_max_rss": "180256", "process_in_blocks": "39320", "process_out_blocks": "3109"}
[0m16:28:25.866532 [debug] [MainThread]: Command `dbt run` succeeded at 16:28:25.866412 after 17.09 seconds
[0m16:28:25.867006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2e2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa3af2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c09520>]}
[0m16:28:25.867308 [debug] [MainThread]: Flushing usage events
[0m13:33:52.666996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86fed040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff876c0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8556f610>]}


============================== 13:33:52.697185 | bfecc04b-0334-4bb6-b050-4cae524da7a3 ==============================
[0m13:33:52.697185 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:33:52.699249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:33:53.477200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff829d6550>]}
[0m13:33:53.513056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85580c10>]}
[0m13:33:53.513872 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m13:33:53.527285 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:33:53.603130 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:33:53.603621 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2
[0m13:33:53.603882 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:33:53.604174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86152b80>]}
[0m13:33:54.403185 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:33:54.404445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8326d2b0>]}
[0m13:33:54.594374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d29820>]}
[0m13:33:54.676535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82cfff10>]}
[0m13:33:54.676919 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m13:33:54.677164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82cf2a30>]}
[0m13:33:54.678336 [info ] [MainThread]: 
[0m13:33:54.678703 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m13:33:54.682953 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m13:33:54.683350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:55.522179 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:33:55.524420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:56.067902 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:33:56.068904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:56.569908 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:33:56.572406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m13:33:56.572765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:57.671865 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m13:33:57.672915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m13:33:57.673902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:58.929456 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m13:33:58.930650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m13:33:58.932683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:00.020457 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m13:34:00.028394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82def310>]}
[0m13:34:00.030229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:34:00.030858 [info ] [MainThread]: 
[0m13:34:00.052319 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m13:34:00.053711 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m13:34:00.054415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.eia_bronze)
[0m13:34:00.054685 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m13:34:00.066304 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m13:34:00.068651 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m13:34:00.090626 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m13:34:00.093176 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m13:34:00.093482 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m13:34:00.093884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:00.682615 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5e5ad7ce-8a02-4583-bdcd-c1f69bad37cc
[0m13:34:02.400857 [debug] [Thread-1  ]: SQL status: OK -1 in 2.307 seconds
[0m13:34:03.611926 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m13:34:03.614061 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m13:34:03.622052 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m13:34:03.623440 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83050cd0>]}
[0m13:34:03.624147 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 3.57s]
[0m13:34:03.624736 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m13:34:03.625259 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m13:34:03.626050 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m13:34:03.627837 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m13:34:03.628202 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m13:34:03.631232 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m13:34:03.632331 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m13:34:03.634424 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m13:34:03.635234 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m13:34:03.635459 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m13:34:03.635662 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:04.141220 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1e6952a0-85f7-4885-b67f-1d5f3c18ac4f
[0m13:34:05.797530 [debug] [Thread-1  ]: SQL status: OK -1 in 2.162 seconds
[0m13:34:06.791577 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m13:34:06.793324 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m13:34:06.795214 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m13:34:06.796001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff861a7d30>]}
[0m13:34:06.796585 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.17s]
[0m13:34:06.797722 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m13:34:06.798250 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m13:34:06.799133 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m13:34:06.802507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m13:34:06.803210 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m13:34:06.808720 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m13:34:06.810503 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m13:34:06.813205 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m13:34:06.814225 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m13:34:06.814562 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m13:34:06.814869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:07.333240 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f7d0fc98-cca3-4bec-98f3-112da710778e
[0m13:34:09.025934 [debug] [Thread-1  ]: SQL status: OK -1 in 2.211 seconds
[0m13:34:10.457540 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m13:34:10.466052 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m13:34:10.485799 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m13:34:10.490930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8329de20>]}
[0m13:34:10.492098 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 3.69s]
[0m13:34:10.493300 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m13:34:10.494207 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m13:34:10.495466 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m13:34:10.498474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m13:34:10.499567 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m13:34:10.511082 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m13:34:10.512851 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m13:34:10.515285 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m13:34:10.516270 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m13:34:10.516561 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m13:34:10.516886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:11.014887 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4e8628ce-a5b4-450c-a0bf-6bfc41b380d2
[0m13:34:12.666070 [debug] [Thread-1  ]: SQL status: OK -1 in 2.147 seconds
[0m13:34:13.724901 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m13:34:13.728805 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m13:34:13.736077 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m13:34:13.742182 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b454880>]}
[0m13:34:13.744665 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.24s]
[0m13:34:13.746889 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m13:34:13.748434 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m13:34:13.750580 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m13:34:13.754408 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m13:34:13.755270 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m13:34:13.770274 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m13:34:13.773258 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m13:34:13.777624 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m13:34:13.779155 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m13:34:13.779532 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m13:34:13.779940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:14.316937 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c4a1dc87-bf93-4645-afd8-9c84029e9fd9
[0m13:34:16.156606 [debug] [Thread-1  ]: SQL status: OK -1 in 2.376 seconds
[0m13:34:17.152804 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m13:34:17.155492 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m13:34:17.158388 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m13:34:17.159387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85597220>]}
[0m13:34:17.160583 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 3.41s]
[0m13:34:17.161973 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m13:34:17.163178 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m13:34:17.164464 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m13:34:17.167332 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m13:34:17.168003 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m13:34:17.173496 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m13:34:17.175692 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m13:34:17.208701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:18.259415 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m13:34:18.260452 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:34:18.263510 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:34:19.263441 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m13:34:19.269213 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:34:19.272209 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/e5b164ba-32d9-4afe-84e5-c155534380cf
[0m13:34:19.992267 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/e5b164ba-32d9-4afe-84e5-c155534380cf', bucket='climate-energy-raw-data', prefix='silver/eia_silver/e5b164ba-32d9-4afe-84e5-c155534380cf/'
[0m13:34:21.885667 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m13:34:21.940107 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:34:22.403981 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:34:22.410450 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/89e4aa26-b19a-4600-8299-0a24b58d2cd6',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m13:34:22.952053 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 84ed3dd8-2762-4550-986b-a0a39d40d10e
[0m13:34:24.624956 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m13:34:24.639750 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m13:34:24.640837 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m13:34:24.846437 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 82878492-c1d7-4662-90d8-25950d844f4d
[0m13:34:26.525934 [debug] [Thread-1  ]: SQL status: OK -1 in 1.884 seconds
[0m13:34:26.529548 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m13:34:26.534565 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m13:34:26.535051 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m13:34:26.729515 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 61aeaffc-2ce1-46bf-81e5-322468b47d89
[0m13:34:28.409878 [debug] [Thread-1  ]: SQL status: OK 2842 in 1.874 seconds
[0m13:34:28.413266 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m13:34:28.414322 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8308ae80>]}
[0m13:34:28.415388 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 11.25s]
[0m13:34:28.416739 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m13:34:28.417642 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m13:34:28.418511 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m13:34:28.420704 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m13:34:28.421179 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m13:34:28.426238 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m13:34:28.427695 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m13:34:28.431199 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:29.891152 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m13:34:29.895157 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:34:29.895898 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:34:30.840329 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m13:34:30.841829 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:34:30.842801 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/b824d209-8d50-484a-b003-33f4d5e37c8b
[0m13:34:31.326560 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/b824d209-8d50-484a-b003-33f4d5e37c8b', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/b824d209-8d50-484a-b003-33f4d5e37c8b/'
[0m13:34:33.150600 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m13:34:33.157685 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:34:33.560997 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:34:33.562615 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/5916eee5-f9a0-4bf9-8897-3e891f999be5',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m13:34:34.087467 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a6e78c22-1228-4abc-a0a9-411db4a2e0d6
[0m13:34:36.905398 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m13:34:36.914927 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m13:34:36.915803 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m13:34:37.115522 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8035596c-1442-4dd2-8c92-c7d140641998
[0m13:34:38.776182 [debug] [Thread-1  ]: SQL status: OK -1 in 1.859 seconds
[0m13:34:38.781257 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m13:34:38.784676 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m13:34:38.785406 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m13:34:38.981196 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b9fbd5bf-1313-45ec-b0bc-7e6975433239
[0m13:34:40.706427 [debug] [Thread-1  ]: SQL status: OK 305 in 1.919 seconds
[0m13:34:40.719927 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m13:34:40.721479 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8308ae80>]}
[0m13:34:40.723405 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 12.30s]
[0m13:34:40.724830 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m13:34:40.725927 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m13:34:40.727146 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m13:34:40.730242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m13:34:40.730939 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m13:34:40.738927 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m13:34:40.741295 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m13:34:40.744661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:41.852830 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m13:34:41.853575 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:34:41.854200 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:34:42.803934 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m13:34:42.804695 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:34:42.805113 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/7117759b-8318-469d-bb5a-ab0dffef6a8c
[0m13:34:43.293018 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/7117759b-8318-469d-bb5a-ab0dffef6a8c', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/7117759b-8318-469d-bb5a-ab0dffef6a8c/'
[0m13:34:45.125273 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m13:34:45.135900 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:34:45.566676 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:34:45.569348 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/3fea950e-2ae3-473b-8079-c5298deac59d',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m13:34:46.071119 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cf396910-df3c-4c33-ae3c-9c820ee59907
[0m13:34:48.894535 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m13:34:48.896810 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m13:34:48.897328 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m13:34:49.100320 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 437089c6-806f-4748-8de9-124341b9eac5
[0m13:34:50.758178 [debug] [Thread-1  ]: SQL status: OK -1 in 1.859 seconds
[0m13:34:50.763815 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m13:34:50.769152 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m13:34:50.769966 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m13:34:50.962170 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 724cc6e9-bfbe-4c97-8c1d-f5b650b4dad5
[0m13:34:52.690575 [debug] [Thread-1  ]: SQL status: OK 12458 in 1.921 seconds
[0m13:34:52.700409 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m13:34:52.701862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82df08e0>]}
[0m13:34:52.705830 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 12458[0m in 11.97s]
[0m13:34:52.707331 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m13:34:52.708148 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m13:34:52.709286 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m13:34:52.712660 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m13:34:52.714218 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m13:34:52.722285 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m13:34:52.723497 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m13:34:52.726429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:34:53.838535 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m13:34:53.839235 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:34:53.841107 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:34:54.778578 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m13:34:54.780091 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:34:54.781087 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/dae57d6d-2cdb-44a4-b5c9-12dff8504c62
[0m13:34:55.415172 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/dae57d6d-2cdb-44a4-b5c9-12dff8504c62', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/dae57d6d-2cdb-44a4-b5c9-12dff8504c62/'
[0m13:34:57.206893 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m13:34:57.210312 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:34:57.630094 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:34:57.634069 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/4f699325-586d-49a3-bb43-6d75fd3f3dd7',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m13:34:58.109858 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9b746088-8af3-492b-ac2c-757ab0f27612
[0m13:35:00.956302 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m13:35:00.970485 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m13:35:00.971722 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m13:35:01.193703 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2858ee86-dc01-47f4-96d1-639e5a8bd8d0
[0m13:35:02.836854 [debug] [Thread-1  ]: SQL status: OK -1 in 1.864 seconds
[0m13:35:02.840337 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m13:35:02.841922 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m13:35:02.842262 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m13:35:03.033706 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1930da99-3c84-471a-9f36-b0e857628d35
[0m13:35:04.709958 [debug] [Thread-1  ]: SQL status: OK 473 in 1.867 seconds
[0m13:35:04.716532 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m13:35:04.719026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82db1c70>]}
[0m13:35:04.720924 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 473[0m in 12.01s]
[0m13:35:04.723692 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m13:35:04.725089 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m13:35:04.727844 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m13:35:04.733845 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m13:35:04.734590 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m13:35:04.743478 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m13:35:04.744653 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m13:35:04.749045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:05.821117 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m13:35:05.822029 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:35:05.822974 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:35:06.768052 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m13:35:06.769299 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:35:06.770261 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/7a1a9030-c750-4daf-a0e5-a492925bb119
[0m13:35:07.265674 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/7a1a9030-c750-4daf-a0e5-a492925bb119', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/7a1a9030-c750-4daf-a0e5-a492925bb119/'
[0m13:35:09.015852 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m13:35:09.020630 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:35:09.499405 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:35:09.508145 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/f8963621-754c-4191-ae9f-d875a22698c5',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m13:35:09.979954 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0948fea0-97f6-4353-87ea-ea22869990bb
[0m13:35:12.779407 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":700,"data_scanned_in_bytes":17709}
[0m13:35:12.783577 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m13:35:12.784093 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m13:35:12.979291 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f96518a6-2a61-402b-84d7-465f65caece4
[0m13:35:14.647782 [debug] [Thread-1  ]: SQL status: OK -1 in 1.862 seconds
[0m13:35:14.653634 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m13:35:14.661241 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m13:35:14.661762 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":700,"data_scanned_in_bytes":17709}';
[0m13:35:14.868811 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a93b130a-0873-4f84-8f7d-060fbd953da0
[0m13:35:16.815903 [debug] [Thread-1  ]: SQL status: OK 700 in 2.151 seconds
[0m13:35:16.823314 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m13:35:16.825074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82dd2490>]}
[0m13:35:16.826812 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 700[0m in 12.09s]
[0m13:35:16.829351 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m13:35:16.832811 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m13:35:16.835487 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m13:35:16.839935 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m13:35:16.840925 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m13:35:16.851961 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m13:35:16.855752 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m13:35:16.859852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:17.973164 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m13:35:17.974204 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:35:17.974830 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:35:18.909682 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m13:35:18.910750 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:35:18.911469 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m13:35:19.463333 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m13:35:21.236213 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m13:35:21.242967 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:35:21.658651 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:35:21.661326 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m13:35:22.145267 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4c86b4f4-662c-48c2-8f44-8d68e3491045
[0m13:35:24.964284 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12931,"data_scanned_in_bytes":88741}
[0m13:35:24.969399 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m13:35:24.969972 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m13:35:25.171549 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c1328ba6-f113-41de-acad-0b2695d13122
[0m13:35:26.818696 [debug] [Thread-1  ]: SQL status: OK -1 in 1.848 seconds
[0m13:35:26.823506 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m13:35:26.825935 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m13:35:26.826225 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":12931,"data_scanned_in_bytes":88741}';
[0m13:35:27.027561 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 87be5ed7-c09e-499e-b2c2-77e9997628c8
[0m13:35:28.720645 [debug] [Thread-1  ]: SQL status: OK 12931 in 1.893 seconds
[0m13:35:28.735370 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m13:35:28.737706 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfecc04b-0334-4bb6-b050-4cae524da7a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc05e80>]}
[0m13:35:28.739639 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 12931[0m in 11.90s]
[0m13:35:28.741438 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m13:35:28.751131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:28.751756 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m13:35:28.757358 [info ] [MainThread]: 
[0m13:35:28.757920 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 34.08 seconds (94.08s).
[0m13:35:28.760835 [debug] [MainThread]: Command end result
[0m13:35:28.807939 [info ] [MainThread]: 
[0m13:35:28.808329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:35:28.808584 [info ] [MainThread]: 
[0m13:35:28.809125 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:35:28.812948 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 96.18702, "process_user_time": 10.830955, "process_kernel_time": 1.582665, "process_mem_max_rss": "191848", "process_in_blocks": "46152", "process_out_blocks": "9632"}
[0m13:35:28.813598 [debug] [MainThread]: Command `dbt run` succeeded at 13:35:28.813532 after 96.19 seconds
[0m13:35:28.813938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86fed040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c08700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82cf2400>]}
[0m13:35:28.814197 [debug] [MainThread]: Flushing usage events
[0m13:35:53.932025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d17160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff984029a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96186550>]}


============================== 13:35:53.939051 | cec2b062-a10c-46dc-a6ac-83509bdce2c0 ==============================
[0m13:35:53.939051 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:35:53.939464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'send_anonymous_usage_stats': 'True'}
[0m13:35:54.369553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cec2b062-a10c-46dc-a6ac-83509bdce2c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c8e9a0>]}
[0m13:35:54.400076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cec2b062-a10c-46dc-a6ac-83509bdce2c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94117730>]}
[0m13:35:54.400816 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m13:35:54.414305 [debug] [MainThread]: checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, vars: {}, profile: gold, target: , version: 1.8.7
[0m13:35:54.488314 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:35:54.488782 [debug] [MainThread]: previous checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m13:35:54.489033 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:35:54.489283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cec2b062-a10c-46dc-a6ac-83509bdce2c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ddffa0>]}
[0m13:35:55.712359 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:35:55.713714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cec2b062-a10c-46dc-a6ac-83509bdce2c0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e14b50>]}
[0m13:35:56.022378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cec2b062-a10c-46dc-a6ac-83509bdce2c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c3f7c0>]}
[0m13:35:56.126501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cec2b062-a10c-46dc-a6ac-83509bdce2c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939023a0>]}
[0m13:35:56.127241 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m13:35:56.127596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec2b062-a10c-46dc-a6ac-83509bdce2c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93996460>]}
[0m13:35:56.129615 [info ] [MainThread]: 
[0m13:35:56.130781 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m13:35:56.136995 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m13:35:56.137818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:56.702450 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:35:56.717636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m13:35:56.719490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:57.926585 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m13:35:57.928255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m13:35:57.929280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:59.077574 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m13:35:59.080416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m13:35:59.082926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:00.543350 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m13:36:00.549748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec2b062-a10c-46dc-a6ac-83509bdce2c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fcb070>]}
[0m13:36:00.552935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:00.553802 [info ] [MainThread]: 
[0m13:36:00.570491 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m13:36:00.571680 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m13:36:00.572794 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.weather_data_gold)
[0m13:36:00.573155 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m13:36:00.590248 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m13:36:00.591667 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m13:36:00.625623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:01.832154 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m13:36:01.833097 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:36:01.835545 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:36:02.772525 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m13:36:02.772917 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:36:02.773162 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m13:36:03.272334 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m13:36:04.975364 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m13:36:05.012320 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:36:05.459100 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:36:05.460357 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m13:36:06.013471 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 189ac97a-940a-461a-b3a1-603eb847afe5
[0m13:36:08.787673 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":12931,"data_scanned_in_bytes":88741}
[0m13:36:08.799917 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m13:36:08.800761 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m13:36:08.989941 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 70ff41a5-b8ec-48b6-8f34-f654c529cd59
[0m13:36:10.638070 [debug] [Thread-1  ]: SQL status: OK -1 in 1.836 seconds
[0m13:36:10.646165 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m13:36:10.648968 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m13:36:10.649373 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":12931,"data_scanned_in_bytes":88741}';
[0m13:36:10.895973 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0d8fbcbb-8542-4a48-8366-df6d7e8a4d14
[0m13:36:12.565729 [debug] [Thread-1  ]: SQL status: OK 12931 in 1.915 seconds
[0m13:36:12.580648 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m13:36:12.582925 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec2b062-a10c-46dc-a6ac-83509bdce2c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94074df0>]}
[0m13:36:12.584399 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 12931[0m in 12.01s]
[0m13:36:12.585697 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m13:36:12.589807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:12.590115 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m13:36:12.592364 [info ] [MainThread]: 
[0m13:36:12.592811 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.46 seconds (16.46s).
[0m13:36:12.593844 [debug] [MainThread]: Command end result
[0m13:36:12.633831 [info ] [MainThread]: 
[0m13:36:12.635647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:36:12.636440 [info ] [MainThread]: 
[0m13:36:12.637240 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:36:12.643167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.743708, "process_user_time": 4.512216, "process_kernel_time": 0.625966, "process_mem_max_rss": "180132", "process_in_blocks": "1824", "process_out_blocks": "3109"}
[0m13:36:12.644287 [debug] [MainThread]: Command `dbt run` succeeded at 13:36:12.644168 after 18.75 seconds
[0m13:36:12.644934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d17160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968cbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901bbd00>]}
[0m13:36:12.645254 [debug] [MainThread]: Flushing usage events
[0m14:40:38.876499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98751890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993446d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98751a90>]}


============================== 14:40:38.907205 | 24cdfb13-4831-46af-a58a-d631a01d631c ==============================
[0m14:40:38.907205 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:40:38.907619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:40:39.579274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9780c690>]}
[0m14:40:39.641588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9780c4d0>]}
[0m14:40:39.642514 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:40:39.648609 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m14:40:39.686827 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:40:39.687311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97988ad0>]}
[0m14:40:40.614716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977b0b90>]}
[0m14:40:40.936769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9768b090>]}
[0m14:40:40.938860 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m14:40:40.940010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97566b50>]}
[0m14:40:40.949982 [info ] [MainThread]: 
[0m14:40:40.952522 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:40:40.968406 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:40:41.004369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:42.240762 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:40:42.250427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m14:40:42.251433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:43.748823 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m14:40:43.752145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m14:40:43.754871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:45.121733 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m14:40:45.127212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m14:40:45.129143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:40:46.727003 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m14:40:46.730186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947580d0>]}
[0m14:40:46.731654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:46.732353 [info ] [MainThread]: 
[0m14:40:46.734386 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m14:40:46.735041 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m14:40:46.735868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_silver)
[0m14:40:46.736274 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m14:40:46.741729 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m14:40:46.743538 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 14:40:46.736512 => 14:40:46.743369
[0m14:40:46.743862 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m14:40:46.784347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:48.141302 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m14:40:48.142967 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:40:48.148169 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:40:49.238047 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m14:40:49.239830 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:40:49.240971 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/89e4aa26-b19a-4600-8299-0a24b58d2cd6
[0m14:40:50.619196 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/89e4aa26-b19a-4600-8299-0a24b58d2cd6', bucket='climate-energy-raw-data', prefix='silver/eia_silver/89e4aa26-b19a-4600-8299-0a24b58d2cd6/'
[0m14:40:53.621053 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m14:40:53.647457 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:40:54.828466 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:40:54.833239 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/eac58a83-5acf-4c67-8dc0-7ce16abf985c',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m14:40:55.459577 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6dd4441c-c928-4b2f-a6c1-2493a92b8993
[0m14:40:59.412336 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m14:40:59.426202 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m14:40:59.427059 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m14:40:59.716603 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c83631d5-632e-40b4-9dc0-1ece97a83076
[0m14:41:01.366840 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:41:01.371345 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m14:41:01.376236 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m14:41:01.376750 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m14:41:01.567527 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 69c39a2d-ce2b-4f42-b47c-1a3acbaa707d
[0m14:41:03.281248 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m14:41:03.312932 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 14:40:46.744053 => 14:41:03.312148
[0m14:41:03.313949 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m14:41:03.316495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9710ba50>]}
[0m14:41:03.318823 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.eia_silver ............................ [[32mOK 2842[0m in 16.58s]
[0m14:41:03.320358 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m14:41:03.321431 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m14:41:03.322733 [info ] [Thread-1 (]: 2 of 5 START sql table model silver.noaa_silver ................................ [RUN]
[0m14:41:03.329927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m14:41:03.330663 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m14:41:03.346229 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m14:41:03.350772 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 14:41:03.331033 => 14:41:03.348628
[0m14:41:03.355152 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m14:41:03.369206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:04.869978 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m14:41:04.872615 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:41:04.873764 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:41:06.075363 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m14:41:06.076510 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:41:06.076855 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/5916eee5-f9a0-4bf9-8897-3e891f999be5
[0m14:41:07.328648 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/5916eee5-f9a0-4bf9-8897-3e891f999be5', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/5916eee5-f9a0-4bf9-8897-3e891f999be5/'
[0m14:41:10.200900 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m14:41:10.213171 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:41:11.426879 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:41:11.431363 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/317c3f53-5413-4c7c-8161-ae89f4cfca03',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m14:41:11.990483 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 40f2d47e-ce75-433f-ab85-7f094b479eba
[0m14:41:14.764157 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m14:41:14.770600 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m14:41:14.771530 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m14:41:15.089643 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 647ee0fb-e9c0-417b-9024-5f5ef95889c2
[0m14:41:16.753648 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:41:16.760735 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m14:41:16.764595 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m14:41:16.765283 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m14:41:16.965082 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4555afb4-7e2f-4404-b13c-d9fc7ae3b5a8
[0m14:41:18.643817 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m14:41:18.647205 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 14:41:03.356915 => 14:41:18.646840
[0m14:41:18.647778 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m14:41:18.649085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946a3c10>]}
[0m14:41:18.650162 [info ] [Thread-1 (]: 2 of 5 OK created sql table model silver.noaa_silver ........................... [[32mOK 305[0m in 15.33s]
[0m14:41:18.650971 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m14:41:18.651554 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m14:41:18.652344 [info ] [Thread-1 (]: 3 of 5 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m14:41:18.654393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m14:41:18.654720 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m14:41:18.660448 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m14:41:18.662463 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 14:41:18.654902 => 14:41:18.662316
[0m14:41:18.662788 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m14:41:18.665182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:20.132311 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m14:41:20.133780 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:41:20.135010 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:41:21.390517 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m14:41:21.391925 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:41:21.392466 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/3fea950e-2ae3-473b-8079-c5298deac59d
[0m14:41:21.988048 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/3fea950e-2ae3-473b-8079-c5298deac59d', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/3fea950e-2ae3-473b-8079-c5298deac59d/'
[0m14:41:24.038063 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m14:41:24.045905 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:41:24.546754 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:41:24.548144 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/79b8a351-7f62-43a7-8090-a5e44b8d2245',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m14:41:25.101744 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2f79ba20-d8b7-40bc-8d8e-fb229286f92e
[0m14:41:27.939556 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":12458,"data_scanned_in_bytes":93419}
[0m14:41:27.942474 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:41:27.942906 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m14:41:28.232160 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0ab0ecc2-d85b-413d-aee9-43ddf1bd9347
[0m14:41:29.865960 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:41:29.872116 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m14:41:29.876712 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:41:29.877554 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":12458,"data_scanned_in_bytes":93419}';
[0m14:41:30.107106 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0077e4d1-1cc4-4298-843c-f63337e9c8d6
[0m14:41:31.807954 [debug] [Thread-1 (]: SQL status: OK 12458 in 2.0 seconds
[0m14:41:31.816518 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 14:41:18.662974 => 14:41:31.815998
[0m14:41:31.817402 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m14:41:31.819571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945f3c90>]}
[0m14:41:31.821090 [info ] [Thread-1 (]: 3 of 5 OK created sql table model silver.openmeteo_silver ...................... [[32mOK 12458[0m in 13.17s]
[0m14:41:31.822053 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m14:41:31.822680 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m14:41:31.823571 [info ] [Thread-1 (]: 4 of 5 START sql table model silver.openweather_silver ......................... [RUN]
[0m14:41:31.826273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m14:41:31.826653 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m14:41:31.836378 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m14:41:31.837543 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 14:41:31.826863 => 14:41:31.837414
[0m14:41:31.837899 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m14:41:31.840618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:33.315769 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m14:41:33.317186 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:41:33.318394 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:41:34.506384 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m14:41:34.507633 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:41:34.508473 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/4f699325-586d-49a3-bb43-6d75fd3f3dd7
[0m14:41:35.085791 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/4f699325-586d-49a3-bb43-6d75fd3f3dd7', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/4f699325-586d-49a3-bb43-6d75fd3f3dd7/'
[0m14:41:37.304770 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m14:41:37.306455 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:41:37.852433 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:41:37.854821 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/c9784e07-d766-4cd7-bb75-fe415b8662f5',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m14:41:38.466048 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 66ddcf38-d06a-42a1-8e2d-37312c175e54
[0m14:41:41.308717 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":473,"data_scanned_in_bytes":6581}
[0m14:41:41.316556 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m14:41:41.317493 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m14:41:41.576468 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID eeac6b8b-44f0-47dd-b374-1f1a7be836f7
[0m14:41:43.231551 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:41:43.238895 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m14:41:43.241060 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m14:41:43.241396 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":473,"data_scanned_in_bytes":6581}';
[0m14:41:43.447817 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 66ff6b21-af66-4399-9579-922190cebf7e
[0m14:41:45.133070 [debug] [Thread-1 (]: SQL status: OK 473 in 2.0 seconds
[0m14:41:45.144507 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 14:41:31.838100 => 14:41:45.143318
[0m14:41:45.146178 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m14:41:45.149431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946bb290>]}
[0m14:41:45.152174 [info ] [Thread-1 (]: 4 of 5 OK created sql table model silver.openweather_silver .................... [[32mOK 473[0m in 13.32s]
[0m14:41:45.154137 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m14:41:45.155450 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m14:41:45.157650 [info ] [Thread-1 (]: 5 of 5 START sql table model silver.sensor_silver .............................. [RUN]
[0m14:41:45.162916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m14:41:45.163903 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m14:41:45.179691 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m14:41:45.181424 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 14:41:45.164381 => 14:41:45.181211
[0m14:41:45.181952 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m14:41:45.185848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:46.681968 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m14:41:46.682530 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:41:46.683013 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:41:47.866674 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m14:41:47.867562 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:41:47.868266 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/f8963621-754c-4191-ae9f-d875a22698c5
[0m14:41:48.420265 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/f8963621-754c-4191-ae9f-d875a22698c5', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/f8963621-754c-4191-ae9f-d875a22698c5/'
[0m14:41:50.595211 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m14:41:50.614510 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:41:51.352985 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:41:51.360383 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/c951357c-5859-432d-8f8b-738837f4c8a7',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m14:41:51.978031 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b91cc0ec-56e4-4462-a333-09e4643fa50d
[0m14:41:54.826331 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2278,"data_scanned_in_bytes":53254}
[0m14:41:54.832730 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m14:41:54.833573 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m14:41:55.078891 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 955f5331-1052-4dc7-ab47-92b1def0e91f
[0m14:41:56.793147 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:41:56.802560 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m14:41:56.808454 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m14:41:56.809250 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2278,"data_scanned_in_bytes":53254}';
[0m14:41:57.002772 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ce8152e6-75eb-4a7d-bf17-a0e8b715d1b1
[0m14:41:58.705365 [debug] [Thread-1 (]: SQL status: OK 2278 in 2.0 seconds
[0m14:41:58.712669 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 14:41:45.182268 => 14:41:58.711698
[0m14:41:58.714016 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m14:41:58.716830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24cdfb13-4831-46af-a58a-d631a01d631c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94486390>]}
[0m14:41:58.718137 [info ] [Thread-1 (]: 5 of 5 OK created sql table model silver.sensor_silver ......................... [[32mOK 2278[0m in 13.56s]
[0m14:41:58.718985 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m14:41:58.723018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:58.723401 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m14:41:58.725416 [info ] [MainThread]: 
[0m14:41:58.726127 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 17.77 seconds (77.77s).
[0m14:41:58.728723 [debug] [MainThread]: Command end result
[0m14:41:58.774389 [info ] [MainThread]: 
[0m14:41:58.775527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:58.776099 [info ] [MainThread]: 
[0m14:41:58.777537 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:41:58.781472 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 79.940575, "process_user_time": 6.921529, "process_kernel_time": 2.046472, "process_mem_max_rss": "186572", "process_in_blocks": "95472", "process_out_blocks": "5196"}
[0m14:41:58.782468 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:58.782294 after 79.94 seconds
[0m14:41:58.783220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9878c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9878d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db12c50>]}
[0m14:41:58.783730 [debug] [MainThread]: Flushing usage events
[0m15:16:49.657445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c57370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70c6940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70c6670>]}


============================== 15:16:49.662092 | 160f1fd8-cf31-4cf7-a7ef-f3fc75263841 ==============================
[0m15:16:49.662092 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:16:49.662519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:16:50.240640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4630ee0>]}
[0m15:16:50.271275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70d8df0>]}
[0m15:16:50.271991 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:16:50.288112 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:16:50.366622 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:16:50.367097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d2d1f0>]}
[0m15:16:51.887284 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:16:51.903416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4db7ac0>]}
[0m15:16:52.406394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4972880>]}
[0m15:16:52.575585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4843400>]}
[0m15:16:52.576206 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m15:16:52.576634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb48d44c0>]}
[0m15:16:52.578635 [info ] [MainThread]: 
[0m15:16:52.579387 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:16:52.585288 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:16:52.585927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:53.252495 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:16:53.254166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:53.860034 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:16:53.863706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:54.423820 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:16:54.431440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m15:16:54.432125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:55.661478 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m15:16:55.680754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m15:16:55.682880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:57.043220 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:16:57.046706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m15:16:57.047714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:58.299292 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:16:58.324744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c1ae20>]}
[0m15:16:58.328403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:16:58.334473 [info ] [MainThread]: 
[0m15:16:58.380592 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m15:16:58.382132 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m15:16:58.383822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m15:16:58.384400 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m15:16:58.414091 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:16:58.416489 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m15:16:58.455183 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:16:58.458418 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m15:16:58.458915 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:16:58.459333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:16:59.091135 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 95ef9baf-e10f-4392-b510-23009a4b8009
[0m15:17:00.794877 [debug] [Thread-1  ]: SQL status: OK -1 in 2.334 seconds
[0m15:17:02.650641 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m15:17:02.655335 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:17:02.693280 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m15:17:02.697373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4972c10>]}
[0m15:17:02.699439 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 4.31s]
[0m15:17:02.700612 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m15:17:02.701283 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m15:17:02.702177 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m15:17:02.706394 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:17:02.707423 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m15:17:02.713644 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:17:02.714864 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m15:17:02.717502 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:17:02.718461 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m15:17:02.718756 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:17:02.719082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:17:03.278485 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b0bb98fa-30fa-4b9e-8111-e9bedcda074f
[0m15:17:04.992765 [debug] [Thread-1  ]: SQL status: OK -1 in 2.273 seconds
[0m15:17:06.039689 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m15:17:06.042928 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:17:06.052212 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m15:17:06.054472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4eee220>]}
[0m15:17:06.056512 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.35s]
[0m15:17:06.058234 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m15:17:06.059470 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m15:17:06.064016 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m15:17:06.068027 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:17:06.068662 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m15:17:06.081109 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:17:06.082512 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m15:17:06.085743 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:17:06.087610 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:17:06.088004 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:17:06.088400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:17:06.648926 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8f5a10ac-b476-4f9f-b680-ec498ca51eb0
[0m15:17:08.331620 [debug] [Thread-1  ]: SQL status: OK -1 in 2.241 seconds
[0m15:17:09.647547 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m15:17:09.651319 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:17:09.653917 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m15:17:09.655235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4972c10>]}
[0m15:17:09.657003 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 3.59s]
[0m15:17:09.658624 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m15:17:09.659851 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m15:17:09.661564 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m15:17:09.664650 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:17:09.665573 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m15:17:09.673838 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:17:09.676108 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m15:17:09.679855 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:17:09.681631 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m15:17:09.682122 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:17:09.682597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:17:10.246862 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cef8d7d1-7200-4f6f-a3aa-91ace51f7f43
[0m15:17:12.110414 [debug] [Thread-1  ]: SQL status: OK -1 in 2.427 seconds
[0m15:17:13.205364 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m15:17:13.207933 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:17:13.214853 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m15:17:13.216374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7cd11c0>]}
[0m15:17:13.218001 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.55s]
[0m15:17:13.219430 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m15:17:13.222429 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m15:17:13.224651 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m15:17:13.230153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:17:13.230541 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m15:17:13.239092 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:17:13.240587 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m15:17:13.245395 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:17:13.247422 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m15:17:13.248055 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:17:13.249072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:17:13.799252 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e2542d77-e6a3-44a0-bd3c-c4ca7815b9e9
[0m15:17:15.494602 [debug] [Thread-1  ]: SQL status: OK -1 in 2.245 seconds
[0m15:17:16.737446 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m15:17:16.740994 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m15:17:16.743414 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m15:17:16.744489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4972c10>]}
[0m15:17:16.745790 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 3.52s]
[0m15:17:16.748217 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m15:17:16.749700 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m15:17:16.750796 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m15:17:16.753338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:17:16.753933 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m15:17:16.759952 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:17:16.762254 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m15:17:16.800503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:17:17.857928 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:17:17.861032 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:17:17.867816 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:17:18.863834 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:17:18.864533 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:17:18.864907 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/eac58a83-5acf-4c67-8dc0-7ce16abf985c
[0m15:17:19.380125 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/eac58a83-5acf-4c67-8dc0-7ce16abf985c', bucket='climate-energy-raw-data', prefix='silver/eia_silver/eac58a83-5acf-4c67-8dc0-7ce16abf985c/'
[0m15:17:21.197532 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:17:21.259833 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:17:21.779576 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:17:21.784294 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/d8026183-7acf-42ad-93c3-a947c1e3a05d',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m15:17:22.286862 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ab36bcd6-dd47-4b48-be4c-09fd025b2952
[0m15:17:25.085222 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:17:25.092744 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:17:25.093375 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:17:25.287457 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7d525daf-5b7e-492c-bc57-1bf069979d8b
[0m15:17:26.939403 [debug] [Thread-1  ]: SQL status: OK -1 in 1.845 seconds
[0m15:17:26.943781 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:17:26.947723 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:17:26.948413 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:17:27.147061 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID bb749383-6cb0-4b5b-b031-31ad6fd6c2fb
[0m15:17:28.848564 [debug] [Thread-1  ]: SQL status: OK 2842 in 1.899 seconds
[0m15:17:28.861129 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m15:17:28.863475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4effbb0>]}
[0m15:17:28.867401 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 12.11s]
[0m15:17:28.873965 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m15:17:28.875475 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m15:17:28.876734 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:17:28.881413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:17:28.882240 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m15:17:28.892762 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:17:28.894133 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m15:17:28.898098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:17:30.179777 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:17:30.181995 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:17:30.182846 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:17:31.151067 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:17:31.156095 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:17:31.156452 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/317c3f53-5413-4c7c-8161-ae89f4cfca03
[0m15:17:31.680746 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/317c3f53-5413-4c7c-8161-ae89f4cfca03', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/317c3f53-5413-4c7c-8161-ae89f4cfca03/'
[0m15:17:33.635393 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:17:33.649435 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:17:34.094386 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:17:34.096929 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/9819b460-b89f-407d-bc6b-2daec3fb62b8',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:17:34.591040 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6368d89f-0cd6-4451-9b2b-92bd733a091b
[0m15:17:37.368411 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:17:37.371457 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:17:37.371913 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:17:37.564830 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 199a3923-fe3f-4cfc-8bd7-777212eb6267
[0m15:17:39.206616 [debug] [Thread-1  ]: SQL status: OK -1 in 1.834 seconds
[0m15:17:39.213255 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:17:39.216828 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:17:39.217448 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:17:39.409936 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 15ed61fa-a0fe-4016-857b-a3842af3b60d
[0m15:17:41.112860 [debug] [Thread-1  ]: SQL status: OK 305 in 1.895 seconds
[0m15:17:41.119470 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m15:17:41.123017 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4972c10>]}
[0m15:17:41.125456 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 12.24s]
[0m15:17:41.127481 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m15:17:41.128900 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m15:17:41.130802 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m15:17:41.135482 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:17:41.136317 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m15:17:41.147793 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:17:41.150131 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m15:17:41.154469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:17:42.589726 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:17:42.591519 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:17:42.592570 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:17:43.593122 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:17:43.593874 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:17:43.594282 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/79b8a351-7f62-43a7-8090-a5e44b8d2245
[0m15:17:44.090083 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/79b8a351-7f62-43a7-8090-a5e44b8d2245', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/79b8a351-7f62-43a7-8090-a5e44b8d2245/'
[0m15:17:46.012473 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:17:46.017951 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:17:46.433574 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:17:46.437855 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/5683bebd-59aa-42e5-80e9-c5dfc9d1c5de',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m15:17:46.904671 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cb32e0d2-8a57-4bc2-877b-8f9ef2589351
[0m15:17:49.670193 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":30794,"data_scanned_in_bytes":211521}
[0m15:17:49.671470 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:17:49.671799 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:17:49.879371 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 15bbcfdf-ee9f-408e-801d-4536d0c32086
[0m15:17:51.575504 [debug] [Thread-1  ]: SQL status: OK -1 in 1.892 seconds
[0m15:17:51.638056 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:17:51.658744 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:17:51.661531 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":30794,"data_scanned_in_bytes":211521}';
[0m15:17:51.879038 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0bb99a86-b1e7-45b9-8b95-a7b353a6f302
[0m15:17:53.575837 [debug] [Thread-1  ]: SQL status: OK 30794 in 1.910 seconds
[0m15:17:53.599334 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m15:17:53.605894 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74e3ca0>]}
[0m15:17:53.608448 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 30794[0m in 12.47s]
[0m15:17:53.610588 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m15:17:53.611959 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m15:17:53.613938 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m15:17:53.618714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:17:53.619427 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m15:17:53.631267 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:17:53.633519 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m15:17:53.638231 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:17:54.689505 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:17:54.691446 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:17:54.692956 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:17:55.673668 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:17:55.674305 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:17:55.674617 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/c9784e07-d766-4cd7-bb75-fe415b8662f5
[0m15:17:56.145093 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/c9784e07-d766-4cd7-bb75-fe415b8662f5', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/c9784e07-d766-4cd7-bb75-fe415b8662f5/'
[0m15:17:58.082943 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:17:58.089337 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:17:58.514863 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:17:58.517579 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/be83e663-9f89-4da2-b010-06d14e183a02',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m15:17:59.008768 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 59e39715-64ce-4216-b98b-281ce3ddc00f
[0m15:18:02.045526 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1817,"data_scanned_in_bytes":21108}
[0m15:18:02.057823 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:18:02.058515 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:18:02.291388 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ffa51a60-073b-4903-86b1-7902e0f579f8
[0m15:18:03.950325 [debug] [Thread-1  ]: SQL status: OK -1 in 1.891 seconds
[0m15:18:03.957974 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:18:03.967019 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:18:03.968442 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":1817,"data_scanned_in_bytes":21108}';
[0m15:18:04.167617 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b32479b4-75bf-481f-9ead-7467f73c9544
[0m15:18:05.869278 [debug] [Thread-1  ]: SQL status: OK 1817 in 1.894 seconds
[0m15:18:05.889491 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m15:18:05.892376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70d7340>]}
[0m15:18:05.895203 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 1817[0m in 12.28s]
[0m15:18:05.897392 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m15:18:05.899008 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m15:18:05.901573 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m15:18:05.907276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:18:05.908053 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m15:18:05.925282 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:18:05.927196 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m15:18:05.932021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:18:06.958350 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:18:06.959419 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:18:06.960463 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:18:07.938662 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:18:07.939973 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:18:07.941369 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/c951357c-5859-432d-8f8b-738837f4c8a7
[0m15:18:08.429526 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/c951357c-5859-432d-8f8b-738837f4c8a7', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/c951357c-5859-432d-8f8b-738837f4c8a7/'
[0m15:18:10.299136 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:18:10.313542 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:18:10.753699 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:18:10.755538 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/e50a87e9-7a1d-4ec9-b6a1-1608770abd27',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m15:18:11.254768 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fc4640e0-7586-4039-8add-191b6934e4d7
[0m15:18:14.117293 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2278,"data_scanned_in_bytes":53254}
[0m15:18:14.163685 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:18:14.165406 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:18:14.396182 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 879c2f83-7fe8-4279-b936-16c667f399b2
[0m15:18:16.102473 [debug] [Thread-1  ]: SQL status: OK -1 in 1.935 seconds
[0m15:18:16.110637 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:18:16.114453 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:18:16.115302 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2278,"data_scanned_in_bytes":53254}';
[0m15:18:16.318947 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 615d81d7-2da6-44f0-a4cc-32594f33f6a4
[0m15:18:18.040894 [debug] [Thread-1  ]: SQL status: OK 2278 in 1.924 seconds
[0m15:18:18.057462 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m15:18:18.060381 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4972c10>]}
[0m15:18:18.063203 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 2278[0m in 12.16s]
[0m15:18:18.065845 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m15:18:18.067887 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m15:18:18.070015 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m15:18:18.075901 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:18:18.076646 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m15:18:18.097913 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:18:18.099929 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m15:18:18.104054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:18:19.301121 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:18:19.302354 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:18:19.303409 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:18:20.346107 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:18:20.346704 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:18:20.346969 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m15:18:20.777099 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m15:18:22.716547 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m15:18:22.733368 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:18:23.192817 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:18:23.198585 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:18:23.702187 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 23e31951-ae6c-4942-9f66-9762c7139bbc
[0m15:18:25.367440 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":32611,"data_scanned_in_bytes":210413}
[0m15:18:25.368767 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:18:25.369162 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m15:18:25.604300 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 62a593ae-8e86-4a7b-947c-b8250dbf9dca
[0m15:18:27.231376 [debug] [Thread-1  ]: SQL status: OK -1 in 1.862 seconds
[0m15:18:27.234181 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m15:18:27.236220 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:18:27.236534 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":32611,"data_scanned_in_bytes":210413}';
[0m15:18:27.427057 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 03b943d6-54b9-4199-9854-883b8214a64f
[0m15:18:29.123076 [debug] [Thread-1  ]: SQL status: OK 32611 in 1.883 seconds
[0m15:18:29.140270 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m15:18:29.143161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '160f1fd8-cf31-4cf7-a7ef-f3fc75263841', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb70d7340>]}
[0m15:18:29.146162 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 32611[0m in 11.07s]
[0m15:18:29.149417 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m15:18:29.158613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:29.159261 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:18:29.162735 [info ] [MainThread]: 
[0m15:18:29.163910 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 36.58 seconds (96.58s).
[0m15:18:29.167323 [debug] [MainThread]: Command end result
[0m15:18:29.235841 [info ] [MainThread]: 
[0m15:18:29.236602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:29.236899 [info ] [MainThread]: 
[0m15:18:29.237262 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m15:18:29.240562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 99.62754, "process_user_time": 14.001703, "process_kernel_time": 1.689061, "process_mem_max_rss": "194548", "process_in_blocks": "26736", "process_out_blocks": "3224"}
[0m15:18:29.241303 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:29.241215 after 99.63 seconds
[0m15:18:29.241794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c57370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88078b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4630ee0>]}
[0m15:18:29.242123 [debug] [MainThread]: Flushing usage events
[0m15:33:51.484270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf1d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4ba580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4ba730>]}


============================== 15:33:51.512117 | 7d440e95-ab3d-4a01-b1e8-844abc326cf7 ==============================
[0m15:33:51.512117 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:33:51.512612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:33:52.137558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa997b5b0>]}
[0m15:33:52.170632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac450c40>]}
[0m15:33:52.171269 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:33:52.184820 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:33:52.297721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:52.298097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:52.335775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa08a610>]}
[0m15:33:52.415696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fa8880>]}
[0m15:33:52.416104 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m15:33:52.416368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fdd550>]}
[0m15:33:52.417689 [info ] [MainThread]: 
[0m15:33:52.418122 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:33:52.422592 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:33:52.422986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:53.096019 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:33:53.098723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:53.694577 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:33:53.695405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:54.248234 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:33:54.252374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m15:33:54.252794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:55.375351 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m15:33:55.377207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m15:33:55.378978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:56.651392 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:33:56.652759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m15:33:56.653385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:57.819926 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:33:57.823681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb94f70>]}
[0m15:33:57.824410 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:57.824817 [info ] [MainThread]: 
[0m15:33:57.836147 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m15:33:57.836832 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m15:33:57.837472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m15:33:57.837860 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m15:33:57.847598 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:33:57.849108 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m15:33:57.870318 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:33:57.871854 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m15:33:57.872125 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:33:57.872363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:33:58.452532 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d3df6408-eb0e-4034-8378-3c17b8e327dc
[0m15:34:00.330781 [debug] [Thread-1  ]: SQL status: OK -1 in 2.458 seconds
[0m15:34:01.329259 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m15:34:01.330977 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m15:34:01.783965 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m15:34:01.794217 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m15:34:01.795475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8703ee0>]}
[0m15:34:01.796053 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 3.96s]
[0m15:34:01.796730 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m15:34:01.797246 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m15:34:01.797854 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m15:34:01.799859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:34:01.800246 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m15:34:01.803123 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:34:01.804366 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m15:34:01.806324 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:34:01.807096 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m15:34:01.807325 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:34:01.807574 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:34:02.313055 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 384e3cd9-c843-47f6-8a5d-f2889ef6d169
[0m15:34:03.981021 [debug] [Thread-1  ]: SQL status: OK -1 in 2.172 seconds
[0m15:34:05.033485 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m15:34:05.039028 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m15:34:05.601801 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m15:34:05.610779 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m15:34:05.613943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8703580>]}
[0m15:34:05.615932 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.81s]
[0m15:34:05.617615 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m15:34:05.619209 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m15:34:05.621945 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m15:34:05.627919 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:34:05.628761 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m15:34:05.638736 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:34:05.641150 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m15:34:05.646356 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:34:05.647780 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:34:05.648289 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:34:05.648779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:34:06.172563 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4ed8276f-457b-42a4-baf5-d3fe7b968046
[0m15:34:08.336496 [debug] [Thread-1  ]: SQL status: OK -1 in 2.682 seconds
[0m15:34:09.963975 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m15:34:09.967400 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m15:34:10.523643 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m15:34:10.529927 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m15:34:10.533892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa10b9d0>]}
[0m15:34:10.536567 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 4.91s]
[0m15:34:10.538055 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m15:34:10.539109 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m15:34:10.540315 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m15:34:10.544325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:34:10.545031 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m15:34:10.555828 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:34:10.557383 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m15:34:10.559620 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:34:10.560439 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m15:34:10.560671 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:34:10.560892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:34:11.054531 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0e371297-b2de-4139-8731-0e07654da7b8
[0m15:34:12.772407 [debug] [Thread-1  ]: SQL status: OK -1 in 2.211 seconds
[0m15:34:13.744721 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m15:34:13.748799 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m15:34:14.237543 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m15:34:14.241095 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m15:34:14.241944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa370fa0>]}
[0m15:34:14.242794 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.70s]
[0m15:34:14.243838 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m15:34:14.244512 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m15:34:14.245164 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m15:34:14.247023 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:34:14.247452 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m15:34:14.250983 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:34:14.252307 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m15:34:14.254853 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:34:14.255657 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m15:34:14.256001 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:34:14.256306 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:34:14.773310 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2ad28491-e271-47ff-9cf0-339cd3154b9b
[0m15:34:16.529996 [debug] [Thread-1  ]: SQL status: OK -1 in 2.273 seconds
[0m15:34:17.537871 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m15:34:17.541393 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m15:34:18.048224 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m15:34:18.055644 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m15:34:18.057120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa10bdf0>]}
[0m15:34:18.058367 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 3.81s]
[0m15:34:18.059386 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m15:34:18.060370 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m15:34:18.061617 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m15:34:18.064518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:34:18.065066 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m15:34:18.072865 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:34:18.074575 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m15:34:18.110681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:34:19.203201 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:34:19.236407 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:34:19.255944 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:34:20.227993 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:34:20.229335 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:34:20.230163 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/d8026183-7acf-42ad-93c3-a947c1e3a05d
[0m15:34:20.747497 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/d8026183-7acf-42ad-93c3-a947c1e3a05d', bucket='climate-energy-raw-data', prefix='silver/eia_silver/d8026183-7acf-42ad-93c3-a947c1e3a05d/'
[0m15:34:22.668466 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:34:22.718543 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:34:23.150195 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:34:23.152826 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/32e8f3c6-dc06-4f34-909a-a9d4a15be14b',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m15:34:23.617729 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID efd56607-3c1c-48a5-917b-2a1bec056555
[0m15:34:25.286187 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:34:25.289690 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:34:25.290189 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:34:25.477197 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 39afacab-b251-4407-a88d-e82bcd96a178
[0m15:34:27.256916 [debug] [Thread-1  ]: SQL status: OK -1 in 1.966 seconds
[0m15:34:27.258732 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:34:27.260200 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:34:27.260512 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:34:27.463232 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b0dbf8fd-8556-48dc-9280-3075dfff4268
[0m15:34:29.148706 [debug] [Thread-1  ]: SQL status: OK 2842 in 1.886 seconds
[0m15:34:29.155980 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m15:34:29.157995 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa302c10>]}
[0m15:34:29.160528 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 11.09s]
[0m15:34:29.161941 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m15:34:29.163548 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m15:34:29.166840 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:34:29.170263 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:34:29.170939 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m15:34:29.189904 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:34:29.201268 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m15:34:29.220876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:34:30.273993 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:34:30.274644 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:34:30.275168 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:34:31.247406 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:34:31.249871 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:34:31.250910 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/9819b460-b89f-407d-bc6b-2daec3fb62b8
[0m15:34:31.710283 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/9819b460-b89f-407d-bc6b-2daec3fb62b8', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/9819b460-b89f-407d-bc6b-2daec3fb62b8/'
[0m15:34:33.426376 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:34:33.430382 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:34:33.864494 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:34:33.865918 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/21a88436-1d92-4eb2-af2a-0832e8fe2814',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:34:34.354293 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0a8a53e8-fc5c-4b98-b20b-dfb96b71c6b0
[0m15:34:37.184060 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:34:37.188940 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:34:37.189555 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:34:37.379310 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7db6ce09-5ef8-4c39-b5a1-bc3880a09e85
[0m15:34:39.112929 [debug] [Thread-1  ]: SQL status: OK -1 in 1.922 seconds
[0m15:34:39.117694 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:34:39.125038 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:34:39.125656 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:34:39.341448 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 33877539-04e9-4687-83c8-c45849853e2c
[0m15:34:41.062016 [debug] [Thread-1  ]: SQL status: OK 305 in 1.936 seconds
[0m15:34:41.070216 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m15:34:41.072448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa871bd00>]}
[0m15:34:41.074633 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 11.90s]
[0m15:34:41.076457 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m15:34:41.078095 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m15:34:41.079744 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m15:34:41.084461 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:34:41.085156 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m15:34:41.095351 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:34:41.096827 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m15:34:41.100508 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:34:42.278699 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:34:42.279993 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:34:42.281046 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:34:43.317139 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:34:43.319456 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:34:43.320521 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/5683bebd-59aa-42e5-80e9-c5dfc9d1c5de
[0m15:34:43.818000 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/5683bebd-59aa-42e5-80e9-c5dfc9d1c5de', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/5683bebd-59aa-42e5-80e9-c5dfc9d1c5de/'
[0m15:34:45.585761 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:34:45.594380 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:34:46.013254 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:34:46.014451 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/94004875-13cb-4cc6-a719-aa7e57a9962a',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m15:34:46.506873 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a25ba6f5-04b2-45f8-9f54-c61d8d174dad
[0m15:34:49.316467 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":30794,"data_scanned_in_bytes":211521}
[0m15:34:49.321340 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:34:49.321927 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:34:49.525670 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4fd9750f-cebb-46ae-96bc-159d511e250d
[0m15:34:51.160892 [debug] [Thread-1  ]: SQL status: OK -1 in 1.838 seconds
[0m15:34:51.165320 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:34:51.167417 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:34:51.167805 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":30794,"data_scanned_in_bytes":211521}';
[0m15:34:51.376241 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6fb5cb76-80dd-418a-a82f-dc7a738037eb
[0m15:34:53.065017 [debug] [Thread-1  ]: SQL status: OK 30794 in 1.895 seconds
[0m15:34:53.075574 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m15:34:53.078690 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ec8df0>]}
[0m15:34:53.080702 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 30794[0m in 12.00s]
[0m15:34:53.081870 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m15:34:53.082798 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m15:34:53.084245 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m15:34:53.087149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:34:53.087573 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m15:34:53.093859 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:34:53.094863 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m15:34:53.097356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:34:54.151737 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:34:54.152895 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:34:54.153738 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:34:55.320458 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:34:55.320886 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:34:55.321111 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/be83e663-9f89-4da2-b010-06d14e183a02
[0m15:34:55.783608 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/be83e663-9f89-4da2-b010-06d14e183a02', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/be83e663-9f89-4da2-b010-06d14e183a02/'
[0m15:34:57.530841 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:34:57.538001 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:34:57.956408 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:34:57.957816 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/334d27b7-98e5-44f2-bd60-617ede9a603c',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m15:34:58.469472 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d111bebd-8b99-491f-81da-bd83766a024d
[0m15:35:01.365525 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1817,"data_scanned_in_bytes":21108}
[0m15:35:01.373220 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:35:01.373754 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:35:01.569929 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID cc279280-68e5-45ab-8719-a8435ed57588
[0m15:35:03.211007 [debug] [Thread-1  ]: SQL status: OK -1 in 1.836 seconds
[0m15:35:03.216315 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:35:03.218668 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:35:03.219061 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":1817,"data_scanned_in_bytes":21108}';
[0m15:35:03.416791 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID eafa1b77-9455-43f2-bb43-0c8221b265b6
[0m15:35:05.110316 [debug] [Thread-1  ]: SQL status: OK 1817 in 1.891 seconds
[0m15:35:05.114561 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m15:35:05.115886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9fecb80>]}
[0m15:35:05.116945 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 1817[0m in 12.03s]
[0m15:35:05.118066 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m15:35:05.118885 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m15:35:05.119951 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m15:35:05.124424 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:35:05.124992 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m15:35:05.131176 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:35:05.132938 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m15:35:05.135299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:35:06.184948 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:35:06.186396 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:06.187592 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:35:07.161953 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:35:07.163154 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:07.163649 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/e50a87e9-7a1d-4ec9-b6a1-1608770abd27
[0m15:35:07.673110 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/e50a87e9-7a1d-4ec9-b6a1-1608770abd27', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/e50a87e9-7a1d-4ec9-b6a1-1608770abd27/'
[0m15:35:09.641278 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:35:09.649564 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:35:10.072726 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:35:10.073977 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/4befda27-281f-4a79-9b0e-c12614c367da',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m15:35:10.528340 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ca2e62d0-0d30-433b-816c-c53acea7200b
[0m15:35:13.528489 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2278,"data_scanned_in_bytes":53254}
[0m15:35:13.532583 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:35:13.533606 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:35:13.732964 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e830007a-b25e-4041-8f15-57086be33c4b
[0m15:35:15.526666 [debug] [Thread-1  ]: SQL status: OK -1 in 1.991 seconds
[0m15:35:15.540105 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:35:15.543332 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:35:15.545090 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2278,"data_scanned_in_bytes":53254}';
[0m15:35:15.799098 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 313a8698-f0ad-4de9-aac5-77695db3081f
[0m15:35:17.616910 [debug] [Thread-1  ]: SQL status: OK 2278 in 2.070 seconds
[0m15:35:17.624225 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m15:35:17.625902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa878b370>]}
[0m15:35:17.627428 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 2278[0m in 12.50s]
[0m15:35:17.631558 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m15:35:17.634892 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m15:35:17.636368 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m15:35:17.640662 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:35:17.641131 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m15:35:17.649260 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:35:17.652738 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m15:35:17.659304 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:35:18.868493 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:35:18.869620 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:18.870506 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:35:19.911789 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:35:19.913962 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:35:19.915172 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m15:35:20.543807 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m15:35:23.036454 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m15:35:23.043942 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:35:23.776216 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:35:23.779115 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:35:24.607176 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5c1945b0-cff3-4edd-a5e4-e1c372cc9a62
[0m15:35:27.992875 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":32611,"data_scanned_in_bytes":210413}
[0m15:35:28.025110 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:35:28.026653 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m15:35:28.305148 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5eb66a1d-2d85-4533-b1db-cab984bbdeee
[0m15:35:30.274476 [debug] [Thread-1  ]: SQL status: OK -1 in 2.245 seconds
[0m15:35:30.279895 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m15:35:30.282099 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:35:30.282342 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":32611,"data_scanned_in_bytes":210413}';
[0m15:35:30.552435 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1a259711-711f-459f-8185-9177785e0e2d
[0m15:35:32.316551 [debug] [Thread-1  ]: SQL status: OK 32611 in 2.033 seconds
[0m15:35:32.321820 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m15:35:32.323278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d440e95-ab3d-4a01-b1e8-844abc326cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa878b6a0>]}
[0m15:35:32.325074 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 32611[0m in 14.69s]
[0m15:35:32.326428 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m15:35:32.337738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:32.338335 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:35:32.341231 [info ] [MainThread]: 
[0m15:35:32.341643 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 39.92 seconds (99.92s).
[0m15:35:32.343663 [debug] [MainThread]: Command end result
[0m15:35:32.384672 [info ] [MainThread]: 
[0m15:35:32.385194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:32.385638 [info ] [MainThread]: 
[0m15:35:32.386066 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m15:35:32.388103 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 100.96743, "process_user_time": 10.278901, "process_kernel_time": 1.28281, "process_mem_max_rss": "183304", "process_in_blocks": "19944", "process_out_blocks": "8625"}
[0m15:35:32.389173 [debug] [MainThread]: Command `dbt run` succeeded at 15:35:32.389023 after 100.97 seconds
[0m15:35:32.389632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf1d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb4c220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa989e160>]}
[0m15:35:32.390016 [debug] [MainThread]: Flushing usage events
[0m15:38:27.391937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac55a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6c15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabdc520>]}


============================== 15:38:27.409510 | 764c9fbb-b070-44d4-a5bf-ce697c6e9010 ==============================
[0m15:38:27.409510 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:38:27.410016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:38:28.001443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa4dff70>]}
[0m15:38:28.032113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac6bec10>]}
[0m15:38:28.032794 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:38:28.061099 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:38:28.264474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:28.265783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:38:28.310578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80fbe20>]}
[0m15:38:28.417514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa801a790>]}
[0m15:38:28.418358 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m15:38:28.418952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa804d490>]}
[0m15:38:28.421735 [info ] [MainThread]: 
[0m15:38:28.422996 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:38:28.428701 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:38:28.429295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:29.182965 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:38:29.184946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:29.760742 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:38:29.763708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:30.313361 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:38:30.317510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m15:38:30.317949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:31.536878 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:38:31.537935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m15:38:31.540540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:32.742479 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m15:38:32.744371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m15:38:32.746597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:33.814861 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:38:33.817651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa798b0a0>]}
[0m15:38:33.819340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:33.820435 [info ] [MainThread]: 
[0m15:38:33.834210 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m15:38:33.835141 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m15:38:33.836230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.eia_bronze)
[0m15:38:33.836791 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m15:38:33.852522 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:38:33.854593 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m15:38:33.878412 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:38:33.879667 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m15:38:33.879942 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:38:33.880187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:38:34.428742 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2f8108d1-0de1-4a3e-acf0-f480055ccf28
[0m15:38:36.377159 [debug] [Thread-1  ]: SQL status: OK -1 in 2.497 seconds
[0m15:38:37.421625 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m15:38:37.423691 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m15:38:37.890130 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m15:38:37.905306 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m15:38:37.907930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66a1c40>]}
[0m15:38:37.909080 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 4.07s]
[0m15:38:37.910678 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m15:38:37.911872 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m15:38:37.913169 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m15:38:37.915957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:38:37.916491 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m15:38:37.921201 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:38:37.922723 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m15:38:37.925838 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:38:37.927010 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m15:38:37.927471 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:38:37.927921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:38:38.449581 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 13e41447-aaad-41e1-8dac-641580e883e9
[0m15:38:40.159419 [debug] [Thread-1  ]: SQL status: OK -1 in 2.231 seconds
[0m15:38:41.178604 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m15:38:41.182759 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m15:38:41.660480 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m15:38:41.665521 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m15:38:41.668321 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6685fd0>]}
[0m15:38:41.669919 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.75s]
[0m15:38:41.671186 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m15:38:41.672127 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m15:38:41.673064 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m15:38:41.675596 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:38:41.676123 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m15:38:41.688194 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:38:41.690951 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m15:38:41.695269 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:38:41.697381 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:38:41.697942 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:38:41.699931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:38:42.202408 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 666ba1d9-826b-4df6-ac82-918f6fdca39f
[0m15:38:44.084215 [debug] [Thread-1  ]: SQL status: OK -1 in 2.385 seconds
[0m15:38:45.193621 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m15:38:45.216372 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m15:38:45.740997 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m15:38:45.746762 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m15:38:45.751103 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa4912e0>]}
[0m15:38:45.753045 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 4.08s]
[0m15:38:45.754636 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m15:38:45.755826 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m15:38:45.757580 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m15:38:45.761445 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:38:45.762156 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m15:38:45.771455 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:38:45.773675 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m15:38:45.780212 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:38:45.781410 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m15:38:45.781756 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:38:45.782097 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:38:46.312322 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f5587123-1e8c-4962-a423-88f414fc5923
[0m15:38:47.979059 [debug] [Thread-1  ]: SQL status: OK -1 in 2.197 seconds
[0m15:38:49.036000 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m15:38:49.038331 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m15:38:49.526142 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m15:38:49.534012 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m15:38:49.536533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa835b310>]}
[0m15:38:49.540445 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.78s]
[0m15:38:49.542008 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m15:38:49.543161 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m15:38:49.544971 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m15:38:49.549796 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:38:49.551642 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m15:38:49.561460 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:38:49.563346 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m15:38:49.566424 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:38:49.567412 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m15:38:49.567722 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:38:49.568060 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:38:50.131523 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f7a9def7-6b92-42ce-aa22-e7f6dcc90e0e
[0m15:38:52.048159 [debug] [Thread-1  ]: SQL status: OK -1 in 2.480 seconds
[0m15:38:53.135834 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m15:38:53.140031 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m15:38:53.652956 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m15:38:53.658701 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m15:38:53.660550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab147c70>]}
[0m15:38:53.662012 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 4.11s]
[0m15:38:53.663275 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m15:38:53.664434 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m15:38:53.665979 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m15:38:53.672738 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:38:53.673968 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m15:38:53.681006 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:38:53.683009 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m15:38:53.715807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:38:54.724345 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:38:54.724921 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:38:54.727856 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:38:55.838476 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:38:55.840009 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:38:55.840670 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/32e8f3c6-dc06-4f34-909a-a9d4a15be14b
[0m15:38:56.399912 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/32e8f3c6-dc06-4f34-909a-a9d4a15be14b', bucket='climate-energy-raw-data', prefix='silver/eia_silver/32e8f3c6-dc06-4f34-909a-a9d4a15be14b/'
[0m15:38:58.139057 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:38:58.189303 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:38:58.607635 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:38:58.610575 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/99dfa4b6-1db1-4e7f-a227-d22cfaf45e7e',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m15:38:59.083901 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1ff27d2b-3747-4214-a6c8-f5212e28b190
[0m15:39:01.889792 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:39:01.900504 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:39:01.901384 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:39:02.106624 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7f02914a-dcc0-4a55-964d-bc60b24220ae
[0m15:39:03.980657 [debug] [Thread-1  ]: SQL status: OK -1 in 2.078 seconds
[0m15:39:03.985181 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:39:03.989354 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:39:03.990971 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:39:04.195459 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID bb597936-06ca-49ed-8cf9-3ba9c86aa426
[0m15:39:05.918198 [debug] [Thread-1  ]: SQL status: OK 2842 in 1.925 seconds
[0m15:39:05.932919 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m15:39:05.938107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6729280>]}
[0m15:39:05.942721 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 12.27s]
[0m15:39:05.944354 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m15:39:05.945313 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m15:39:05.946510 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:39:05.949625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:39:05.950138 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m15:39:05.959002 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:39:05.960716 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m15:39:05.964370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:07.041882 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:39:07.043266 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:07.044280 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:39:08.039705 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:39:08.040415 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:08.040933 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/21a88436-1d92-4eb2-af2a-0832e8fe2814
[0m15:39:08.504047 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/21a88436-1d92-4eb2-af2a-0832e8fe2814', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/21a88436-1d92-4eb2-af2a-0832e8fe2814/'
[0m15:39:10.288167 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:39:10.295480 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:39:10.717435 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:39:10.721039 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/73ee57d1-a224-4578-8b9a-3e55c733175c',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:39:11.226065 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0638d354-16cb-4881-9b3f-7c63fb4cce43
[0m15:39:12.873106 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:39:12.876695 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:39:12.877487 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:39:13.076012 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f23353a7-a594-40fb-a01b-c3fc29ac3b7d
[0m15:39:14.716494 [debug] [Thread-1  ]: SQL status: OK -1 in 1.838 seconds
[0m15:39:14.720525 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:39:14.725537 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:39:14.726084 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:39:14.945266 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9ad2cff2-6e4f-4ee3-bf94-11e17fca52df
[0m15:39:16.726703 [debug] [Thread-1  ]: SQL status: OK 305 in 1.998 seconds
[0m15:39:16.744179 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m15:39:16.746019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa54d68e0>]}
[0m15:39:16.747746 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 10.80s]
[0m15:39:16.749615 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m15:39:16.750884 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m15:39:16.752182 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m15:39:16.757631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:39:16.758558 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m15:39:16.766019 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:39:16.767743 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m15:39:16.772676 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:18.110108 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:39:18.112563 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:18.127951 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:39:19.132571 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:39:19.133448 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:19.133940 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/94004875-13cb-4cc6-a719-aa7e57a9962a
[0m15:39:19.634579 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/94004875-13cb-4cc6-a719-aa7e57a9962a', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/94004875-13cb-4cc6-a719-aa7e57a9962a/'
[0m15:39:21.411467 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:39:21.425296 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:39:21.835711 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:39:21.838208 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/f06a5afc-e21c-4477-a64b-0953912654e6',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m15:39:22.386754 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c786ce35-e405-444d-a4d8-4b76a3462633
[0m15:39:25.377763 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":30794,"data_scanned_in_bytes":211521}
[0m15:39:25.383212 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:39:25.383927 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:39:25.607301 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 16617578-e1a4-4168-b296-fd034532ba0b
[0m15:39:27.281451 [debug] [Thread-1  ]: SQL status: OK -1 in 1.897 seconds
[0m15:39:27.289769 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:39:27.292434 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:39:27.293047 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":30794,"data_scanned_in_bytes":211521}';
[0m15:39:27.513462 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 23f39af4-7194-450e-88df-4bcda153571a
[0m15:39:29.286990 [debug] [Thread-1  ]: SQL status: OK 30794 in 1.990 seconds
[0m15:39:29.314425 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m15:39:29.317383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63dfaf0>]}
[0m15:39:29.320310 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 30794[0m in 12.56s]
[0m15:39:29.322619 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m15:39:29.324189 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m15:39:29.326310 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m15:39:29.331395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:39:29.332218 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m15:39:29.342431 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:39:29.344821 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m15:39:29.348758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:30.437824 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:39:30.439586 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:30.441037 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:39:31.613923 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:39:31.614425 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:31.614708 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/334d27b7-98e5-44f2-bd60-617ede9a603c
[0m15:39:32.050689 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/334d27b7-98e5-44f2-bd60-617ede9a603c', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/334d27b7-98e5-44f2-bd60-617ede9a603c/'
[0m15:39:33.955737 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:39:33.963649 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:39:34.401333 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:39:34.404675 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/effc1335-697b-4d45-aae5-3bacd77cd36f',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m15:39:34.896120 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4d2ff170-0bcc-43d3-89c3-d57ea9e84764
[0m15:39:37.770659 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1817,"data_scanned_in_bytes":21108}
[0m15:39:37.776582 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:39:37.777180 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:39:37.974548 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fbfc4056-144d-4b3d-a7e0-d6fbc693ff83
[0m15:39:39.687026 [debug] [Thread-1  ]: SQL status: OK -1 in 1.906 seconds
[0m15:39:39.703018 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:39:39.708905 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:39:39.709671 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":1817,"data_scanned_in_bytes":21108}';
[0m15:39:39.906583 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d8551b9d-af52-41b0-93d0-3e9aad6e25fb
[0m15:39:41.600763 [debug] [Thread-1  ]: SQL status: OK 1817 in 1.890 seconds
[0m15:39:41.614601 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m15:39:41.618112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa835b1c0>]}
[0m15:39:41.621055 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 1817[0m in 12.29s]
[0m15:39:41.623541 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m15:39:41.625411 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m15:39:41.629491 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m15:39:41.641768 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:39:41.642542 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m15:39:41.652555 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:39:41.654066 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m15:39:41.658199 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:42.825922 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:39:42.829451 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:42.830511 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:39:43.811851 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:39:43.813137 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:43.813788 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/4befda27-281f-4a79-9b0e-c12614c367da
[0m15:39:44.323368 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/4befda27-281f-4a79-9b0e-c12614c367da', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/4befda27-281f-4a79-9b0e-c12614c367da/'
[0m15:39:47.178004 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:39:47.184907 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:39:47.621000 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:39:47.622698 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/27d9ab10-3642-4d0d-ad5c-06a834ff0d3c',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m15:39:48.120178 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ba86996b-3696-44ce-b10a-d6e99bb95881
[0m15:39:51.295279 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2278,"data_scanned_in_bytes":53254}
[0m15:39:51.298132 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:39:51.299093 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:39:51.514866 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6279292d-7f4a-4471-8981-cccce1702689
[0m15:39:53.164383 [debug] [Thread-1  ]: SQL status: OK -1 in 1.864 seconds
[0m15:39:53.168182 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:39:53.171647 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:39:53.172623 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2278,"data_scanned_in_bytes":53254}';
[0m15:39:53.389673 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1e00e0e9-f6b1-4d02-ab7f-7fedca98f7c8
[0m15:39:55.128693 [debug] [Thread-1  ]: SQL status: OK 2278 in 1.956 seconds
[0m15:39:55.193931 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m15:39:55.197992 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa835baf0>]}
[0m15:39:55.201648 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 2278[0m in 13.56s]
[0m15:39:55.207215 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m15:39:55.213128 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m15:39:55.217283 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m15:39:55.226600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:39:55.229609 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m15:39:55.252905 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:39:55.260694 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m15:39:55.270090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:56.434267 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:39:56.438010 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:56.440492 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:39:57.417581 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:39:57.418189 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:39:57.418712 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m15:39:57.916860 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m15:39:59.663786 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m15:39:59.675753 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:40:00.131635 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:40:00.133336 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:40:00.601730 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4c6e29fd-4598-4fd8-9ec4-417afe15fe90
[0m15:40:02.280133 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":32611,"data_scanned_in_bytes":210413}
[0m15:40:02.284398 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:40:02.285827 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m15:40:02.488938 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 88e18321-8740-40da-86d8-2e5daf9eb4b9
[0m15:40:04.126316 [debug] [Thread-1  ]: SQL status: OK -1 in 1.838 seconds
[0m15:40:04.135367 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m15:40:04.139562 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:40:04.140325 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":32611,"data_scanned_in_bytes":210413}';
[0m15:40:04.439861 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 025f9806-b760-4ec6-acd4-87d02bfc8e82
[0m15:40:06.138617 [debug] [Thread-1  ]: SQL status: OK 32611 in 1.997 seconds
[0m15:40:06.151388 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m15:40:06.152978 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '764c9fbb-b070-44d4-a5bf-ce697c6e9010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6574190>]}
[0m15:40:06.154442 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 32611[0m in 10.93s]
[0m15:40:06.155728 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m15:40:06.162010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:06.162416 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:40:06.165693 [info ] [MainThread]: 
[0m15:40:06.166300 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 37.74 seconds (97.74s).
[0m15:40:06.168514 [debug] [MainThread]: Command end result
[0m15:40:06.208863 [info ] [MainThread]: 
[0m15:40:06.209595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:06.209953 [info ] [MainThread]: 
[0m15:40:06.210729 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m15:40:06.217067 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 98.857185, "process_user_time": 11.360947, "process_kernel_time": 1.471327, "process_mem_max_rss": "184144", "process_in_blocks": "38408", "process_out_blocks": "8625"}
[0m15:40:06.217982 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:06.217903 after 98.86 seconds
[0m15:40:06.218475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac55a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbc7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa803a0d0>]}
[0m15:40:06.218762 [debug] [MainThread]: Flushing usage events
[0m15:44:17.769734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d59160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2065b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f206280>]}


============================== 15:44:17.774374 | 7f615c9b-045e-428b-9fb0-3b5f37c56897 ==============================
[0m15:44:17.774374 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:44:17.774758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:44:18.215584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dcded00>]}
[0m15:44:18.245248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914b3250>]}
[0m15:44:18.245737 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:44:18.257717 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:44:18.391571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:18.392118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:18.428313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce88910>]}
[0m15:44:18.524761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cdaa8e0>]}
[0m15:44:18.525311 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m15:44:18.525949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cddb5b0>]}
[0m15:44:18.527540 [info ] [MainThread]: 
[0m15:44:18.528168 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:44:18.533207 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:44:18.533789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:19.135036 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:44:19.137043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:19.816093 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:44:19.818781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:20.339742 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:44:20.344759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m15:44:20.345647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:21.402125 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m15:44:21.403940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m15:44:21.407021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:22.619806 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:44:22.623503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m15:44:22.625074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:23.815284 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:44:23.819235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c697730>]}
[0m15:44:23.820419 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:44:23.820841 [info ] [MainThread]: 
[0m15:44:23.835927 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m15:44:23.837085 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m15:44:23.838093 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m15:44:23.838463 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m15:44:23.863470 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:44:23.865898 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m15:44:23.890963 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:44:23.892460 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m15:44:23.893046 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:44:23.893723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:44:24.435568 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 91afa6b2-b436-4948-86c4-169cfe9fcaea
[0m15:44:26.376345 [debug] [Thread-1  ]: SQL status: OK -1 in 2.482 seconds
[0m15:44:27.461029 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m15:44:27.464615 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m15:44:27.952298 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m15:44:27.973681 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m15:44:27.977191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5c4eb0>]}
[0m15:44:27.978441 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 4.14s]
[0m15:44:27.979572 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m15:44:27.980493 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m15:44:27.982661 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m15:44:27.986664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:44:27.987312 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m15:44:27.993432 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:44:27.995797 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m15:44:27.998685 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:44:27.999609 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m15:44:27.999914 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:44:28.000176 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:44:28.573873 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6a2df948-3ed9-4f0d-be69-aff7f3979dba
[0m15:44:30.267249 [debug] [Thread-1  ]: SQL status: OK -1 in 2.267 seconds
[0m15:44:31.344901 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m15:44:31.347175 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m15:44:31.822071 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m15:44:31.828612 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m15:44:31.830304 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5c4cd0>]}
[0m15:44:31.831726 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.85s]
[0m15:44:31.832816 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m15:44:31.833725 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m15:44:31.834975 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m15:44:31.845701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:44:31.846544 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m15:44:31.853054 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:44:31.854804 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m15:44:31.857857 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:44:31.859883 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:44:31.860736 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:44:31.861076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:44:32.427693 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 41100144-d25c-43ba-9352-d73d12238c73
[0m15:44:34.308600 [debug] [Thread-1  ]: SQL status: OK -1 in 2.447 seconds
[0m15:44:35.720910 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m15:44:35.725168 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m15:44:36.239212 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m15:44:36.265084 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m15:44:36.268789 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a3dbfd0>]}
[0m15:44:36.271963 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 4.43s]
[0m15:44:36.274085 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m15:44:36.276173 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m15:44:36.278548 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m15:44:36.284823 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:44:36.285811 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m15:44:36.296311 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:44:36.298210 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m15:44:36.305708 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:44:36.309358 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m15:44:36.312019 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:44:36.316500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:44:36.955973 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 74d02463-ea72-4c64-9480-fea18620514c
[0m15:44:38.612990 [debug] [Thread-1  ]: SQL status: OK -1 in 2.296 seconds
[0m15:44:39.616281 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m15:44:39.619498 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m15:44:40.108208 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m15:44:40.118868 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m15:44:40.122536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf49b50>]}
[0m15:44:40.125039 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.84s]
[0m15:44:40.129094 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m15:44:40.130846 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m15:44:40.134872 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m15:44:40.139861 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:44:40.140707 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m15:44:40.153963 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:44:40.156025 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m15:44:40.159911 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:44:40.161004 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m15:44:40.161369 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:44:40.161714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:44:40.677743 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1f6095a0-48e9-4d07-89f7-1d4028aee22e
[0m15:44:42.578239 [debug] [Thread-1  ]: SQL status: OK -1 in 2.416 seconds
[0m15:44:43.603554 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m15:44:43.608792 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m15:44:44.106890 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m15:44:44.114122 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m15:44:44.115653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ce93970>]}
[0m15:44:44.117103 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 3.98s]
[0m15:44:44.118904 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m15:44:44.120254 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m15:44:44.121529 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m15:44:44.125878 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:44:44.126926 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m15:44:44.135678 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:44:44.138788 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m15:44:44.183902 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:44:45.399143 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:44:45.410642 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:44:45.433009 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:44:46.424158 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:44:46.425558 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:44:46.426676 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/99dfa4b6-1db1-4e7f-a227-d22cfaf45e7e
[0m15:44:46.958863 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/99dfa4b6-1db1-4e7f-a227-d22cfaf45e7e', bucket='climate-energy-raw-data', prefix='silver/eia_silver/99dfa4b6-1db1-4e7f-a227-d22cfaf45e7e/'
[0m15:44:48.753338 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:44:48.790210 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:44:49.203144 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:44:49.206270 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/d677eb8a-1c34-4fc2-b9ce-0e5091b9ec25',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m15:44:49.671867 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 73e3cb37-bf1c-4933-97b1-f10357adbd2f
[0m15:44:52.480642 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:44:52.494056 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:44:52.494964 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:44:52.699525 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 329e2f0b-97fb-40b4-a6c9-30c435f9887f
[0m15:44:54.363392 [debug] [Thread-1  ]: SQL status: OK -1 in 1.869 seconds
[0m15:44:54.368067 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:44:54.370243 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:44:54.370628 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:44:54.569465 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e5f218f9-8118-4451-be70-c956a78394e0
[0m15:44:56.413697 [debug] [Thread-1  ]: SQL status: OK 2842 in 2.042 seconds
[0m15:44:56.419802 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m15:44:56.421190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f292070>]}
[0m15:44:56.423047 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 12.30s]
[0m15:44:56.424966 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m15:44:56.426273 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m15:44:56.427505 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:44:56.432056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:44:56.433005 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m15:44:56.438563 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:44:56.440870 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m15:44:56.445250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:44:57.458960 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:44:57.460028 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:44:57.460975 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:44:58.474870 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:44:58.476447 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:44:58.477025 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/73ee57d1-a224-4578-8b9a-3e55c733175c
[0m15:44:58.939590 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/73ee57d1-a224-4578-8b9a-3e55c733175c', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/73ee57d1-a224-4578-8b9a-3e55c733175c/'
[0m15:45:00.914498 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:45:00.921097 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:45:01.325968 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:45:01.327132 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/0ecbfc73-f53f-4aa4-b85b-6945eecf43f4',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:45:01.849242 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5001cc5c-abef-4c04-bfd3-cc1e7ed0e3ca
[0m15:45:04.651834 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:45:04.655602 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:45:04.656389 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:45:04.879519 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4b2b3b95-dd6e-4839-b0bf-4c0bb553d8e1
[0m15:45:06.583147 [debug] [Thread-1  ]: SQL status: OK -1 in 1.925 seconds
[0m15:45:06.589775 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:45:06.592591 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:45:06.592960 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:45:06.807723 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b6bb993b-1525-4036-96b3-8409aae47c78
[0m15:45:08.528743 [debug] [Thread-1  ]: SQL status: OK 305 in 1.935 seconds
[0m15:45:08.533265 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m15:45:08.534238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c93db80>]}
[0m15:45:08.542204 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 12.11s]
[0m15:45:08.543965 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m15:45:08.544852 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m15:45:08.545900 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m15:45:08.549819 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:45:08.550219 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m15:45:08.555647 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:45:08.556494 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m15:45:08.559289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:45:09.741228 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:45:09.742158 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:45:09.743389 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:45:10.718234 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:45:10.720084 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:45:10.720807 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/f06a5afc-e21c-4477-a64b-0953912654e6
[0m15:45:11.232795 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/f06a5afc-e21c-4477-a64b-0953912654e6', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/f06a5afc-e21c-4477-a64b-0953912654e6/'
[0m15:45:13.114011 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:45:13.124069 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:45:13.563378 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:45:13.565924 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/192ddc48-9674-4831-bca4-e33e40216398',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m15:45:14.069166 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 216ddbea-dc3e-42e8-8532-b906c7c7365d
[0m15:45:16.888325 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":30794,"data_scanned_in_bytes":211521}
[0m15:45:16.895235 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:45:16.895867 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:45:17.141087 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7ef05451-4a79-4c55-8cf7-69c5f8e0e3c1
[0m15:45:18.790965 [debug] [Thread-1  ]: SQL status: OK -1 in 1.894 seconds
[0m15:45:18.795267 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:45:18.798478 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:45:18.798895 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":30794,"data_scanned_in_bytes":211521}';
[0m15:45:18.991903 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2e2b365f-b7f5-4ef8-b4ec-572b9e041ecd
[0m15:45:20.708745 [debug] [Thread-1  ]: SQL status: OK 30794 in 1.909 seconds
[0m15:45:20.719886 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m15:45:20.723981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c93db80>]}
[0m15:45:20.727368 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 30794[0m in 12.18s]
[0m15:45:20.730368 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m15:45:20.732264 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m15:45:20.734805 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m15:45:20.740888 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:45:20.741943 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m15:45:20.755063 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:45:20.757254 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m15:45:20.761107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:45:21.904215 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:45:21.906320 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:45:21.907167 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:45:22.868973 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:45:22.869801 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:45:22.870441 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/effc1335-697b-4d45-aae5-3bacd77cd36f
[0m15:45:23.479376 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/effc1335-697b-4d45-aae5-3bacd77cd36f', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/effc1335-697b-4d45-aae5-3bacd77cd36f/'
[0m15:45:25.213746 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:45:25.229801 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:45:25.724160 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:45:25.752575 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/6d56157a-3c24-4350-8e2b-2d73f5881083',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m15:45:26.265803 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b38e76cd-cf42-4c7f-b7f3-b5b196951594
[0m15:45:29.100748 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1817,"data_scanned_in_bytes":21108}
[0m15:45:29.107830 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:45:29.108670 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:45:29.304990 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0669d5fa-ba0b-42ea-ab75-70cf68898b74
[0m15:45:30.961761 [debug] [Thread-1  ]: SQL status: OK -1 in 1.852 seconds
[0m15:45:30.966629 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:45:30.968811 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:45:30.969241 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":1817,"data_scanned_in_bytes":21108}';
[0m15:45:31.176589 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 57fb3bef-e228-4612-a9f0-7a74012f901e
[0m15:45:32.910040 [debug] [Thread-1  ]: SQL status: OK 1817 in 1.921 seconds
[0m15:45:32.924798 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m15:45:32.926314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6d8430>]}
[0m15:45:32.928974 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 1817[0m in 12.19s]
[0m15:45:32.930606 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m15:45:32.931662 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m15:45:32.933109 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m15:45:32.944199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:45:32.946925 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m15:45:32.960270 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:45:32.963728 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m15:45:32.971727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:45:34.091656 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:45:34.092250 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:45:34.092777 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:45:35.058590 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:45:35.092029 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:45:35.129821 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/27d9ab10-3642-4d0d-ad5c-06a834ff0d3c
[0m15:45:35.717927 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/27d9ab10-3642-4d0d-ad5c-06a834ff0d3c', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/27d9ab10-3642-4d0d-ad5c-06a834ff0d3c/'
[0m15:45:37.546588 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:45:37.562028 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:45:38.008008 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:45:38.010518 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/0b5f8bcf-0529-42f5-bc99-01181b5de4e0',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m15:45:38.482273 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID da5f9b3b-2558-4813-843f-307861358106
[0m15:45:41.263186 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2278,"data_scanned_in_bytes":53254}
[0m15:45:41.269859 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:45:41.270752 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:45:41.462862 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID feb568be-27f4-4aa7-9645-996e357f58f9
[0m15:45:43.272572 [debug] [Thread-1  ]: SQL status: OK -1 in 2.001 seconds
[0m15:45:43.275431 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:45:43.278602 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:45:43.279199 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2278,"data_scanned_in_bytes":53254}';
[0m15:45:43.483647 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 31e55401-1207-4fbc-9e53-184568f5ec7e
[0m15:45:45.284010 [debug] [Thread-1  ]: SQL status: OK 2278 in 1.997 seconds
[0m15:45:45.332505 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m15:45:45.335302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5c49d0>]}
[0m15:45:45.337982 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 2278[0m in 12.40s]
[0m15:45:45.339334 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m15:45:45.340441 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m15:45:45.341367 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m15:45:45.356210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:45:45.358305 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m15:45:45.379062 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:45:45.411598 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m15:45:45.424800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:45:46.569077 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:45:46.570217 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:45:46.571078 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:45:47.571544 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:45:47.572604 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:45:47.573821 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m15:45:48.087395 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m15:45:50.065192 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m15:45:50.071914 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:45:50.520933 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:45:50.527083 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:45:51.024609 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4e15d97b-0942-4187-b1bb-adb29514467a
[0m15:45:52.709192 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":32611,"data_scanned_in_bytes":210413}
[0m15:45:52.711757 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:45:52.712180 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m15:45:52.909745 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1e69dca0-92bc-417d-af79-833363e40dc6
[0m15:45:54.550280 [debug] [Thread-1  ]: SQL status: OK -1 in 1.839 seconds
[0m15:45:54.565763 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m15:45:54.569853 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:45:54.570435 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":32611,"data_scanned_in_bytes":210413}';
[0m15:45:54.764867 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 994f6380-d9c7-4216-81e7-4d912b2c920a
[0m15:45:56.457073 [debug] [Thread-1  ]: SQL status: OK 32611 in 1.885 seconds
[0m15:45:56.474789 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m15:45:56.476798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f615c9b-045e-428b-9fb0-3b5f37c56897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5c4ac0>]}
[0m15:45:56.478614 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 32611[0m in 11.13s]
[0m15:45:56.480266 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m15:45:56.486232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:56.486835 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:45:56.492229 [info ] [MainThread]: 
[0m15:45:56.493179 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 37.96 seconds (97.96s).
[0m15:45:56.497414 [debug] [MainThread]: Command end result
[0m15:45:56.542159 [info ] [MainThread]: 
[0m15:45:56.542614 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:56.542862 [info ] [MainThread]: 
[0m15:45:56.543183 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m15:45:56.545724 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 98.82804, "process_user_time": 10.695233, "process_kernel_time": 1.576032, "process_mem_max_rss": "183000", "process_in_blocks": "55792", "process_out_blocks": "2217"}
[0m15:45:56.546558 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:56.546475 after 98.83 seconds
[0m15:45:56.546958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d59160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f90bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bd6790>]}
[0m15:45:56.547186 [debug] [MainThread]: Flushing usage events
[0m15:46:19.341852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7a2340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2e2070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2e2a30>]}


============================== 15:46:19.346431 | 404516e5-f01d-4f80-9cc5-17f005ce6bb1 ==============================
[0m15:46:19.346431 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:46:19.346986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'send_anonymous_usage_stats': 'True'}
[0m15:46:19.827304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '404516e5-f01d-4f80-9cc5-17f005ce6bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad54b3d0>]}
[0m15:46:19.877375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '404516e5-f01d-4f80-9cc5-17f005ce6bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac8894f0>]}
[0m15:46:19.878920 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:46:19.903259 [debug] [MainThread]: checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, vars: {}, profile: gold, target: , version: 1.8.7
[0m15:46:20.025967 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:46:20.026759 [debug] [MainThread]: previous checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m15:46:20.027228 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:46:20.027570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '404516e5-f01d-4f80-9cc5-17f005ce6bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac86eee0>]}
[0m15:46:20.914991 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:46:20.915646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '404516e5-f01d-4f80-9cc5-17f005ce6bb1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa98ac310>]}
[0m15:46:21.091919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '404516e5-f01d-4f80-9cc5-17f005ce6bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94b4820>]}
[0m15:46:21.174334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '404516e5-f01d-4f80-9cc5-17f005ce6bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9084340>]}
[0m15:46:21.175146 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m15:46:21.175617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '404516e5-f01d-4f80-9cc5-17f005ce6bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa91d6400>]}
[0m15:46:21.177376 [info ] [MainThread]: 
[0m15:46:21.178106 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:46:21.179132 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:46:21.179496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:21.717027 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:46:21.729512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m15:46:21.730216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:22.875161 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m15:46:22.876522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m15:46:22.878160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:24.088267 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:46:24.090442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m15:46:24.093934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:25.419129 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:46:25.505569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '404516e5-f01d-4f80-9cc5-17f005ce6bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ff6d60>]}
[0m15:46:25.516029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:25.522789 [info ] [MainThread]: 
[0m15:46:25.568154 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m15:46:25.571621 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m15:46:25.573600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.weather_data_gold)
[0m15:46:25.574185 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m15:46:25.588509 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:46:25.590294 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m15:46:25.648267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:46:27.084581 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:46:27.087135 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:46:27.091885 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:46:28.122463 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:46:28.123672 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:46:28.124806 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m15:46:28.692008 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m15:46:30.614894 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m15:46:30.662833 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:46:31.081666 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:46:31.084916 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:46:31.649322 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 899a69d5-be45-4b06-bb99-ca0454d17a69
[0m15:46:34.487270 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":32611,"data_scanned_in_bytes":210413}
[0m15:46:34.507535 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:46:34.508434 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m15:46:34.703511 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a3f71c13-dd0d-4e2b-9588-d0fd2f02f7dc
[0m15:46:36.380678 [debug] [Thread-1  ]: SQL status: OK -1 in 1.869 seconds
[0m15:46:36.392775 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m15:46:36.398819 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:46:36.399658 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":32611,"data_scanned_in_bytes":210413}';
[0m15:46:36.619356 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a1f0c596-1b9a-4e04-b8b8-4a8addd57cd6
[0m15:46:38.297086 [debug] [Thread-1  ]: SQL status: OK 32611 in 1.897 seconds
[0m15:46:38.316435 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m15:46:38.318716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '404516e5-f01d-4f80-9cc5-17f005ce6bb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9103250>]}
[0m15:46:38.320145 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 32611[0m in 12.74s]
[0m15:46:38.321447 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m15:46:38.324813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:38.325176 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:46:38.327048 [info ] [MainThread]: 
[0m15:46:38.327436 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 17.15 seconds (17.15s).
[0m15:46:38.328315 [debug] [MainThread]: Command end result
[0m15:46:38.366342 [info ] [MainThread]: 
[0m15:46:38.367007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:38.367360 [info ] [MainThread]: 
[0m15:46:38.367724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:46:38.370275 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.058895, "process_user_time": 4.494277, "process_kernel_time": 0.61177, "process_mem_max_rss": "179352", "process_in_blocks": "25952", "process_out_blocks": "3109"}
[0m15:46:38.371243 [debug] [MainThread]: Command `dbt run` succeeded at 15:46:38.371105 after 19.06 seconds
[0m15:46:38.371672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad7a2340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac87e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac889460>]}
[0m15:46:38.371920 [debug] [MainThread]: Flushing usage events
[0m13:29:00.386799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bda430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d405b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f25c520>]}


============================== 13:29:00.403954 | caafe276-a50a-4ddb-ac2a-9424e6e0f078 ==============================
[0m13:29:00.403954 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:29:00.404403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:29:01.096117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb5ff70>]}
[0m13:29:01.128367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebc0bb0>]}
[0m13:29:01.129099 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m13:29:01.143729 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:29:01.265198 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:29:01.267552 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2
[0m13:29:01.269349 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:29:01.270143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f76d9a0>]}
[0m13:29:02.539830 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:29:02.540662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c707280>]}
[0m13:29:02.795766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c32b7f0>]}
[0m13:29:03.089676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2f09d0>]}
[0m13:29:03.090565 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m13:29:03.090900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c2450d0>]}
[0m13:29:03.092989 [info ] [MainThread]: 
[0m13:29:03.094736 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m13:29:03.102474 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m13:29:03.103336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:03.903383 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:29:03.906352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:04.628697 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:29:04.629825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:05.133211 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:29:05.138805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m13:29:05.139300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:06.271254 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m13:29:06.274181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m13:29:06.275591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:07.663459 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m13:29:07.665289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m13:29:07.670959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:08.709580 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m13:29:08.711388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c3ef850>]}
[0m13:29:08.713447 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:08.716998 [info ] [MainThread]: 
[0m13:29:08.731013 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m13:29:08.732204 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m13:29:08.732962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.eia_bronze)
[0m13:29:08.733519 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m13:29:08.745192 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m13:29:08.748727 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m13:29:08.774629 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m13:29:08.776600 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m13:29:08.776858 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m13:29:08.777083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:09.329824 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a79a409a-598c-48b4-b675-f68a9888ad73
[0m13:29:11.044738 [debug] [Thread-1  ]: SQL status: OK -1 in 2.269 seconds
[0m13:29:12.208889 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m13:29:12.215480 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m13:29:12.707475 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m13:29:12.723203 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m13:29:12.725232 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e338a30>]}
[0m13:29:12.726154 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 3.99s]
[0m13:29:12.726861 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m13:29:12.727535 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m13:29:12.728672 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m13:29:12.731592 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m13:29:12.732353 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m13:29:12.736432 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m13:29:12.739473 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m13:29:12.742479 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m13:29:12.744065 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m13:29:12.744386 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m13:29:12.744694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:13.307845 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 220e6957-711d-4f99-97f9-ec45d89ca76e
[0m13:29:14.993466 [debug] [Thread-1  ]: SQL status: OK -1 in 2.248 seconds
[0m13:29:16.030584 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m13:29:16.034913 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m13:29:16.500393 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m13:29:16.503834 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m13:29:16.506886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e338a30>]}
[0m13:29:16.509680 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.78s]
[0m13:29:16.510796 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m13:29:16.511738 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m13:29:16.512567 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m13:29:16.514354 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m13:29:16.514750 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m13:29:16.520983 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m13:29:16.522430 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m13:29:16.524670 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m13:29:16.525630 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m13:29:16.525863 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m13:29:16.526266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:17.034482 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 685da2e0-fab0-439c-88e3-54eea638f90e
[0m13:29:18.713078 [debug] [Thread-1  ]: SQL status: OK -1 in 2.187 seconds
[0m13:29:19.905232 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m13:29:19.911526 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m13:29:20.411084 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m13:29:20.417831 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m13:29:20.419528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99b570a0>]}
[0m13:29:20.421234 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 3.91s]
[0m13:29:20.423159 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m13:29:20.424479 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m13:29:20.427570 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m13:29:20.431962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m13:29:20.433068 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m13:29:20.440228 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m13:29:20.442791 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m13:29:20.447733 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m13:29:20.449283 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m13:29:20.450062 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m13:29:20.451166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:20.946134 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID bbf9ac56-8dbc-4ab9-9702-555208082e92
[0m13:29:22.679265 [debug] [Thread-1  ]: SQL status: OK -1 in 2.228 seconds
[0m13:29:23.706885 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m13:29:23.711799 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m13:29:24.217217 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m13:29:24.222454 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m13:29:24.223944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ab92f40>]}
[0m13:29:24.225239 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.79s]
[0m13:29:24.226218 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m13:29:24.227032 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m13:29:24.230392 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m13:29:24.236097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m13:29:24.236536 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m13:29:24.243073 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m13:29:24.245260 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m13:29:24.247701 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m13:29:24.248409 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m13:29:24.248618 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m13:29:24.248883 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:24.777122 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6bd7a6cf-738e-4086-82c7-c9d4d52f9189
[0m13:29:26.583413 [debug] [Thread-1  ]: SQL status: OK -1 in 2.334 seconds
[0m13:29:27.629708 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m13:29:27.636148 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m13:29:28.119677 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m13:29:28.124454 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m13:29:28.125799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8664c0>]}
[0m13:29:28.127229 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 3.89s]
[0m13:29:28.129869 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m13:29:28.131212 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m13:29:28.132876 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m13:29:28.137317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m13:29:28.138298 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m13:29:28.145165 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m13:29:28.148179 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m13:29:28.186583 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:29.329996 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m13:29:29.332600 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:29:29.339434 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:29:30.296198 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m13:29:30.296830 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:29:30.297138 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/d677eb8a-1c34-4fc2-b9ce-0e5091b9ec25
[0m13:29:30.819216 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/d677eb8a-1c34-4fc2-b9ce-0e5091b9ec25', bucket='climate-energy-raw-data', prefix='silver/eia_silver/d677eb8a-1c34-4fc2-b9ce-0e5091b9ec25/'
[0m13:29:32.889734 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m13:29:32.935110 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:29:33.381015 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:29:33.384459 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/3adc0d99-86ee-44cf-940f-938fa442d873',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m13:29:33.873373 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3322c4c6-1c5c-4f72-9882-280672ceb8d1
[0m13:29:36.673411 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m13:29:36.680421 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m13:29:36.680941 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m13:29:36.874847 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7a67e538-9b2f-48d5-b356-f7fc7ca31fca
[0m13:29:38.543798 [debug] [Thread-1  ]: SQL status: OK -1 in 1.862 seconds
[0m13:29:38.548355 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m13:29:38.550138 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m13:29:38.550564 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m13:29:38.741670 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a758b6ad-2b9a-4059-ac45-b03de52011dc
[0m13:29:40.436996 [debug] [Thread-1  ]: SQL status: OK 2842 in 1.886 seconds
[0m13:29:40.444445 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m13:29:40.446911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993d7850>]}
[0m13:29:40.449331 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 12.31s]
[0m13:29:40.451718 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m13:29:40.453437 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m13:29:40.455570 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m13:29:40.460210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m13:29:40.460856 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m13:29:40.469428 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m13:29:40.471394 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m13:29:40.476725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:41.689390 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m13:29:41.691130 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:29:41.692223 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:29:42.765256 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m13:29:42.771537 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:29:42.776774 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/0ecbfc73-f53f-4aa4-b85b-6945eecf43f4
[0m13:29:43.230997 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/0ecbfc73-f53f-4aa4-b85b-6945eecf43f4', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/0ecbfc73-f53f-4aa4-b85b-6945eecf43f4/'
[0m13:29:45.171435 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m13:29:45.179121 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:29:45.637485 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:29:45.638885 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/55d374ae-bc6d-470e-9008-7ab458dea050',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m13:29:46.162728 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8f088ca3-d9b1-4456-a1cd-81b2214e1329
[0m13:29:50.115616 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m13:29:50.120479 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m13:29:50.121330 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m13:29:50.320423 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ed1793c8-c4e8-41e9-970b-1874224433af
[0m13:29:51.974408 [debug] [Thread-1  ]: SQL status: OK -1 in 1.851 seconds
[0m13:29:51.983121 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m13:29:51.990767 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m13:29:51.993020 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m13:29:52.209126 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4f9a6c50-69d8-47af-a570-da07f86e87b1
[0m13:29:53.887925 [debug] [Thread-1  ]: SQL status: OK 305 in 1.892 seconds
[0m13:29:53.897256 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m13:29:53.899117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c8664c0>]}
[0m13:29:53.900899 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 13.44s]
[0m13:29:53.902639 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m13:29:53.903998 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m13:29:53.905493 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m13:29:53.915702 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m13:29:53.916329 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m13:29:53.926587 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m13:29:53.928230 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m13:29:53.931604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:55.110185 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m13:29:55.111099 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:29:55.111572 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:29:56.069514 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m13:29:56.070637 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:29:56.071449 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/192ddc48-9674-4831-bca4-e33e40216398
[0m13:29:56.577089 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/192ddc48-9674-4831-bca4-e33e40216398', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/192ddc48-9674-4831-bca4-e33e40216398/'
[0m13:29:58.335636 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m13:29:58.340660 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:29:58.769691 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:29:58.772929 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/d5dc8a79-3ed4-45de-888c-066b5409a35a',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m13:29:59.267704 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 838f5f5d-831a-4281-b425-6f95e99579cd
[0m13:30:02.111003 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":30794,"data_scanned_in_bytes":211521}
[0m13:30:02.135609 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m13:30:02.139648 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m13:30:02.410375 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f70f6c38-b22c-4966-b03a-51edd829059b
[0m13:30:04.028633 [debug] [Thread-1  ]: SQL status: OK -1 in 1.886 seconds
[0m13:30:04.034416 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m13:30:04.036651 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m13:30:04.037139 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":30794,"data_scanned_in_bytes":211521}';
[0m13:30:04.260480 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 08d763e6-f58d-4e89-81dc-cc05067d23f6
[0m13:30:05.960469 [debug] [Thread-1  ]: SQL status: OK 30794 in 1.918 seconds
[0m13:30:05.977397 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m13:30:05.978736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c9c73d0>]}
[0m13:30:05.980612 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 30794[0m in 12.07s]
[0m13:30:05.984496 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m13:30:05.987608 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m13:30:05.988960 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m13:30:05.992024 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m13:30:05.992537 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m13:30:06.005105 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m13:30:06.006150 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m13:30:06.008743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:30:07.074650 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m13:30:07.075878 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:30:07.076772 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:30:08.085496 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m13:30:08.086657 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:30:08.088308 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/6d56157a-3c24-4350-8e2b-2d73f5881083
[0m13:30:08.704942 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/6d56157a-3c24-4350-8e2b-2d73f5881083', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/6d56157a-3c24-4350-8e2b-2d73f5881083/'
[0m13:30:10.548612 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m13:30:10.552711 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:30:11.047735 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:30:11.049997 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/6a60a553-50c1-412a-a9d1-7b45557a49fe',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m13:30:11.539923 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 02a929c7-4134-4133-be5b-738c9cc3228a
[0m13:30:14.450537 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1817,"data_scanned_in_bytes":21108}
[0m13:30:14.460040 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m13:30:14.460475 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m13:30:14.654096 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 614648e2-2c4d-497c-be8f-dc10fb0811b5
[0m13:30:16.281607 [debug] [Thread-1  ]: SQL status: OK -1 in 1.820 seconds
[0m13:30:16.290716 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m13:30:16.297788 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m13:30:16.298610 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":1817,"data_scanned_in_bytes":21108}';
[0m13:30:16.494138 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fa326445-18db-4ce8-baae-019ebfe91059
[0m13:30:18.229708 [debug] [Thread-1  ]: SQL status: OK 1817 in 1.930 seconds
[0m13:30:18.237689 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m13:30:18.240315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb4dee0>]}
[0m13:30:18.242641 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 1817[0m in 12.25s]
[0m13:30:18.244849 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m13:30:18.246543 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m13:30:18.248868 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m13:30:18.254559 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m13:30:18.255366 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m13:30:18.268549 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m13:30:18.271027 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m13:30:18.276494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:30:19.340100 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m13:30:19.340567 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:30:19.340919 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:30:20.314388 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m13:30:20.315766 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:30:20.316688 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/0b5f8bcf-0529-42f5-bc99-01181b5de4e0
[0m13:30:20.818086 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/0b5f8bcf-0529-42f5-bc99-01181b5de4e0', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/0b5f8bcf-0529-42f5-bc99-01181b5de4e0/'
[0m13:30:22.960199 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m13:30:22.972817 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:30:23.418067 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:30:23.421056 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/2bd241c7-5f1b-4b77-ba9b-7dc758d383a8',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m13:30:23.907285 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 78828690-7c30-437c-bef0-75fab4ab7bb7
[0m13:30:26.702968 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2278,"data_scanned_in_bytes":53254}
[0m13:30:26.705759 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m13:30:26.706162 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m13:30:26.889971 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d55c9246-d50f-4cf7-9fbb-3eb8f139f6bb
[0m13:30:28.780217 [debug] [Thread-1  ]: SQL status: OK -1 in 2.073 seconds
[0m13:30:28.786797 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m13:30:28.789561 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m13:30:28.789990 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2278,"data_scanned_in_bytes":53254}';
[0m13:30:28.985918 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5ec91bb6-69f1-4830-9d1f-4f83756705da
[0m13:30:30.925376 [debug] [Thread-1  ]: SQL status: OK 2278 in 2.135 seconds
[0m13:30:30.927924 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m13:30:30.928645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99662bb0>]}
[0m13:30:30.929460 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 2278[0m in 12.68s]
[0m13:30:30.930342 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m13:30:30.931000 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m13:30:30.931753 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m13:30:30.935044 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m13:30:30.935551 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m13:30:30.939779 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m13:30:30.942213 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m13:30:30.944528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:30:31.981703 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m13:30:31.985277 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:30:31.987638 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:30:33.249424 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m13:30:33.253084 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:30:33.254416 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m13:30:33.857462 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m13:30:35.861015 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m13:30:35.867107 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:30:36.314849 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:30:36.316907 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m13:30:36.779275 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a498bfae-24c8-4d5a-aa89-b74e95aa75e6
[0m13:30:38.439820 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":32611,"data_scanned_in_bytes":210413}
[0m13:30:38.446178 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m13:30:38.447280 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m13:30:38.648266 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 79af0ff6-58f6-4a98-a166-5999b29f868e
[0m13:30:40.293109 [debug] [Thread-1  ]: SQL status: OK -1 in 1.845 seconds
[0m13:30:40.300363 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m13:30:40.304678 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m13:30:40.305241 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":32611,"data_scanned_in_bytes":210413}';
[0m13:30:40.498958 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e5da9925-92aa-4dcb-90fd-19e68a601485
[0m13:30:42.209463 [debug] [Thread-1  ]: SQL status: OK 32611 in 1.903 seconds
[0m13:30:42.241907 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m13:30:42.248258 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caafe276-a50a-4ddb-ac2a-9424e6e0f078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba65730>]}
[0m13:30:42.250680 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 32611[0m in 11.31s]
[0m13:30:42.252560 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m13:30:42.264725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:42.265654 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m13:30:42.272393 [info ] [MainThread]: 
[0m13:30:42.273530 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 39.18 seconds (99.18s).
[0m13:30:42.277075 [debug] [MainThread]: Command end result
[0m13:30:42.371113 [info ] [MainThread]: 
[0m13:30:42.372620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:42.373862 [info ] [MainThread]: 
[0m13:30:42.376316 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:30:42.384067 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 102.030205, "process_user_time": 12.187595, "process_kernel_time": 1.71669, "process_mem_max_rss": "192872", "process_in_blocks": "48192", "process_out_blocks": "9634"}
[0m13:30:42.386225 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:42.385907 after 102.03 seconds
[0m13:30:42.387575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bda430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c77c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa024c160>]}
[0m13:30:42.389227 [debug] [MainThread]: Flushing usage events
[0m13:31:01.114906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff868621c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d06940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d066a0>]}


============================== 13:31:01.119044 | 6c0485f2-3667-4ba2-a8e3-191c2c9a2284 ==============================
[0m13:31:01.119044 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:31:01.119415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:31:01.614301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c0485f2-3667-4ba2-a8e3-191c2c9a2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff864df460>]}
[0m13:31:01.649416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c0485f2-3667-4ba2-a8e3-191c2c9a2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86fb32e0>]}
[0m13:31:01.650104 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m13:31:01.666065 [debug] [MainThread]: checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, vars: {}, profile: gold, target: , version: 1.8.7
[0m13:31:01.736689 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:31:01.737095 [debug] [MainThread]: previous checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m13:31:01.737341 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:31:01.737545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6c0485f2-3667-4ba2-a8e3-191c2c9a2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8592d0a0>]}
[0m13:31:03.110582 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:31:03.111311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6c0485f2-3667-4ba2-a8e3-191c2c9a2284', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82999af0>]}
[0m13:31:03.376247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c0485f2-3667-4ba2-a8e3-191c2c9a2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825738e0>]}
[0m13:31:03.490433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c0485f2-3667-4ba2-a8e3-191c2c9a2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82445400>]}
[0m13:31:03.491057 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m13:31:03.491659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c0485f2-3667-4ba2-a8e3-191c2c9a2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff824d64c0>]}
[0m13:31:03.496493 [info ] [MainThread]: 
[0m13:31:03.499584 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m13:31:03.501043 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m13:31:03.501541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:04.035366 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:31:04.040559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m13:31:04.040872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:05.165490 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m13:31:05.167153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m13:31:05.167951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:06.280065 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m13:31:06.280939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m13:31:06.281788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:07.498193 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m13:31:07.504937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c0485f2-3667-4ba2-a8e3-191c2c9a2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83701280>]}
[0m13:31:07.507715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:07.508636 [info ] [MainThread]: 
[0m13:31:07.528598 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m13:31:07.532935 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m13:31:07.534003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.weather_data_gold)
[0m13:31:07.534922 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m13:31:07.550043 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m13:31:07.552311 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m13:31:07.582644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:31:08.754538 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m13:31:08.756821 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:31:08.761831 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m13:31:09.728311 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m13:31:09.728807 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:31:09.729083 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m13:31:10.225188 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m13:31:12.125650 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m13:31:12.312284 [debug] [Thread-1  ]: Skip partitioning: False
[0m13:31:12.789545 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:31:12.798532 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m13:31:13.264684 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 49ca547d-d273-4d8e-bc1b-589c28cf9be9
[0m13:31:16.069731 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":32611,"data_scanned_in_bytes":210413}
[0m13:31:16.086821 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m13:31:16.087822 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m13:31:16.307754 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ba011b7c-2aee-445f-830f-1c79f55bb709
[0m13:31:17.960000 [debug] [Thread-1  ]: SQL status: OK -1 in 1.870 seconds
[0m13:31:17.966825 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m13:31:17.970438 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m13:31:17.971051 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":32611,"data_scanned_in_bytes":210413}';
[0m13:31:18.252147 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a78922bc-d554-4ca0-972d-d7601987566b
[0m13:31:19.954654 [debug] [Thread-1  ]: SQL status: OK 32611 in 1.983 seconds
[0m13:31:19.977005 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m13:31:19.982719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c0485f2-3667-4ba2-a8e3-191c2c9a2284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b4eca0>]}
[0m13:31:19.985606 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 32611[0m in 12.45s]
[0m13:31:19.988576 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m13:31:19.996177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:19.997190 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m13:31:20.001089 [info ] [MainThread]: 
[0m13:31:20.002343 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.50 seconds (16.50s).
[0m13:31:20.010939 [debug] [MainThread]: Command end result
[0m13:31:20.065442 [info ] [MainThread]: 
[0m13:31:20.065944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:20.066227 [info ] [MainThread]: 
[0m13:31:20.066726 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:31:20.069997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.983606, "process_user_time": 4.594608, "process_kernel_time": 0.468627, "process_mem_max_rss": "180064", "process_in_blocks": "37096", "process_out_blocks": "3109"}
[0m13:31:20.072426 [debug] [MainThread]: Command `dbt run` succeeded at 13:31:20.072011 after 18.99 seconds
[0m13:31:20.073621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff868621c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859302b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86fb32e0>]}
[0m13:31:20.074055 [debug] [MainThread]: Flushing usage events
[0m15:00:23.651687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb32191c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb38f2d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1dcbf40>]}


============================== 15:00:23.657869 | 5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1 ==============================
[0m15:00:23.657869 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:00:23.658416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:00:24.246500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f0d460>]}
[0m15:00:24.276771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb79df0>]}
[0m15:00:24.277371 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m15:00:24.292026 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:00:24.365176 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:00:24.365580 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2
[0m15:00:24.365794 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:00:24.365994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb22ed0a0>]}
[0m15:00:25.244802 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:00:25.247167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf49bb50>]}
[0m15:00:25.556497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaef35820>]}
[0m15:00:25.678334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee01400>]}
[0m15:00:25.678857 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m15:00:25.679294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee94460>]}
[0m15:00:25.681728 [info ] [MainThread]: 
[0m15:00:25.682578 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m15:00:25.688544 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m15:00:25.689634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:26.430546 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:00:26.433231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:27.281316 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:00:27.286422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:27.904859 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m15:00:27.925399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m15:00:27.926178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:30.546124 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m15:00:30.601401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m15:00:30.637375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:33.428109 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m15:00:33.441826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m15:00:33.449565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:00:34.906664 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m15:00:34.916477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefc3220>]}
[0m15:00:34.929091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:34.929992 [info ] [MainThread]: 
[0m15:00:34.962263 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m15:00:34.963332 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m15:00:34.964448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.eia_bronze)
[0m15:00:34.965112 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m15:00:34.980848 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m15:00:34.986015 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m15:00:35.009215 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m15:00:35.011029 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m15:00:35.011694 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m15:00:35.012221 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:35.811562 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1533ae51-6f06-42fe-b651-734781a7f532
[0m15:00:37.860352 [debug] [Thread-1  ]: SQL status: OK -1 in 2.846 seconds
[0m15:00:39.930432 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['8', '7', '6', '5', '4']
[0m15:00:39.935386 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['4']
[0m15:00:40.574493 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 4 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m15:00:40.610168 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m15:00:40.612577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0657b50>]}
[0m15:00:40.614923 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 5.65s]
[0m15:00:40.616936 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m15:00:40.618029 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m15:00:40.621276 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m15:00:40.625736 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m15:00:40.626235 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m15:00:40.632367 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m15:00:40.636662 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m15:00:40.653946 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m15:00:40.655731 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m15:00:40.656174 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m15:00:40.656707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:41.291782 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ad3f36f5-3f0d-4e36-b793-6f2283bf43a8
[0m15:00:43.082855 [debug] [Thread-1  ]: SQL status: OK -1 in 2.425 seconds
[0m15:00:44.291918 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['8', '7', '6', '5', '4']
[0m15:00:44.313416 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['4']
[0m15:00:44.826863 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 4 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m15:00:44.838415 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m15:00:44.840821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaefc04f0>]}
[0m15:00:44.843127 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 4.22s]
[0m15:00:44.844494 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m15:00:44.845550 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m15:00:44.848721 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m15:00:44.859092 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m15:00:44.859651 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m15:00:44.871683 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m15:00:44.873379 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m15:00:44.877297 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m15:00:44.878398 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m15:00:44.878671 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m15:00:44.879071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:45.450034 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6ac1773e-c646-4283-9b8f-e5b2a8ce5461
[0m15:00:47.163168 [debug] [Thread-1  ]: SQL status: OK -1 in 2.282 seconds
[0m15:00:48.947952 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['8', '7', '6', '5', '4']
[0m15:00:48.957533 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['4']
[0m15:00:49.569677 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 4 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m15:00:49.578931 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m15:00:49.580951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3cf7f0>]}
[0m15:00:49.587702 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 4.73s]
[0m15:00:49.589345 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m15:00:49.591975 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m15:00:49.593654 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m15:00:49.597130 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m15:00:49.598295 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m15:00:49.610440 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m15:00:49.614412 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m15:00:49.626284 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m15:00:49.637176 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m15:00:49.638420 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m15:00:49.642586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:50.242800 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3eebec62-0ef3-4d5e-8654-021dcbcca0a0
[0m15:00:51.935623 [debug] [Thread-1  ]: SQL status: OK -1 in 2.294 seconds
[0m15:00:53.114136 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['8', '7', '6', '5', '4']
[0m15:00:53.122996 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['4']
[0m15:00:53.629970 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 4 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m15:00:53.649931 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m15:00:53.655365 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf365a90>]}
[0m15:00:53.658814 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 4.06s]
[0m15:00:53.660572 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m15:00:53.662049 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m15:00:53.665904 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m15:00:53.676212 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m15:00:53.676824 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m15:00:53.690408 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m15:00:53.692494 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m15:00:53.695658 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m15:00:53.696691 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m15:00:53.697036 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m15:00:53.697372 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:54.282251 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a4a5bab6-8850-4998-aa31-32093e61e5f3
[0m15:00:56.248676 [debug] [Thread-1  ]: SQL status: OK -1 in 2.551 seconds
[0m15:00:57.429015 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['8', '7', '6', '5', '4']
[0m15:00:57.432070 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['4']
[0m15:00:57.911765 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 4 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m15:00:57.920459 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m15:00:57.922110 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaee37be0>]}
[0m15:00:57.923662 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 4.25s]
[0m15:00:57.925064 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m15:00:57.925920 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m15:00:57.927091 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m15:00:57.937554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m15:00:57.938220 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m15:00:57.945227 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m15:00:57.946494 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m15:00:57.979493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:00:59.322846 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:00:59.325534 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:00:59.330666 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:01:00.476355 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m15:01:00.479037 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:00.479962 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/3adc0d99-86ee-44cf-940f-938fa442d873
[0m15:01:01.019077 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/3adc0d99-86ee-44cf-940f-938fa442d873', bucket='climate-energy-raw-data', prefix='silver/eia_silver/3adc0d99-86ee-44cf-940f-938fa442d873/'
[0m15:01:02.911595 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m15:01:02.952819 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:01:03.395239 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:01:03.401859 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/6d0bf33f-ce40-4a90-9ef2-e2ed2d8b0d05',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m15:01:03.942569 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 812e75ef-81f8-4430-9cbc-f7c6e46b6362
[0m15:01:06.841594 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m15:01:06.849862 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:01:06.850541 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m15:01:07.081946 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e7ede9ff-f280-4de9-8860-9324abb20798
[0m15:01:08.832572 [debug] [Thread-1  ]: SQL status: OK -1 in 1.979 seconds
[0m15:01:08.850969 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m15:01:08.863502 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m15:01:08.864670 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m15:01:09.078009 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 023ca87f-7479-4352-89de-953988779790
[0m15:01:10.978839 [debug] [Thread-1  ]: SQL status: OK 2842 in 2.112 seconds
[0m15:01:11.056219 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m15:01:11.078747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3cadc0>]}
[0m15:01:11.102927 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 13.14s]
[0m15:01:11.108934 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m15:01:11.111443 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m15:01:11.119165 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m15:01:11.126939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m15:01:11.127799 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m15:01:11.157371 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m15:01:11.186624 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m15:01:11.225494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:01:15.010902 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:01:15.012909 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:15.015120 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:01:16.043153 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m15:01:16.043970 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:16.045487 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/55d374ae-bc6d-470e-9008-7ab458dea050
[0m15:01:16.598195 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/55d374ae-bc6d-470e-9008-7ab458dea050', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/55d374ae-bc6d-470e-9008-7ab458dea050/'
[0m15:01:18.575602 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m15:01:18.582021 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:01:19.300814 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:01:19.308894 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/f3e886fe-3827-4003-b7e6-12ce8ded518b',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m15:01:19.846204 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ae3ed70a-259b-4571-9c98-400b7557a3ba
[0m15:01:22.792220 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m15:01:22.796993 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:01:22.797448 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m15:01:23.010644 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 200fac3f-aa69-423c-b74c-368df27e2c84
[0m15:01:24.765026 [debug] [Thread-1  ]: SQL status: OK -1 in 1.966 seconds
[0m15:01:24.776153 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m15:01:24.781456 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m15:01:24.781953 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m15:01:24.989130 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 90640186-cb51-48a0-87a8-2f001e9d5552
[0m15:01:26.766675 [debug] [Thread-1  ]: SQL status: OK 305 in 1.982 seconds
[0m15:01:26.784322 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m15:01:26.789104 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb169b430>]}
[0m15:01:26.791910 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 15.67s]
[0m15:01:26.793980 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m15:01:26.795528 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m15:01:26.798562 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m15:01:26.808756 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m15:01:26.809596 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m15:01:26.821581 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m15:01:26.823328 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m15:01:26.827761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:01:28.476044 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:01:28.477356 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:28.478097 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:01:29.658726 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m15:01:29.667148 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:29.670887 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/d5dc8a79-3ed4-45de-888c-066b5409a35a
[0m15:01:30.507023 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/d5dc8a79-3ed4-45de-888c-066b5409a35a', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/d5dc8a79-3ed4-45de-888c-066b5409a35a/'
[0m15:01:32.344304 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m15:01:32.355489 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:01:32.816616 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:01:32.825464 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/85e78d1c-2f74-4ae5-bd9e-eeb60300af79',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m15:01:33.371382 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7c9180af-04c2-476f-bb8a-d2ed814401b2
[0m15:01:36.376566 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":30794,"data_scanned_in_bytes":211521}
[0m15:01:36.380546 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:01:36.381569 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m15:01:36.702445 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ec80ab6d-1d8f-4615-8afd-361f9749a206
[0m15:01:38.434459 [debug] [Thread-1  ]: SQL status: OK -1 in 2.051 seconds
[0m15:01:38.442439 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m15:01:38.446368 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m15:01:38.447068 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":30794,"data_scanned_in_bytes":211521}';
[0m15:01:38.656901 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d9dfc0b6-1279-437e-8068-1077bbcc76f4
[0m15:01:40.443235 [debug] [Thread-1  ]: SQL status: OK 30794 in 1.995 seconds
[0m15:01:40.455762 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m15:01:40.458239 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac573850>]}
[0m15:01:40.460872 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 30794[0m in 13.66s]
[0m15:01:40.462177 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m15:01:40.463081 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m15:01:40.464263 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m15:01:40.471002 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m15:01:40.471739 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m15:01:40.479615 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m15:01:40.480824 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m15:01:40.486167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:01:41.720508 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:01:41.721275 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:41.722158 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:01:42.851484 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m15:01:42.856743 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:42.858058 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/6a60a553-50c1-412a-a9d1-7b45557a49fe
[0m15:01:43.609670 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/6a60a553-50c1-412a-a9d1-7b45557a49fe', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/6a60a553-50c1-412a-a9d1-7b45557a49fe/'
[0m15:01:45.532247 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m15:01:45.547493 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:01:46.007728 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:01:46.011031 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/a17d6359-a673-4731-af84-7b9d47d62647',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m15:01:46.497140 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 944eb3ac-6e2a-4d56-94ed-d3becb93e90d
[0m15:01:49.786977 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1817,"data_scanned_in_bytes":21108}
[0m15:01:49.792415 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:01:49.793071 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m15:01:49.999945 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 00280edb-4303-4922-ae09-f253c741d17f
[0m15:01:52.266676 [debug] [Thread-1  ]: SQL status: OK -1 in 2.440 seconds
[0m15:01:52.378747 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m15:01:52.397759 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m15:01:52.408497 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":1817,"data_scanned_in_bytes":21108}';
[0m15:01:52.621724 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d9b7d402-8099-43e1-af35-e0615cac6109
[0m15:01:54.445040 [debug] [Thread-1  ]: SQL status: OK 1817 in 2.050 seconds
[0m15:01:54.469646 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m15:01:54.474341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4504f0>]}
[0m15:01:54.477675 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 1817[0m in 14.01s]
[0m15:01:54.479770 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m15:01:54.481483 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m15:01:54.483797 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m15:01:54.493225 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m15:01:54.494089 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m15:01:54.504905 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m15:01:54.506647 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m15:01:54.511370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:01:55.612196 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:01:55.612736 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:55.613339 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:01:56.709734 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m15:01:56.710236 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:01:56.710557 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/2bd241c7-5f1b-4b77-ba9b-7dc758d383a8
[0m15:01:57.235007 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/2bd241c7-5f1b-4b77-ba9b-7dc758d383a8', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/2bd241c7-5f1b-4b77-ba9b-7dc758d383a8/'
[0m15:01:59.110435 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m15:01:59.117104 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:01:59.627943 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:01:59.630010 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/de46b6fe-68d4-4ffe-b4d0-3fe06c8f48b3',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m15:02:00.149219 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7e63e733-a65b-4357-83cf-9e8d2e51da3a
[0m15:02:02.954902 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2278,"data_scanned_in_bytes":53254}
[0m15:02:02.958607 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:02:02.959160 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m15:02:03.166255 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 75a68be9-9b70-4f35-81e3-7a5c11fbeb69
[0m15:02:04.853367 [debug] [Thread-1  ]: SQL status: OK -1 in 1.894 seconds
[0m15:02:04.857246 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m15:02:04.859221 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m15:02:04.859643 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2278,"data_scanned_in_bytes":53254}';
[0m15:02:05.112575 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6b4e6be1-5f46-4922-b84f-38ddcf1c40ca
[0m15:02:07.483913 [debug] [Thread-1  ]: SQL status: OK 2278 in 2.623 seconds
[0m15:02:07.488650 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m15:02:07.490488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb289e190>]}
[0m15:02:07.491784 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 2278[0m in 13.01s]
[0m15:02:07.492916 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m15:02:07.493710 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m15:02:07.495509 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m15:02:07.505572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m15:02:07.506290 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m15:02:07.511596 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m15:02:07.513046 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m15:02:07.516536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:02:08.825551 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:02:08.832461 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:02:08.836195 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m15:02:09.851962 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m15:02:09.853166 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m15:02:09.854309 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m15:02:10.344707 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m15:02:12.287830 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m15:02:12.290970 [debug] [Thread-1  ]: Skip partitioning: False
[0m15:02:12.745489 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m15:02:12.748693 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m15:02:13.247550 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 91bfe312-9c9a-4157-9a07-d6a67716cd61
[0m15:02:16.195728 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":32611,"data_scanned_in_bytes":210413}
[0m15:02:16.198731 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:02:16.199642 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m15:02:16.409397 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 49453a73-70ba-46d2-986f-40c104bf26a2
[0m15:02:18.071340 [debug] [Thread-1  ]: SQL status: OK -1 in 1.870 seconds
[0m15:02:18.081595 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m15:02:18.085780 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m15:02:18.086618 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":32611,"data_scanned_in_bytes":210413}';
[0m15:02:18.283706 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 1d2794a9-1347-42b7-a59d-40b75cd59328
[0m15:02:20.105403 [debug] [Thread-1  ]: SQL status: OK 32611 in 2.018 seconds
[0m15:02:20.113023 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m15:02:20.115661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6446ac-bfa6-4e14-98ab-ad0fb5172ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb289e190>]}
[0m15:02:20.118153 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 32611[0m in 12.62s]
[0m15:02:20.120385 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m15:02:20.130989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:20.131569 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m15:02:20.136419 [info ] [MainThread]: 
[0m15:02:20.137285 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 54.45 seconds (114.45s).
[0m15:02:20.140720 [debug] [MainThread]: Command end result
[0m15:02:20.199681 [info ] [MainThread]: 
[0m15:02:20.200347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:20.200800 [info ] [MainThread]: 
[0m15:02:20.202360 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m15:02:20.206586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 116.6062, "process_user_time": 17.615828, "process_kernel_time": 3.488709, "process_mem_max_rss": "193600", "process_out_blocks": "3226", "process_in_blocks": "0"}
[0m15:02:20.207696 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:20.207540 after 116.61 seconds
[0m15:02:20.208240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb32191c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb23005e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb79df0>]}
[0m15:02:20.208783 [debug] [MainThread]: Flushing usage events
[0m16:17:24.031529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98122220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c5e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969affd0>]}


============================== 16:17:24.041651 | 1eeb372b-52a8-4ca6-8e70-1bb4ec711584 ==============================
[0m16:17:24.041651 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:17:24.042096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:17:25.358127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965841f0>]}
[0m16:17:25.428393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987f2280>]}
[0m16:17:25.429471 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m16:17:25.460528 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:17:25.682135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:17:25.683658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:17:25.730853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942489a0>]}
[0m16:17:25.904001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94169970>]}
[0m16:17:25.904665 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m16:17:25.904999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9419b640>]}
[0m16:17:25.906952 [info ] [MainThread]: 
[0m16:17:25.907583 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:17:25.914628 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:17:25.915909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:26.720565 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:17:26.723972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:27.367695 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:17:27.369585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:27.926974 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:17:27.936667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m16:17:27.937788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:29.137079 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:17:29.139314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m16:17:29.140081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:30.399223 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:17:30.401209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m16:17:30.402460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:31.764945 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:17:31.784007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fb00d0>]}
[0m16:17:31.790212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:17:31.792453 [info ] [MainThread]: 
[0m16:17:31.821960 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m16:17:31.823141 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m16:17:31.824525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m16:17:31.824998 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m16:17:31.842863 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m16:17:31.847329 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m16:17:31.887320 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m16:17:31.889910 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m16:17:31.890247 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m16:17:31.890503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:17:32.536395 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2f658f79-b21b-4f08-bde5-52c96a9de278
[0m16:17:34.329740 [debug] [Thread-1  ]: SQL status: OK -1 in 2.436 seconds
[0m16:17:35.889816 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['9', '8', '7', '6', '5']
[0m16:17:35.895001 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['5']
[0m16:17:36.363724 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 5 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m16:17:36.377602 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m16:17:36.379885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92944f40>]}
[0m16:17:36.380871 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 4.55s]
[0m16:17:36.381945 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m16:17:36.382630 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m16:17:36.383302 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m16:17:36.388991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m16:17:36.390681 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m16:17:36.397520 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m16:17:36.400361 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m16:17:36.406147 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m16:17:36.408384 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m16:17:36.408844 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m16:17:36.409156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:17:36.947770 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5657e305-d5cc-4e2c-af12-f75989d211f1
[0m16:17:38.608973 [debug] [Thread-1  ]: SQL status: OK -1 in 2.199 seconds
[0m16:17:39.662392 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['9', '8', '7', '6', '5']
[0m16:17:39.664451 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['5']
[0m16:17:40.164017 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 5 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m16:17:40.180166 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m16:17:40.184004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b38130>]}
[0m16:17:40.187215 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.80s]
[0m16:17:40.191853 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m16:17:40.194221 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m16:17:40.196797 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m16:17:40.205723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m16:17:40.206529 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m16:17:40.216770 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m16:17:40.218540 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m16:17:40.222357 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m16:17:40.223381 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m16:17:40.223929 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m16:17:40.224456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:17:40.792757 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 11c8f4b2-0120-4919-9884-1372a2a6a68d
[0m16:17:42.992829 [debug] [Thread-1  ]: SQL status: OK -1 in 2.768 seconds
[0m16:17:44.131837 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['9', '8', '7', '6', '5']
[0m16:17:44.135758 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['5']
[0m16:17:44.598938 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 5 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m16:17:44.605715 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m16:17:44.608535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9308ed00>]}
[0m16:17:44.610384 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 4.41s]
[0m16:17:44.612099 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m16:17:44.613537 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m16:17:44.615990 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m16:17:44.621023 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m16:17:44.622026 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m16:17:44.633664 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m16:17:44.636910 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m16:17:44.642279 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m16:17:44.644020 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m16:17:44.644675 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m16:17:44.645087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:17:45.238763 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fd211a03-4c72-4b20-8dbb-fd0366f1cb0b
[0m16:17:46.981962 [debug] [Thread-1  ]: SQL status: OK -1 in 2.337 seconds
[0m16:17:48.058377 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['9', '8', '7', '6', '5']
[0m16:17:48.060846 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['5']
[0m16:17:48.548060 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 5 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m16:17:48.561713 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m16:17:48.563988 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9719c7f0>]}
[0m16:17:48.565676 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.95s]
[0m16:17:48.567431 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m16:17:48.568771 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m16:17:48.570420 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m16:17:48.574946 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m16:17:48.575480 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m16:17:48.584458 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m16:17:48.586768 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m16:17:48.589672 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m16:17:48.590566 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m16:17:48.590856 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m16:17:48.591159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:17:49.131700 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a46b4fa7-0157-4ea8-bd9f-bf53859599ea
[0m16:17:51.093392 [debug] [Thread-1  ]: SQL status: OK -1 in 2.502 seconds
[0m16:17:52.423827 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['9', '8', '7', '6', '5']
[0m16:17:52.427576 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['5']
[0m16:17:53.014506 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 5 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m16:17:53.022476 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m16:17:53.024386 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d51220>]}
[0m16:17:53.025861 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 4.45s]
[0m16:17:53.027164 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m16:17:53.028143 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m16:17:53.029620 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m16:17:53.034306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m16:17:53.034917 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m16:17:53.044951 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m16:17:53.046484 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m16:17:53.075395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:17:54.196030 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m16:17:54.198154 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:17:54.203811 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:17:55.230903 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m16:17:55.231519 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:17:55.231888 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/6d0bf33f-ce40-4a90-9ef2-e2ed2d8b0d05
[0m16:17:55.751153 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/6d0bf33f-ce40-4a90-9ef2-e2ed2d8b0d05', bucket='climate-energy-raw-data', prefix='silver/eia_silver/6d0bf33f-ce40-4a90-9ef2-e2ed2d8b0d05/'
[0m16:17:57.840548 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m16:17:57.869268 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:17:58.293616 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:17:58.297838 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/ab79c899-259c-4004-a007-4ba776d650c6',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m16:17:58.865611 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID dcb27aa7-8864-4cfa-a209-f59bf565a612
[0m16:18:01.810988 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m16:18:01.874828 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m16:18:01.904305 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m16:18:02.095352 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f0fe40b9-2d10-43f8-b649-447cafd0fd9f
[0m16:18:03.881172 [debug] [Thread-1  ]: SQL status: OK -1 in 1.974 seconds
[0m16:18:03.895278 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m16:18:03.898925 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m16:18:03.899541 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m16:18:04.110408 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5abc0526-f880-4076-8d78-ccd539677fea
[0m16:18:06.039554 [debug] [Thread-1  ]: SQL status: OK 2842 in 2.139 seconds
[0m16:18:06.043499 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m16:18:06.044537 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9719c7f0>]}
[0m16:18:06.045562 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 2842[0m in 13.01s]
[0m16:18:06.046781 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m16:18:06.047774 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m16:18:06.048758 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m16:18:06.052248 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m16:18:06.052814 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m16:18:06.057705 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m16:18:06.058952 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m16:18:06.062953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:18:07.138518 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m16:18:07.140497 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:18:07.141595 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:18:08.460704 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m16:18:08.462792 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:18:08.463650 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/f3e886fe-3827-4003-b7e6-12ce8ded518b
[0m16:18:08.975297 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/f3e886fe-3827-4003-b7e6-12ce8ded518b', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/f3e886fe-3827-4003-b7e6-12ce8ded518b/'
[0m16:18:10.829593 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m16:18:10.835573 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:18:11.347013 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:18:11.349039 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/e46d49f1-91ba-45cb-bbc3-05a30d5aa2d1',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m16:18:11.820340 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 40264f82-76fc-4005-bb99-56fdf6b9076f
[0m16:18:14.697279 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m16:18:14.712077 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m16:18:14.713073 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m16:18:14.940566 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0b977b18-5785-40a3-929e-a63cfcd58eda
[0m16:18:16.690751 [debug] [Thread-1  ]: SQL status: OK -1 in 1.976 seconds
[0m16:18:16.696340 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m16:18:16.704178 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m16:18:16.705842 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m16:18:16.899793 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7179981a-4a4e-4881-a38c-a7332b580c6c
[0m16:18:18.643384 [debug] [Thread-1  ]: SQL status: OK 305 in 1.934 seconds
[0m16:18:18.666992 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m16:18:18.676685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9434ba90>]}
[0m16:18:18.681598 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 305[0m in 12.62s]
[0m16:18:18.683970 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m16:18:18.685769 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m16:18:18.687706 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m16:18:18.699151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m16:18:18.700032 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m16:18:18.709757 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m16:18:18.711582 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m16:18:18.715036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:18:20.089196 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m16:18:20.090526 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:18:20.091882 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:18:21.085136 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m16:18:21.092401 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:18:21.093248 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/85e78d1c-2f74-4ae5-bd9e-eeb60300af79
[0m16:18:21.679142 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/85e78d1c-2f74-4ae5-bd9e-eeb60300af79', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/85e78d1c-2f74-4ae5-bd9e-eeb60300af79/'
[0m16:18:23.560987 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m16:18:23.567132 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:18:24.056341 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:18:24.057905 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/da1a961a-e878-467c-b275-2a1d91f874b2',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m16:18:24.542961 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 41efae7c-135f-4bbe-a985-1bcbd284e369
[0m16:18:27.625710 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":30794,"data_scanned_in_bytes":211521}
[0m16:18:27.636528 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m16:18:27.637021 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m16:18:27.844908 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2cc4f88d-f42b-4e58-816b-e46fc841e5af
[0m16:18:29.479771 [debug] [Thread-1  ]: SQL status: OK -1 in 1.842 seconds
[0m16:18:29.484227 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m16:18:29.490378 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m16:18:29.490688 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":30794,"data_scanned_in_bytes":211521}';
[0m16:18:29.786937 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 531fe09d-1bfd-42c1-8bcd-0c5ace4c269f
[0m16:18:31.682155 [debug] [Thread-1  ]: SQL status: OK 30794 in 2.188 seconds
[0m16:18:31.692523 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m16:18:31.694183 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9275cb80>]}
[0m16:18:31.695435 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 30794[0m in 13.00s]
[0m16:18:31.696502 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m16:18:31.697540 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m16:18:31.698729 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m16:18:31.702946 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m16:18:31.703452 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m16:18:31.713986 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m16:18:31.716130 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m16:18:31.722244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:18:33.084850 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m16:18:33.087476 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:18:33.089546 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:18:34.230722 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m16:18:34.231376 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:18:34.232080 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/a17d6359-a673-4731-af84-7b9d47d62647
[0m16:18:34.890591 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/a17d6359-a673-4731-af84-7b9d47d62647', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/a17d6359-a673-4731-af84-7b9d47d62647/'
[0m16:18:36.705146 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m16:18:36.712960 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:18:37.125650 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:18:37.127279 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/176b1a5f-f9f1-464f-9ffa-3edc0ae56af3',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m16:18:37.612618 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a2ef9a9d-71f9-4004-aa4a-c14564f50649
[0m16:18:40.461398 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2508,"data_scanned_in_bytes":33539}
[0m16:18:40.464761 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m16:18:40.465239 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m16:18:40.660742 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 68387856-d073-4303-8e50-9b69033137c5
[0m16:18:42.402119 [debug] [Thread-1  ]: SQL status: OK -1 in 1.934 seconds
[0m16:18:42.416498 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m16:18:42.420163 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m16:18:42.420630 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":2508,"data_scanned_in_bytes":33539}';
[0m16:18:42.659178 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ad169d9c-ff6c-46a0-b219-acb52ac3f6c4
[0m16:18:44.407077 [debug] [Thread-1  ]: SQL status: OK 2508 in 1.984 seconds
[0m16:18:44.419123 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m16:18:44.421592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93cb21c0>]}
[0m16:18:44.423499 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 2508[0m in 12.72s]
[0m16:18:44.425168 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m16:18:44.426419 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m16:18:44.428341 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m16:18:44.433854 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m16:18:44.434364 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m16:18:44.443415 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m16:18:44.445131 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m16:18:44.449018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:18:45.596132 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m16:18:45.596871 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:18:45.597702 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:18:46.695980 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m16:18:46.697687 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:18:46.698585 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/de46b6fe-68d4-4ffe-b4d0-3fe06c8f48b3
[0m16:18:47.234114 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/de46b6fe-68d4-4ffe-b4d0-3fe06c8f48b3', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/de46b6fe-68d4-4ffe-b4d0-3fe06c8f48b3/'
[0m16:18:49.187829 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m16:18:49.194904 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:18:49.624708 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:18:49.628196 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/125cc3ba-0546-4e90-bef6-dfb4c89de67b',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m16:18:50.167200 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5173cb15-2412-46a3-b04f-304892103ff8
[0m16:18:53.082623 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2278,"data_scanned_in_bytes":53254}
[0m16:18:53.087690 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m16:18:53.088229 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m16:18:53.287357 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4a8ce6f1-5ea5-4b50-9843-be9f13ae7269
[0m16:18:54.926753 [debug] [Thread-1  ]: SQL status: OK -1 in 1.838 seconds
[0m16:18:54.931257 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m16:18:54.933525 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m16:18:54.933887 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2278,"data_scanned_in_bytes":53254}';
[0m16:18:55.136547 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 31dbad15-cc7e-44e7-9084-5ba8fe3253d7
[0m16:18:57.130067 [debug] [Thread-1  ]: SQL status: OK 2278 in 2.195 seconds
[0m16:18:57.136564 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m16:18:57.138420 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943018b0>]}
[0m16:18:57.140502 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 2278[0m in 12.71s]
[0m16:18:57.142611 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m16:18:57.143973 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m16:18:57.145267 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m16:18:57.150292 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m16:18:57.151267 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m16:18:57.158217 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m16:18:57.160290 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m16:18:57.163653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:18:58.276037 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m16:18:58.277139 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:18:58.278243 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:18:59.430246 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m16:18:59.431383 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:18:59.431970 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m16:18:59.946237 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m16:19:01.892168 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m16:19:01.987849 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:19:02.472090 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:19:02.473578 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m16:19:03.075880 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3fb2e810-7de0-47d3-bcba-4f9bba22e42d
[0m16:19:04.770597 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":33302,"data_scanned_in_bytes":218590}
[0m16:19:04.775510 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m16:19:04.776046 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m16:19:05.013461 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9535cf2a-b476-4d55-bf67-fd90ba5a5bdf
[0m16:19:06.728684 [debug] [Thread-1  ]: SQL status: OK -1 in 1.952 seconds
[0m16:19:06.732981 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m16:19:06.736659 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m16:19:06.737402 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":33302,"data_scanned_in_bytes":218590}';
[0m16:19:06.958405 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 68e491de-3674-42cc-8462-01142ef01612
[0m16:19:08.806269 [debug] [Thread-1  ]: SQL status: OK 33302 in 2.066 seconds
[0m16:19:08.822426 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m16:19:08.825587 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eeb372b-52a8-4ca6-8e70-1bb4ec711584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9167d640>]}
[0m16:19:08.828144 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 33302[0m in 11.68s]
[0m16:19:08.830870 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m16:19:08.840592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:08.841462 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m16:19:08.847951 [info ] [MainThread]: 
[0m16:19:08.848954 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 42.94 seconds (102.94s).
[0m16:19:08.853101 [debug] [MainThread]: Command end result
[0m16:19:08.904020 [info ] [MainThread]: 
[0m16:19:08.904859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:08.905152 [info ] [MainThread]: 
[0m16:19:08.905483 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m16:19:08.908563 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 104.908394, "process_user_time": 12.9331, "process_kernel_time": 3.394439, "process_mem_max_rss": "182944", "process_in_blocks": "2976", "process_out_blocks": "2217"}
[0m16:19:08.909491 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:08.909379 after 104.91 seconds
[0m16:19:08.909957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98122220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971f0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987f2280>]}
[0m16:19:08.910204 [debug] [MainThread]: Flushing usage events
[0m16:19:27.619359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed221c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad186940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1866a0>]}


============================== 16:19:27.624803 | 5dca2cea-8e83-4aec-811a-199aea284b26 ==============================
[0m16:19:27.624803 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:19:27.625232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:19:28.224838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dca2cea-8e83-4aec-811a-199aea284b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea0a460>]}
[0m16:19:28.255237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dca2cea-8e83-4aec-811a-199aea284b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4732e0>]}
[0m16:19:28.255917 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m16:19:28.274866 [debug] [MainThread]: checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, vars: {}, profile: gold, target: , version: 1.8.7
[0m16:19:28.360338 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:19:28.360767 [debug] [MainThread]: previous checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m16:19:28.361003 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:19:28.361233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dca2cea-8e83-4aec-811a-199aea284b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadded0a0>]}
[0m16:19:29.239805 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:19:29.240374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5dca2cea-8e83-4aec-811a-199aea284b26', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaae58bb0>]}
[0m16:19:29.459468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dca2cea-8e83-4aec-811a-199aea284b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac438e0>]}
[0m16:19:29.559220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dca2cea-8e83-4aec-811a-199aea284b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa905400>]}
[0m16:19:29.559694 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m16:19:29.560019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dca2cea-8e83-4aec-811a-199aea284b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa9524f0>]}
[0m16:19:29.561372 [info ] [MainThread]: 
[0m16:19:29.561838 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:19:29.562724 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:19:29.562999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:30.198109 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:19:30.206709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m16:19:30.207198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:31.427738 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:19:31.429539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m16:19:31.430340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:32.881980 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:19:32.888644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m16:19:32.894407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:33.998248 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:19:34.007956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dca2cea-8e83-4aec-811a-199aea284b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97f6ee0>]}
[0m16:19:34.019589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:34.021325 [info ] [MainThread]: 
[0m16:19:34.043557 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m16:19:34.044756 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m16:19:34.045538 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.weather_data_gold)
[0m16:19:34.046116 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m16:19:34.061304 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m16:19:34.062921 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m16:19:34.091761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:35.355685 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m16:19:35.357524 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:19:35.362646 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m16:19:36.415233 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m16:19:36.427334 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m16:19:36.430438 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m16:19:37.290057 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m16:19:39.323856 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m16:19:39.377694 [debug] [Thread-1  ]: Skip partitioning: False
[0m16:19:39.845943 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:19:39.850287 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m16:19:40.384796 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4d0def6e-5f10-4bb0-bac2-5289cf6b5140
[0m16:19:43.270591 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":33302,"data_scanned_in_bytes":218590}
[0m16:19:43.297893 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m16:19:43.298445 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m16:19:43.621219 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 757351a4-62f9-42cb-a40f-016522fc194c
[0m16:19:45.361706 [debug] [Thread-1  ]: SQL status: OK -1 in 2.061 seconds
[0m16:19:45.368968 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m16:19:45.372238 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m16:19:45.372722 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":33302,"data_scanned_in_bytes":218590}';
[0m16:19:45.585555 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 834333b4-3305-43db-b2ed-289c19d1c160
[0m16:19:47.370353 [debug] [Thread-1  ]: SQL status: OK 33302 in 1.995 seconds
[0m16:19:47.410368 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m16:19:47.416172 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dca2cea-8e83-4aec-811a-199aea284b26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4593d0>]}
[0m16:19:47.418539 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 33302[0m in 13.37s]
[0m16:19:47.421160 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m16:19:47.428052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:47.428661 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m16:19:47.431331 [info ] [MainThread]: 
[0m16:19:47.431916 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 17.87 seconds (17.87s).
[0m16:19:47.433307 [debug] [MainThread]: Command end result
[0m16:19:47.501754 [info ] [MainThread]: 
[0m16:19:47.503372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:47.504029 [info ] [MainThread]: 
[0m16:19:47.504425 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:19:47.508782 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.920246, "process_user_time": 5.180216, "process_kernel_time": 0.955296, "process_mem_max_rss": "179116", "process_in_blocks": "77032", "process_out_blocks": "3109"}
[0m16:19:47.510943 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:47.510719 after 19.92 seconds
[0m16:19:47.511667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed221c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade005e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4732e0>]}
[0m16:19:47.511989 [debug] [MainThread]: Flushing usage events
[0m16:32:27.264774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c517d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c51a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c53d90>]}


============================== 16:32:27.270538 | 598ca305-48a1-4595-8566-3aa524aab8dd ==============================
[0m16:32:27.270538 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:32:27.271045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:32:27.606960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '598ca305-48a1-4595-8566-3aa524aab8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95cbe690>]}
[0m16:32:27.657575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '598ca305-48a1-4595-8566-3aa524aab8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c921d0>]}
[0m16:32:27.658261 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:32:27.665275 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m16:32:27.684225 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:32:27.684756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '598ca305-48a1-4595-8566-3aa524aab8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e791d0>]}
[0m16:32:28.395612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '598ca305-48a1-4595-8566-3aa524aab8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95976850>]}
[0m16:32:28.410469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '598ca305-48a1-4595-8566-3aa524aab8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95543cd0>]}
[0m16:32:28.410794 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m16:32:28.411098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598ca305-48a1-4595-8566-3aa524aab8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95505110>]}
[0m16:32:28.412461 [info ] [MainThread]: 
[0m16:32:28.413032 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:32:28.414097 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:32:28.414422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:29.203670 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:32:29.210973 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_gold'
[0m16:32:29.212041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:30.479705 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:32:30.483060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m16:32:30.484762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:31.861927 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:32:31.863366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m16:32:31.865348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:33.296378 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:32:33.302126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '598ca305-48a1-4595-8566-3aa524aab8dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6e9690>]}
[0m16:32:33.303940 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:33.304785 [info ] [MainThread]: 
[0m16:32:33.308835 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m16:32:33.310253 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m16:32:33.311991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.eia_silver)
[0m16:32:33.312503 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m16:32:33.343957 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m16:32:33.365012 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 16:32:33.313928 => 16:32:33.364602
[0m16:32:33.366737 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m16:32:33.476156 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:32:33.479031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:34.108865 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:32:34.112070 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver__ha"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/silver/eia_silver/394b8dfe-b086-4d8c-8269-c56cb839f3fd',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m16:32:34.713390 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cf10928e-7c72-409a-8fe3-89770189c236
[0m16:32:37.885466 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m16:32:37.910635 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m16:32:37.911567 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` rename to `silver`.`eia_silver__bkp`
[0m16:32:38.399768 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c1fcbaa5-7c2c-46c7-8cdd-d24373712fc8
[0m16:32:46.281483 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0c352c3e-a293-4875-b82c-0da0c3087df2
[0m16:33:01.237848 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ee80745c-4a33-4a5f-aba0-1c2cc31d01b7
[0m16:33:28.378342 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3f87d5fc-6089-4a6d-94d2-715cc4e7570e
[0m16:34:19.583721 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6e49bd2a-7b24-437c-9ca1-582af2dbf580
[0m16:34:29.994410 [error] [MainThread]: CANCEL query list_AwsDataCatalog ............................................... [[31mCANCEL[0m]
[0m16:34:29.998908 [error] [MainThread]: CANCEL query model.silver.eia_silver ........................................... [[31mCANCEL[0m]
[0m16:34:30.510245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:30.510821 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m16:34:30.511065 [debug] [MainThread]: Connection 'model.silver.eia_silver' was left open.
[0m16:34:30.511506 [debug] [MainThread]: On model.silver.eia_silver: Close
[0m16:34:30.516302 [info ] [MainThread]: 
[0m16:34:30.517296 [info ] [MainThread]: Finished running  in 0 hours 2 minutes and 2.10 seconds (122.10s).
[0m16:34:30.518639 [error] [MainThread]: Encountered an error:

[0m16:34:30.528072 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:34:30.536273 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 123.29534, "process_user_time": 3.70913, "process_kernel_time": 0.828732, "process_mem_max_rss": "201492", "process_in_blocks": "96800", "process_out_blocks": "4184", "command_success": false}
[0m16:34:30.539496 [debug] [MainThread]: Command `dbt run` failed at 16:34:30.538534 after 123.30 seconds
[0m16:34:30.543867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c51c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6ce6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b1add0>]}
[0m16:34:30.545035 [debug] [MainThread]: Flushing usage events
[0m16:34:44.531721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9441dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94701250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94413810>]}


============================== 16:34:44.533598 | ef63052b-50f0-47cd-8922-152cf0d1c1b9 ==============================
[0m16:34:44.533598 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:34:44.534018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:44.534391 [info ] [MainThread]: dbt version: 1.7.9
[0m16:34:44.534661 [info ] [MainThread]: python version: 3.11.14
[0m16:34:44.534985 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:34:44.535283 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m16:34:44.745923 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m16:34:44.746396 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m16:34:44.746733 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m16:34:44.747153 [info ] [MainThread]: adapter type: athena
[0m16:34:44.747484 [info ] [MainThread]: adapter version: 1.7.2
[0m16:34:44.783366 [info ] [MainThread]: Configuration:
[0m16:34:44.783824 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:34:44.784184 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:34:44.784480 [info ] [MainThread]: Required dependencies:
[0m16:34:44.784795 [debug] [MainThread]: Executing "git --help"
[0m16:34:44.797751 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:34:44.798165 [debug] [MainThread]: STDERR: "b''"
[0m16:34:44.798376 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:34:44.798689 [info ] [MainThread]: Connection:
[0m16:34:44.799144 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m16:34:44.799399 [info ] [MainThread]:   work_group: None
[0m16:34:44.799711 [info ] [MainThread]:   region_name: us-east-1
[0m16:34:44.800079 [info ] [MainThread]:   database: AwsDataCatalog
[0m16:34:44.800334 [info ] [MainThread]:   schema: silver
[0m16:34:44.800622 [info ] [MainThread]:   poll_interval: 1.0
[0m16:34:44.800897 [info ] [MainThread]:   aws_profile_name: None
[0m16:34:44.801225 [info ] [MainThread]:   aws_access_key_id: None
[0m16:34:44.801470 [info ] [MainThread]:   aws_secret_access_key: None
[0m16:34:44.801763 [info ] [MainThread]:   aws_session_token: None
[0m16:34:44.802037 [info ] [MainThread]:   endpoint_url: None
[0m16:34:44.802284 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m16:34:44.802541 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m16:34:44.802800 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m16:34:44.803324 [info ] [MainThread]:   debug_query_state: False
[0m16:34:44.804293 [info ] [MainThread]:   seed_s3_upload_args: None
[0m16:34:44.804712 [info ] [MainThread]:   lf_tags_database: None
[0m16:34:44.805174 [info ] [MainThread]:   spark_work_group: None
[0m16:34:44.805669 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:34:44.806312 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m16:34:44.806685 [debug] [MainThread]: Using athena connection "debug"
[0m16:34:44.806987 [debug] [MainThread]: On debug: select 1 as id
[0m16:34:44.807281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:45.355475 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID ea64bc69-5b5f-4bb4-8100-97b9d75414fc
[0m16:34:47.155183 [debug] [MainThread]: SQL status: OK -1 in 2.0 seconds
[0m16:34:47.161177 [debug] [MainThread]: On debug: Close
[0m16:34:47.162422 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:34:47.163569 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:34:47.166331 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.6551456, "process_user_time": 1.321097, "process_kernel_time": 0.259411, "process_mem_max_rss": "143744", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m16:34:47.167578 [debug] [MainThread]: Command `dbt debug` succeeded at 16:34:47.167265 after 2.66 seconds
[0m16:34:47.168578 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:34:47.174906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94426bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94701290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9335bd90>]}
[0m16:34:47.175781 [debug] [MainThread]: Flushing usage events
[0m16:34:58.897422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f523b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f521dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8093d0>]}


============================== 16:34:58.899366 | e6fda13b-6ced-48a5-a1e7-89cf19cd97ca ==============================
[0m16:34:58.899366 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:34:58.899880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profile silver --select path:models/bronze', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:59.133985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5d5250>]}
[0m16:34:59.173990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5d5cd0>]}
[0m16:34:59.174490 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:34:59.178757 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m16:34:59.205781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:59.206121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:59.209768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e47f710>]}
[0m16:34:59.223169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e37f290>]}
[0m16:34:59.223590 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m16:34:59.223887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e49abd0>]}
[0m16:34:59.225274 [info ] [MainThread]: 
[0m16:34:59.226081 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:34:59.228228 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:34:59.228896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:59.807760 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:34:59.814230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m16:34:59.815140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:01.061322 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:35:01.063854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m16:35:01.064765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:02.229896 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:35:02.236353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m16:35:02.239447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:03.890165 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:35:03.900864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c83e350>]}
[0m16:35:03.903357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:35:03.904168 [info ] [MainThread]: 
[0m16:35:03.910777 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m16:35:03.912798 [info ] [Thread-1 (]: 1 of 5 START sql view model bronze.eia_bronze .................................. [RUN]
[0m16:35:03.915538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m16:35:03.916150 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m16:35:03.933778 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m16:35:03.936509 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 16:35:03.916647 => 16:35:03.935740
[0m16:35:03.937054 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m16:35:03.968255 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m16:35:03.971139 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m16:35:03.971868 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m16:35:03.972498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:04.510875 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 501e3404-7f57-4674-a954-c3f73e3b6cf5
[0m16:35:06.486343 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m16:35:07.636956 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['10', '9', '8', '7', '6']
[0m16:35:07.642974 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['6']
[0m16:35:08.115703 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 6 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m16:35:08.150878 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 16:35:03.937374 => 16:35:08.150174
[0m16:35:08.152054 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m16:35:08.154737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3b1a50>]}
[0m16:35:08.157110 [info ] [Thread-1 (]: 1 of 5 OK created sql view model bronze.eia_bronze ............................. [[32mOK -1[0m in 4.24s]
[0m16:35:08.158498 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m16:35:08.159526 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m16:35:08.160933 [info ] [Thread-1 (]: 2 of 5 START sql view model bronze.noaa_bronze ................................. [RUN]
[0m16:35:08.164073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m16:35:08.164663 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m16:35:08.178057 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m16:35:08.181920 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 16:35:08.165012 => 16:35:08.181579
[0m16:35:08.182506 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m16:35:08.191258 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m16:35:08.193497 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m16:35:08.194720 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m16:35:08.195601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:09.031585 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5b510a81-319e-4145-9d18-951c0d72432d
[0m16:35:10.976092 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m16:35:12.169973 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['10', '9', '8', '7', '6']
[0m16:35:12.174841 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['6']
[0m16:35:12.646552 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 6 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m16:35:12.665491 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 16:35:08.182872 => 16:35:12.664531
[0m16:35:12.667178 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m16:35:12.670474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87cc6f50>]}
[0m16:35:12.676026 [info ] [Thread-1 (]: 2 of 5 OK created sql view model bronze.noaa_bronze ............................ [[32mOK -1[0m in 4.51s]
[0m16:35:12.678595 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m16:35:12.680124 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m16:35:12.682355 [info ] [Thread-1 (]: 3 of 5 START sql view model bronze.openmeteo_bronze ............................ [RUN]
[0m16:35:12.691335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m16:35:12.692131 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m16:35:12.716957 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m16:35:12.719688 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 16:35:12.692654 => 16:35:12.719366
[0m16:35:12.720110 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m16:35:12.737946 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m16:35:12.741236 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m16:35:12.741843 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m16:35:12.742312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:13.348037 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e194266c-25b7-4139-8b63-048fa9b7ebf6
[0m16:35:15.228634 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:35:16.307377 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['10', '9', '8', '7', '6']
[0m16:35:16.310857 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['6']
[0m16:35:16.801743 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 6 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m16:35:16.807769 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 16:35:12.720330 => 16:35:16.807115
[0m16:35:16.808984 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m16:35:16.810252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c67a850>]}
[0m16:35:16.811405 [info ] [Thread-1 (]: 3 of 5 OK created sql view model bronze.openmeteo_bronze ....................... [[32mOK -1[0m in 4.13s]
[0m16:35:16.812803 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m16:35:16.813851 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m16:35:16.814798 [info ] [Thread-1 (]: 4 of 5 START sql view model bronze.openweather_bronze .......................... [RUN]
[0m16:35:16.817935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m16:35:16.819565 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m16:35:16.825502 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m16:35:16.827498 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 16:35:16.820783 => 16:35:16.827115
[0m16:35:16.828103 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m16:35:16.833135 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m16:35:16.834496 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m16:35:16.835015 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m16:35:16.835574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:17.354343 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 35f8a048-ac59-456d-b739-023643fbf1fd
[0m16:35:19.147101 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:35:20.252647 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['10', '9', '8', '7', '6']
[0m16:35:20.254381 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['6']
[0m16:35:20.806170 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 6 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m16:35:20.811652 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 16:35:16.828426 => 16:35:20.811281
[0m16:35:20.813424 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m16:35:20.815502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ada610>]}
[0m16:35:20.817324 [info ] [Thread-1 (]: 4 of 5 OK created sql view model bronze.openweather_bronze ..................... [[32mOK -1[0m in 4.00s]
[0m16:35:20.819507 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m16:35:20.820774 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m16:35:20.821821 [info ] [Thread-1 (]: 5 of 5 START sql view model bronze.sensor_bronze ............................... [RUN]
[0m16:35:20.823759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m16:35:20.824120 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m16:35:20.834545 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m16:35:20.836678 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 16:35:20.824322 => 16:35:20.836452
[0m16:35:20.837497 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m16:35:20.841146 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m16:35:20.842713 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m16:35:20.843034 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m16:35:20.843390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:21.576412 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 692e1faa-1ede-4272-b3d0-89a337f59f47
[0m16:35:23.780746 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m16:35:24.997491 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['10', '9', '8', '7', '6']
[0m16:35:25.001622 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['6']
[0m16:35:25.488011 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 6 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m16:35:25.500152 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 16:35:20.838055 => 16:35:25.499220
[0m16:35:25.501543 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m16:35:25.505000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6fda13b-6ced-48a5-a1e7-89cf19cd97ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ca2bd0>]}
[0m16:35:25.507534 [info ] [Thread-1 (]: 5 of 5 OK created sql view model bronze.sensor_bronze .......................... [[32mOK -1[0m in 4.68s]
[0m16:35:25.509196 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m16:35:25.516993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:25.517775 [debug] [MainThread]: Connection 'model.silver.sensor_bronze' was properly closed.
[0m16:35:25.520630 [info ] [MainThread]: 
[0m16:35:25.521703 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 26.29 seconds (26.29s).
[0m16:35:25.524171 [debug] [MainThread]: Command end result
[0m16:35:25.565257 [info ] [MainThread]: 
[0m16:35:25.565937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:25.566539 [info ] [MainThread]: 
[0m16:35:25.566998 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:35:25.569841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.692741, "process_user_time": 4.421748, "process_kernel_time": 0.638708, "process_mem_max_rss": "181300", "process_out_blocks": "2031", "process_in_blocks": "0"}
[0m16:35:25.570622 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:25.570493 after 26.69 seconds
[0m16:35:25.571263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f8098d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9071a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947d5b10>]}
[0m16:35:25.571634 [debug] [MainThread]: Flushing usage events
[0m16:35:35.788838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d02e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d486690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d02c350>]}


============================== 16:35:35.790746 | e3c7ae66-0803-4fd4-bd7c-982eed34eb80 ==============================
[0m16:35:35.790746 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:35:35.791262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:36.052704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3c7ae66-0803-4fd4-bd7c-982eed34eb80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1ea8d0>]}
[0m16:35:36.100116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3c7ae66-0803-4fd4-bd7c-982eed34eb80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c196a90>]}
[0m16:35:36.100895 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:35:36.107699 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m16:35:36.135800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:36.136253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:36.140882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3c7ae66-0803-4fd4-bd7c-982eed34eb80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf83e10>]}
[0m16:35:36.149138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3c7ae66-0803-4fd4-bd7c-982eed34eb80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf68250>]}
[0m16:35:36.149491 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m16:35:36.149782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c7ae66-0803-4fd4-bd7c-982eed34eb80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d03c650>]}
[0m16:35:36.151245 [info ] [MainThread]: 
[0m16:35:36.151902 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:35:36.152925 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:35:36.153256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:36.754891 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:35:36.761887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m16:35:36.762962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:38.029052 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:35:38.033208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m16:35:38.042221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:39.349487 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:35:39.351029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m16:35:39.358654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:40.539211 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:35:40.541524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c7ae66-0803-4fd4-bd7c-982eed34eb80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a965910>]}
[0m16:35:40.543145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:35:40.544097 [info ] [MainThread]: 
[0m16:35:40.547851 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m16:35:40.548849 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m16:35:40.550750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.eia_silver)
[0m16:35:40.551613 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m16:35:40.563218 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m16:35:40.565054 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 16:35:40.552193 => 16:35:40.564780
[0m16:35:40.565546 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m16:35:40.604478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:41.833841 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver__ha
[0m16:35:41.838108 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.ICEBERG
[0m16:35:41.845607 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:35:42.897988 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver__ha
[0m16:35:42.902113 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.ICEBERG
[0m16:35:42.904994 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver__ha" is stored in s3://climate-energy-raw-data/silver/eia_silver/394b8dfe-b086-4d8c-8269-c56cb839f3fd
[0m16:35:43.578983 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/394b8dfe-b086-4d8c-8269-c56cb839f3fd', bucket='climate-energy-raw-data', prefix='silver/eia_silver/394b8dfe-b086-4d8c-8269-c56cb839f3fd/'
[0m16:35:45.999695 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver__ha"
[0m16:35:46.018432 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:35:46.428332 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:35:46.430373 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver__ha"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/silver/eia_silver/13c7a0e9-e2e3-49ef-99c6-5bdbcb45a910',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m16:35:46.938287 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 172ec5d1-cad8-4c07-9874-471c3da553af
[0m16:35:49.791379 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m16:35:49.813161 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m16:35:49.814132 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` rename to `silver`.`eia_silver__bkp`
[0m16:35:50.078312 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 45be06c3-2639-47b0-8612-cbcd17e9f09f
[0m16:35:58.856024 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 30cd07db-8d04-4e5c-a4fc-7138e0e37099
[0m16:36:13.600749 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7fadb752-7f26-403d-8096-cad7999c272f
[0m16:36:40.439538 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e362060f-9825-42b7-8fbd-2bf87ee5bfbb
[0m16:37:30.576840 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3989f638-4303-42ef-83dd-4b508723a6c2
[0m16:39:10.314457 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0a9c927b-f9a8-4fdc-b631-47d1ba7ac0e9
[0m16:39:11.864961 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Error running SQL: alter table `AwsDataCatalog`.`silver`.`eia_silver` rename to `silver`.`eia_silver__bkp`
[0m16:39:11.871013 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 16:35:40.565895 => 16:39:11.868368
[0m16:39:11.872866 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m16:39:11.899520 [debug] [Thread-1 (]: Runtime Error in model eia_silver (models/silver/eia_silver.sql)
  FAILED: ParseException line 1:37 cannot recognize input near '.' 'eia_silver' 'rename' in alter table statement
[0m16:39:11.904856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c7ae66-0803-4fd4-bd7c-982eed34eb80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a417790>]}
[0m16:39:11.912829 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model silver.eia_silver ........................ [[31mERROR[0m in 211.35s]
[0m16:39:11.916131 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m16:39:11.917581 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m16:39:11.922839 [info ] [Thread-1 (]: 2 of 5 START sql table model silver.noaa_silver ................................ [RUN]
[0m16:39:11.924516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m16:39:11.925603 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m16:39:11.944647 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m16:39:11.950288 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 16:39:11.926062 => 16:39:11.949841
[0m16:39:11.950700 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m16:39:11.956598 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:39:11.957372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:39:12.576540 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:39:12.577847 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver__ha"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/silver/noaa_silver/c0935272-eb36-4f46-bc7b-beccb87ecb7e',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m16:39:13.064834 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8f8bb3fb-8ab3-4d20-bf7d-220afd1a09be
[0m16:39:17.285131 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m16:39:17.308490 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m16:39:17.309348 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` rename to `silver`.`noaa_silver__bkp`
[0m16:39:17.585291 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ad8028f9-263b-459f-a249-3c8252a4e5ae
[0m16:39:26.499370 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 398d86f7-e01e-42b3-9b36-6996868a39d6
[0m16:39:41.489942 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1cf0b1fe-2e0b-442d-8fd3-b9e3cbf8bb5c
[0m16:40:08.287714 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bd84a656-a5f0-4ad8-a01f-c1c9c1adb039
[0m16:40:58.294273 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bc7f5bd3-93d9-4fa5-8dd4-b8344dffd011
[0m16:42:36.350135 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 01987179-5594-4527-809a-4f413c30a2ed
[0m16:42:37.908792 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Error running SQL: alter table `AwsDataCatalog`.`silver`.`noaa_silver` rename to `silver`.`noaa_silver__bkp`
[0m16:42:37.912743 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 16:39:11.950920 => 16:42:37.911430
[0m16:42:37.916270 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m16:42:37.935413 [debug] [Thread-1 (]: Runtime Error in model noaa_silver (models/silver/noaa_silver.sql)
  FAILED: ParseException line 1:37 cannot recognize input near '.' 'noaa_silver' 'rename' in alter table statement
[0m16:42:37.937567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c7ae66-0803-4fd4-bd7c-982eed34eb80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996d77d0>]}
[0m16:42:37.944470 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model silver.noaa_silver ....................... [[31mERROR[0m in 206.01s]
[0m16:42:37.948431 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m16:42:37.950030 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m16:42:37.953785 [info ] [Thread-1 (]: 3 of 5 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m16:42:37.955155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m16:42:37.955577 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m16:42:37.983237 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m16:42:37.993042 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 16:42:37.955811 => 16:42:37.992713
[0m16:42:37.993478 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m16:42:37.997893 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:42:37.998558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:39.282466 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:42:39.285061 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver__ha"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/silver/openmeteo_silver/e2e68608-ed50-46e0-a679-bbb02bd91437',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m16:42:39.789476 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e09ec466-4f89-4990-ab03-67c4533789bd
[0m16:42:42.699854 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":30794,"data_scanned_in_bytes":211521}
[0m16:42:42.725146 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m16:42:42.726051 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` rename to `silver`.`openmeteo_silver__bkp`
[0m16:42:43.001608 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9ff21593-c7a4-40eb-aace-b652326472f4
[0m16:42:50.917433 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e192e617-0eaf-4217-ae9a-66ec4fac191c
[0m16:43:05.839003 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 409c4f1e-88c2-48db-bb60-74fe321e1edd
[0m16:43:32.873978 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6691cd7f-bddb-48a5-9917-03cc1cf75c23
[0m16:44:23.078083 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID fc4aecbf-10eb-429a-883b-593168c87527
[0m16:44:40.531340 [error] [MainThread]: CANCEL query model.silver.openmeteo_silver ..................................... [[31mCANCEL[0m]
[0m16:44:42.184761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:42.189418 [debug] [MainThread]: Connection 'model.silver.openmeteo_silver' was left open.
[0m16:44:42.190162 [debug] [MainThread]: On model.silver.openmeteo_silver: Close
[0m16:44:42.191833 [info ] [MainThread]: 
[0m16:44:42.192799 [info ] [MainThread]: Finished running 2 table models in 0 hours 9 minutes and 6.04 seconds (546.04s).
[0m16:44:42.195025 [error] [MainThread]: Encountered an error:

[0m16:44:42.212963 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:44:42.228398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 546.44006, "process_user_time": 5.574291, "process_kernel_time": 0.554906, "process_mem_max_rss": "177004", "process_in_blocks": "896", "process_out_blocks": "1054", "command_success": false}
[0m16:44:42.229622 [debug] [MainThread]: Command `dbt run` failed at 16:44:42.229351 after 546.44 seconds
[0m16:44:42.230715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ef6d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa24097d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6e91d0>]}
[0m16:44:42.232075 [debug] [MainThread]: Flushing usage events
[0m16:46:41.260131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b91de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b91e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b91dad0>]}


============================== 16:46:41.263456 | bc23060a-03d4-4851-93b7-fc632b679b2c ==============================
[0m16:46:41.263456 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:46:41.264756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:46:41.265058 [info ] [MainThread]: dbt version: 1.7.9
[0m16:46:41.265340 [info ] [MainThread]: python version: 3.11.14
[0m16:46:41.265696 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m16:46:41.266013 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m16:46:41.538331 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m16:46:41.538939 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m16:46:41.539431 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m16:46:41.539924 [info ] [MainThread]: adapter type: athena
[0m16:46:41.540233 [info ] [MainThread]: adapter version: 1.7.2
[0m16:46:41.580740 [info ] [MainThread]: Configuration:
[0m16:46:41.581253 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:46:41.581627 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:46:41.581922 [info ] [MainThread]: Required dependencies:
[0m16:46:41.582276 [debug] [MainThread]: Executing "git --help"
[0m16:46:41.588619 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:46:41.589018 [debug] [MainThread]: STDERR: "b''"
[0m16:46:41.589213 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:46:41.589462 [info ] [MainThread]: Connection:
[0m16:46:41.589814 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m16:46:41.590156 [info ] [MainThread]:   work_group: None
[0m16:46:41.590425 [info ] [MainThread]:   region_name: us-east-1
[0m16:46:41.590649 [info ] [MainThread]:   database: AwsDataCatalog
[0m16:46:41.590883 [info ] [MainThread]:   schema: silver
[0m16:46:41.591186 [info ] [MainThread]:   poll_interval: 1.0
[0m16:46:41.591430 [info ] [MainThread]:   aws_profile_name: None
[0m16:46:41.591661 [info ] [MainThread]:   aws_access_key_id: None
[0m16:46:41.591907 [info ] [MainThread]:   aws_secret_access_key: None
[0m16:46:41.592184 [info ] [MainThread]:   aws_session_token: None
[0m16:46:41.592390 [info ] [MainThread]:   endpoint_url: None
[0m16:46:41.592627 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m16:46:41.592898 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m16:46:41.593115 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m16:46:41.593377 [info ] [MainThread]:   debug_query_state: False
[0m16:46:41.593611 [info ] [MainThread]:   seed_s3_upload_args: None
[0m16:46:41.593828 [info ] [MainThread]:   lf_tags_database: None
[0m16:46:41.594154 [info ] [MainThread]:   spark_work_group: None
[0m16:46:41.594537 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:46:41.595409 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m16:46:41.595689 [debug] [MainThread]: Using athena connection "debug"
[0m16:46:41.595889 [debug] [MainThread]: On debug: select 1 as id
[0m16:46:41.596076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:42.177177 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 9d65a17a-9497-4794-aec2-ffdfb4e4339c
[0m16:46:44.264861 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m16:46:44.275431 [debug] [MainThread]: On debug: Close
[0m16:46:44.277435 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:46:44.278815 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:46:44.283466 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.0450072, "process_user_time": 1.373501, "process_kernel_time": 0.401315, "process_mem_max_rss": "143848", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m16:46:44.285106 [debug] [MainThread]: Command `dbt debug` succeeded at 16:46:44.284679 after 3.05 seconds
[0m16:46:44.286358 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:46:44.299923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b75ba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b773a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a7e3c10>]}
[0m16:46:44.301499 [debug] [MainThread]: Flushing usage events
[0m16:46:50.888014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd132d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd0b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd12c10>]}


============================== 16:46:50.889740 | 9d478d2d-2b58-427e-9ee7-386520e169c8 ==============================
[0m16:46:50.889740 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:46:50.890166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profile silver --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m16:46:51.188220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d478d2d-2b58-427e-9ee7-386520e169c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd27c90>]}
[0m16:46:51.232411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d478d2d-2b58-427e-9ee7-386520e169c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd121d0>]}
[0m16:46:51.233075 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:46:51.240944 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m16:46:51.273687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:46:51.274585 [debug] [MainThread]: Partial parsing: updated file: silver://models/sources/bronze_sources.yml
[0m16:46:51.472208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d478d2d-2b58-427e-9ee7-386520e169c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5bd8d0>]}
[0m16:46:51.480621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d478d2d-2b58-427e-9ee7-386520e169c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bac6990>]}
[0m16:46:51.481017 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m16:46:51.481383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d478d2d-2b58-427e-9ee7-386520e169c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b5f6d10>]}
[0m16:46:51.482914 [info ] [MainThread]: 
[0m16:46:51.483714 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:46:51.484908 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:46:51.485260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:52.264517 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:46:52.278299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m16:46:52.279307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:53.587138 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:46:53.588954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m16:46:53.590234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:55.251163 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:46:55.253419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m16:46:55.257090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:56.349666 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:46:56.353122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d478d2d-2b58-427e-9ee7-386520e169c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff73a0ffd0>]}
[0m16:46:56.355584 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:46:56.356606 [info ] [MainThread]: 
[0m16:46:56.361962 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m16:46:56.363954 [info ] [Thread-1 (]: 1 of 5 START sql view model bronze.eia_bronze .................................. [RUN]
[0m16:46:56.365899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.eia_bronze)
[0m16:46:56.366404 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m16:46:56.381521 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m16:46:56.387143 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 16:46:56.366790 => 16:46:56.385900
[0m16:46:56.390402 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m16:46:56.448298 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m16:46:56.450511 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m16:46:56.451635 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."bronze"."eia_energy"

[0m16:46:56.452124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:57.034313 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2dd44ad4-0469-4f2e-a8a2-a64262c87ab5
[0m16:47:04.981676 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7f5366a2-59a3-4f7c-aa5d-9d064b4b2769
[0m16:47:18.841743 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 620022c0-fdcd-412c-84d6-ad454e58cced
[0m16:47:44.786242 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 66237bb3-fc24-45d9-bbfb-72ffbe820178
[0m16:48:34.893947 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7a8419a7-995e-459d-8562-35d99b0708c8
[0m16:50:13.044347 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6cdf210a-77ec-4979-ad76-3edf9ff17ace
[0m16:50:14.396427 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Error running SQL: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."bronze"."eia_energy"

[0m16:50:14.400473 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 16:46:56.392182 => 16:50:14.399655
[0m16:50:14.401942 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m16:50:14.423592 [debug] [Thread-1 (]: Runtime Error in model eia_bronze (models/bronze/eia_bronze.sql)
  line 13:6: Table 'awsdatacatalog.bronze.eia_energy' does not exist
[0m16:50:14.426073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d478d2d-2b58-427e-9ee7-386520e169c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bbeeb50>]}
[0m16:50:14.429042 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model bronze.eia_bronze ......................... [[31mERROR[0m in 198.06s]
[0m16:50:14.430306 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m16:50:14.431226 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m16:50:14.434639 [info ] [Thread-1 (]: 2 of 5 START sql view model bronze.noaa_bronze ................................. [RUN]
[0m16:50:14.436227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m16:50:14.436786 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m16:50:14.457709 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m16:50:14.461876 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 16:50:14.437525 => 16:50:14.461556
[0m16:50:14.463248 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m16:50:14.469518 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m16:50:14.470952 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m16:50:14.472466 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."bronze"."noaa_weather"

[0m16:50:14.473339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:15.107752 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a4ab9a7b-952a-4320-bf5e-9432b84b68d9
[0m16:50:22.737650 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID da0f73c2-0730-41a4-9333-c71a47a8f44d
[0m16:50:36.425230 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 48928878-8f88-4482-abe5-82fb01da685f
[0m16:51:02.050796 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ad0a40a4-edf8-405a-ac9a-e159e231f394
[0m16:51:27.661132 [error] [MainThread]: CANCEL query model.silver.noaa_bronze .......................................... [[31mCANCEL[0m]
[0m16:51:28.298964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:28.301023 [debug] [MainThread]: Connection 'model.silver.noaa_bronze' was left open.
[0m16:51:28.301651 [debug] [MainThread]: On model.silver.noaa_bronze: Close
[0m16:51:28.304076 [info ] [MainThread]: 
[0m16:51:28.305774 [info ] [MainThread]: Finished running 1 view model in 0 hours 4 minutes and 36.82 seconds (276.82s).
[0m16:51:28.308384 [error] [MainThread]: Encountered an error:

[0m16:51:28.317188 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:51:28.325435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 277.45685, "process_user_time": 3.700489, "process_kernel_time": 0.585986, "process_mem_max_rss": "187432", "process_out_blocks": "1994", "command_success": false, "process_in_blocks": "0"}
[0m16:51:28.326829 [debug] [MainThread]: Command `dbt run` failed at 16:51:28.326582 after 277.46 seconds
[0m16:51:28.327866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cb5fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78dbc790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ef97d0>]}
[0m16:51:28.331667 [debug] [MainThread]: Flushing usage events
[0m16:52:05.741087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b12d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91528050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b12ad0>]}


============================== 16:52:05.742972 | d6d46150-867e-4a02-a69b-df55d72b237b ==============================
[0m16:52:05.742972 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:52:05.743342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profile silver --select path:models/bronze', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:06.020478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6d46150-867e-4a02-a69b-df55d72b237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8faae690>]}
[0m16:52:06.063799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6d46150-867e-4a02-a69b-df55d72b237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90944a90>]}
[0m16:52:06.064396 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:52:06.069121 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m16:52:06.076869 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:52:06.077269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6d46150-867e-4a02-a69b-df55d72b237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9092c550>]}
[0m16:52:06.835312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6d46150-867e-4a02-a69b-df55d72b237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f735f90>]}
[0m16:52:06.849668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6d46150-867e-4a02-a69b-df55d72b237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f693490>]}
[0m16:52:06.850117 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m16:52:06.850560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d46150-867e-4a02-a69b-df55d72b237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f9ca890>]}
[0m16:52:06.852224 [info ] [MainThread]: 
[0m16:52:06.853033 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:52:06.854290 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:52:06.854764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:07.514738 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:52:07.521315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m16:52:07.522066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:08.872539 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:52:08.875505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m16:52:08.877793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:10.047895 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:52:10.051071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m16:52:10.051978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:11.494325 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:52:11.498284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d46150-867e-4a02-a69b-df55d72b237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8efd1990>]}
[0m16:52:11.499538 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:11.500248 [info ] [MainThread]: 
[0m16:52:11.503885 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m16:52:11.504953 [info ] [Thread-1 (]: 1 of 5 START sql table model bronze.eia_bronze ................................. [RUN]
[0m16:52:11.506290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m16:52:11.507579 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m16:52:11.527248 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m16:52:11.534076 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 16:52:11.511437 => 16:52:11.532546
[0m16:52:11.535377 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m16:52:11.581345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:12.683823 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_bronze
[0m16:52:12.685788 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.VIEW
[0m16:52:12.692438 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m16:52:13.845957 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_bronze
[0m16:52:13.848068 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.VIEW
[0m16:52:15.030708 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."bronze"."eia_bronze"
[0m16:52:15.067668 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:52:15.561494 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:52:15.565633 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */


    create table "AwsDataCatalog"."bronze"."eia_bronze"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/bronze/eia_bronze/fb6edc13-3f03-48dc-8562-6dce81575779',
      format='parquet'
    )
    as
      
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."bronze"."eia_energy"
[0m16:52:16.080103 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 04eeb305-2ad9-42b7-ae5d-f0fcca3abb6f
[0m16:52:23.859929 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7626f6d9-70e5-4dc2-b522-b6784331046c
[0m16:52:37.764439 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 884454d6-93bd-47c2-9725-fb45e952e7ce
[0m16:53:03.601157 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ae3287e8-1444-44f1-a6c6-1d52261fbc6d
[0m16:53:18.265682 [error] [MainThread]: CANCEL query model.silver.eia_bronze ........................................... [[31mCANCEL[0m]
[0m16:53:19.182804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:19.185042 [debug] [MainThread]: Connection 'model.silver.eia_bronze' was left open.
[0m16:53:19.186339 [debug] [MainThread]: On model.silver.eia_bronze: Close
[0m16:53:19.189072 [info ] [MainThread]: 
[0m16:53:19.191242 [info ] [MainThread]: Finished running  in 0 hours 1 minutes and 12.33 seconds (72.33s).
[0m16:53:19.202249 [error] [MainThread]: Encountered an error:

[0m16:53:19.218202 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:53:19.228726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 73.50598, "process_user_time": 3.528835, "process_kernel_time": 0.477632, "process_mem_max_rss": "186848", "process_out_blocks": "1984", "command_success": false, "process_in_blocks": "0"}
[0m16:53:19.230439 [debug] [MainThread]: Command `dbt run` failed at 16:53:19.230150 after 73.51 seconds
[0m16:53:19.231881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b8fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a5be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb9ec90>]}
[0m16:53:19.233266 [debug] [MainThread]: Flushing usage events
[0m16:54:53.813964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d0bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d0bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d11c10>]}


============================== 16:54:53.816188 | 18222860-c90e-4d21-8782-71c675dc4e9b ==============================
[0m16:54:53.816188 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:54:53.816674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profile silver --select path:models/bronze', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:54:54.116631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18222860-c90e-4d21-8782-71c675dc4e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98cae690>]}
[0m16:54:54.171399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18222860-c90e-4d21-8782-71c675dc4e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d258d0>]}
[0m16:54:54.172963 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:54:54.178481 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m16:54:54.221136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m16:54:54.221858 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/openweather_silver.sql
[0m16:54:54.222261 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/eia_silver.sql
[0m16:54:54.222544 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/openmeteo_silver.sql
[0m16:54:54.222838 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/sensor_silver.sql
[0m16:54:54.223132 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/noaa_silver.sql
[0m16:54:54.302665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18222860-c90e-4d21-8782-71c675dc4e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988e5c50>]}
[0m16:54:54.310575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18222860-c90e-4d21-8782-71c675dc4e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989a8410>]}
[0m16:54:54.310941 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m16:54:54.311284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18222860-c90e-4d21-8782-71c675dc4e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff988f40d0>]}
[0m16:54:54.313265 [info ] [MainThread]: 
[0m16:54:54.314233 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:54:54.315740 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:54:54.316037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:54.961917 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:54:54.964526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m16:54:54.964941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:56.121548 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:54:56.125403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m16:54:56.126957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:57.146092 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:54:57.148410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m16:54:57.149102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:58.998682 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:54:59.007246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18222860-c90e-4d21-8782-71c675dc4e9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98913150>]}
[0m16:54:59.009161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:59.010105 [info ] [MainThread]: 
[0m16:54:59.014399 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m16:54:59.015460 [info ] [Thread-1 (]: 1 of 5 START sql table model bronze.eia_bronze ................................. [RUN]
[0m16:54:59.016759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m16:54:59.017308 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m16:54:59.029486 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m16:54:59.033037 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 16:54:59.017697 => 16:54:59.032683
[0m16:54:59.033678 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m16:54:59.103359 [debug] [Thread-1 (]: Skip partitioning: False
[0m16:54:59.104413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:59.620795 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m16:54:59.622642 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */


    create table "AwsDataCatalog"."bronze"."eia_bronze"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/bronze/eia_bronze/deb46342-e014-4167-a803-8ea015d33e4a',
      format='parquet'
    )
    as
      
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."bronze"."eia_energy"
[0m16:55:00.202016 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a9ea35a2-d384-4395-82a1-442133e88707
[0m16:55:08.019369 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 59596c5c-e2f1-4d98-8bcc-1d2e69be03e6
[0m16:55:19.185895 [error] [MainThread]: CANCEL query model.silver.eia_bronze ........................................... [[31mCANCEL[0m]
[0m16:55:19.459703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:19.461819 [debug] [MainThread]: Connection 'model.silver.eia_bronze' was left open.
[0m16:55:19.463126 [debug] [MainThread]: On model.silver.eia_bronze: Close
[0m16:55:19.465840 [info ] [MainThread]: 
[0m16:55:19.468091 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 25.15 seconds (25.15s).
[0m16:55:19.470704 [error] [MainThread]: Encountered an error:

[0m16:55:19.509129 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:55:19.532985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 25.741888, "process_user_time": 2.789153, "process_kernel_time": 0.559048, "process_mem_max_rss": "184936", "process_out_blocks": "1987", "command_success": false, "process_in_blocks": "0"}
[0m16:55:19.543551 [debug] [MainThread]: Command `dbt run` failed at 16:55:19.543110 after 25.75 seconds
[0m16:55:19.549210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9894cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eef9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eef97d0>]}
[0m16:55:19.554262 [debug] [MainThread]: Flushing usage events
[0m16:55:47.121344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ee5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa4b58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ee5010>]}


============================== 16:55:47.123612 | a24b9e9f-63db-47d8-8033-5482eaf20816 ==============================
[0m16:55:47.123612 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:55:47.124073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profile silver --select path:models/bronze', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:47.410336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a24b9e9f-63db-47d8-8033-5482eaf20816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f5cd50>]}
[0m16:55:47.454626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a24b9e9f-63db-47d8-8033-5482eaf20816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa805e390>]}
[0m16:55:47.455321 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:55:47.460796 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m16:55:47.477968 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:55:47.478597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a24b9e9f-63db-47d8-8033-5482eaf20816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7e29910>]}
[0m16:55:48.240063 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.silver.noaa_bronze' (models/bronze/noaa_bronze.sql) depends on a source named 'bronze.noaa_weather' which was not found
[0m16:55:48.241410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1505075, "process_user_time": 2.00877, "process_kernel_time": 0.254109, "process_mem_max_rss": "134484", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m16:55:48.241772 [debug] [MainThread]: Command `dbt run` failed at 16:55:48.241698 after 1.15 seconds
[0m16:55:48.242079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2f8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2f97d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7518c10>]}
[0m16:55:48.242409 [debug] [MainThread]: Flushing usage events
[0m16:56:25.447978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e13a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e13f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831e90d0>]}


============================== 16:56:25.449930 | 282eedc8-706c-45f1-9bb8-5176c009ab53 ==============================
[0m16:56:25.449930 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:56:25.450432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profile silver --select path:models/bronze', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:56:25.737821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '282eedc8-706c-45f1-9bb8-5176c009ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e83a50>]}
[0m16:56:25.799714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '282eedc8-706c-45f1-9bb8-5176c009ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80e22550>]}
[0m16:56:25.800826 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m16:56:25.809897 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m16:56:25.817966 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:56:25.818402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '282eedc8-706c-45f1-9bb8-5176c009ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c281d0>]}
[0m16:56:26.548045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '282eedc8-706c-45f1-9bb8-5176c009ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80caea90>]}
[0m16:56:26.561358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '282eedc8-706c-45f1-9bb8-5176c009ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c56190>]}
[0m16:56:26.562035 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m16:56:26.562505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '282eedc8-706c-45f1-9bb8-5176c009ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a34110>]}
[0m16:56:26.565609 [info ] [MainThread]: 
[0m16:56:26.568245 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m16:56:26.571158 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m16:56:26.575226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:27.207519 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m16:56:27.217138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m16:56:27.218240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:28.689580 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m16:56:28.691986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m16:56:28.697244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:29.776920 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m16:56:29.780982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m16:56:29.782535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:56:30.952465 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m16:56:30.954440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '282eedc8-706c-45f1-9bb8-5176c009ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80cfe5d0>]}
[0m16:56:30.955712 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:30.956399 [info ] [MainThread]: 
[0m16:56:30.958666 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m16:56:30.959214 [info ] [Thread-1 (]: 1 of 5 START sql view model bronze.eia_bronze .................................. [RUN]
[0m16:56:30.960029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.eia_bronze)
[0m16:56:30.960413 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m16:56:30.967307 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m16:56:30.968714 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 16:56:30.960674 => 16:56:30.968520
[0m16:56:30.969089 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m16:56:30.991287 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m16:56:30.992658 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m16:56:30.993031 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m16:56:30.993432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:31.556932 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3fe7b80a-70b9-4ae9-b964-63effcbaf9f7
[0m16:56:33.496700 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m16:56:34.732095 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['0']
[0m16:56:34.744228 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m16:56:34.762622 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 16:56:30.969335 => 16:56:34.760873
[0m16:56:34.763707 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m16:56:34.766103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282eedc8-706c-45f1-9bb8-5176c009ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff781964d0>]}
[0m16:56:34.767875 [info ] [Thread-1 (]: 1 of 5 OK created sql view model bronze.eia_bronze ............................. [[32mOK -1[0m in 3.81s]
[0m16:56:34.768987 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m16:56:34.769855 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m16:56:34.770961 [info ] [Thread-1 (]: 2 of 5 START sql view model bronze.noaa_bronze ................................. [RUN]
[0m16:56:34.778630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m16:56:34.779315 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m16:56:34.789769 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m16:56:34.791477 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 16:56:34.779587 => 16:56:34.791240
[0m16:56:34.791875 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m16:56:34.795959 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m16:56:34.797416 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m16:56:34.797754 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m16:56:34.798120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:35.772225 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ccb6b671-b4d1-4bab-add8-8a1caaf61edc
[0m16:56:37.904130 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m16:56:39.032739 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['11', '10', '9', '8', '7']
[0m16:56:39.035579 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['7']
[0m16:56:39.524735 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 7 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m16:56:39.533719 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 16:56:34.792116 => 16:56:39.532895
[0m16:56:39.534823 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m16:56:39.537395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282eedc8-706c-45f1-9bb8-5176c009ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8051f1d0>]}
[0m16:56:39.540145 [info ] [Thread-1 (]: 2 of 5 OK created sql view model bronze.noaa_bronze ............................ [[32mOK -1[0m in 4.76s]
[0m16:56:39.542130 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m16:56:39.543050 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m16:56:39.544402 [info ] [Thread-1 (]: 3 of 5 START sql view model bronze.openmeteo_bronze ............................ [RUN]
[0m16:56:39.547825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m16:56:39.548956 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m16:56:39.563786 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m16:56:39.565970 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 16:56:39.549333 => 16:56:39.565739
[0m16:56:39.566476 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m16:56:39.570538 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m16:56:39.571695 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m16:56:39.572125 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m16:56:39.572659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:40.126445 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b27d7a98-0703-409b-b248-00390a88d071
[0m16:56:41.825874 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m16:56:43.227106 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['11', '10', '9', '8', '7']
[0m16:56:43.231637 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['7']
[0m16:56:43.752627 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 7 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m16:56:43.757999 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 16:56:39.566793 => 16:56:43.757745
[0m16:56:43.758646 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m16:56:43.759641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '282eedc8-706c-45f1-9bb8-5176c009ab53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78eef490>]}
[0m16:56:43.760468 [info ] [Thread-1 (]: 3 of 5 OK created sql view model bronze.openmeteo_bronze ....................... [[32mOK -1[0m in 4.21s]
[0m16:56:43.761317 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m16:56:43.761849 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m16:56:43.762403 [info ] [Thread-1 (]: 4 of 5 START sql view model bronze.openweather_bronze .......................... [RUN]
[0m16:56:43.764380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m16:56:43.764748 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m16:56:43.768502 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m16:56:43.769595 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 16:56:43.764976 => 16:56:43.769468
[0m16:56:43.769891 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m16:56:43.772378 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m16:56:43.773207 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m16:56:43.773523 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m16:56:43.773833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:43.930797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:56:43.994242 [error] [MainThread]: CANCEL query model.silver.openweather_bronze ................................... [[31mCANCEL[0m]
[0m16:56:44.225021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:44.225897 [debug] [MainThread]: Connection 'model.silver.openweather_bronze' was left open.
[0m16:56:44.226396 [debug] [MainThread]: On model.silver.openweather_bronze: Close
[0m16:56:44.227560 [info ] [MainThread]: 
[0m16:56:44.228360 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 17.66 seconds (17.66s).
[0m16:56:44.229825 [error] [MainThread]: Encountered an error:

[0m16:56:44.247087 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m16:56:44.251511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 18.826128, "process_user_time": 4.601972, "process_kernel_time": 0.63111, "process_mem_max_rss": "188116", "process_out_blocks": "2009", "command_success": false, "process_in_blocks": "0"}
[0m16:56:44.252679 [debug] [MainThread]: Command `dbt run` failed at 16:56:44.252457 after 18.83 seconds
[0m16:56:44.253778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff870997d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e1a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e19d10>]}
[0m16:56:44.255092 [debug] [MainThread]: Flushing usage events
[0m16:56:44.449401 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d851b274-05b0-4106-95a5-e6f8037b1e3b
[0m17:01:38.124885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a75de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a90fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a75d510>]}


============================== 17:01:38.126789 | 452f969a-c38c-403e-ad87-74f85454a1c9 ==============================
[0m17:01:38.126789 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:01:38.127625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profile silver --select path:models/bronze', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:01:38.415679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89842690>]}
[0m17:01:38.464426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899958d0>]}
[0m17:01:38.465130 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:01:38.470735 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m17:01:38.503550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:38.503930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:38.508391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89720a10>]}
[0m17:01:38.523835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8973fbd0>]}
[0m17:01:38.524230 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m17:01:38.524536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8993a510>]}
[0m17:01:38.525992 [info ] [MainThread]: 
[0m17:01:38.526724 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:01:38.527637 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:01:38.528022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:39.137496 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:01:39.141192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m17:01:39.142095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:40.311134 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m17:01:40.313071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m17:01:40.314702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:41.383360 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m17:01:41.386583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m17:01:41.388007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:42.782902 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:01:42.788259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898a1710>]}
[0m17:01:42.789947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:01:42.790500 [info ] [MainThread]: 
[0m17:01:42.792530 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m17:01:42.793127 [info ] [Thread-1 (]: 1 of 5 START sql view model bronze.eia_bronze .................................. [RUN]
[0m17:01:42.794043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m17:01:42.794395 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m17:01:42.801858 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m17:01:42.803415 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 17:01:42.794674 => 17:01:42.803233
[0m17:01:42.803770 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m17:01:42.823153 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m17:01:42.824281 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m17:01:42.824644 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m17:01:42.825443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:43.375161 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 6f082aac-94a0-4e94-837b-b90f0e812989
[0m17:01:45.300745 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:01:46.416832 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['1', '0']
[0m17:01:46.418132 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m17:01:46.425030 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 17:01:42.804068 => 17:01:46.424805
[0m17:01:46.425610 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m17:01:46.426599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d72dd0>]}
[0m17:01:46.427411 [info ] [Thread-1 (]: 1 of 5 OK created sql view model bronze.eia_bronze ............................. [[32mOK -1[0m in 3.63s]
[0m17:01:46.428060 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m17:01:46.428632 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m17:01:46.429247 [info ] [Thread-1 (]: 2 of 5 START sql view model bronze.noaa_bronze ................................. [RUN]
[0m17:01:46.431214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m17:01:46.431655 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m17:01:46.437622 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m17:01:46.439449 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 17:01:46.431981 => 17:01:46.439257
[0m17:01:46.439763 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m17:01:46.442441 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m17:01:46.444479 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m17:01:46.444966 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m17:01:46.445237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:47.147239 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2a063ec1-2f61-4ec6-a9fe-2d51f2c0df43
[0m17:01:49.095496 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m17:01:50.119367 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['12', '11', '10', '9', '8']
[0m17:01:50.121487 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['8']
[0m17:01:50.672360 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 8 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m17:01:50.676998 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 17:01:46.439960 => 17:01:50.676637
[0m17:01:50.677724 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m17:01:50.679043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88410650>]}
[0m17:01:50.680162 [info ] [Thread-1 (]: 2 of 5 OK created sql view model bronze.noaa_bronze ............................ [[32mOK -1[0m in 4.25s]
[0m17:01:50.681492 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m17:01:50.682400 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m17:01:50.683463 [info ] [Thread-1 (]: 3 of 5 START sql view model bronze.openmeteo_bronze ............................ [RUN]
[0m17:01:50.686111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m17:01:50.686705 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m17:01:50.691073 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m17:01:50.692705 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 17:01:50.687094 => 17:01:50.692431
[0m17:01:50.693276 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m17:01:50.696635 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m17:01:50.697997 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m17:01:50.698492 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m17:01:50.698985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:51.238207 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0be2df91-7c72-4b6b-9a2c-92ba4b8125a0
[0m17:01:53.289526 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m17:01:54.359255 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['12', '11', '10', '9', '8']
[0m17:01:54.361223 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['8']
[0m17:01:55.133457 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 8 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m17:01:55.135401 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 17:01:50.693634 => 17:01:55.135247
[0m17:01:55.135812 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m17:01:55.136412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89996490>]}
[0m17:01:55.136881 [info ] [Thread-1 (]: 3 of 5 OK created sql view model bronze.openmeteo_bronze ....................... [[32mOK -1[0m in 4.45s]
[0m17:01:55.137327 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m17:01:55.137676 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m17:01:55.138114 [info ] [Thread-1 (]: 4 of 5 START sql view model bronze.openweather_bronze .......................... [RUN]
[0m17:01:55.139521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m17:01:55.139944 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m17:01:55.142453 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m17:01:55.143541 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 17:01:55.140175 => 17:01:55.143389
[0m17:01:55.143841 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m17:01:55.145796 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m17:01:55.147039 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m17:01:55.147373 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m17:01:55.147627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:55.814356 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4457341e-7629-4883-9583-3bae17a89f46
[0m17:01:57.498734 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:01:58.633018 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['12', '11', '10', '9', '8', '7']
[0m17:01:58.636557 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['8', '7']
[0m17:01:59.123652 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 8 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m17:01:59.329933 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 7 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m17:01:59.334602 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 17:01:55.144029 => 17:01:59.334190
[0m17:01:59.335326 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m17:01:59.336678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83dc0650>]}
[0m17:01:59.337939 [info ] [Thread-1 (]: 4 of 5 OK created sql view model bronze.openweather_bronze ..................... [[32mOK -1[0m in 4.20s]
[0m17:01:59.339307 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m17:01:59.340252 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m17:01:59.341128 [info ] [Thread-1 (]: 5 of 5 START sql view model bronze.sensor_bronze ............................... [RUN]
[0m17:01:59.343471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m17:01:59.344072 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m17:01:59.348983 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m17:01:59.351842 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 17:01:59.344472 => 17:01:59.351581
[0m17:01:59.352311 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m17:01:59.356231 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m17:01:59.357714 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m17:01:59.358227 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m17:01:59.358710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:00.000119 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 085a63dc-742b-4cf7-9d67-d012f35fdaaa
[0m17:02:01.890842 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m17:02:03.056057 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['11', '10', '9', '8', '7']
[0m17:02:03.058926 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['7']
[0m17:02:03.539181 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 7 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m17:02:03.551406 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 17:01:59.352641 => 17:02:03.551064
[0m17:02:03.557443 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m17:02:03.565701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '452f969a-c38c-403e-ad87-74f85454a1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83892fd0>]}
[0m17:02:03.574894 [info ] [Thread-1 (]: 5 of 5 OK created sql view model bronze.sensor_bronze .......................... [[32mOK -1[0m in 4.22s]
[0m17:02:03.581469 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m17:02:03.602093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:03.605775 [debug] [MainThread]: Connection 'model.silver.sensor_bronze' was properly closed.
[0m17:02:03.677473 [info ] [MainThread]: 
[0m17:02:03.693573 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 25.15 seconds (25.15s).
[0m17:02:03.706474 [debug] [MainThread]: Command end result
[0m17:02:03.728908 [info ] [MainThread]: 
[0m17:02:03.729999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:03.731151 [info ] [MainThread]: 
[0m17:02:03.731965 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:02:03.734328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.632795, "process_user_time": 3.483774, "process_kernel_time": 0.488578, "process_mem_max_rss": "183136", "process_out_blocks": "2029", "process_in_blocks": "0"}
[0m17:02:03.736485 [debug] [MainThread]: Command `dbt run` succeeded at 17:02:03.736205 after 25.64 seconds
[0m17:02:03.737966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a775650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab82610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bb06090>]}
[0m17:02:03.738562 [debug] [MainThread]: Flushing usage events
[0m17:02:12.914618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3122dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3409250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34093d0>]}


============================== 17:02:12.916523 | 429dac1a-7ba8-4203-8c04-d747203d8bdd ==============================
[0m17:02:12.916523 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:02:12.916975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:13.230646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa209bf50>]}
[0m17:02:13.279034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa21d7b50>]}
[0m17:02:13.279782 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:02:13.286766 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m17:02:13.318667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:02:13.319215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:02:13.323354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f14bd0>]}
[0m17:02:13.336287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa20f0250>]}
[0m17:02:13.336711 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m17:02:13.337118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa218e150>]}
[0m17:02:13.338712 [info ] [MainThread]: 
[0m17:02:13.339633 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:02:13.340854 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:02:13.341239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:13.997725 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:02:14.001436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m17:02:14.002412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:15.513614 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m17:02:15.515070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m17:02:15.516113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:16.708190 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m17:02:16.710835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m17:02:16.711740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:18.083929 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:02:18.092169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2066510>]}
[0m17:02:18.094122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:18.095047 [info ] [MainThread]: 
[0m17:02:18.099029 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m17:02:18.099890 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m17:02:18.101387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_silver)
[0m17:02:18.102012 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m17:02:18.114252 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m17:02:18.116255 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 17:02:18.102572 => 17:02:18.115970
[0m17:02:18.116747 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m17:02:18.148391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:19.183273 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m17:02:19.184934 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:02:19.188832 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:02:20.192003 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m17:02:20.193401 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:02:20.194276 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/ab79c899-259c-4004-a007-4ba776d650c6
[0m17:02:20.734618 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/ab79c899-259c-4004-a007-4ba776d650c6', bucket='climate-energy-raw-data', prefix='silver/eia_silver/ab79c899-259c-4004-a007-4ba776d650c6/'
[0m17:02:22.887492 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m17:02:22.929622 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:02:23.398091 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:02:23.399739 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/a8f310fc-8390-414c-9ed3-819a9ca516dc',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m17:02:23.953159 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 98e9996d-7ce3-41ec-accb-cf2c588d5843
[0m17:02:26.830226 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m17:02:26.845929 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m17:02:26.846469 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m17:02:27.188760 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b9d25db2-dce3-4ef7-b90d-0e9fcda7a7ce
[0m17:02:29.234152 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:02:29.241818 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m17:02:29.245404 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m17:02:29.246105 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m17:02:29.447699 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 393b767b-9254-4ddc-9cde-996544fa6445
[0m17:02:31.585653 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m17:02:31.590857 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 17:02:18.117070 => 17:02:31.590603
[0m17:02:31.591381 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m17:02:31.592291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0d0d810>]}
[0m17:02:31.593296 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.eia_silver ............................ [[32mOK 2842[0m in 13.49s]
[0m17:02:31.593934 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m17:02:31.594540 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m17:02:31.595203 [info ] [Thread-1 (]: 2 of 5 START sql table model silver.noaa_silver ................................ [RUN]
[0m17:02:31.596958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m17:02:31.597476 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m17:02:31.603294 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m17:02:31.605588 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 17:02:31.597756 => 17:02:31.605416
[0m17:02:31.605859 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m17:02:31.608277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:32.777912 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m17:02:32.780542 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:02:32.783057 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:02:33.781068 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m17:02:33.781545 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:02:33.781987 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/e46d49f1-91ba-45cb-bbc3-05a30d5aa2d1
[0m17:02:34.247919 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/e46d49f1-91ba-45cb-bbc3-05a30d5aa2d1', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/e46d49f1-91ba-45cb-bbc3-05a30d5aa2d1/'
[0m17:02:36.505712 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m17:02:36.510931 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:02:36.990096 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:02:36.992755 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/2d16f8fc-5074-43d9-b193-9e88f1d81b67',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m17:02:37.628092 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e36a44b9-93f8-4e7d-8569-79db671237ec
[0m17:02:41.320846 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m17:02:41.323694 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m17:02:41.324594 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m17:02:41.623803 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b1c6b1d2-4984-4b6e-9de4-bbd9eea486a5
[0m17:02:43.362637 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:02:43.367049 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m17:02:43.369527 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m17:02:43.370115 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m17:02:43.571403 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b2f0d3e1-ea27-4cf2-8f71-2564cc2e15a2
[0m17:02:45.348629 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m17:02:45.358426 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 17:02:31.606074 => 17:02:45.357854
[0m17:02:45.359840 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m17:02:45.362077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b423cd0>]}
[0m17:02:45.364204 [info ] [Thread-1 (]: 2 of 5 OK created sql table model silver.noaa_silver ........................... [[32mOK 305[0m in 13.77s]
[0m17:02:45.365538 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m17:02:45.366681 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m17:02:45.367769 [info ] [Thread-1 (]: 3 of 5 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m17:02:45.372298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m17:02:45.373040 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m17:02:45.379761 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m17:02:45.381694 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 17:02:45.373506 => 17:02:45.381376
[0m17:02:45.382253 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m17:02:45.387588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:46.646633 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m17:02:46.648649 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:02:46.650466 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:02:47.698246 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m17:02:47.699456 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:02:47.700297 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/da1a961a-e878-467c-b275-2a1d91f874b2
[0m17:02:48.220234 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/da1a961a-e878-467c-b275-2a1d91f874b2', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/da1a961a-e878-467c-b275-2a1d91f874b2/'
[0m17:02:50.430292 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m17:02:50.433258 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:02:50.863537 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:02:50.865634 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/074991d4-fa81-4df9-b65c-6459b7b408e1',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m17:02:51.350052 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 87b80e0a-52ba-4ff4-9daf-3eaa8a1de005
[0m17:02:54.272599 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":30794,"data_scanned_in_bytes":211521}
[0m17:02:54.276833 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m17:02:54.277681 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m17:02:54.554525 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ea0f79a8-4422-4aa0-8bd5-c02c99220c55
[0m17:02:56.454965 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:02:56.457683 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m17:02:56.459565 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m17:02:56.459928 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":30794,"data_scanned_in_bytes":211521}';
[0m17:02:56.663034 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8122497a-c2b9-4a4c-9b46-6b73d619dc93
[0m17:02:58.469225 [debug] [Thread-1 (]: SQL status: OK 30794 in 2.0 seconds
[0m17:02:58.475463 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 17:02:45.382648 => 17:02:58.474708
[0m17:02:58.476436 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m17:02:58.477603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1005a90>]}
[0m17:02:58.478888 [info ] [Thread-1 (]: 3 of 5 OK created sql table model silver.openmeteo_silver ...................... [[32mOK 30794[0m in 13.11s]
[0m17:02:58.480013 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m17:02:58.480734 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m17:02:58.481396 [info ] [Thread-1 (]: 4 of 5 START sql table model silver.openweather_silver ......................... [RUN]
[0m17:02:58.484211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m17:02:58.484811 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m17:02:58.488879 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m17:02:58.490678 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 17:02:58.485153 => 17:02:58.490370
[0m17:02:58.491231 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m17:02:58.497587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:59.714418 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m17:02:59.715839 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:02:59.717148 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:03:00.746110 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m17:03:00.746793 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:03:00.747300 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/176b1a5f-f9f1-464f-9ffa-3edc0ae56af3
[0m17:03:01.225751 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/176b1a5f-f9f1-464f-9ffa-3edc0ae56af3', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/176b1a5f-f9f1-464f-9ffa-3edc0ae56af3/'
[0m17:03:03.266645 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m17:03:03.276641 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:03:03.706654 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:03:03.708217 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/ff83ba4e-98a4-485f-925b-a46fe5dec3ba',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m17:03:04.193682 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7ca032d3-839f-4dfa-8b8b-303cf668da0b
[0m17:03:07.325108 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2508,"data_scanned_in_bytes":33539}
[0m17:03:07.327573 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m17:03:07.328295 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m17:03:07.589710 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0369ae14-8520-4604-93be-bd44907648a8
[0m17:03:09.229880 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:03:09.235620 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m17:03:09.238118 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m17:03:09.238744 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":2508,"data_scanned_in_bytes":33539}';
[0m17:03:09.580176 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e13009d9-8a48-4fab-aa65-cc08990fe0a9
[0m17:03:11.523907 [debug] [Thread-1 (]: SQL status: OK 2508 in 2.0 seconds
[0m17:03:11.527915 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 17:02:58.491568 => 17:03:11.527574
[0m17:03:11.528601 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m17:03:11.529986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7db3d0>]}
[0m17:03:11.531367 [info ] [Thread-1 (]: 4 of 5 OK created sql table model silver.openweather_silver .................... [[32mOK 2508[0m in 13.05s]
[0m17:03:11.532265 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m17:03:11.532925 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m17:03:11.533826 [info ] [Thread-1 (]: 5 of 5 START sql table model silver.sensor_silver .............................. [RUN]
[0m17:03:11.536563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m17:03:11.537004 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m17:03:11.543640 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m17:03:11.549494 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 17:03:11.537225 => 17:03:11.548936
[0m17:03:11.554993 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m17:03:11.854508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:12.959622 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m17:03:12.960427 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:03:12.961290 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:03:13.955056 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m17:03:13.956110 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:03:13.956867 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/125cc3ba-0546-4e90-bef6-dfb4c89de67b
[0m17:03:14.403835 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/125cc3ba-0546-4e90-bef6-dfb4c89de67b', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/125cc3ba-0546-4e90-bef6-dfb4c89de67b/'
[0m17:03:16.451066 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m17:03:16.458008 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:03:16.911688 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:03:16.912862 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/4936fcbc-15eb-4049-92aa-f157c66f16fd',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m17:03:17.444417 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1c0a0501-6c2a-4493-a904-68704ac832c9
[0m17:03:20.535668 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2278,"data_scanned_in_bytes":53254}
[0m17:03:20.537399 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m17:03:20.537754 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m17:03:20.841147 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 770dc29a-8ff1-4a56-a7c0-5ed69d3fbe26
[0m17:03:22.827202 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:03:22.836008 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m17:03:22.839755 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m17:03:22.840705 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2278,"data_scanned_in_bytes":53254}';
[0m17:03:23.199692 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8a243628-7e18-479c-93f9-a7fd735606e5
[0m17:03:25.145209 [debug] [Thread-1 (]: SQL status: OK 2278 in 2.0 seconds
[0m17:03:25.155105 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 17:03:11.557687 => 17:03:25.154121
[0m17:03:25.156193 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m17:03:25.159027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '429dac1a-7ba8-4203-8c04-d747203d8bdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fb8410>]}
[0m17:03:25.161542 [info ] [Thread-1 (]: 5 of 5 OK created sql table model silver.sensor_silver ......................... [[32mOK 2278[0m in 13.62s]
[0m17:03:25.162999 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m17:03:25.172736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:25.173532 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m17:03:25.177445 [info ] [MainThread]: 
[0m17:03:25.178262 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 11.84 seconds (71.84s).
[0m17:03:25.180587 [debug] [MainThread]: Command end result
[0m17:03:25.221428 [info ] [MainThread]: 
[0m17:03:25.222859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:25.223896 [info ] [MainThread]: 
[0m17:03:25.225156 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:03:25.237471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 72.34413, "process_user_time": 5.808, "process_kernel_time": 0.619762, "process_mem_max_rss": "182340", "process_out_blocks": "2044", "process_in_blocks": "0"}
[0m17:03:25.238778 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:25.238625 after 72.35 seconds
[0m17:03:25.240039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2f6b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34098d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83d5750>]}
[0m17:03:25.240442 [debug] [MainThread]: Flushing usage events
[0m17:03:58.859832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ab8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dd1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dd13d0>]}


============================== 17:03:58.863269 | 0fdfe74a-c8ed-40cd-a73a-44f617a64d05 ==============================
[0m17:03:58.863269 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:03:58.864522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'send_anonymous_usage_stats': 'True'}
[0m17:03:59.237451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fdfe74a-c8ed-40cd-a73a-44f617a64d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8897f950>]}
[0m17:03:59.282691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fdfe74a-c8ed-40cd-a73a-44f617a64d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dd1950>]}
[0m17:03:59.283447 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:03:59.290081 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m17:03:59.299749 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:03:59.300398 [debug] [MainThread]: previous checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, current checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a
[0m17:03:59.300916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0fdfe74a-c8ed-40cd-a73a-44f617a64d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88848ad0>]}
[0m17:04:00.045357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fdfe74a-c8ed-40cd-a73a-44f617a64d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889d9690>]}
[0m17:04:00.062334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fdfe74a-c8ed-40cd-a73a-44f617a64d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f1e190>]}
[0m17:04:00.062861 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m17:04:00.063681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fdfe74a-c8ed-40cd-a73a-44f617a64d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8871d9d0>]}
[0m17:04:00.065463 [info ] [MainThread]: 
[0m17:04:00.066491 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:04:00.067878 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:04:00.068217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:00.655723 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:04:00.664803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m17:04:00.666711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:02.320715 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m17:04:02.323670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m17:04:02.324823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:03.760712 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:04:03.765814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m17:04:03.769806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:05.395690 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m17:04:05.398235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fdfe74a-c8ed-40cd-a73a-44f617a64d05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84affb50>]}
[0m17:04:05.399514 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:05.400182 [info ] [MainThread]: 
[0m17:04:05.403126 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m17:04:05.403911 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m17:04:05.405365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.weather_data_gold)
[0m17:04:05.406091 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m17:04:05.416452 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m17:04:05.418264 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 17:04:05.406471 => 17:04:05.417957
[0m17:04:05.418698 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m17:04:05.468999 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:04:05.470234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:06.023775 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m17:04:06.673371 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold__ha"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m17:04:07.182067 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ad521556-e480-4bfe-a6f6-373d7171f3e2
[0m17:04:10.509450 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":33302,"data_scanned_in_bytes":218590}
[0m17:04:10.540502 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m17:04:10.541301 [debug] [Thread-1 (]: On model.silver.weather_data_gold: alter table `AwsDataCatalog`.`gold`.`weather_data_gold` rename to `gold`.`weather_data_gold__bkp`
[0m17:04:10.814994 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e4cc2a0f-1069-4a09-8c8c-feb96e21d800
[0m17:04:19.837914 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c1c7b5f2-0437-4f84-877f-6428ddc60041
[0m17:04:34.986728 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b8af611f-e7f7-4f08-b16d-f7819409051c
[0m17:05:01.939384 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e0aba0c5-286f-41c1-94c4-3afd791855e4
[0m17:06:53.756975 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 015b9877-df69-48fe-8aeb-de9ca301c1c8
[0m17:07:15.439618 [error] [MainThread]: CANCEL query model.silver.weather_data_gold .................................... [[31mCANCEL[0m]
[0m17:07:16.764350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:16.766308 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was left open.
[0m17:07:16.768038 [debug] [MainThread]: On model.silver.weather_data_gold: Close
[0m17:07:16.771227 [info ] [MainThread]: 
[0m17:07:16.773942 [info ] [MainThread]: Finished running  in 0 hours 3 minutes and 16.70 seconds (196.70s).
[0m17:07:16.777517 [error] [MainThread]: Encountered an error:

[0m17:07:16.821178 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:07:16.846083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 198.01216, "process_user_time": 4.703948, "process_kernel_time": 0.728435, "process_mem_max_rss": "187640", "process_out_blocks": "1986", "command_success": false, "process_in_blocks": "0"}
[0m17:07:16.848674 [debug] [MainThread]: Command `dbt run` failed at 17:07:16.848321 after 198.02 seconds
[0m17:07:16.851100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecf9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ecf97d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bd6710>]}
[0m17:07:16.852656 [debug] [MainThread]: Flushing usage events
[0m17:07:21.635059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bccfe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bfd1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bfd13d0>]}


============================== 17:07:21.636845 | 1e65420c-a9b8-4bfd-9c2b-d7ea96f61ceb ==============================
[0m17:07:21.636845 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:07:21.637349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:07:21.897651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e65420c-a9b8-4bfd-9c2b-d7ea96f61ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9acbf250>]}
[0m17:07:21.945041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e65420c-a9b8-4bfd-9c2b-d7ea96f61ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac6f6d0>]}
[0m17:07:21.945933 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:07:21.953682 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m17:07:21.980297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:21.980619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:21.984279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e65420c-a9b8-4bfd-9c2b-d7ea96f61ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aaf0150>]}
[0m17:07:21.992489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e65420c-a9b8-4bfd-9c2b-d7ea96f61ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9abda910>]}
[0m17:07:21.992804 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m17:07:21.993072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e65420c-a9b8-4bfd-9c2b-d7ea96f61ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac6d750>]}
[0m17:07:21.994297 [info ] [MainThread]: 
[0m17:07:21.994907 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:07:21.995776 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:07:21.996088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:22.598531 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:07:22.601716 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver'
[0m17:07:22.602168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:24.143327 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:07:24.145728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m17:07:24.148071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:25.342434 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m17:07:25.346734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m17:07:25.348532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:26.798045 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m17:07:26.805690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e65420c-a9b8-4bfd-9c2b-d7ea96f61ceb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99eaaad0>]}
[0m17:07:26.807839 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:26.808680 [info ] [MainThread]: 
[0m17:07:26.812782 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m17:07:26.814613 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m17:07:26.817482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.weather_data_gold)
[0m17:07:26.818112 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m17:07:26.845512 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m17:07:26.847632 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 17:07:26.818628 => 17:07:26.847259
[0m17:07:26.848108 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m17:07:26.885731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:28.265454 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold__ha
[0m17:07:28.267829 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.ICEBERG
[0m17:07:28.280764 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:07:29.449753 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold__ha
[0m17:07:29.450972 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.ICEBERG
[0m17:07:29.452051 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold__ha" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m17:07:30.855058 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m17:07:34.102648 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold__ha"
[0m17:07:34.149108 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:07:35.344194 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:07:35.345815 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold__ha"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m17:07:35.820796 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e7a924b0-6cdd-4b1f-806a-3cebe5df697a
[0m17:07:39.851601 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":33302,"data_scanned_in_bytes":218590}
[0m17:07:39.877782 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m17:07:39.878594 [debug] [Thread-1 (]: On model.silver.weather_data_gold: alter table `AwsDataCatalog`.`gold`.`weather_data_gold` rename to `gold`.`weather_data_gold__bkp`
[0m17:07:40.178928 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2d74ba56-77f1-4810-97ce-17f70270218b
[0m17:07:48.941174 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4a96614c-462b-4636-a7f5-169419c0439a
[0m17:08:03.784287 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e2028618-7e3f-495d-87e4-807c5f84fcbf
[0m17:08:29.367942 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b1ec79ac-c542-4d4c-a024-8c52915ad7a0
[0m17:09:20.583480 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3fee5d46-ac14-484d-8ffd-fc5fb5f99b94
[0m17:10:09.348467 [error] [MainThread]: CANCEL query list_AwsDataCatalog ............................................... [[31mCANCEL[0m]
[0m17:10:09.356557 [error] [MainThread]: CANCEL query model.silver.weather_data_gold .................................... [[31mCANCEL[0m]
[0m17:10:11.154003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:11.155726 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m17:10:11.156487 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was left open.
[0m17:10:11.159543 [debug] [MainThread]: On model.silver.weather_data_gold: Close
[0m17:10:11.174725 [info ] [MainThread]: 
[0m17:10:11.178301 [info ] [MainThread]: Finished running  in 0 hours 2 minutes and 49.18 seconds (169.18s).
[0m17:10:11.183429 [error] [MainThread]: Encountered an error:

[0m17:10:11.212791 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:10:11.232773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 169.61644, "process_user_time": 3.375981, "process_kernel_time": 0.490905, "process_mem_max_rss": "185888", "process_out_blocks": "1034", "command_success": false, "process_in_blocks": "0"}
[0m17:10:11.234578 [debug] [MainThread]: Command `dbt run` failed at 17:10:11.234409 after 169.62 seconds
[0m17:10:11.236237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982a6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99756190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0ef97d0>]}
[0m17:10:11.237845 [debug] [MainThread]: Flushing usage events
[0m17:12:09.302114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90622e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9180e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90622b10>]}


============================== 17:12:09.304353 | 48b1ea55-3f81-4f39-97ec-d0d607b0f153 ==============================
[0m17:12:09.304353 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:12:09.304893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:12:09.586173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48b1ea55-3f81-4f39-97ec-d0d607b0f153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9061ae10>]}
[0m17:12:09.630051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48b1ea55-3f81-4f39-97ec-d0d607b0f153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f661e50>]}
[0m17:12:09.630625 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:12:09.635232 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m17:12:09.645022 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:12:09.645520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '48b1ea55-3f81-4f39-97ec-d0d607b0f153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3b7a10>]}
[0m17:12:10.327548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48b1ea55-3f81-4f39-97ec-d0d607b0f153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f49ee50>]}
[0m17:12:10.337209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48b1ea55-3f81-4f39-97ec-d0d607b0f153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1f38d0>]}
[0m17:12:10.337626 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m17:12:10.337985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48b1ea55-3f81-4f39-97ec-d0d607b0f153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f4b9090>]}
[0m17:12:10.339211 [info ] [MainThread]: 
[0m17:12:10.339786 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:12:10.340806 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:12:10.341115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:11.022422 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:12:11.025027 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_bronze'
[0m17:12:11.025649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:12.429288 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m17:12:12.436748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m17:12:12.438377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:13.795499 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m17:12:13.804064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m17:12:13.808299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:15.589418 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:12:15.597409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48b1ea55-3f81-4f39-97ec-d0d607b0f153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d5fb10>]}
[0m17:12:15.600750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:15.602001 [info ] [MainThread]: 
[0m17:12:15.606548 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m17:12:15.607654 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m17:12:15.609534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.weather_data_gold)
[0m17:12:15.610298 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m17:12:15.621751 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m17:12:15.623596 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 17:12:15.610779 => 17:12:15.623320
[0m17:12:15.624075 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m17:12:15.663572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:16.925056 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold__ha
[0m17:12:16.925836 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.ICEBERG
[0m17:12:16.928428 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:12:18.260097 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold__ha
[0m17:12:18.268164 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.ICEBERG
[0m17:12:18.269276 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold__ha" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m17:12:18.901586 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m17:12:21.222036 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold__ha"
[0m17:12:21.263146 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:12:21.775260 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:12:21.778214 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold__ha"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m17:12:22.386960 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4ffbce15-b04a-4de8-8af1-2e93a7f90a1a
[0m17:12:25.195586 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":33302,"data_scanned_in_bytes":218590}
[0m17:12:25.224550 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m17:12:25.225356 [debug] [Thread-1 (]: On model.silver.weather_data_gold: alter table `AwsDataCatalog`.`gold`.`weather_data_gold` rename to `gold`.`weather_data_gold__bkp`
[0m17:12:25.504412 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bbb853b5-e79b-48d7-b8a3-7c6d57217bd7
[0m17:12:34.263809 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 81452d49-ca9b-46b3-a68d-c8653e6f344c
[0m17:12:49.052063 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 986ddec8-54f2-4a5c-9d1c-0e1aa85e6127
[0m17:13:14.663066 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 55517d6e-2ec4-4694-ae84-b8f0ef9939c1
[0m17:14:05.817136 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cd2328e7-1b48-44b7-9cd2-7c7c6ce17f1f
[0m17:14:47.846140 [error] [MainThread]: CANCEL query list_AwsDataCatalog ............................................... [[31mCANCEL[0m]
[0m17:14:47.861861 [error] [MainThread]: CANCEL query model.silver.weather_data_gold .................................... [[31mCANCEL[0m]
[0m17:14:48.592140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:48.593555 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m17:14:48.594702 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was left open.
[0m17:14:48.596412 [debug] [MainThread]: On model.silver.weather_data_gold: Close
[0m17:14:48.615366 [info ] [MainThread]: 
[0m17:14:48.618968 [info ] [MainThread]: Finished running  in 0 hours 2 minutes and 38.27 seconds (158.27s).
[0m17:14:48.622311 [error] [MainThread]: Encountered an error:

[0m17:14:48.635772 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:14:48.641608 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 159.35861, "process_user_time": 3.74879, "process_kernel_time": 0.602484, "process_mem_max_rss": "202008", "process_out_blocks": "1988", "command_success": false, "process_in_blocks": "0"}
[0m17:14:48.643765 [debug] [MainThread]: Command `dbt run` failed at 17:14:48.642944 after 159.36 seconds
[0m17:14:48.648858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909093d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90909590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958655d0>]}
[0m17:14:48.650716 [debug] [MainThread]: Flushing usage events
[0m17:15:45.342169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e2fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ff3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4ff2650>]}


============================== 17:15:45.344344 | 61286c13-de31-416f-aefc-aa11b900bfa4 ==============================
[0m17:15:45.344344 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:15:45.345404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profile silver --select path:models/bronze', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:45.628399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4018c90>]}
[0m17:15:45.670475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ff15d0>]}
[0m17:15:45.671010 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:15:45.676740 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m17:15:45.689510 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:15:45.690157 [debug] [MainThread]: previous checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, current checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387
[0m17:15:45.690520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3caad10>]}
[0m17:15:46.417239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3de9010>]}
[0m17:15:46.427499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b94210>]}
[0m17:15:46.427963 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m17:15:46.428304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e22550>]}
[0m17:15:46.430119 [info ] [MainThread]: 
[0m17:15:46.430740 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:15:46.431798 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:15:46.432082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:47.024546 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:15:47.030780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m17:15:47.031856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:48.712341 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:15:48.715330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m17:15:48.719760 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:50.022268 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m17:15:50.027440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m17:15:50.028832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:51.566118 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m17:15:51.568077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b503250>]}
[0m17:15:51.569097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:51.569540 [info ] [MainThread]: 
[0m17:15:51.572150 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m17:15:51.572961 [info ] [Thread-1 (]: 1 of 5 START sql view model bronze.eia_bronze .................................. [RUN]
[0m17:15:51.573959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.eia_bronze)
[0m17:15:51.574336 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m17:15:51.581673 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m17:15:51.583079 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 17:15:51.574596 => 17:15:51.582929
[0m17:15:51.583334 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m17:15:51.601513 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m17:15:51.602809 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m17:15:51.603628 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m17:15:51.604128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:52.242045 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 03d7fcfd-b885-42f9-82ec-1cd7afc11b6a
[0m17:15:53.957082 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:15:55.220162 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['2', '1', '0']
[0m17:15:55.224483 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m17:15:55.235345 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 17:15:51.583508 => 17:15:55.234922
[0m17:15:55.236046 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m17:15:55.237666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27c6d90>]}
[0m17:15:55.239845 [info ] [Thread-1 (]: 1 of 5 OK created sql view model bronze.eia_bronze ............................. [[32mOK -1[0m in 3.66s]
[0m17:15:55.241341 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m17:15:55.242099 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m17:15:55.243062 [info ] [Thread-1 (]: 2 of 5 START sql view model bronze.noaa_bronze ................................. [RUN]
[0m17:15:55.245316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m17:15:55.246123 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m17:15:55.254008 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m17:15:55.258963 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 17:15:55.246438 => 17:15:55.258242
[0m17:15:55.260517 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m17:15:55.263812 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m17:15:55.266697 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m17:15:55.267184 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m17:15:55.267711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:56.120005 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 11605553-c979-4db9-bd1d-19b6916b1b64
[0m17:15:57.774229 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m17:15:59.041427 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['13', '12', '11', '10', '9']
[0m17:15:59.044906 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['9']
[0m17:15:59.507844 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 9 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m17:15:59.513442 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 17:15:55.260904 => 17:15:59.513015
[0m17:15:59.514419 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m17:15:59.515634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bf00a90>]}
[0m17:15:59.516978 [info ] [Thread-1 (]: 2 of 5 OK created sql view model bronze.noaa_bronze ............................ [[32mOK -1[0m in 4.27s]
[0m17:15:59.517886 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m17:15:59.518632 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m17:15:59.519404 [info ] [Thread-1 (]: 3 of 5 START sql view model bronze.openmeteo_bronze ............................ [RUN]
[0m17:15:59.521657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m17:15:59.522263 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m17:15:59.529572 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m17:15:59.531210 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 17:15:59.522621 => 17:15:59.530999
[0m17:15:59.531723 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m17:15:59.534902 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m17:15:59.536181 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m17:15:59.536699 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m17:15:59.537140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:00.180440 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2136f939-fc7f-43c5-ae50-029f88ef91e8
[0m17:16:01.841939 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:16:03.253755 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['13', '12', '11', '10', '9']
[0m17:16:03.256956 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['9']
[0m17:16:03.742178 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 9 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m17:16:03.746070 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 17:15:59.531998 => 17:16:03.745789
[0m17:16:03.746704 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m17:16:03.747973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9beacd50>]}
[0m17:16:03.748928 [info ] [Thread-1 (]: 3 of 5 OK created sql view model bronze.openmeteo_bronze ....................... [[32mOK -1[0m in 4.23s]
[0m17:16:03.749885 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m17:16:03.750611 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m17:16:03.751377 [info ] [Thread-1 (]: 4 of 5 START sql view model bronze.openweather_bronze .......................... [RUN]
[0m17:16:03.753681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m17:16:03.754236 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m17:16:03.758851 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m17:16:03.761282 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 17:16:03.754585 => 17:16:03.761082
[0m17:16:03.761732 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m17:16:03.764842 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m17:16:03.766230 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m17:16:03.766658 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m17:16:03.767040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:04.528318 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 38ef0edd-374d-4708-b9a8-3a7c744c5b08
[0m17:16:06.196237 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:16:07.359468 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['13', '12', '11', '10', '9']
[0m17:16:07.361939 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['9']
[0m17:16:07.806431 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 9 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m17:16:07.810622 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 17:16:03.762035 => 17:16:07.810274
[0m17:16:07.811674 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m17:16:07.813516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa27fd810>]}
[0m17:16:07.815001 [info ] [Thread-1 (]: 4 of 5 OK created sql view model bronze.openweather_bronze ..................... [[32mOK -1[0m in 4.06s]
[0m17:16:07.815768 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m17:16:07.816291 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m17:16:07.817232 [info ] [Thread-1 (]: 5 of 5 START sql view model bronze.sensor_bronze ............................... [RUN]
[0m17:16:07.819642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m17:16:07.820327 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m17:16:07.825951 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m17:16:07.827894 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 17:16:07.820607 => 17:16:07.827708
[0m17:16:07.828238 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m17:16:07.831323 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m17:16:07.832566 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m17:16:07.832925 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m17:16:07.833258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:16:08.858965 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d1ed8ca4-2788-4e2f-b405-0c48834ef042
[0m17:16:10.543043 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m17:16:11.689943 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['12', '11', '10', '9', '8']
[0m17:16:11.693889 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['8']
[0m17:16:12.266125 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 8 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m17:16:12.277989 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 17:16:07.828525 => 17:16:12.277004
[0m17:16:12.279590 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m17:16:12.283136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61286c13-de31-416f-aefc-aa11b900bfa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09c3e50>]}
[0m17:16:12.285430 [info ] [Thread-1 (]: 5 of 5 OK created sql view model bronze.sensor_bronze .......................... [[32mOK -1[0m in 4.46s]
[0m17:16:12.287516 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m17:16:12.298525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:12.299986 [debug] [MainThread]: Connection 'model.silver.sensor_bronze' was properly closed.
[0m17:16:12.303529 [info ] [MainThread]: 
[0m17:16:12.305168 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 25.87 seconds (25.87s).
[0m17:16:12.308592 [debug] [MainThread]: Command end result
[0m17:16:12.334751 [info ] [MainThread]: 
[0m17:16:12.335969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:12.336587 [info ] [MainThread]: 
[0m17:16:12.337199 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:16:12.340499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.02111, "process_user_time": 4.943927, "process_kernel_time": 0.683216, "process_mem_max_rss": "193904", "process_out_blocks": "2983", "process_in_blocks": "0"}
[0m17:16:12.341743 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:12.341584 after 27.02 seconds
[0m17:16:12.342577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e48410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63ed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa52048d0>]}
[0m17:16:12.342942 [debug] [MainThread]: Flushing usage events
[0m17:24:25.237192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9625a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96258f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96417e50>]}


============================== 17:24:25.239091 | 1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c ==============================
[0m17:24:25.239091 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:24:25.240253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:25.506788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95438d10>]}
[0m17:24:25.546825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954046d0>]}
[0m17:24:25.547330 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:24:25.552310 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m17:24:25.582150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:25.582523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:25.585986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9525c090>]}
[0m17:24:25.593786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951cf6d0>]}
[0m17:24:25.594117 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m17:24:25.594359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95350cd0>]}
[0m17:24:25.595662 [info ] [MainThread]: 
[0m17:24:25.596328 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:24:25.597265 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:24:25.597574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:26.336228 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:24:26.341593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m17:24:26.342683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:27.705219 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m17:24:27.708132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m17:24:27.709610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:29.190328 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:24:29.193992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m17:24:29.198119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:30.574466 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m17:24:30.576658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9640f090>]}
[0m17:24:30.578265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:30.578718 [info ] [MainThread]: 
[0m17:24:30.581362 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m17:24:30.582058 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m17:24:30.582976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.eia_silver)
[0m17:24:30.583326 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m17:24:30.589210 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m17:24:30.590711 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 17:24:30.583547 => 17:24:30.590509
[0m17:24:30.591049 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m17:24:30.619661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:31.894986 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m17:24:31.896864 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:24:31.901039 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:24:32.984022 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m17:24:32.985601 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:24:32.986347 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/a8f310fc-8390-414c-9ed3-819a9ca516dc
[0m17:24:34.317972 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/a8f310fc-8390-414c-9ed3-819a9ca516dc', bucket='climate-energy-raw-data', prefix='silver/eia_silver/a8f310fc-8390-414c-9ed3-819a9ca516dc/'
[0m17:24:36.889819 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m17:24:36.908904 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:24:37.417913 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:24:37.419608 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/9e5fefd9-47de-4ccb-bd56-225e9d79eb08',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m17:24:38.322667 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7f341731-9c95-4916-b56c-3436d31ff160
[0m17:24:39.958861 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2842,"data_scanned_in_bytes":17021}
[0m17:24:39.971077 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m17:24:39.971589 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m17:24:40.258873 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a6073fc5-1b37-470e-8522-9d164b67eef3
[0m17:24:41.907159 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:24:41.910433 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m17:24:41.911867 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m17:24:41.912147 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":2842,"data_scanned_in_bytes":17021}';
[0m17:24:42.112811 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID eacc90e0-1af1-4a89-82f4-6a41ed0d9615
[0m17:24:43.834902 [debug] [Thread-1 (]: SQL status: OK 2842 in 2.0 seconds
[0m17:24:43.853899 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 17:24:30.591269 => 17:24:43.853458
[0m17:24:43.854514 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m17:24:43.855897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff33c90>]}
[0m17:24:43.857162 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.eia_silver ............................ [[32mOK 2842[0m in 13.27s]
[0m17:24:43.858044 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m17:24:43.858686 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m17:24:43.859544 [info ] [Thread-1 (]: 2 of 5 START sql table model silver.noaa_silver ................................ [RUN]
[0m17:24:43.862054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m17:24:43.862398 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m17:24:43.867046 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m17:24:43.868402 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 17:24:43.862617 => 17:24:43.868247
[0m17:24:43.868686 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m17:24:43.873900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:45.346160 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m17:24:45.347845 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:24:45.349454 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:24:46.584649 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m17:24:46.586049 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:24:46.586928 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/2d16f8fc-5074-43d9-b193-9e88f1d81b67
[0m17:24:47.166834 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/2d16f8fc-5074-43d9-b193-9e88f1d81b67', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/2d16f8fc-5074-43d9-b193-9e88f1d81b67/'
[0m17:24:49.265960 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m17:24:49.269289 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:24:50.055632 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:24:50.059493 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/0726270e-22e6-4078-bcf1-9a719d623980',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m17:24:50.515951 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7e2204a5-d7e2-42ef-826b-56c8701a0a15
[0m17:24:53.582971 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":305,"data_scanned_in_bytes":2498}
[0m17:24:53.589119 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m17:24:53.589867 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m17:24:53.991157 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ecadb15d-1853-479d-89f8-2539b45abe62
[0m17:24:55.648258 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:24:55.654474 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m17:24:55.656456 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m17:24:55.656804 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":305,"data_scanned_in_bytes":2498}';
[0m17:24:55.853851 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 06d00ab7-e282-4804-8563-83a72b67bb9c
[0m17:24:57.532812 [debug] [Thread-1 (]: SQL status: OK 305 in 2.0 seconds
[0m17:24:57.544268 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 17:24:43.868891 => 17:24:57.543736
[0m17:24:57.545092 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m17:24:57.547083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941d74d0>]}
[0m17:24:57.549056 [info ] [Thread-1 (]: 2 of 5 OK created sql table model silver.noaa_silver ........................... [[32mOK 305[0m in 13.69s]
[0m17:24:57.550529 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m17:24:57.551500 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m17:24:57.552541 [info ] [Thread-1 (]: 3 of 5 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m17:24:57.559197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m17:24:57.560525 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m17:24:57.570723 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m17:24:57.572163 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 17:24:57.561201 => 17:24:57.571977
[0m17:24:57.572602 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m17:24:57.577842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:58.906243 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m17:24:58.907908 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:24:58.909323 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:25:00.156276 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m17:25:00.158465 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:25:00.159220 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/074991d4-fa81-4df9-b65c-6459b7b408e1
[0m17:25:01.392131 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/074991d4-fa81-4df9-b65c-6459b7b408e1', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/074991d4-fa81-4df9-b65c-6459b7b408e1/'
[0m17:25:04.314043 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m17:25:04.320266 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:25:05.519568 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:25:05.523217 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/acb191bb-b8d5-472b-bc64-bb59eb98a74d',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m17:25:06.105770 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID abab4c5c-98cf-422b-b36b-638b5ea403ef
[0m17:25:08.921207 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":30794,"data_scanned_in_bytes":211521}
[0m17:25:08.928362 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m17:25:08.929363 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m17:25:09.174947 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cb18ddf4-1228-4e4c-b770-a2b080f10cb1
[0m17:25:11.072074 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:25:11.075497 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m17:25:11.078164 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m17:25:11.078648 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":30794,"data_scanned_in_bytes":211521}';
[0m17:25:11.277775 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 259f58b1-e68f-4cd7-831c-cc77f027163d
[0m17:25:13.013164 [debug] [Thread-1 (]: SQL status: OK 30794 in 2.0 seconds
[0m17:25:13.025157 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 17:24:57.572843 => 17:25:13.024702
[0m17:25:13.025892 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m17:25:13.027516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e81550>]}
[0m17:25:13.028929 [info ] [Thread-1 (]: 3 of 5 OK created sql table model silver.openmeteo_silver ...................... [[32mOK 30794[0m in 15.47s]
[0m17:25:13.029794 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m17:25:13.030568 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m17:25:13.031450 [info ] [Thread-1 (]: 4 of 5 START sql table model silver.openweather_silver ......................... [RUN]
[0m17:25:13.034293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m17:25:13.034649 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m17:25:13.042306 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m17:25:13.043884 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 17:25:13.034850 => 17:25:13.043762
[0m17:25:13.044156 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m17:25:13.046740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:14.336062 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m17:25:14.338447 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:25:14.339663 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:25:15.545974 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m17:25:15.547760 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:25:15.548893 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/ff83ba4e-98a4-485f-925b-a46fe5dec3ba
[0m17:25:16.832757 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/ff83ba4e-98a4-485f-925b-a46fe5dec3ba', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/ff83ba4e-98a4-485f-925b-a46fe5dec3ba/'
[0m17:25:19.622393 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m17:25:19.630789 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:25:20.822978 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:25:20.824646 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/db2dfe0c-2c03-4336-88af-ffe1e3877287',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m17:25:21.381257 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e18a5316-33ea-487e-a03b-ea2ac9c68f53
[0m17:25:24.242738 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2508,"data_scanned_in_bytes":33539}
[0m17:25:24.247881 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m17:25:24.248515 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m17:25:24.508261 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 37032253-7125-4ed3-bc16-78867b737171
[0m17:25:26.200802 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:25:26.208503 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m17:25:26.211418 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m17:25:26.211983 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":2508,"data_scanned_in_bytes":33539}';
[0m17:25:26.403373 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 28ba6d62-1626-43ed-a226-c83867d4cabf
[0m17:25:28.356486 [debug] [Thread-1 (]: SQL status: OK 2508 in 2.0 seconds
[0m17:25:28.366076 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 17:25:13.044324 => 17:25:28.365198
[0m17:25:28.367468 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m17:25:28.370413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e90c610>]}
[0m17:25:28.372709 [info ] [Thread-1 (]: 4 of 5 OK created sql table model silver.openweather_silver .................... [[32mOK 2508[0m in 15.34s]
[0m17:25:28.374472 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m17:25:28.375619 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m17:25:28.377848 [info ] [Thread-1 (]: 5 of 5 START sql table model silver.sensor_silver .............................. [RUN]
[0m17:25:28.383828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m17:25:28.384540 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m17:25:28.396257 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m17:25:28.398394 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 17:25:28.384952 => 17:25:28.398073
[0m17:25:28.399022 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m17:25:28.597528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:29.872578 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m17:25:29.874309 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:25:29.876232 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:25:31.120170 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m17:25:31.121164 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:25:31.121945 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/4936fcbc-15eb-4049-92aa-f157c66f16fd
[0m17:25:32.366439 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/4936fcbc-15eb-4049-92aa-f157c66f16fd', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/4936fcbc-15eb-4049-92aa-f157c66f16fd/'
[0m17:25:35.161634 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m17:25:35.167150 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:25:35.692793 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:25:35.695665 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/6a236b96-e83c-4e90-9d57-a3414177e918',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m17:25:36.286068 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3a32e7d8-258f-495a-8557-b4b99807c7c8
[0m17:25:39.056029 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2278,"data_scanned_in_bytes":53254}
[0m17:25:39.058266 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m17:25:39.058650 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m17:25:39.310601 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 40b0dcca-c5e5-4d2f-a328-6f0e80472a70
[0m17:25:40.972187 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:25:40.982067 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m17:25:40.985816 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m17:25:40.986660 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2278,"data_scanned_in_bytes":53254}';
[0m17:25:41.191040 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4aa25f26-041f-4962-9fdf-1cb93816c91b
[0m17:25:42.924222 [debug] [Thread-1 (]: SQL status: OK 2278 in 2.0 seconds
[0m17:25:42.928488 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 17:25:28.399380 => 17:25:42.928157
[0m17:25:42.929199 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m17:25:42.930444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ebeda17-f7fe-4833-86a8-44fc4bb0cb1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f0afb50>]}
[0m17:25:42.931502 [info ] [Thread-1 (]: 5 of 5 OK created sql table model silver.sensor_silver ......................... [[32mOK 2278[0m in 14.55s]
[0m17:25:42.932459 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m17:25:42.936288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:42.936669 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m17:25:42.938734 [info ] [MainThread]: 
[0m17:25:42.939161 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 17.34 seconds (77.34s).
[0m17:25:42.940492 [debug] [MainThread]: Command end result
[0m17:25:42.958080 [info ] [MainThread]: 
[0m17:25:42.958568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:42.959008 [info ] [MainThread]: 
[0m17:25:42.959419 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:25:42.963788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 77.7476, "process_user_time": 5.867508, "process_kernel_time": 0.820779, "process_mem_max_rss": "179652", "process_out_blocks": "2044", "process_in_blocks": "0"}
[0m17:25:42.965110 [debug] [MainThread]: Command `dbt run` succeeded at 17:25:42.964673 after 77.75 seconds
[0m17:25:42.967165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97442150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b640c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6417d0>]}
[0m17:25:42.968494 [debug] [MainThread]: Flushing usage events
[0m17:26:18.243923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6b22710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d08890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb939cb50>]}


============================== 17:26:18.245871 | 27b1caab-d70c-4851-980f-32836e3efefe ==============================
[0m17:26:18.245871 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:26:18.246426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:26:18.509821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b1caab-d70c-4851-980f-32836e3efefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b9d590>]}
[0m17:26:18.552337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27b1caab-d70c-4851-980f-32836e3efefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5bc3d90>]}
[0m17:26:18.552887 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:26:18.559313 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m17:26:18.566554 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:26:18.566924 [debug] [MainThread]: previous checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, current checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a
[0m17:26:18.567276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27b1caab-d70c-4851-980f-32836e3efefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5950390>]}
[0m17:26:19.234583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27b1caab-d70c-4851-980f-32836e3efefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59d5bd0>]}
[0m17:26:19.241932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27b1caab-d70c-4851-980f-32836e3efefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb588ae10>]}
[0m17:26:19.242228 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m17:26:19.242538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b1caab-d70c-4851-980f-32836e3efefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb598af50>]}
[0m17:26:19.243902 [info ] [MainThread]: 
[0m17:26:19.244491 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:26:19.245571 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:26:19.245993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:19.902331 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:26:19.909654 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_gold'
[0m17:26:19.910739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:22.009618 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m17:26:22.011526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m17:26:22.012618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:24.149061 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:26:24.158616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m17:26:24.162915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:26:26.610288 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m17:26:26.613197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b1caab-d70c-4851-980f-32836e3efefe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4276510>]}
[0m17:26:26.614511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:26.615195 [info ] [MainThread]: 
[0m17:26:26.617832 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m17:26:26.618494 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m17:26:26.619374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.weather_data_gold)
[0m17:26:26.619782 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m17:26:26.627319 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m17:26:26.629566 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 17:26:26.620050 => 17:26:26.629357
[0m17:26:26.629928 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m17:26:26.657968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:28.579375 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold__ha
[0m17:26:28.580073 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.ICEBERG
[0m17:26:28.581936 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:26:30.482509 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold__ha
[0m17:26:30.484235 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.ICEBERG
[0m17:26:30.485488 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold__ha" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m17:26:31.818838 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m17:26:35.370348 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold__ha"
[0m17:26:35.402318 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:26:36.592331 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:26:36.594129 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold__ha"
    with (
      table_type='iceberg',
      is_external=false,location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m17:26:37.208517 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b6b0785a-3923-40ae-84b7-32ac51134a8e
[0m17:26:40.046720 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":33302,"data_scanned_in_bytes":218590}
[0m17:26:40.068170 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m17:26:40.068956 [debug] [Thread-1 (]: On model.silver.weather_data_gold: alter table `AwsDataCatalog`.`gold`.`weather_data_gold` rename to `gold`.`weather_data_gold__bkp`
[0m17:26:40.350286 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 532a9787-7378-4d1d-98a5-e735b6268c1f
[0m17:26:48.001115 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 86025a5e-a3b2-4892-bcd7-4d7a98b65597
[0m17:27:01.620687 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c7545594-7222-4786-94b5-77f4c838140d
[0m17:27:13.276611 [error] [MainThread]: CANCEL query list_AwsDataCatalog ............................................... [[31mCANCEL[0m]
[0m17:27:13.283244 [error] [MainThread]: CANCEL query model.silver.weather_data_gold .................................... [[31mCANCEL[0m]
[0m17:27:14.137205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:14.139525 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m17:27:14.140826 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was left open.
[0m17:27:14.144664 [debug] [MainThread]: On model.silver.weather_data_gold: Close
[0m17:27:14.151170 [info ] [MainThread]: 
[0m17:27:14.153345 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 54.91 seconds (54.91s).
[0m17:27:14.157580 [error] [MainThread]: Encountered an error:

[0m17:27:14.166277 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:27:14.171152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 55.949932, "process_user_time": 3.782053, "process_kernel_time": 0.428808, "process_mem_max_rss": "201824", "process_out_blocks": "1987", "command_success": false, "process_in_blocks": "0"}
[0m17:27:14.172356 [debug] [MainThread]: Command `dbt run` failed at 17:27:14.172187 after 55.95 seconds
[0m17:27:14.173254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6967910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6967890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaca01d90>]}
[0m17:27:14.173995 [debug] [MainThread]: Flushing usage events
[0m17:27:29.217650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be23ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d00a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be17110>]}


============================== 17:27:29.219564 | 70f4733e-2717-4e88-8446-96191e1c26c1 ==============================
[0m17:27:29.219564 [info ] [MainThread]: Running with dbt=1.7.9
[0m17:27:29.220048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:27:29.467059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70f4733e-2717-4e88-8446-96191e1c26c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae26690>]}
[0m17:27:29.507259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70f4733e-2717-4e88-8446-96191e1c26c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ae4f990>]}
[0m17:27:29.507829 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m17:27:29.512921 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m17:27:29.543447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:27:29.544144 [debug] [MainThread]: Partial parsing: updated file: silver://models/gold/weather_data_gold.sql
[0m17:27:29.691469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70f4733e-2717-4e88-8446-96191e1c26c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a502150>]}
[0m17:27:29.699116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70f4733e-2717-4e88-8446-96191e1c26c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad026d0>]}
[0m17:27:29.699540 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m17:27:29.700094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70f4733e-2717-4e88-8446-96191e1c26c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a51e890>]}
[0m17:27:29.701567 [info ] [MainThread]: 
[0m17:27:29.702252 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m17:27:29.703070 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m17:27:29.703335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:30.394999 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m17:27:30.398564 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_gold'
[0m17:27:30.399443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:32.371958 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m17:27:32.384009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m17:27:32.387981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:34.721422 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m17:27:34.726216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m17:27:34.728815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:36.927191 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m17:27:36.933281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70f4733e-2717-4e88-8446-96191e1c26c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9994f090>]}
[0m17:27:36.936128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:36.936829 [info ] [MainThread]: 
[0m17:27:36.942192 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m17:27:36.943178 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m17:27:36.944661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.weather_data_gold)
[0m17:27:36.945226 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m17:27:36.974861 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m17:27:36.979267 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 17:27:36.945545 => 17:27:36.978872
[0m17:27:36.980238 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m17:27:37.135183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:38.692287 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold
[0m17:27:38.694286 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:27:38.699125 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m17:27:39.908133 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold
[0m17:27:39.909305 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m17:27:39.910105 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m17:27:41.160902 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m17:27:44.204684 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m17:27:44.239945 [debug] [Thread-1 (]: Skip partitioning: False
[0m17:27:45.415678 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m17:27:45.418577 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m17:27:46.008021 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 86429c5a-4290-4d2f-95ab-8e108f7b3ed0
[0m17:27:47.690541 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":33302,"data_scanned_in_bytes":218590}
[0m17:27:47.705845 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m17:27:47.706992 [debug] [Thread-1 (]: On model.silver.weather_data_gold: alter table `AwsDataCatalog`.`gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m17:27:47.964791 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2b09bf17-9bc7-490a-9990-1ae774d175db
[0m17:27:49.597543 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m17:27:49.601624 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m17:27:49.604070 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m17:27:49.604358 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":33302,"data_scanned_in_bytes":218590}';
[0m17:27:49.799661 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID db3b6ead-f823-4e28-b705-7bd6fa6e972e
[0m17:27:51.490914 [debug] [Thread-1 (]: SQL status: OK 33302 in 2.0 seconds
[0m17:27:51.509536 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 17:27:36.981017 => 17:27:51.508750
[0m17:27:51.510850 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m17:27:51.513874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70f4733e-2717-4e88-8446-96191e1c26c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92857610>]}
[0m17:27:51.516343 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 33302[0m in 14.57s]
[0m17:27:51.518115 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m17:27:51.530590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:51.531317 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m17:27:51.531712 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m17:27:51.535911 [info ] [MainThread]: 
[0m17:27:51.537149 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.83 seconds (21.83s).
[0m17:27:51.539279 [debug] [MainThread]: Command end result
[0m17:27:51.565463 [info ] [MainThread]: 
[0m17:27:51.568056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:27:51.570841 [info ] [MainThread]: 
[0m17:27:51.574724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:27:51.581676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.386204, "process_user_time": 3.164336, "process_kernel_time": 0.440616, "process_mem_max_rss": "201328", "process_out_blocks": "2951", "process_in_blocks": "0"}
[0m17:27:51.582542 [debug] [MainThread]: Command `dbt run` succeeded at 17:27:51.582426 after 22.39 seconds
[0m17:27:51.583169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c834090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa10b9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa10b8c50>]}
[0m17:27:51.583490 [debug] [MainThread]: Flushing usage events
[0m18:15:05.503081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95da41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f01550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9441ccd0>]}


============================== 18:15:05.613184 | f61e9771-edfb-454c-a89a-c01aa843919f ==============================
[0m18:15:05.613184 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:15:05.613640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:15:06.479169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911aba30>]}
[0m18:15:06.511781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940c0250>]}
[0m18:15:06.512619 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m18:15:06.529949 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:15:06.606355 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:15:06.606807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9492d970>]}
[0m18:15:07.527438 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:15:07.528082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91bf5a00>]}
[0m18:15:07.725710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9152b7c0>]}
[0m18:15:07.814428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914939a0>]}
[0m18:15:07.814944 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m18:15:07.815313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914450a0>]}
[0m18:15:07.817489 [info ] [MainThread]: 
[0m18:15:07.817991 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m18:15:07.822635 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m18:15:07.823077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:08.591262 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m18:15:08.594068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:09.247126 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m18:15:09.248197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:10.020813 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m18:15:10.032176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m18:15:10.033461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:11.316266 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m18:15:11.319011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m18:15:11.321140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:13.016217 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m18:15:13.020279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m18:15:13.028127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:14.279523 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m18:15:14.285129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915e9a60>]}
[0m18:15:14.287082 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:14.288137 [info ] [MainThread]: 
[0m18:15:14.307081 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m18:15:14.308412 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m18:15:14.309797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.eia_bronze)
[0m18:15:14.310525 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m18:15:14.338067 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m18:15:14.354499 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m18:15:14.392550 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m18:15:14.393961 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m18:15:14.394275 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m18:15:14.394576 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:14.971283 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5b9f06ce-f242-482c-9191-5cdaa4c31551
[0m18:15:16.921380 [debug] [Thread-1  ]: SQL status: OK -1 in 2.526 seconds
[0m18:15:18.428898 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['3', '2', '1', '0']
[0m18:15:18.431428 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: []
[0m18:15:18.443341 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m18:15:18.445465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9504b100>]}
[0m18:15:18.446470 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 4.14s]
[0m18:15:18.447348 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m18:15:18.448063 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m18:15:18.448994 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m18:15:18.451554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m18:15:18.451937 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m18:15:18.455524 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m18:15:18.457276 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m18:15:18.459471 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m18:15:18.460189 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m18:15:18.460455 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m18:15:18.460706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:19.000704 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 38942b4b-2c30-4dad-b89f-6e065d266e53
[0m18:15:20.707332 [debug] [Thread-1  ]: SQL status: OK -1 in 2.246 seconds
[0m18:15:21.814958 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['14', '13', '12', '11', '10']
[0m18:15:21.816539 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['10']
[0m18:15:22.313304 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 10 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m18:15:22.317356 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m18:15:22.318237 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94986c70>]}
[0m18:15:22.319105 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.87s]
[0m18:15:22.320104 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m18:15:22.320661 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m18:15:22.321377 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m18:15:22.324385 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m18:15:22.325264 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m18:15:22.332312 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m18:15:22.333474 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m18:15:22.336328 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m18:15:22.337206 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m18:15:22.337501 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m18:15:22.337759 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:22.853978 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e78739b1-0e8d-455d-ab02-e1ace563ce19
[0m18:15:24.555124 [debug] [Thread-1  ]: SQL status: OK -1 in 2.215 seconds
[0m18:15:26.085951 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['14', '13', '12', '11', '10']
[0m18:15:26.090924 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['10']
[0m18:15:26.589765 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 10 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m18:15:26.599792 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m18:15:26.602053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9504b100>]}
[0m18:15:26.604170 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 4.28s]
[0m18:15:26.606065 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m18:15:26.607816 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m18:15:26.612474 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m18:15:26.616552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m18:15:26.617406 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m18:15:26.626253 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m18:15:26.628251 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m18:15:26.635342 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m18:15:26.636712 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m18:15:26.637037 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m18:15:26.637382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:27.139211 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 04a2dd3f-420c-4073-8339-350a9cac34c3
[0m18:15:28.877024 [debug] [Thread-1  ]: SQL status: OK -1 in 2.233 seconds
[0m18:15:30.033085 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['14', '13', '12', '11', '10']
[0m18:15:30.035499 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['10']
[0m18:15:30.562690 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 10 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m18:15:30.570532 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m18:15:30.572820 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f15ee0>]}
[0m18:15:30.575493 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.96s]
[0m18:15:30.577303 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m18:15:30.578719 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m18:15:30.581132 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m18:15:30.589576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m18:15:30.590185 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m18:15:30.596866 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m18:15:30.598388 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m18:15:30.601085 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m18:15:30.601820 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m18:15:30.602055 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m18:15:30.602331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:31.130219 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3c86c464-acbf-46f9-806b-927708116273
[0m18:15:33.046722 [debug] [Thread-1  ]: SQL status: OK -1 in 2.443 seconds
[0m18:15:34.178193 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['13', '12', '11', '10', '9']
[0m18:15:34.180214 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['9']
[0m18:15:34.662996 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 9 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m18:15:34.671064 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m18:15:34.673214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a544250>]}
[0m18:15:34.675441 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 4.09s]
[0m18:15:34.677461 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m18:15:34.678887 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m18:15:34.680651 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m18:15:34.686752 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m18:15:34.688181 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m18:15:34.696859 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m18:15:34.699019 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m18:15:34.735437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:35.887106 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m18:15:35.889142 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:15:35.892870 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m18:15:36.933580 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m18:15:36.934163 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:15:36.934602 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/9e5fefd9-47de-4ccb-bd56-225e9d79eb08
[0m18:15:37.494659 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/9e5fefd9-47de-4ccb-bd56-225e9d79eb08', bucket='climate-energy-raw-data', prefix='silver/eia_silver/9e5fefd9-47de-4ccb-bd56-225e9d79eb08/'
[0m18:15:39.376170 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m18:15:39.440891 [debug] [Thread-1  ]: Skip partitioning: False
[0m18:15:39.852624 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:15:39.856590 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/767b3990-0da0-4f0c-bec7-12f655f2d648',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m18:15:40.355095 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b87205c7-af33-4721-ac69-5361f6b7c732
[0m18:15:43.179360 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":20118,"data_scanned_in_bytes":113462}
[0m18:15:43.194053 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m18:15:43.195099 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m18:15:43.399022 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 2c4eba7c-2a22-4f79-866f-792cd883abae
[0m18:15:45.112715 [debug] [Thread-1  ]: SQL status: OK -1 in 1.916 seconds
[0m18:15:45.125685 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m18:15:45.132494 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m18:15:45.133767 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":20118,"data_scanned_in_bytes":113462}';
[0m18:15:45.344897 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID aafcbd29-1868-4efe-867a-29c8a3d6eab9
[0m18:15:47.096814 [debug] [Thread-1  ]: SQL status: OK 20118 in 1.960 seconds
[0m18:15:47.114767 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m18:15:47.117451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91825e80>]}
[0m18:15:47.120257 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 20118[0m in 12.43s]
[0m18:15:47.122580 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m18:15:47.124472 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m18:15:47.126233 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m18:15:47.133017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m18:15:47.133839 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m18:15:47.142885 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m18:15:47.146600 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m18:15:47.157582 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:15:48.702004 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m18:15:48.703747 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:15:48.705114 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m18:15:49.695919 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m18:15:49.697331 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:15:49.698342 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/0726270e-22e6-4078-bcf1-9a719d623980
[0m18:15:50.162497 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/0726270e-22e6-4078-bcf1-9a719d623980', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/0726270e-22e6-4078-bcf1-9a719d623980/'
[0m18:15:51.891052 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m18:15:51.896911 [debug] [Thread-1  ]: Skip partitioning: False
[0m18:15:52.334043 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:15:52.337079 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/6955c40d-f6ae-4533-81de-21f18076b04d',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m18:15:52.825232 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 0f6fff0a-65e2-40d8-b36d-0a603ad23962
[0m18:15:55.694801 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1595,"data_scanned_in_bytes":13556}
[0m18:15:55.721578 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m18:15:55.725067 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m18:15:55.934753 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d2a30bce-29cf-4075-8856-ef681f77bd3c
[0m18:15:57.574764 [debug] [Thread-1  ]: SQL status: OK -1 in 1.844 seconds
[0m18:15:57.580878 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m18:15:57.583406 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m18:15:57.583949 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":1595,"data_scanned_in_bytes":13556}';
[0m18:15:57.782336 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d8f39ac8-5be6-4600-ac32-15123af8d6fd
[0m18:15:59.514662 [debug] [Thread-1  ]: SQL status: OK 1595 in 1.929 seconds
[0m18:15:59.524317 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m18:15:59.527242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d972b0>]}
[0m18:15:59.529342 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 1595[0m in 12.40s]
[0m18:15:59.531877 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m18:15:59.533572 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m18:15:59.536298 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m18:15:59.544321 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m18:15:59.545078 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m18:15:59.556437 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m18:15:59.558550 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m18:15:59.562305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:00.778865 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m18:16:00.779829 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:16:00.780389 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m18:16:01.755190 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m18:16:01.756289 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:16:01.757063 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/acb191bb-b8d5-472b-bc64-bb59eb98a74d
[0m18:16:02.232976 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/acb191bb-b8d5-472b-bc64-bb59eb98a74d', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/acb191bb-b8d5-472b-bc64-bb59eb98a74d/'
[0m18:16:04.019540 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m18:16:04.026932 [debug] [Thread-1  ]: Skip partitioning: False
[0m18:16:04.490698 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:16:04.494832 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/2e103a53-3bfa-46b4-ba9f-9ab1eddf1e5a',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m18:16:04.990493 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b9e1150a-12d6-4f1d-ac37-8910c9ed8222
[0m18:16:07.785208 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":34174,"data_scanned_in_bytes":317370}
[0m18:16:07.789644 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m18:16:07.790124 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m18:16:07.998593 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f34bbd85-52a8-4b97-9854-f944513f6c32
[0m18:16:09.648801 [debug] [Thread-1  ]: SQL status: OK -1 in 1.858 seconds
[0m18:16:09.654489 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m18:16:09.656970 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m18:16:09.657389 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":34174,"data_scanned_in_bytes":317370}';
[0m18:16:09.854188 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 07fef57d-a000-44e7-a63f-082da270d068
[0m18:16:11.608187 [debug] [Thread-1  ]: SQL status: OK 34174 in 1.949 seconds
[0m18:16:11.626829 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m18:16:11.632127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b71e20>]}
[0m18:16:11.636012 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 34174[0m in 12.09s]
[0m18:16:11.638104 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m18:16:11.639638 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m18:16:11.641720 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m18:16:11.650648 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m18:16:11.651366 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m18:16:11.662145 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m18:16:11.663648 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m18:16:11.667871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:12.762572 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m18:16:12.763570 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:16:12.764633 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m18:16:13.750678 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m18:16:13.758982 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:16:13.760397 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/db2dfe0c-2c03-4336-88af-ffe1e3877287
[0m18:16:14.686967 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/db2dfe0c-2c03-4336-88af-ffe1e3877287', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/db2dfe0c-2c03-4336-88af-ffe1e3877287/'
[0m18:16:16.751393 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m18:16:16.763387 [debug] [Thread-1  ]: Skip partitioning: False
[0m18:16:17.200820 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:16:17.202234 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/69a96d26-b1a8-4fbc-b223-476ba4c2ce41',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m18:16:17.677006 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 82bb808a-0a08-4597-95a4-81dd75adb0e0
[0m18:16:19.325395 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2322,"data_scanned_in_bytes":32785}
[0m18:16:19.330316 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m18:16:19.330820 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m18:16:19.528397 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 561d547d-a568-4d20-bee7-ffe6380c36f3
[0m18:16:21.178943 [debug] [Thread-1  ]: SQL status: OK -1 in 1.846 seconds
[0m18:16:21.191368 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m18:16:21.193498 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m18:16:21.193906 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":2322,"data_scanned_in_bytes":32785}';
[0m18:16:21.395890 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6c8012cc-d12d-4da1-82c3-5c3c60533744
[0m18:16:23.609832 [debug] [Thread-1  ]: SQL status: OK 2322 in 2.415 seconds
[0m18:16:23.615668 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m18:16:23.617659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b71dc0>]}
[0m18:16:23.619398 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 2322[0m in 11.97s]
[0m18:16:23.623307 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m18:16:23.627227 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m18:16:23.631524 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m18:16:23.637254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m18:16:23.637892 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m18:16:23.646775 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m18:16:23.648298 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m18:16:23.652816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:24.768477 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m18:16:24.773119 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:16:24.776205 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m18:16:25.789286 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m18:16:25.790230 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:16:25.790679 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/6a236b96-e83c-4e90-9d57-a3414177e918
[0m18:16:26.312172 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/6a236b96-e83c-4e90-9d57-a3414177e918', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/6a236b96-e83c-4e90-9d57-a3414177e918/'
[0m18:16:28.209879 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m18:16:28.216300 [debug] [Thread-1  ]: Skip partitioning: False
[0m18:16:28.687475 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:16:28.689151 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/1f2d6190-71b0-45c6-894a-d3b5965ed1b1',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m18:16:29.194432 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 6c8ef86c-c986-489b-bff9-3c8d2d0430cd
[0m18:16:31.995058 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2479,"data_scanned_in_bytes":62551}
[0m18:16:32.000731 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m18:16:32.001482 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m18:16:32.198844 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3160b10c-aacf-4b97-b794-b9f058774b52
[0m18:16:33.857406 [debug] [Thread-1  ]: SQL status: OK -1 in 1.855 seconds
[0m18:16:33.863431 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m18:16:33.869393 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m18:16:33.869895 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2479,"data_scanned_in_bytes":62551}';
[0m18:16:34.087052 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7c30edeb-e4c7-4ced-ac81-5acd5780f97d
[0m18:16:36.057339 [debug] [Thread-1  ]: SQL status: OK 2479 in 2.186 seconds
[0m18:16:36.064122 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m18:16:36.065647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9119b7f0>]}
[0m18:16:36.067281 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 2479[0m in 12.43s]
[0m18:16:36.068793 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m18:16:36.070017 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m18:16:36.071425 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m18:16:36.076635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m18:16:36.077357 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m18:16:36.084413 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m18:16:36.086829 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m18:16:36.090899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:16:37.254077 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m18:16:37.262027 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:16:37.295887 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m18:16:38.310919 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m18:16:38.312404 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:16:38.313517 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m18:16:38.796261 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m18:16:40.807727 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m18:16:40.822761 [debug] [Thread-1  ]: Skip partitioning: False
[0m18:16:41.293602 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:16:41.296008 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m18:16:41.761366 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 17561d3d-2637-410e-abb2-024a659541c3
[0m18:16:43.459749 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":36496,"data_scanned_in_bytes":230856}
[0m18:16:43.463745 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m18:16:43.465137 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m18:16:43.667379 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fbf7ea93-d122-40f5-ae12-6f5b00289d54
[0m18:16:45.400634 [debug] [Thread-1  ]: SQL status: OK -1 in 1.929 seconds
[0m18:16:45.412509 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m18:16:45.419177 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m18:16:45.419575 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":36496,"data_scanned_in_bytes":230856}';
[0m18:16:45.632949 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 80668172-02a6-4b87-be9d-4ee563e07395
[0m18:16:47.363782 [debug] [Thread-1  ]: SQL status: OK 36496 in 1.941 seconds
[0m18:16:47.374869 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m18:16:47.377214 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e9771-edfb-454c-a89a-c01aa843919f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913f35e0>]}
[0m18:16:47.379228 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 36496[0m in 11.30s]
[0m18:16:47.383452 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m18:16:47.394146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:47.395712 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m18:16:47.409208 [info ] [MainThread]: 
[0m18:16:47.409886 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 39.59 seconds (99.59s).
[0m18:16:47.417853 [debug] [MainThread]: Command end result
[0m18:16:47.484914 [info ] [MainThread]: 
[0m18:16:47.485339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:47.485597 [info ] [MainThread]: 
[0m18:16:47.486262 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m18:16:47.489642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 102.03492, "process_user_time": 13.514558, "process_kernel_time": 2.689896, "process_mem_max_rss": "193076", "process_in_blocks": "57568", "process_out_blocks": "9633"}
[0m18:16:47.490541 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:47.490472 after 102.04 seconds
[0m18:16:47.491038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95da41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9492da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940c0250>]}
[0m18:16:47.491275 [debug] [MainThread]: Flushing usage events
[0m18:17:06.084906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e22220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9895e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982c6a00>]}


============================== 18:17:06.089565 | 74b6199a-7fde-406c-8934-b13ea7fb4ccb ==============================
[0m18:17:06.089565 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:17:06.090005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:17:06.508773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74b6199a-7fde-406c-8934-b13ea7fb4ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957de100>]}
[0m18:17:06.542361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74b6199a-7fde-406c-8934-b13ea7fb4ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a533280>]}
[0m18:17:06.543152 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m18:17:06.558848 [debug] [MainThread]: checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, vars: {}, profile: gold, target: , version: 1.8.7
[0m18:17:06.635099 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:17:06.635557 [debug] [MainThread]: previous checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m18:17:06.635799 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:17:06.636084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '74b6199a-7fde-406c-8934-b13ea7fb4ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98eed1c0>]}
[0m18:17:07.454108 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:17:07.454565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '74b6199a-7fde-406c-8934-b13ea7fb4ccb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96159820>]}
[0m18:17:07.650170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74b6199a-7fde-406c-8934-b13ea7fb4ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b32910>]}
[0m18:17:07.742358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74b6199a-7fde-406c-8934-b13ea7fb4ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a45430>]}
[0m18:17:07.743600 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m18:17:07.744079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b6199a-7fde-406c-8934-b13ea7fb4ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a964f0>]}
[0m18:17:07.746564 [info ] [MainThread]: 
[0m18:17:07.747170 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m18:17:07.748114 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m18:17:07.748403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:08.318276 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m18:17:08.329324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m18:17:08.329958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:09.698305 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m18:17:09.701716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m18:17:09.709342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:10.740300 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m18:17:10.741395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m18:17:10.741969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:11.803766 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m18:17:11.808168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74b6199a-7fde-406c-8934-b13ea7fb4ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff947f6f10>]}
[0m18:17:11.812284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:11.820293 [info ] [MainThread]: 
[0m18:17:11.861534 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m18:17:11.863116 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m18:17:11.864423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.weather_data_gold)
[0m18:17:11.865133 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m18:17:11.884009 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m18:17:11.885762 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m18:17:11.921297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:17:13.212619 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m18:17:13.213422 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:17:13.215703 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m18:17:14.206083 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m18:17:14.207013 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m18:17:14.207504 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m18:17:14.785463 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m18:17:16.863413 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m18:17:16.905668 [debug] [Thread-1  ]: Skip partitioning: False
[0m18:17:17.316121 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m18:17:17.318891 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m18:17:17.829722 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 7efa3d13-0abb-411b-97a8-652d82bcd412
[0m18:17:20.692799 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":36496,"data_scanned_in_bytes":230856}
[0m18:17:20.717138 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m18:17:20.718105 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m18:17:20.921995 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 161bbfb4-5ee1-4c3e-afad-13d5619fc1ee
[0m18:17:22.579446 [debug] [Thread-1  ]: SQL status: OK -1 in 1.860 seconds
[0m18:17:22.589591 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m18:17:22.593523 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m18:17:22.594239 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":36496,"data_scanned_in_bytes":230856}';
[0m18:17:22.800541 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 5731b092-2c99-4705-92ad-03436b180a62
[0m18:17:24.547237 [debug] [Thread-1  ]: SQL status: OK 36496 in 1.950 seconds
[0m18:17:24.577269 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m18:17:24.580398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74b6199a-7fde-406c-8934-b13ea7fb4ccb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a579af0>]}
[0m18:17:24.581966 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 36496[0m in 12.71s]
[0m18:17:24.583424 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m18:17:24.587994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:24.588935 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m18:17:24.592449 [info ] [MainThread]: 
[0m18:17:24.593201 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.85 seconds (16.85s).
[0m18:17:24.594503 [debug] [MainThread]: Command end result
[0m18:17:24.633329 [info ] [MainThread]: 
[0m18:17:24.633862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:24.634152 [info ] [MainThread]: 
[0m18:17:24.634550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:17:24.637012 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.58314, "process_user_time": 4.264978, "process_kernel_time": 0.62036, "process_mem_max_rss": "179616", "process_in_blocks": "23208", "process_out_blocks": "3109"}
[0m18:17:24.637998 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:24.637878 after 18.58 seconds
[0m18:17:24.638437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e22220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ef0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f00610>]}
[0m18:17:24.638676 [debug] [MainThread]: Flushing usage events
[0m05:19:27.540541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b621c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98272d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9670bf40>]}


============================== 05:19:27.548574 | f77e3a43-6c80-4ec4-ae74-9b069e3aaf9c ==============================
[0m05:19:27.548574 [info ] [MainThread]: Running with dbt=1.8.7
[0m05:19:27.549579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:19:31.327176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f77e3a43-6c80-4ec4-ae74-9b069e3aaf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9784b460>]}
[0m05:19:31.424326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f77e3a43-6c80-4ec4-ae74-9b069e3aaf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934b6f10>]}
[0m05:19:31.426177 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m05:19:31.472857 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m05:19:31.575921 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m05:19:31.576537 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2
[0m05:19:31.576879 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:19:31.577135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f77e3a43-6c80-4ec4-ae74-9b069e3aaf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c2d0a0>]}
[0m05:19:32.818617 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:19:32.819789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f77e3a43-6c80-4ec4-ae74-9b069e3aaf9c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93dd4b50>]}
[0m05:19:33.919499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f77e3a43-6c80-4ec4-ae74-9b069e3aaf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a81820>]}
[0m05:19:34.402103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f77e3a43-6c80-4ec4-ae74-9b069e3aaf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93742400>]}
[0m05:19:34.404250 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m05:19:34.407699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f77e3a43-6c80-4ec4-ae74-9b069e3aaf9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937d4460>]}
[0m05:19:34.433466 [info ] [MainThread]: 
[0m05:19:34.441124 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m05:19:34.479612 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m05:19:34.483212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:19:35.621834 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m05:19:35.632384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:19:36.455353 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m05:19:36.458636 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:19:37.189509 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m05:19:37.207311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:19:37.208847 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m05:19:37.210660 [info ] [MainThread]: 
[0m05:19:37.214596 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m05:19:37.222675 [error] [MainThread]: Encountered an error:
An error occurred (InvalidSignatureException) when calling the GetDatabases operation: Signature expired: 20260130T051935Z is now earlier than 20260130T062115Z (20260130T062615Z - 5 min.)
[0m05:19:37.243992 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1009, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (InvalidSignatureException) when calling the GetDatabases operation: Signature expired: 20260130T051935Z is now earlier than 20260130T062115Z (20260130T062615Z - 5 min.)

[0m05:19:37.249111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.746601, "process_user_time": 7.988558, "process_kernel_time": 2.50406, "process_mem_max_rss": "178220", "process_in_blocks": "336", "process_out_blocks": "2082", "command_success": false}
[0m05:19:37.251395 [debug] [MainThread]: Command `dbt run` failed at 05:19:37.251112 after 9.75 seconds
[0m05:19:37.252886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97b621c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937b8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937428e0>]}
[0m05:19:37.254004 [debug] [MainThread]: Flushing usage events
[0m06:58:33.211477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb275d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c015b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2e42bb0>]}


============================== 06:58:33.227484 | 0460c591-04a1-42aa-b8fe-8d65c3e8c7e6 ==============================
[0m06:58:33.227484 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:58:33.230371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:58:38.578132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0460c591-04a1-42aa-b8fe-8d65c3e8c7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae15eb50>]}
[0m06:58:38.988890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0460c591-04a1-42aa-b8fe-8d65c3e8c7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1846550>]}
[0m06:58:39.008853 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m06:58:39.297493 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:58:40.399559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:58:40.407945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:58:40.630200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0460c591-04a1-42aa-b8fe-8d65c3e8c7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae862910>]}
[0m06:58:41.123124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0460c591-04a1-42aa-b8fe-8d65c3e8c7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7aa8e0>]}
[0m06:58:41.125340 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m06:58:41.128805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0460c591-04a1-42aa-b8fe-8d65c3e8c7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7dc5b0>]}
[0m06:58:41.152683 [info ] [MainThread]: 
[0m06:58:41.156736 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m06:58:41.181517 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m06:58:41.184587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:42.842014 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m06:58:42.874247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:58:50.450615 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m06:58:50.480534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:58:51.730726 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m06:58:51.771467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:58:51.777716 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m06:58:51.802606 [info ] [MainThread]: 
[0m06:58:51.813622 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 10.63 seconds (10.63s).
[0m06:58:51.861838 [error] [MainThread]: Encountered an error:
An error occurred (InvalidSignatureException) when calling the GetDatabases operation: Signature expired: 20260130T065842Z is now earlier than 20260130T071437Z (20260130T071937Z - 5 min.)
[0m06:58:51.893079 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1009, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (InvalidSignatureException) when calling the GetDatabases operation: Signature expired: 20260130T065842Z is now earlier than 20260130T071437Z (20260130T071937Z - 5 min.)

[0m06:58:51.903341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 18.79178, "process_user_time": 13.694657, "process_kernel_time": 3.797016, "process_mem_max_rss": "172832", "process_out_blocks": "1073", "command_success": false, "process_in_blocks": "0"}
[0m06:58:51.908112 [debug] [MainThread]: Command `dbt run` failed at 06:58:51.906893 after 18.80 seconds
[0m06:58:51.921324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb275d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7dc970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae83d8b0>]}
[0m06:58:51.923761 [debug] [MainThread]: Flushing usage events
[0m07:37:26.538201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94562340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a06580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c42bb0>]}


============================== 07:37:26.553348 | 8acff130-e84b-4610-bc16-358226bfb1b2 ==============================
[0m07:37:26.553348 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:37:26.554338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbt/logs', 'profiles_dir': '/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:37:27.507354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8acff130-e84b-4610-bc16-358226bfb1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff2cb50>]}
[0m07:37:27.566589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8acff130-e84b-4610-bc16-358226bfb1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93635550>]}
[0m07:37:27.567812 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m07:37:27.616004 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:37:27.808415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:27.809097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:27.867153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8acff130-e84b-4610-bc16-358226bfb1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90687f40>]}
[0m07:37:28.094731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8acff130-e84b-4610-bc16-358226bfb1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905a88e0>]}
[0m07:37:28.096404 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m07:37:28.097036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8acff130-e84b-4610-bc16-358226bfb1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905db2e0>]}
[0m07:37:28.101876 [info ] [MainThread]: 
[0m07:37:28.107942 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m07:37:28.125927 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m07:37:28.127967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:28.701306 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m07:37:28.702728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:29.306677 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m07:37:29.309721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:33.611710 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m08:38:33.625392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:33.626167 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m08:38:33.629024 [info ] [MainThread]: 
[0m08:38:33.631572 [info ] [MainThread]: Finished running  in 1 hours 1 minutes and 5.52 seconds (3665.52s).
[0m08:38:33.644686 [error] [MainThread]: Encountered an error:
An error occurred (InvalidSignatureException) when calling the GetDatabases operation: Signature expired: 20260130T073728Z is now earlier than 20260130T080425Z (20260130T080925Z - 5 min.)
[0m08:38:33.655863 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1009, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (InvalidSignatureException) when calling the GetDatabases operation: Signature expired: 20260130T073728Z is now earlier than 20260130T080425Z (20260130T080925Z - 5 min.)

[0m08:38:33.666802 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 58.882072, "process_user_time": 4.466098, "process_kernel_time": 1.14753, "process_mem_max_rss": "173236", "process_out_blocks": "1073", "command_success": false, "process_in_blocks": "0"}
[0m08:38:33.668905 [debug] [MainThread]: Command `dbt run` failed at 08:38:33.668635 after 58.89 seconds
[0m08:38:33.669928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94562340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90642670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9ec970>]}
[0m08:38:33.671175 [debug] [MainThread]: Flushing usage events
[0m10:22:56.764778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1221c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e872d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cccbf40>]}


============================== 10:22:56.785137 | 6f4684fc-cf79-4d57-9ea0-65b496bf40e8 ==============================
[0m10:22:56.785137 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:22:56.788883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:59.383184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f4684fc-cf79-4d57-9ea0-65b496bf40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd9f460>]}
[0m10:22:59.454196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f4684fc-cf79-4d57-9ea0-65b496bf40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a76f10>]}
[0m10:22:59.455810 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m10:22:59.495830 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:22:59.753158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:22:59.753706 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:22:59.818596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f4684fc-cf79-4d57-9ea0-65b496bf40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a221910>]}
[0m10:23:00.036315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f4684fc-cf79-4d57-9ea0-65b496bf40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a16a910>]}
[0m10:23:00.037648 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m10:23:00.038629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4684fc-cf79-4d57-9ea0-65b496bf40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a19b340>]}
[0m10:23:00.046642 [info ] [MainThread]: 
[0m10:23:00.049403 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m10:23:00.067088 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m10:23:00.068336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:00.869250 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m10:23:00.872204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:01.552329 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m10:23:01.553646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:02.109629 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m10:23:02.115837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m10:23:02.116738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:03.380820 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m10:23:03.388646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m10:23:03.394194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:05.023962 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m10:23:05.027355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m10:23:05.032074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:06.194346 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m10:23:06.196410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f4684fc-cf79-4d57-9ea0-65b496bf40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afb00d0>]}
[0m10:23:06.197718 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:23:06.198328 [info ] [MainThread]: 
[0m10:23:06.212407 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m10:23:06.213283 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m10:23:06.213926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.eia_bronze)
[0m10:23:06.214306 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m10:23:06.228806 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m10:23:06.232624 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m10:23:06.259734 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m10:23:06.261004 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m10:23:06.261400 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m10:23:06.261721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:06.860849 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 145063de-ac4f-438c-9626-a34af8293926
[0m10:23:08.720836 [debug] [Thread-1  ]: SQL status: OK -1 in 2.459 seconds
[0m10:23:09.748758 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['4', '3', '2', '1', '0']
[0m10:23:09.751249 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['0']
[0m10:23:10.232010 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 0 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m10:23:10.239814 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m10:23:10.241711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f4684fc-cf79-4d57-9ea0-65b496bf40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afb00d0>]}
[0m10:23:10.242388 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 4.03s]
[0m10:23:10.243065 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m10:23:10.243553 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m10:23:10.244215 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m10:23:10.245962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m10:23:10.246250 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m10:23:10.249128 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m10:23:10.250038 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m10:23:10.252016 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m10:23:10.252813 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m10:23:10.253045 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m10:23:10.253276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:10.762604 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ffaadf24-c821-48c4-b41c-397da31a64d7
[0m10:23:12.454598 [debug] [Thread-1  ]: SQL status: OK -1 in 2.201 seconds
[0m10:23:13.767398 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['15', '14', '13', '12', '11']
[0m10:23:13.775069 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['11']
[0m10:23:14.292488 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 11 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m10:23:14.302315 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m10:23:14.304402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f4684fc-cf79-4d57-9ea0-65b496bf40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a575b0>]}
[0m10:23:14.306102 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 4.06s]
[0m10:23:14.307353 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m10:23:14.308610 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m10:23:14.310165 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m10:23:14.317190 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m10:23:14.317928 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m10:23:14.329961 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m10:23:14.333021 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m10:23:14.343670 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m10:23:14.345724 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m10:23:14.347558 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m10:23:14.348210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:14.874753 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 75fdc637-b364-4fe9-ac51-09c1f43415cc
[0m10:23:16.747112 [debug] [Thread-1  ]: SQL status: OK -1 in 2.398 seconds
[0m10:23:17.829881 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['15', '14', '13', '12', '11']
[0m10:23:17.831287 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['11']
[0m10:23:18.294277 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 11 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m10:23:18.300812 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m10:23:18.302467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f4684fc-cf79-4d57-9ea0-65b496bf40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89a57e50>]}
[0m10:23:18.303983 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 3.99s]
[0m10:23:18.305897 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m10:23:18.307290 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m10:23:18.310267 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m10:23:18.316482 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m10:23:18.317245 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m10:23:18.325887 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m10:23:18.328288 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m10:23:18.331556 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m10:23:18.332857 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m10:23:18.333195 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m10:23:18.333443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:23:18.871514 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 715d4e47-e0e2-4f2c-bc94-a93f0997aa15
[0m11:02:45.354058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1221c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c586160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c586b50>]}


============================== 11:02:45.361269 | 444a3ccd-c4bd-4981-b69f-b62eff9c87b9 ==============================
[0m11:02:45.361269 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:02:45.361771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:02:45.758042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '444a3ccd-c4bd-4981-b69f-b62eff9c87b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b08f9a0>]}
[0m11:02:45.818720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '444a3ccd-c4bd-4981-b69f-b62eff9c87b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c59ad60>]}
[0m11:02:45.819415 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:02:45.833393 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:02:45.936200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:45.936558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:45.967875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '444a3ccd-c4bd-4981-b69f-b62eff9c87b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a222970>]}
[0m11:02:46.050176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '444a3ccd-c4bd-4981-b69f-b62eff9c87b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a169940>]}
[0m11:02:46.050676 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m11:02:46.050950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '444a3ccd-c4bd-4981-b69f-b62eff9c87b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a19a610>]}
[0m11:02:46.052460 [info ] [MainThread]: 
[0m11:02:46.053048 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:02:46.060436 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:02:46.060879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:48.381319 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:02:48.388580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:49.099773 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:02:49.101413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:49.563720 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:02:49.566653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:49.567099 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m11:02:49.567772 [info ] [MainThread]: 
[0m11:02:49.568714 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m11:02:49.576319 [error] [MainThread]: Encountered an error:
An error occurred (InvalidSignatureException) when calling the GetDatabases operation: Signature expired: 20260130T110246Z is now earlier than 20260130T111427Z (20260130T111927Z - 5 min.)
[0m11:02:49.580910 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 627, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/local/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt_common/utils/executor.py", line 16, in connected
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 602, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/adapters/athena/impl.py", line 1090, in list_schemas
    for page in paginator.paginate():
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 269, in __iter__
    response = self._make_request(current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/paginate.py", line 357, in _make_request
    return self._method(**current_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 553, in _api_call
    return self._make_api_call(operation_name, kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/botocore/client.py", line 1009, in _make_api_call
    raise error_class(parsed_response, operation_name)
botocore.exceptions.ClientError: An error occurred (InvalidSignatureException) when calling the GetDatabases operation: Signature expired: 20260130T110246Z is now earlier than 20260130T111427Z (20260130T111927Z - 5 min.)

[0m11:02:49.583140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.262741, "process_user_time": 2.0902, "process_kernel_time": 0.458236, "process_mem_max_rss": "173372", "process_out_blocks": "1073", "command_success": false, "process_in_blocks": "0"}
[0m11:02:49.583949 [debug] [MainThread]: Command `dbt run` failed at 11:02:49.583784 after 4.26 seconds
[0m11:02:49.584490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1221c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a19a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a1dc580>]}
[0m11:02:49.584926 [debug] [MainThread]: Flushing usage events
[0m11:24:06.030766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8849d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869465b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86946280>]}


============================== 11:24:06.043655 | 4764c5f8-e5da-4ff4-a665-970e36a4846f ==============================
[0m11:24:06.043655 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:24:06.044871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:24:09.253293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e9c3d0>]}
[0m11:24:09.325958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bf3250>]}
[0m11:24:09.327948 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:24:09.398624 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:24:09.625508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:09.626304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:09.754427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845f18e0>]}
[0m11:24:09.935238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff844e88e0>]}
[0m11:24:09.936310 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m11:24:09.936850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8451c5e0>]}
[0m11:24:09.940835 [info ] [MainThread]: 
[0m11:24:09.942261 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:24:09.953464 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:24:09.954262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:10.753854 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:24:10.755710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:11.613653 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:24:11.616856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:12.395168 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:24:12.406300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m11:24:12.407677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:13.727304 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m11:24:13.745028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m11:24:13.748238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:15.217969 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:24:15.223134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m11:24:15.225680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:16.340180 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m11:24:16.349521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84507ee0>]}
[0m11:24:16.358332 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:24:16.361446 [info ] [MainThread]: 
[0m11:24:16.392116 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m11:24:16.395520 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m11:24:16.398833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.eia_bronze)
[0m11:24:16.400749 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m11:24:16.465984 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m11:24:16.469718 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m11:24:16.521746 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m11:24:16.524019 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m11:24:16.524582 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m11:24:16.525018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:24:17.201722 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c1376849-03a3-4bfa-b79f-a99ca27394eb
[0m11:24:19.044421 [debug] [Thread-1  ]: SQL status: OK -1 in 2.519 seconds
[0m11:24:20.050888 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['5', '4', '3', '2', '1']
[0m11:24:20.052726 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['1']
[0m11:24:20.497432 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 1 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m11:24:20.522035 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m11:24:20.525200 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84507ee0>]}
[0m11:24:20.526777 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 4.13s]
[0m11:24:20.528943 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m11:24:20.530622 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m11:24:20.531838 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m11:24:20.534693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m11:24:20.535339 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m11:24:20.541492 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m11:24:20.543041 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m11:24:20.546612 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m11:24:20.547846 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m11:24:20.548317 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m11:24:20.548706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:26.710268 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 30b6ffcb-6c4b-4075-a2a8-cff2b72095cb
[0m11:27:28.645617 [debug] [Thread-1  ]: SQL status: OK -1 in 7.971 seconds
[0m11:27:31.529643 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['16', '15', '14', '13', '12']
[0m11:27:31.534081 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['12']
[0m11:27:32.034699 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 12 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m11:27:32.109494 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m11:27:32.125653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e3c2e0>]}
[0m11:27:32.140749 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 191.58s]
[0m11:27:32.148549 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m11:27:32.149617 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m11:27:32.150618 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m11:27:32.169341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m11:27:32.173709 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m11:27:32.205150 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m11:27:32.214023 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m11:27:32.232692 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m11:27:32.238587 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m11:27:32.239517 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m11:27:32.240399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:33.012429 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID de7cbb5a-d95c-4a8f-97de-af094c2a338f
[0m11:27:35.502847 [debug] [Thread-1  ]: SQL status: OK -1 in 3.261 seconds
[0m11:27:36.839869 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['16', '15', '14', '13', '12']
[0m11:27:36.856469 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['12']
[0m11:27:37.426975 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 12 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m11:27:37.450333 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m11:27:37.458410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e00520>]}
[0m11:27:37.462171 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 5.30s]
[0m11:27:37.468888 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m11:27:37.472569 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m11:27:37.475338 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m11:27:37.481565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m11:27:37.484220 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m11:27:37.509250 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m11:27:37.512335 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m11:27:37.525383 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m11:27:37.528765 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m11:27:37.529769 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m11:27:37.530171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:38.156159 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 311b8da0-cb65-42a8-b522-3602126a15e3
[0m11:27:40.173884 [debug] [Thread-1  ]: SQL status: OK -1 in 2.642 seconds
[0m11:27:41.299381 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['16', '15', '14', '13', '12', '11']
[0m11:27:41.302484 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['12', '11']
[0m11:27:41.749086 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 12 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m11:27:41.946666 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 11 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m11:27:41.956234 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m11:27:41.959107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bb1970>]}
[0m11:27:41.961255 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 4.48s]
[0m11:27:41.965085 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m11:27:41.966532 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m11:27:41.968370 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m11:27:41.973713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m11:27:41.976002 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m11:27:41.986814 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m11:27:41.988942 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m11:27:41.993029 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m11:27:41.994404 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m11:27:41.994821 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m11:27:41.995214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:42.523055 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4ce855ef-1655-4e0d-91ae-31e447f3d476
[0m11:27:45.210422 [debug] [Thread-1  ]: SQL status: OK -1 in 3.214 seconds
[0m11:27:46.398283 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['14', '13', '12', '11', '10']
[0m11:27:46.402078 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['10']
[0m11:27:46.861682 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 10 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m11:27:46.874701 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m11:27:46.877142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ccdd30>]}
[0m11:27:46.882102 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 4.91s]
[0m11:27:46.885684 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m11:27:46.887233 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m11:27:46.888639 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m11:27:46.893277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m11:27:46.896803 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m11:27:46.912303 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m11:27:46.913602 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m11:27:46.956054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:27:48.031882 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:27:48.033290 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:48.040392 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:27:49.028095 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:27:49.029583 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:27:49.030379 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/767b3990-0da0-4f0c-bec7-12f655f2d648
[0m11:27:49.579858 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/767b3990-0da0-4f0c-bec7-12f655f2d648', bucket='climate-energy-raw-data', prefix='silver/eia_silver/767b3990-0da0-4f0c-bec7-12f655f2d648/'
[0m11:27:51.366633 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m11:27:51.402545 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:27:51.830769 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:27:51.832854 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/d9c9a6e3-cbe2-47b3-9cfb-5f9d2a430798',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m11:27:52.306775 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 096b2cef-be3d-4dd5-82b8-ef4ecfd29801
[0m11:27:55.139902 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":20118,"data_scanned_in_bytes":113462}
[0m11:27:55.158571 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:27:55.159302 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m11:27:55.377648 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 075321f8-6b1b-42ef-96c5-305265804fb5
[0m11:27:57.188810 [debug] [Thread-1  ]: SQL status: OK -1 in 2.029 seconds
[0m11:27:57.191637 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m11:27:57.193754 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:27:57.194212 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":20118,"data_scanned_in_bytes":113462}';
[0m11:27:57.380109 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 04efd8fb-9784-47ac-ac1d-1eec11a36db0
[0m11:27:59.099007 [debug] [Thread-1  ]: SQL status: OK 20118 in 1.904 seconds
[0m11:27:59.106060 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m11:27:59.108999 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847df790>]}
[0m11:27:59.112257 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 20118[0m in 12.22s]
[0m11:27:59.114497 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m11:27:59.115764 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m11:27:59.116900 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m11:27:59.120465 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m11:27:59.120939 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m11:27:59.133168 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m11:27:59.137154 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m11:27:59.157580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:28:00.382944 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:28:00.384176 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:28:00.385056 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:28:01.429628 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:28:01.431483 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:28:01.432072 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/6955c40d-f6ae-4533-81de-21f18076b04d
[0m11:28:02.015209 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/6955c40d-f6ae-4533-81de-21f18076b04d', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/6955c40d-f6ae-4533-81de-21f18076b04d/'
[0m11:28:03.865046 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m11:28:03.880197 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:28:04.312608 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:28:04.316238 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/55089096-171d-41ef-b025-cf52d50857b8',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m11:28:04.808649 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3a4e9ed2-a597-48c5-b01f-ee637b51925d
[0m11:28:07.643762 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1595,"data_scanned_in_bytes":13556}
[0m11:28:07.659564 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:28:07.660363 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m11:28:07.861837 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 66331db0-ec14-4df8-9ccc-6ac4b360b4a4
[0m11:28:09.469961 [debug] [Thread-1  ]: SQL status: OK -1 in 1.809 seconds
[0m11:28:09.480346 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m11:28:09.485605 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:28:09.486695 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":1595,"data_scanned_in_bytes":13556}';
[0m11:28:09.681172 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 640302f6-e690-49b7-aa04-15f3b6bdc17f
[0m11:28:11.383702 [debug] [Thread-1  ]: SQL status: OK 1595 in 1.896 seconds
[0m11:28:11.400057 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m11:28:11.402708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845a8b80>]}
[0m11:28:11.405151 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 1595[0m in 12.28s]
[0m11:28:11.407429 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m11:28:11.410967 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m11:28:11.414613 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m11:28:11.422435 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m11:28:11.423762 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m11:28:11.438043 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m11:28:11.439758 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m11:28:11.444185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:28:12.741711 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:28:12.742371 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:28:12.742830 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:28:13.714382 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:28:13.715474 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:28:13.716392 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/2e103a53-3bfa-46b4-ba9f-9ab1eddf1e5a
[0m11:28:14.281524 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/2e103a53-3bfa-46b4-ba9f-9ab1eddf1e5a', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/2e103a53-3bfa-46b4-ba9f-9ab1eddf1e5a/'
[0m11:28:16.292561 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m11:28:16.302367 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:28:16.723573 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:28:16.729160 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/325f481a-c6c4-4f0a-a897-b5b5f0f831c9',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m11:28:17.207383 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a9618543-441d-44fd-b08e-3b59083e8923
[0m11:28:20.011248 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":34174,"data_scanned_in_bytes":317370}
[0m11:28:20.014796 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:28:20.015237 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m11:28:20.218471 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c7e57885-4b6c-4470-bd25-d3e97a03708a
[0m11:28:21.881473 [debug] [Thread-1  ]: SQL status: OK -1 in 1.864 seconds
[0m11:28:21.890321 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m11:28:21.893885 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:28:21.894611 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":34174,"data_scanned_in_bytes":317370}';
[0m11:28:22.084151 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 831cfa58-4cb9-4794-81ab-fadffe356224
[0m11:28:23.790171 [debug] [Thread-1  ]: SQL status: OK 34174 in 1.889 seconds
[0m11:28:23.807618 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m11:28:23.810598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e22250>]}
[0m11:28:23.813702 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 34174[0m in 12.39s]
[0m11:28:23.816360 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m11:28:23.819309 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m11:28:23.826028 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m11:28:23.832802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m11:28:23.833550 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m11:28:23.845653 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m11:28:23.847354 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m11:28:23.856657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:28:24.939407 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:28:24.940155 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:28:24.940864 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:28:26.365124 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:28:26.368386 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:28:26.373097 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/69a96d26-b1a8-4fbc-b223-476ba4c2ce41
[0m11:28:26.873627 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/69a96d26-b1a8-4fbc-b223-476ba4c2ce41', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/69a96d26-b1a8-4fbc-b223-476ba4c2ce41/'
[0m11:28:28.724176 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m11:28:28.730527 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:28:29.166303 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:28:29.171736 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/743caf7c-987c-4190-adda-0fbc7324e5e5',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m11:28:29.658517 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 66f9db90-fd20-42c6-afe1-86a355962311
[0m11:28:32.511073 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2322,"data_scanned_in_bytes":32785}
[0m11:28:32.520529 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:28:32.523184 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m11:28:32.718485 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ad1fb706-eb23-4104-ba5a-8410da8de873
[0m11:28:34.502032 [debug] [Thread-1  ]: SQL status: OK -1 in 1.976 seconds
[0m11:28:34.514354 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m11:28:34.521110 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:28:34.522376 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":2322,"data_scanned_in_bytes":32785}';
[0m11:28:34.738235 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9b877713-1777-44a9-9484-9cd36927977a
[0m11:28:36.447341 [debug] [Thread-1  ]: SQL status: OK 2322 in 1.924 seconds
[0m11:28:36.458653 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m11:28:36.460708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87583c70>]}
[0m11:28:36.462726 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 2322[0m in 12.63s]
[0m11:28:36.465282 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m11:28:36.466447 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m11:28:36.472026 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m11:28:36.493965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m11:28:36.495244 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m11:28:36.517370 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m11:28:36.519110 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m11:28:36.523677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:28:37.599294 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:28:37.600105 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:28:37.601513 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:28:38.578433 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:28:38.579676 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:28:38.580275 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/1f2d6190-71b0-45c6-894a-d3b5965ed1b1
[0m11:28:39.168399 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/1f2d6190-71b0-45c6-894a-d3b5965ed1b1', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/1f2d6190-71b0-45c6-894a-d3b5965ed1b1/'
[0m11:28:41.208515 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m11:28:41.228694 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:28:41.675112 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:28:41.679481 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/513d2209-f723-4c6f-a2fa-1aaa1ce45509',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m11:28:42.156653 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID dda66bcb-e7fb-4b46-9a58-83e15aa92fa5
[0m11:28:45.186030 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2479,"data_scanned_in_bytes":62551}
[0m11:28:45.189045 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:28:45.189687 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m11:28:45.403040 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c2e78a05-0e60-4c92-9ae1-70adf426a71c
[0m11:28:47.083238 [debug] [Thread-1  ]: SQL status: OK -1 in 1.892 seconds
[0m11:28:47.092813 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m11:28:47.097221 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:28:47.098255 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2479,"data_scanned_in_bytes":62551}';
[0m11:28:47.294213 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8cb82022-1a78-4701-a1bb-6b3d3f85b611
[0m11:28:49.001457 [debug] [Thread-1  ]: SQL status: OK 2479 in 1.901 seconds
[0m11:28:49.020398 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m11:28:49.024891 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87590700>]}
[0m11:28:49.027871 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 2479[0m in 12.55s]
[0m11:28:49.030328 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m11:28:49.032309 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m11:28:49.034477 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m11:28:49.043187 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m11:28:49.044023 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m11:28:49.059860 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:28:49.061822 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m11:28:49.068677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:28:50.186638 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m11:28:50.187408 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:28:50.188107 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:28:51.160995 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m11:28:51.162168 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:28:51.162727 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m11:28:51.711735 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m11:28:53.487950 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m11:28:53.497995 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:28:53.950408 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:28:53.954429 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:28:54.422784 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID afd2835a-5f12-421f-841a-69f9e9f2644d
[0m11:28:56.170230 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":36496,"data_scanned_in_bytes":230922}
[0m11:28:56.195999 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m11:28:56.200981 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m11:28:56.433792 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 840c31e0-1636-4eb3-a177-9d2efadad326
[0m11:28:58.077290 [debug] [Thread-1  ]: SQL status: OK -1 in 1.873 seconds
[0m11:28:58.083859 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m11:28:58.090548 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m11:28:58.091247 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":36496,"data_scanned_in_bytes":230922}';
[0m11:28:58.277110 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 06f04e0c-32e9-4964-b138-db9cf6c01712
[0m11:28:59.973833 [debug] [Thread-1  ]: SQL status: OK 36496 in 1.881 seconds
[0m11:28:59.997227 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m11:29:00.001191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4764c5f8-e5da-4ff4-a665-970e36a4846f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82978af0>]}
[0m11:29:00.006327 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 36496[0m in 10.96s]
[0m11:29:00.012143 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m11:29:00.025166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:00.025930 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m11:29:00.034669 [info ] [MainThread]: 
[0m11:29:00.036351 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 4 minutes and 50.09 seconds (290.09s).
[0m11:29:00.042547 [debug] [MainThread]: Command end result
[0m11:29:00.118445 [info ] [MainThread]: 
[0m11:29:00.118973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:29:00.119247 [info ] [MainThread]: 
[0m11:29:00.119940 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:29:00.131842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 114.182915, "process_user_time": 23.76981, "process_kernel_time": 4.499771, "process_mem_max_rss": "184288", "process_out_blocks": "2217", "process_in_blocks": "0"}
[0m11:29:00.134404 [debug] [MainThread]: Command `dbt run` succeeded at 11:29:00.134252 after 114.19 seconds
[0m11:29:00.135028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8849d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8756aac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8705bcd0>]}
[0m11:29:00.135318 [debug] [MainThread]: Flushing usage events
[0m11:42:52.876734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbae5a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb94dc670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8e38c10>]}


============================== 11:42:52.900682 | c3856914-4287-49ef-9e28-e214537a1426 ==============================
[0m11:42:52.900682 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:42:52.901206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:42:53.677733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba611c70>]}
[0m11:42:53.707803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6cd3580>]}
[0m11:42:53.708416 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:42:53.732503 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:42:53.853387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:42:53.853708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:42:53.889373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a0a4f0>]}
[0m11:42:53.977723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb692a730>]}
[0m11:42:53.978105 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m11:42:53.978354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69f0b20>]}
[0m11:42:53.979635 [info ] [MainThread]: 
[0m11:42:53.980040 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:42:53.984270 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:42:53.984618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:54.754972 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:42:54.758862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:55.384632 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:42:55.386212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:55.993658 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:42:55.998711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m11:42:55.999193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:57.117963 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m11:42:57.120423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m11:42:57.123316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:58.579932 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:42:58.582494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m11:42:58.585329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:59.718628 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m11:42:59.730928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6cdd0d0>]}
[0m11:42:59.741512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:42:59.747073 [info ] [MainThread]: 
[0m11:42:59.823025 [debug] [Thread-1  ]: Began running node model.silver.eia_bronze
[0m11:42:59.824907 [info ] [Thread-1  ]: 1 of 11 START sql view model bronze.eia_bronze ................................. [RUN]
[0m11:42:59.850757 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.eia_bronze)
[0m11:42:59.852597 [debug] [Thread-1  ]: Began compiling node model.silver.eia_bronze
[0m11:42:59.914390 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_bronze"
[0m11:43:00.055718 [debug] [Thread-1  ]: Began executing node model.silver.eia_bronze
[0m11:43:00.155129 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_bronze"
[0m11:43:00.160304 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_bronze"
[0m11:43:00.161512 [debug] [Thread-1  ]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    
select
  CAST(state AS varchar) as state,
  CAST(sector AS varchar) as sector,
  CAST(price AS double) as price,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."eia_energy"

[0m11:43:00.162950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:00.861024 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8322248e-5f88-475b-99d9-35f35eed4fd8
[0m11:43:02.777775 [debug] [Thread-1  ]: SQL status: OK -1 in 2.615 seconds
[0m11:43:03.818118 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['6', '5', '4', '3', '2']
[0m11:43:03.826547 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['2']
[0m11:43:04.326704 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 2 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m11:43:04.357666 [debug] [Thread-1  ]: On model.silver.eia_bronze: Close
[0m11:43:04.361246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4fe67f0>]}
[0m11:43:04.363947 [info ] [Thread-1  ]: 1 of 11 OK created sql view model bronze.eia_bronze ............................ [[32mOK -1[0m in 4.53s]
[0m11:43:04.366281 [debug] [Thread-1  ]: Finished running node model.silver.eia_bronze
[0m11:43:04.367583 [debug] [Thread-1  ]: Began running node model.silver.noaa_bronze
[0m11:43:04.369724 [info ] [Thread-1  ]: 2 of 11 START sql view model bronze.noaa_bronze ................................ [RUN]
[0m11:43:04.378984 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m11:43:04.380396 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_bronze
[0m11:43:04.391939 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m11:43:04.395106 [debug] [Thread-1  ]: Began executing node model.silver.noaa_bronze
[0m11:43:04.399864 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m11:43:04.401965 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_bronze"
[0m11:43:04.402394 [debug] [Thread-1  ]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    
select
  event_timestamp,
  CAST(station_id AS varchar) as station_id,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(datatype AS varchar) as datatype,
  CAST(value AS double) as value,
  CAST(dt_timestamp AS date) as observation_date
from "AwsDataCatalog"."silver"."noaa_weather"

[0m11:43:04.402930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:05.020118 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID baeeab14-4625-46e6-bcee-8a2715643764
[0m11:43:06.750057 [debug] [Thread-1  ]: SQL status: OK -1 in 2.343 seconds
[0m11:43:07.829194 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['17', '16', '15', '14', '13']
[0m11:43:07.832003 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['13']
[0m11:43:08.287132 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 13 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m11:43:08.294297 [debug] [Thread-1  ]: On model.silver.noaa_bronze: Close
[0m11:43:08.296129 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4fd0c70>]}
[0m11:43:08.297585 [info ] [Thread-1  ]: 2 of 11 OK created sql view model bronze.noaa_bronze ........................... [[32mOK -1[0m in 3.92s]
[0m11:43:08.298964 [debug] [Thread-1  ]: Finished running node model.silver.noaa_bronze
[0m11:43:08.300606 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_bronze
[0m11:43:08.302696 [info ] [Thread-1  ]: 3 of 11 START sql view model bronze.openmeteo_bronze ........................... [RUN]
[0m11:43:08.307469 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m11:43:08.308247 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_bronze
[0m11:43:08.321448 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m11:43:08.323100 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_bronze
[0m11:43:08.326002 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m11:43:08.327116 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_bronze"
[0m11:43:08.327432 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(temp_mic_c AS double) as temp_min,
  CAST(precipitation_mm AS double) as precipitation,
  CAST(windspeed_max_mps AS double) as windspeed,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openmeteo_historical"

[0m11:43:08.327740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:08.860358 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ece936d6-d0f0-4348-b514-135bb54b5db0
[0m11:43:10.847020 [debug] [Thread-1  ]: SQL status: OK -1 in 2.519 seconds
[0m11:43:11.847788 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['17', '16', '15', '14', '13']
[0m11:43:11.850847 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['13']
[0m11:43:12.331896 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 13 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m11:43:12.341472 [debug] [Thread-1  ]: On model.silver.openmeteo_bronze: Close
[0m11:43:12.351046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb64af760>]}
[0m11:43:12.354338 [info ] [Thread-1  ]: 3 of 11 OK created sql view model bronze.openmeteo_bronze ...................... [[32mOK -1[0m in 4.04s]
[0m11:43:12.357131 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_bronze
[0m11:43:12.359219 [debug] [Thread-1  ]: Began running node model.silver.openweather_bronze
[0m11:43:12.363556 [info ] [Thread-1  ]: 4 of 11 START sql view model bronze.openweather_bronze ......................... [RUN]
[0m11:43:12.369515 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m11:43:12.370402 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_bronze
[0m11:43:12.411337 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m11:43:12.418645 [debug] [Thread-1  ]: Began executing node model.silver.openweather_bronze
[0m11:43:12.422311 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m11:43:12.423562 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_bronze"
[0m11:43:12.423886 [debug] [Thread-1  ]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    
select
  CAST(city AS varchar) as city,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(temp_c AS double) as temperature,
  CAST(feelslike_c AS double) as feelslike_temp,
  CAST(humidity_pct AS double) as humidity,
  CAST(windspeed_mps AS double) as windspeed,
  CAST(visibility_m AS double) as visibility,
  CAST(weather_status AS varchar) as weather_status,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."openweather_monthly"

[0m11:43:12.424197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:12.950900 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 560d00a3-7237-434c-8c27-a7ba53cde853
[0m11:43:14.652284 [debug] [Thread-1  ]: SQL status: OK -1 in 2.228 seconds
[0m11:43:15.733809 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['17', '16', '15', '14', '13']
[0m11:43:15.739138 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['13']
[0m11:43:16.197204 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 13 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m11:43:16.208801 [debug] [Thread-1  ]: On model.silver.openweather_bronze: Close
[0m11:43:16.212296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb947f970>]}
[0m11:43:16.214969 [info ] [Thread-1  ]: 4 of 11 OK created sql view model bronze.openweather_bronze .................... [[32mOK -1[0m in 3.84s]
[0m11:43:16.217180 [debug] [Thread-1  ]: Finished running node model.silver.openweather_bronze
[0m11:43:16.219001 [debug] [Thread-1  ]: Began running node model.silver.sensor_bronze
[0m11:43:16.221289 [info ] [Thread-1  ]: 5 of 11 START sql view model bronze.sensor_bronze .............................. [RUN]
[0m11:43:16.234982 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m11:43:16.235869 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_bronze
[0m11:43:16.248076 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m11:43:16.250459 [debug] [Thread-1  ]: Began executing node model.silver.sensor_bronze
[0m11:43:16.254038 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m11:43:16.255117 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_bronze"
[0m11:43:16.255437 [debug] [Thread-1  ]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    
select
  meter_id,
  CAST(power_kw AS double) as power_kw,
  CAST(voltage AS int) as voltage,
  sensor_id,
  CAST(temp_c AS double) as temp_c,
  CAST(humidity_pct AS double) as humidity_pct,
  location,
  CAST(dt_timestamp AS timestamp) as dt_timestamp,
  CAST(dt_timestamp AS date) as observation_date,
  event_timestamp
from "AwsDataCatalog"."silver"."sensor_readings"

[0m11:43:16.255876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:17.086561 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e03c557d-8bd7-49e3-9227-3d2c43986391
[0m11:43:18.814268 [debug] [Thread-1  ]: SQL status: OK -1 in 2.558 seconds
[0m11:43:20.021265 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Total table versions: ['15', '14', '13', '12', '11']
[0m11:43:20.026271 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Versions to delete: ['11']
[0m11:43:20.499776 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted version 11 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m11:43:20.507176 [debug] [Thread-1  ]: On model.silver.sensor_bronze: Close
[0m11:43:20.509542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4fd0b80>]}
[0m11:43:20.512200 [info ] [Thread-1  ]: 5 of 11 OK created sql view model bronze.sensor_bronze ......................... [[32mOK -1[0m in 4.28s]
[0m11:43:20.514005 [debug] [Thread-1  ]: Finished running node model.silver.sensor_bronze
[0m11:43:20.515291 [debug] [Thread-1  ]: Began running node model.silver.eia_silver
[0m11:43:20.516018 [info ] [Thread-1  ]: 6 of 11 START sql table model silver.eia_silver ................................ [RUN]
[0m11:43:20.520663 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_bronze, now model.silver.eia_silver)
[0m11:43:20.521398 [debug] [Thread-1  ]: Began compiling node model.silver.eia_silver
[0m11:43:20.532082 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.eia_silver"
[0m11:43:20.534129 [debug] [Thread-1  ]: Began executing node model.silver.eia_silver
[0m11:43:20.570426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:21.671781 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:43:21.674734 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:43:21.678588 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:43:22.648595 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.eia_silver
[0m11:43:22.649311 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:43:22.649937 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/d9c9a6e3-cbe2-47b3-9cfb-5f9d2a430798
[0m11:43:23.173943 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/d9c9a6e3-cbe2-47b3-9cfb-5f9d2a430798', bucket='climate-energy-raw-data', prefix='silver/eia_silver/d9c9a6e3-cbe2-47b3-9cfb-5f9d2a430798/'
[0m11:43:25.023574 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m11:43:25.079089 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:43:25.502991 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:43:25.506054 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver/0cf5d6e3-6856-4adf-911e-0f3d00e32ec4',
      format='parquet'
    )
    as
      
select
    state,
    sector,
    cast(dt_timestamp as date) as observation_date,
    price,
    event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."eia_bronze"
[0m11:43:26.015763 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID e2ac6f0d-b000-4554-91dc-e381b1e0076a
[0m11:43:28.795101 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":20118,"data_scanned_in_bytes":113462}
[0m11:43:28.801447 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:43:28.801917 [debug] [Thread-1  ]: On model.silver.eia_silver: alter table `silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m11:43:29.003325 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9430c772-5b54-4d60-906c-f01f29076348
[0m11:43:30.885637 [debug] [Thread-1  ]: SQL status: OK -1 in 2.083 seconds
[0m11:43:30.887752 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.eia_silver"
[0m11:43:30.889851 [debug] [Thread-1  ]: Using athena connection "model.silver.eia_silver"
[0m11:43:30.890224 [debug] [Thread-1  ]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":20118,"data_scanned_in_bytes":113462}';
[0m11:43:31.086510 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID fbc65c36-b407-451b-b6fd-e8d47829a2d3
[0m11:43:32.797840 [debug] [Thread-1  ]: SQL status: OK 20118 in 1.907 seconds
[0m11:43:32.806679 [debug] [Thread-1  ]: On model.silver.eia_silver: Close
[0m11:43:32.808900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9428250>]}
[0m11:43:32.810905 [info ] [Thread-1  ]: 6 of 11 OK created sql table model silver.eia_silver ........................... [[32mOK 20118[0m in 12.29s]
[0m11:43:32.812879 [debug] [Thread-1  ]: Finished running node model.silver.eia_silver
[0m11:43:32.816085 [debug] [Thread-1  ]: Began running node model.silver.noaa_silver
[0m11:43:32.820909 [info ] [Thread-1  ]: 7 of 11 START sql table model silver.noaa_silver ............................... [RUN]
[0m11:43:32.826255 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m11:43:32.826891 [debug] [Thread-1  ]: Began compiling node model.silver.noaa_silver
[0m11:43:32.834387 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.noaa_silver"
[0m11:43:32.836338 [debug] [Thread-1  ]: Began executing node model.silver.noaa_silver
[0m11:43:32.841087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:33.935636 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:43:33.938918 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:43:33.940822 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:43:34.916771 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.noaa_silver
[0m11:43:34.918282 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:43:34.919317 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/55089096-171d-41ef-b025-cf52d50857b8
[0m11:43:35.483666 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/55089096-171d-41ef-b025-cf52d50857b8', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/55089096-171d-41ef-b025-cf52d50857b8/'
[0m11:43:37.224545 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m11:43:37.236554 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:43:37.674278 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:43:37.676043 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver/a70c1aa8-b42e-4e60-a8c3-e8e2ea7c1099',
      format='parquet'
    )
    as
      
select
  station_id,
  cast(dt_timestamp as date) as observation_date,
  datatype as metric,
  value / 10.0 as metric_value,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."noaa_bronze"
-- where datatype in ('TMAX', 'TMIN', 'PRCP')
[0m11:43:38.116477 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 4dc4af4d-0578-4d18-a29b-1a1eb78f211b
[0m11:43:40.941978 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":1595,"data_scanned_in_bytes":13556}
[0m11:43:40.952445 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:43:40.953369 [debug] [Thread-1  ]: On model.silver.noaa_silver: alter table `silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m11:43:41.152418 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 08507f5a-e3fc-4392-8645-a32630118cb0
[0m11:43:42.822373 [debug] [Thread-1  ]: SQL status: OK -1 in 1.867 seconds
[0m11:43:42.835392 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.noaa_silver"
[0m11:43:42.838010 [debug] [Thread-1  ]: Using athena connection "model.silver.noaa_silver"
[0m11:43:42.838403 [debug] [Thread-1  ]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":1595,"data_scanned_in_bytes":13556}';
[0m11:43:43.033705 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ce89afb8-3517-48ae-bd3e-7d16ec34f9ac
[0m11:43:44.732272 [debug] [Thread-1  ]: SQL status: OK 1595 in 1.893 seconds
[0m11:43:44.745070 [debug] [Thread-1  ]: On model.silver.noaa_silver: Close
[0m11:43:44.748369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb607d100>]}
[0m11:43:44.751465 [info ] [Thread-1  ]: 7 of 11 OK created sql table model silver.noaa_silver .......................... [[32mOK 1595[0m in 11.92s]
[0m11:43:44.754596 [debug] [Thread-1  ]: Finished running node model.silver.noaa_silver
[0m11:43:44.759231 [debug] [Thread-1  ]: Began running node model.silver.openmeteo_silver
[0m11:43:44.762599 [info ] [Thread-1  ]: 8 of 11 START sql table model silver.openmeteo_silver .......................... [RUN]
[0m11:43:44.768883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m11:43:44.769594 [debug] [Thread-1  ]: Began compiling node model.silver.openmeteo_silver
[0m11:43:44.781847 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m11:43:44.783361 [debug] [Thread-1  ]: Began executing node model.silver.openmeteo_silver
[0m11:43:44.792168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:46.030016 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:43:46.031977 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:43:46.033444 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:43:47.060544 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openmeteo_silver
[0m11:43:47.061796 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:43:47.062966 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/325f481a-c6c4-4f0a-a897-b5b5f0f831c9
[0m11:43:47.620466 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/325f481a-c6c4-4f0a-a897-b5b5f0f831c9', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/325f481a-c6c4-4f0a-a897-b5b5f0f831c9/'
[0m11:43:49.499033 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m11:43:49.549120 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:43:50.024324 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:43:50.025911 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver/484941df-4e72-4805-bd73-623ad227c9e9',
      format='parquet'
    )
    as
      
select
    city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temp_min,
  temp_min * (9.0 / 5.0) + 32.0 as temp_min_f,
  precipitation,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m11:43:50.556716 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d6dcc79c-bfec-49cc-a2d3-c83961f0049c
[0m11:43:53.372943 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":34174,"data_scanned_in_bytes":317370}
[0m11:43:53.383342 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:43:53.384157 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: alter table `silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m11:43:53.575569 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3e61ecf9-9124-4a3b-b78c-f756abb2c649
[0m11:43:55.246839 [debug] [Thread-1  ]: SQL status: OK -1 in 1.857 seconds
[0m11:43:55.253594 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m11:43:55.256073 [debug] [Thread-1  ]: Using athena connection "model.silver.openmeteo_silver"
[0m11:43:55.256421 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":34174,"data_scanned_in_bytes":317370}';
[0m11:43:55.483554 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 3a6039c0-befe-4cea-95ab-ce5ddaaa0db2
[0m11:43:57.177003 [debug] [Thread-1  ]: SQL status: OK 34174 in 1.920 seconds
[0m11:43:57.189563 [debug] [Thread-1  ]: On model.silver.openmeteo_silver: Close
[0m11:43:57.193609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a41af0>]}
[0m11:43:57.201940 [info ] [Thread-1  ]: 8 of 11 OK created sql table model silver.openmeteo_silver ..................... [[32mOK 34174[0m in 12.43s]
[0m11:43:57.203988 [debug] [Thread-1  ]: Finished running node model.silver.openmeteo_silver
[0m11:43:57.205690 [debug] [Thread-1  ]: Began running node model.silver.openweather_silver
[0m11:43:57.207794 [info ] [Thread-1  ]: 9 of 11 START sql table model silver.openweather_silver ........................ [RUN]
[0m11:43:57.212851 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m11:43:57.213499 [debug] [Thread-1  ]: Began compiling node model.silver.openweather_silver
[0m11:43:57.225261 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.openweather_silver"
[0m11:43:57.227187 [debug] [Thread-1  ]: Began executing node model.silver.openweather_silver
[0m11:43:57.231191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:43:58.284816 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:43:58.286418 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:43:58.288103 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:43:59.585545 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.openweather_silver
[0m11:43:59.594824 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:43:59.596791 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/743caf7c-987c-4190-adda-0fbc7324e5e5
[0m11:44:00.380550 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/743caf7c-987c-4190-adda-0fbc7324e5e5', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/743caf7c-987c-4190-adda-0fbc7324e5e5/'
[0m11:44:02.161172 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m11:44:02.167619 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:44:02.605276 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:44:02.607872 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver/7bee7dc5-2059-4b8a-83b5-e196bb56f159',
      format='parquet'
    )
    as
      
select
  city,
  temperature,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  cast(dt_timestamp as date) as observation_date,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."openweather_bronze"
[0m11:44:03.106087 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 8fe1e9fb-4341-4013-bfe2-c86f039cf0a9
[0m11:44:05.957135 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2322,"data_scanned_in_bytes":32785}
[0m11:44:05.964607 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:44:05.965203 [debug] [Thread-1  ]: On model.silver.openweather_silver: alter table `silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m11:44:06.230149 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 43e32f54-5f71-4105-9e3e-a3bb7d16125a
[0m11:44:07.898215 [debug] [Thread-1  ]: SQL status: OK -1 in 1.932 seconds
[0m11:44:07.901430 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.openweather_silver"
[0m11:44:07.903895 [debug] [Thread-1  ]: Using athena connection "model.silver.openweather_silver"
[0m11:44:07.904282 [debug] [Thread-1  ]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":2322,"data_scanned_in_bytes":32785}';
[0m11:44:08.098477 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID f4e09e22-ca3f-43d8-85be-bc0507793bc7
[0m11:44:09.993516 [debug] [Thread-1  ]: SQL status: OK 2322 in 2.087 seconds
[0m11:44:10.025529 [debug] [Thread-1  ]: On model.silver.openweather_silver: Close
[0m11:44:10.027916 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a41af0>]}
[0m11:44:10.030651 [info ] [Thread-1  ]: 9 of 11 OK created sql table model silver.openweather_silver ................... [[32mOK 2322[0m in 12.82s]
[0m11:44:10.032229 [debug] [Thread-1  ]: Finished running node model.silver.openweather_silver
[0m11:44:10.033528 [debug] [Thread-1  ]: Began running node model.silver.sensor_silver
[0m11:44:10.035110 [info ] [Thread-1  ]: 10 of 11 START sql table model silver.sensor_silver ............................ [RUN]
[0m11:44:10.039278 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m11:44:10.039687 [debug] [Thread-1  ]: Began compiling node model.silver.sensor_silver
[0m11:44:10.048291 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.sensor_silver"
[0m11:44:10.049597 [debug] [Thread-1  ]: Began executing node model.silver.sensor_silver
[0m11:44:10.053558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:44:11.182164 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:44:11.183015 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:44:11.183591 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:44:12.143465 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.silver.sensor_silver
[0m11:44:12.144920 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:44:12.145564 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/513d2209-f723-4c6f-a2fa-1aaa1ce45509
[0m11:44:12.623928 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/513d2209-f723-4c6f-a2fa-1aaa1ce45509', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/513d2209-f723-4c6f-a2fa-1aaa1ce45509/'
[0m11:44:14.547752 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m11:44:14.552697 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:44:14.957160 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:44:14.960846 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver/c5a9a162-df9b-4b18-8e06-943163a37710',
      format='parquet'
    )
    as
      
select
    location,
   cast(dt_timestamp as date) as observation_date,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage as current,
  sensor_id,
  temp_c as tempeture,
  humidity_pct as humidity,
  event_timestamp as ingestion_timestamp
from "AwsDataCatalog"."bronze"."sensor_bronze"
[0m11:44:15.432362 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9192e0ea-f2cb-4804-9b57-05e25e1f8463
[0m11:44:18.401700 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":2479,"data_scanned_in_bytes":62551}
[0m11:44:18.405811 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:44:18.406971 [debug] [Thread-1  ]: On model.silver.sensor_silver: alter table `silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m11:44:18.626782 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 9b4e14ca-0811-4b94-a724-db251b339ac0
[0m11:44:20.296482 [debug] [Thread-1  ]: SQL status: OK -1 in 1.887 seconds
[0m11:44:20.314510 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.sensor_silver"
[0m11:44:20.317846 [debug] [Thread-1  ]: Using athena connection "model.silver.sensor_silver"
[0m11:44:20.318394 [debug] [Thread-1  ]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2479,"data_scanned_in_bytes":62551}';
[0m11:44:20.518261 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID c2f71676-373f-431c-8167-b74acd14a488
[0m11:44:22.219267 [debug] [Thread-1  ]: SQL status: OK 2479 in 1.899 seconds
[0m11:44:22.232568 [debug] [Thread-1  ]: On model.silver.sensor_silver: Close
[0m11:44:22.237164 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a05190>]}
[0m11:44:22.243719 [info ] [Thread-1  ]: 10 of 11 OK created sql table model silver.sensor_silver ....................... [[32mOK 2479[0m in 12.20s]
[0m11:44:22.246105 [debug] [Thread-1  ]: Finished running node model.silver.sensor_silver
[0m11:44:22.247619 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m11:44:22.249213 [info ] [Thread-1  ]: 11 of 11 START sql table model gold.weather_data_gold .......................... [RUN]
[0m11:44:22.253368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.silver.sensor_silver, now model.silver.weather_data_gold)
[0m11:44:22.254048 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m11:44:22.269562 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:44:22.273715 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m11:44:22.283862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:44:23.471545 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m11:44:23.474086 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:44:23.476005 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:44:24.425398 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m11:44:24.426003 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:44:24.426703 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m11:44:24.947686 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m11:44:26.843120 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m11:44:26.851972 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:44:27.276085 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:44:27.277704 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:44:27.735742 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b770421b-dd32-4bdb-ab7f-7f7d3a098db1
[0m11:44:30.544635 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":36496,"data_scanned_in_bytes":231128}
[0m11:44:30.554229 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m11:44:30.555222 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m11:44:30.755875 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID b733e9dc-2a74-4b6c-b20f-87f5587229d5
[0m11:44:32.386119 [debug] [Thread-1  ]: SQL status: OK -1 in 1.830 seconds
[0m11:44:32.393743 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m11:44:32.395922 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m11:44:32.396199 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":36496,"data_scanned_in_bytes":231128}';
[0m11:44:32.582834 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID ef87e010-db97-4d48-9916-b541d0035d66
[0m11:44:34.497811 [debug] [Thread-1  ]: SQL status: OK 36496 in 2.100 seconds
[0m11:44:34.512960 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m11:44:34.514688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3856914-4287-49ef-9e28-e214537a1426', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb52db8b0>]}
[0m11:44:34.516264 [info ] [Thread-1  ]: 11 of 11 OK created sql table model gold.weather_data_gold ..................... [[32mOK 36496[0m in 12.26s]
[0m11:44:34.517449 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m11:44:34.526380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:34.527237 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m11:44:34.536236 [info ] [MainThread]: 
[0m11:44:34.536877 [info ] [MainThread]: Finished running 5 view models, 6 table models in 0 hours 1 minutes and 40.56 seconds (100.56s).
[0m11:44:34.539081 [debug] [MainThread]: Command end result
[0m11:44:34.595590 [info ] [MainThread]: 
[0m11:44:34.596338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:34.596626 [info ] [MainThread]: 
[0m11:44:34.597057 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:44:34.600340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 101.75646, "process_user_time": 12.473169, "process_kernel_time": 2.591761, "process_mem_max_rss": "181568", "process_in_blocks": "40360", "process_out_blocks": "8625"}
[0m11:44:34.601575 [debug] [MainThread]: Command `dbt run` succeeded at 11:44:34.601476 after 101.76 seconds
[0m11:44:34.602663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbae5a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba4c7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c0cc10>]}
[0m11:44:34.602986 [debug] [MainThread]: Flushing usage events
[0m11:44:53.237671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2d71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac746fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf56e340>]}


============================== 11:44:53.247581 | bcbfed89-3c1a-4ec9-aae4-52d28f7c61cb ==============================
[0m11:44:53.247581 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:44:53.251904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:53.744578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcbfed89-3c1a-4ec9-aae4-52d28f7c61cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7601f0>]}
[0m11:44:53.782865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcbfed89-3c1a-4ec9-aae4-52d28f7c61cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea33280>]}
[0m11:44:53.783568 [info ] [MainThread]: Registered adapter: athena=1.8.4
[0m11:44:53.797359 [debug] [MainThread]: checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, vars: {}, profile: gold, target: , version: 1.8.7
[0m11:44:53.875951 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:44:53.876382 [debug] [MainThread]: previous checksum: 9ffd2b903cb173a3ba3e5d9649f38a01efcf8f12b488a900ae5d3baa03eff3a2, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m11:44:53.876687 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:44:53.876908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bcbfed89-3c1a-4ec9-aae4-52d28f7c61cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad3ad0a0>]}
[0m11:44:54.711557 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m11:44:54.712239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bcbfed89-3c1a-4ec9-aae4-52d28f7c61cb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6a25e0>]}
[0m11:44:54.904427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcbfed89-3c1a-4ec9-aae4-52d28f7c61cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ff27f0>]}
[0m11:44:54.988940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcbfed89-3c1a-4ec9-aae4-52d28f7c61cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ec63d0>]}
[0m11:44:54.989299 [info ] [MainThread]: Found 11 models, 5 data tests, 5 sources, 451 macros
[0m11:44:54.989599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcbfed89-3c1a-4ec9-aae4-52d28f7c61cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f56490>]}
[0m11:44:54.991167 [info ] [MainThread]: 
[0m11:44:54.991720 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m11:44:54.992782 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m11:44:54.993284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:55.528886 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m11:44:55.536976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m11:44:55.537491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:56.796105 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m11:44:56.800099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m11:44:56.805876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:57.867442 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m11:44:57.871705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m11:44:57.874240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:59.030296 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m11:44:59.042552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcbfed89-3c1a-4ec9-aae4-52d28f7c61cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab1710d0>]}
[0m11:44:59.046289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:44:59.047405 [info ] [MainThread]: 
[0m11:44:59.073557 [debug] [Thread-1  ]: Began running node model.silver.weather_data_gold
[0m11:44:59.077253 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m11:44:59.078569 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.weather_data_gold)
[0m11:44:59.079023 [debug] [Thread-1  ]: Began compiling node model.silver.weather_data_gold
[0m11:44:59.096622 [debug] [Thread-1  ]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m11:44:59.098807 [debug] [Thread-1  ]: Began executing node model.silver.weather_data_gold
[0m11:44:59.132907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:45:00.863887 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m11:45:00.865484 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:45:00.870199 [debug] [Thread-1  ]: Dropping relation via Glue and S3 APIs
[0m11:45:02.019955 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table_name : 254957258847.gold.weather_data_gold
[0m11:45:02.023541 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m11:45:02.024918 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m11:45:02.674761 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m11:45:04.825265 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m11:45:04.874115 [debug] [Thread-1  ]: Skip partitioning: False
[0m11:45:05.407947 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m11:45:05.409833 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      

WITH openweather AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        humidity,
        windspeed AS windspeed_mps,
        'openweather' AS source
    FROM "AwsDataCatalog"."silver"."openweather_silver"
),

openmeteo AS (
    SELECT
        date(from_iso8601_timestamp(ingestion_timestamp)) AS ingestion_date,
        observation_date,
        city AS location,
        temperature AS temperature_c,
        LEAST(100, precipitation * 10) AS humidity,
        windspeed AS windspeed_mps,
        'openmeteo' AS source
    FROM "AwsDataCatalog"."silver"."openmeteo_silver"
)

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openweather

UNION ALL

SELECT
    ingestion_date,
    observation_date,
    location,
    temperature_c,
    humidity,
    windspeed_mps,
    source
FROM openmeteo
[0m11:45:05.961473 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID d5bcf731-c291-478f-8750-d45000547640
[0m11:45:07.849209 [debug] [Thread-1  ]: COMPILED CODE RESULT: {"rowcount":36496,"data_scanned_in_bytes":231128}
[0m11:45:07.881103 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m11:45:07.881714 [debug] [Thread-1  ]: On model.silver.weather_data_gold: alter table `gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m11:45:08.131331 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID a94fa979-d9a5-43b1-8fd7-9b8211ad5667
[0m11:45:09.973201 [debug] [Thread-1  ]: SQL status: OK -1 in 2.090 seconds
[0m11:45:09.979489 [debug] [Thread-1  ]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m11:45:09.982203 [debug] [Thread-1  ]: Using athena connection "model.silver.weather_data_gold"
[0m11:45:09.982573 [debug] [Thread-1  ]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":36496,"data_scanned_in_bytes":231128}';
[0m11:45:10.197820 [debug] [Thread-1  ]: dbt.adapters.athena.constants adapter: Athena query ID 93acba26-64eb-408e-91ea-d5eab7d7c8ac
[0m11:45:12.002859 [debug] [Thread-1  ]: SQL status: OK 36496 in 2.019 seconds
[0m11:45:12.021535 [debug] [Thread-1  ]: On model.silver.weather_data_gold: Close
[0m11:45:12.025886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcbfed89-3c1a-4ec9-aae4-52d28f7c61cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ff6eb0>]}
[0m11:45:12.028417 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 36496[0m in 12.94s]
[0m11:45:12.030104 [debug] [Thread-1  ]: Finished running node model.silver.weather_data_gold
[0m11:45:12.039338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:12.039844 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m11:45:12.042090 [info ] [MainThread]: 
[0m11:45:12.042498 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 17.05 seconds (17.05s).
[0m11:45:12.043523 [debug] [MainThread]: Command end result
[0m11:45:12.083315 [info ] [MainThread]: 
[0m11:45:12.083801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:12.084048 [info ] [MainThread]: 
[0m11:45:12.084320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:45:12.086570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.906202, "process_user_time": 4.530257, "process_kernel_time": 0.62892, "process_mem_max_rss": "179184", "process_in_blocks": "38296", "process_out_blocks": "3109"}
[0m11:45:12.088882 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:12.088708 after 18.91 seconds
[0m11:45:12.090080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2d71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad3c05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea33280>]}
[0m11:45:12.090500 [debug] [MainThread]: Flushing usage events
[0m13:28:09.295551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86544150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86545410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86544210>]}


============================== 13:28:09.303333 | 5decc5a8-0c3a-4d4c-b40a-02989418adfb ==============================
[0m13:28:09.303333 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:28:09.304965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:28:09.306229 [info ] [MainThread]: dbt version: 1.7.9
[0m13:28:09.307419 [info ] [MainThread]: python version: 3.11.14
[0m13:28:09.308129 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m13:28:09.308812 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m13:28:09.639440 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m13:28:09.640209 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m13:28:09.640713 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m13:28:09.641380 [info ] [MainThread]: adapter type: athena
[0m13:28:09.641674 [info ] [MainThread]: adapter version: 1.7.2
[0m13:28:09.690880 [info ] [MainThread]: Configuration:
[0m13:28:09.691296 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:28:09.691616 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:28:09.691878 [info ] [MainThread]: Required dependencies:
[0m13:28:09.692208 [debug] [MainThread]: Executing "git --help"
[0m13:28:09.726973 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:28:09.727501 [debug] [MainThread]: STDERR: "b''"
[0m13:28:09.727745 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:28:09.728171 [info ] [MainThread]: Connection:
[0m13:28:09.728651 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m13:28:09.728920 [info ] [MainThread]:   work_group: None
[0m13:28:09.729299 [info ] [MainThread]:   region_name: us-east-1
[0m13:28:09.729712 [info ] [MainThread]:   database: AwsDataCatalog
[0m13:28:09.729959 [info ] [MainThread]:   schema: silver
[0m13:28:09.730286 [info ] [MainThread]:   poll_interval: 1.0
[0m13:28:09.730532 [info ] [MainThread]:   aws_profile_name: None
[0m13:28:09.730947 [info ] [MainThread]:   aws_access_key_id: None
[0m13:28:09.731292 [info ] [MainThread]:   aws_secret_access_key: None
[0m13:28:09.731625 [info ] [MainThread]:   aws_session_token: None
[0m13:28:09.731874 [info ] [MainThread]:   endpoint_url: None
[0m13:28:09.732092 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m13:28:09.732536 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m13:28:09.732837 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m13:28:09.733422 [info ] [MainThread]:   debug_query_state: False
[0m13:28:09.734056 [info ] [MainThread]:   seed_s3_upload_args: None
[0m13:28:09.734344 [info ] [MainThread]:   lf_tags_database: None
[0m13:28:09.734876 [info ] [MainThread]:   spark_work_group: None
[0m13:28:09.735255 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m13:28:09.736364 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m13:28:09.736893 [debug] [MainThread]: Using athena connection "debug"
[0m13:28:09.737587 [debug] [MainThread]: On debug: select 1 as id
[0m13:28:09.738230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:11.098409 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID 28eefadc-7dc4-4dc8-bbb5-48a037a753d9
[0m13:28:13.046494 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m13:28:13.054273 [debug] [MainThread]: On debug: Close
[0m13:28:13.055981 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:28:13.057222 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:28:13.062239 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.7941175, "process_user_time": 1.721138, "process_kernel_time": 0.538173, "process_mem_max_rss": "143104", "process_in_blocks": "80480", "process_out_blocks": "2213"}
[0m13:28:13.063758 [debug] [MainThread]: Command `dbt debug` succeeded at 13:28:13.063372 after 3.80 seconds
[0m13:28:13.064790 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:28:13.069746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba09990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85768f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff854d8ed0>]}
[0m13:28:13.070904 [debug] [MainThread]: Flushing usage events
[0m13:28:23.852125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1917a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1917050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1923a10>]}


============================== 13:28:23.854127 | 70ad9d64-4386-4731-a9bd-9516ccde9ac1 ==============================
[0m13:28:23.854127 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:28:23.854721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profile silver --select path:models/bronze', 'send_anonymous_usage_stats': 'True'}
[0m13:28:24.278052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70ad9d64-4386-4731-a9bd-9516ccde9ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0964790>]}
[0m13:28:24.323198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70ad9d64-4386-4731-a9bd-9516ccde9ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e9add0>]}
[0m13:28:24.323884 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m13:28:24.331019 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m13:28:24.343780 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:28:24.344308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70ad9d64-4386-4731-a9bd-9516ccde9ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb07ec810>]}
[0m13:28:25.034564 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.silver.noaa_bronze' (models/bronze/noaa_bronze.sql) depends on a source named 'bronze.noaa_raw' which was not found
[0m13:28:25.035945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2111908, "process_user_time": 2.287537, "process_kernel_time": 0.276548, "process_mem_max_rss": "134012", "process_in_blocks": "2072", "process_out_blocks": "5", "command_success": false}
[0m13:28:25.036266 [debug] [MainThread]: Command `dbt run` failed at 13:28:25.036189 after 1.21 seconds
[0m13:28:25.036567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd18e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd13e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd1ad50>]}
[0m13:28:25.036849 [debug] [MainThread]: Flushing usage events
[0m13:32:22.836093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a714150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a715810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a532290>]}


============================== 13:32:22.838173 | e1b59239-cb8e-4bf2-b4a7-ccc0c2c92cd1 ==============================
[0m13:32:22.838173 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:32:22.839170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:22.839451 [info ] [MainThread]: dbt version: 1.7.9
[0m13:32:22.839739 [info ] [MainThread]: python version: 3.11.14
[0m13:32:22.840071 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m13:32:22.840325 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m13:32:23.099746 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m13:32:23.100286 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m13:32:23.100676 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m13:32:23.101106 [info ] [MainThread]: adapter type: athena
[0m13:32:23.101386 [info ] [MainThread]: adapter version: 1.7.2
[0m13:32:23.142204 [info ] [MainThread]: Configuration:
[0m13:32:23.142750 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:32:23.143124 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:32:23.143620 [info ] [MainThread]: Required dependencies:
[0m13:32:23.143906 [debug] [MainThread]: Executing "git --help"
[0m13:32:23.151973 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:32:23.152467 [debug] [MainThread]: STDERR: "b''"
[0m13:32:23.152729 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:32:23.153136 [info ] [MainThread]: Connection:
[0m13:32:23.153655 [info ] [MainThread]:   s3_staging_dir: s3://climate-energy-raw-data/athena_results/
[0m13:32:23.154281 [info ] [MainThread]:   work_group: None
[0m13:32:23.155126 [info ] [MainThread]:   region_name: us-east-1
[0m13:32:23.155825 [info ] [MainThread]:   database: AwsDataCatalog
[0m13:32:23.156197 [info ] [MainThread]:   schema: silver
[0m13:32:23.156530 [info ] [MainThread]:   poll_interval: 1.0
[0m13:32:23.156774 [info ] [MainThread]:   aws_profile_name: None
[0m13:32:23.157017 [info ] [MainThread]:   aws_access_key_id: None
[0m13:32:23.157315 [info ] [MainThread]:   aws_secret_access_key: None
[0m13:32:23.157594 [info ] [MainThread]:   aws_session_token: None
[0m13:32:23.158066 [info ] [MainThread]:   endpoint_url: None
[0m13:32:23.158315 [info ] [MainThread]:   s3_data_dir: s3://climate-energy-raw-data/
[0m13:32:23.158686 [info ] [MainThread]:   s3_data_naming: schema_table_unique
[0m13:32:23.159007 [info ] [MainThread]:   s3_tmp_table_dir: None
[0m13:32:23.159614 [info ] [MainThread]:   debug_query_state: False
[0m13:32:23.160237 [info ] [MainThread]:   seed_s3_upload_args: None
[0m13:32:23.160818 [info ] [MainThread]:   lf_tags_database: None
[0m13:32:23.161140 [info ] [MainThread]:   spark_work_group: None
[0m13:32:23.161460 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m13:32:23.161983 [debug] [MainThread]: Acquiring new athena connection 'debug'
[0m13:32:23.162215 [debug] [MainThread]: Using athena connection "debug"
[0m13:32:23.162411 [debug] [MainThread]: On debug: select 1 as id
[0m13:32:23.162609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:24.272245 [debug] [MainThread]: dbt.adapters.athena.constants adapter: Athena query ID b9f7ca99-f2e0-49a8-b4d2-202f1fdcec53
[0m13:32:26.142849 [debug] [MainThread]: SQL status: OK -1 in 3.0 seconds
[0m13:32:26.149197 [debug] [MainThread]: On debug: Close
[0m13:32:26.150691 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:32:26.151647 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:32:26.161721 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.3499348, "process_user_time": 1.421976, "process_kernel_time": 0.524789, "process_mem_max_rss": "143720", "process_out_blocks": "13", "process_in_blocks": "0"}
[0m13:32:26.163594 [debug] [MainThread]: Command `dbt debug` succeeded at 13:32:26.163143 after 3.35 seconds
[0m13:32:26.164958 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:32:26.173452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a931490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8971e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9c3e50>]}
[0m13:32:26.174812 [debug] [MainThread]: Flushing usage events
[0m13:32:32.578636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9282b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90eb51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fdcd410>]}


============================== 13:32:32.580533 | 3c622d0f-7e75-417d-8442-e62e281d254f ==============================
[0m13:32:32.580533 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:32:32.580981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profile silver --select path:models/bronze', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:32:32.858864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ea7fa50>]}
[0m13:32:32.899887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e829a50>]}
[0m13:32:32.900475 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m13:32:32.905724 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m13:32:32.918885 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m13:32:32.919460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e84fc50>]}
[0m13:32:34.102937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6c0690>]}
[0m13:32:34.119786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df00410>]}
[0m13:32:34.120304 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m13:32:34.120862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8cbb50>]}
[0m13:32:34.123487 [info ] [MainThread]: 
[0m13:32:34.124524 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m13:32:34.126181 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m13:32:34.126978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:35.240982 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:32:35.244656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_gold)
[0m13:32:35.245244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:37.345083 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m13:32:37.349143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m13:32:37.350654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:38.993392 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m13:32:38.995760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m13:32:38.997575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:40.743850 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m13:32:40.749632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86a72a10>]}
[0m13:32:40.751816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:32:40.752837 [info ] [MainThread]: 
[0m13:32:40.756874 [debug] [Thread-1 (]: Began running node model.silver.eia_bronze
[0m13:32:40.757942 [info ] [Thread-1 (]: 1 of 5 START sql view model bronze.eia_bronze .................................. [RUN]
[0m13:32:40.759460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_bronze)
[0m13:32:40.760156 [debug] [Thread-1 (]: Began compiling node model.silver.eia_bronze
[0m13:32:40.773862 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_bronze"
[0m13:32:40.777294 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (compile): 13:32:40.760699 => 13:32:40.776895
[0m13:32:40.777982 [debug] [Thread-1 (]: Began executing node model.silver.eia_bronze
[0m13:32:40.807212 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_bronze"
[0m13:32:40.808637 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_bronze"
[0m13:32:40.808994 [debug] [Thread-1 (]: On model.silver.eia_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."eia_bronze"
  as
    

SELECT
  json_extract_scalar(json_payload, '$.data.state') AS state,
  json_extract_scalar(json_payload, '$.data.sector') AS sector,
  CAST(json_extract_scalar(json_payload, '$.data.price') AS double) AS price,
  json_extract_scalar(json_payload, '$.data.period') AS period,
  json_extract_scalar(json_payload, '$.timestamp') AS ingestion_timestamp
FROM "AwsDataCatalog"."silver"."eia_raw"

[0m13:32:40.809321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:41.397008 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2f618599-1a1d-491f-8f75-7dd63ac7397c
[0m13:32:43.220662 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:32:44.456486 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['7', '6', '5', '4', '3']
[0m13:32:44.461654 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['3']
[0m13:32:44.982769 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 3 of table "AwsDataCatalog"."bronze"."eia_bronze" 
[0m13:32:45.016540 [debug] [Thread-1 (]: Timing info for model.silver.eia_bronze (execute): 13:32:40.778369 => 13:32:45.015480
[0m13:32:45.018467 [debug] [Thread-1 (]: On model.silver.eia_bronze: Close
[0m13:32:45.027204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c42edd0>]}
[0m13:32:45.030014 [info ] [Thread-1 (]: 1 of 5 OK created sql view model bronze.eia_bronze ............................. [[32mOK -1[0m in 4.27s]
[0m13:32:45.036521 [debug] [Thread-1 (]: Finished running node model.silver.eia_bronze
[0m13:32:45.042949 [debug] [Thread-1 (]: Began running node model.silver.noaa_bronze
[0m13:32:45.045705 [info ] [Thread-1 (]: 2 of 5 START sql view model bronze.noaa_bronze ................................. [RUN]
[0m13:32:45.051146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_bronze, now model.silver.noaa_bronze)
[0m13:32:45.051870 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_bronze
[0m13:32:45.063908 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_bronze"
[0m13:32:45.068616 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (compile): 13:32:45.052260 => 13:32:45.067264
[0m13:32:45.069520 [debug] [Thread-1 (]: Began executing node model.silver.noaa_bronze
[0m13:32:45.075707 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_bronze"
[0m13:32:45.076896 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_bronze"
[0m13:32:45.077325 [debug] [Thread-1 (]: On model.silver.noaa_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."noaa_bronze"
  as
    

SELECT
  json_extract_scalar(json_payload, '$.data.station_id') AS station_id,
  json_extract_scalar(json_payload, '$.data.datatype') AS datatype,
  CAST(json_extract_scalar(json_payload, '$.data.value') AS double) AS value,
  json_extract_scalar(json_payload, '$.data.date') AS date_str,
  json_extract_scalar(json_payload, '$.timestamp') AS ingestion_timestamp
FROM "AwsDataCatalog"."silver"."noaa_raw"

[0m13:32:45.077844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:45.851934 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0ad4986b-672c-46bc-9788-81751c33bb5d
[0m13:32:47.690004 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m13:32:48.901591 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['18', '17', '16', '15', '14']
[0m13:32:48.903448 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['14']
[0m13:32:49.413194 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 14 of table "AwsDataCatalog"."bronze"."noaa_bronze" 
[0m13:32:49.418608 [debug] [Thread-1 (]: Timing info for model.silver.noaa_bronze (execute): 13:32:45.069939 => 13:32:49.418160
[0m13:32:49.419348 [debug] [Thread-1 (]: On model.silver.noaa_bronze: Close
[0m13:32:49.420904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c62ced0>]}
[0m13:32:49.428293 [info ] [Thread-1 (]: 2 of 5 OK created sql view model bronze.noaa_bronze ............................ [[32mOK -1[0m in 4.37s]
[0m13:32:49.430253 [debug] [Thread-1 (]: Finished running node model.silver.noaa_bronze
[0m13:32:49.431422 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_bronze
[0m13:32:49.432692 [info ] [Thread-1 (]: 3 of 5 START sql view model bronze.openmeteo_bronze ............................ [RUN]
[0m13:32:49.435404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_bronze, now model.silver.openmeteo_bronze)
[0m13:32:49.435948 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_bronze
[0m13:32:49.447668 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_bronze"
[0m13:32:49.449726 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (compile): 13:32:49.436206 => 13:32:49.449478
[0m13:32:49.450115 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_bronze
[0m13:32:49.458823 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_bronze"
[0m13:32:49.465201 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_bronze"
[0m13:32:49.467025 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openmeteo_bronze"
  as
    

SELECT
  json_extract_scalar(json_payload, '$.data.city') AS city,
  CAST(json_extract_scalar(json_payload, '$.data.temperature_c') AS double) AS temperature,
  CAST(json_extract_scalar(json_payload, '$.data.temperature_min_c') AS double) AS temperature_min,
  CAST(json_extract_scalar(json_payload, '$.data.precipitation_mm') AS double) AS precipitation_mm,
  CAST(json_extract_scalar(json_payload, '$.data.windspeed_max_mps') AS double) AS windspeed,
  json_extract_scalar(json_payload, '$.data.dt') AS date_str,
  json_extract_scalar(json_payload, '$.timestamp') AS ingestion_timestamp
FROM "AwsDataCatalog"."silver"."openmeteo_raw"

[0m13:32:49.467701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:50.077612 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7386ceed-63b5-4cbe-88cb-1ec2fb671493
[0m13:32:51.904522 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:32:53.381711 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['18', '17', '16', '15', '14']
[0m13:32:53.385028 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['14']
[0m13:32:54.158673 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 14 of table "AwsDataCatalog"."bronze"."openmeteo_bronze" 
[0m13:32:54.169892 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_bronze (execute): 13:32:49.450352 => 13:32:54.169266
[0m13:32:54.171711 [debug] [Thread-1 (]: On model.silver.openmeteo_bronze: Close
[0m13:32:54.176292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9f0a10>]}
[0m13:32:54.179083 [info ] [Thread-1 (]: 3 of 5 OK created sql view model bronze.openmeteo_bronze ....................... [[32mOK -1[0m in 4.74s]
[0m13:32:54.180191 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_bronze
[0m13:32:54.181036 [debug] [Thread-1 (]: Began running node model.silver.openweather_bronze
[0m13:32:54.183105 [info ] [Thread-1 (]: 4 of 5 START sql view model bronze.openweather_bronze .......................... [RUN]
[0m13:32:54.186258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_bronze, now model.silver.openweather_bronze)
[0m13:32:54.186993 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_bronze
[0m13:32:54.191525 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_bronze"
[0m13:32:54.194083 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (compile): 13:32:54.187282 => 13:32:54.193854
[0m13:32:54.194451 [debug] [Thread-1 (]: Began executing node model.silver.openweather_bronze
[0m13:32:54.202460 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_bronze"
[0m13:32:54.204980 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_bronze"
[0m13:32:54.205948 [debug] [Thread-1 (]: On model.silver.openweather_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."openweather_bronze"
  as
    

SELECT
  json_extract_scalar(json_payload, '$.data.city') AS city,
  CAST(json_extract_scalar(json_payload, '$.data.temperature_c') AS double) AS temperature,
    CAST(json_extract_scalar(json_payload, '$.data.feels_like_c') AS double) AS feelslike_temp,
  CAST(json_extract_scalar(json_payload, '$.data.humidity_pct') AS double) AS humidity,
  CAST(json_extract_scalar(json_payload, '$.data.wind_speed_mps') AS double) AS windspeed,
  CAST(json_extract_scalar(json_payload, '$.data.visibility_m') AS double) AS visibility,
  CAST(json_extract_scalar(json_payload, '$.data.weather_main') AS varchar) AS weather_status,
  CAST(json_extract_scalar(json_payload, '$.data.dt') AS bigint) AS epoch_ts,
  json_extract_scalar(json_payload, '$.timestamp') AS ingestion_timestamp
FROM "AwsDataCatalog"."silver"."openweather_raw"

[0m13:32:54.206608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:54.830339 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 900b6b4b-f755-48a7-8484-01137bfad754
[0m13:32:56.601135 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:32:57.790487 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['18', '17', '16', '15', '14']
[0m13:32:57.796953 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['14']
[0m13:32:58.331068 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 14 of table "AwsDataCatalog"."bronze"."openweather_bronze" 
[0m13:32:58.351570 [debug] [Thread-1 (]: Timing info for model.silver.openweather_bronze (execute): 13:32:54.194691 => 13:32:58.350646
[0m13:32:58.352718 [debug] [Thread-1 (]: On model.silver.openweather_bronze: Close
[0m13:32:58.355869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d360210>]}
[0m13:32:58.358573 [info ] [Thread-1 (]: 4 of 5 OK created sql view model bronze.openweather_bronze ..................... [[32mOK -1[0m in 4.17s]
[0m13:32:58.360231 [debug] [Thread-1 (]: Finished running node model.silver.openweather_bronze
[0m13:32:58.361557 [debug] [Thread-1 (]: Began running node model.silver.sensor_bronze
[0m13:32:58.363497 [info ] [Thread-1 (]: 5 of 5 START sql view model bronze.sensor_bronze ............................... [RUN]
[0m13:32:58.367738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_bronze, now model.silver.sensor_bronze)
[0m13:32:58.368494 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_bronze
[0m13:32:58.389623 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_bronze"
[0m13:32:58.392218 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (compile): 13:32:58.368886 => 13:32:58.391966
[0m13:32:58.392790 [debug] [Thread-1 (]: Began executing node model.silver.sensor_bronze
[0m13:32:58.403652 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_bronze"
[0m13:32:58.410711 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_bronze"
[0m13:32:58.411900 [debug] [Thread-1 (]: On model.silver.sensor_bronze: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_bronze"} */
create or replace view
    "AwsDataCatalog"."bronze"."sensor_bronze"
  as
    

SELECT
  json_extract_scalar(json_payload, '$.data.meter_id') AS meter_id,
  CAST(json_extract_scalar(json_payload, '$.data.power_kw') AS double) AS power_kw,
  CAST(json_extract_scalar(json_payload, '$.data.voltage') AS int) AS voltage,
  json_extract_scalar(json_payload, '$.data.sensor_id') AS sensor_id,
  CAST(json_extract_scalar(json_payload, '$.data.temperature_c') AS double) AS temp_c,
  CAST(json_extract_scalar(json_payload, '$.data.humidity_pct') AS double) AS humidity_pct,
  json_extract_scalar(json_payload, '$.data.location') AS location,
  CAST(json_extract_scalar(json_payload, '$.data.timestamp') AS bigint) AS epoch_ts,
  json_extract_scalar(json_payload, '$.timestamp') AS ingestion_timestamp
FROM "AwsDataCatalog"."silver"."sensor_raw"

[0m13:32:58.412675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:59.273385 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 527133c2-3eab-40d1-a21b-6a745f8fae0f
[0m13:33:01.103597 [debug] [Thread-1 (]: SQL status: OK -1 in 3.0 seconds
[0m13:33:02.272351 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Total table versions: ['16', '15', '14', '13', '12']
[0m13:33:02.276156 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Versions to delete: ['12']
[0m13:33:02.843225 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted version 12 of table "AwsDataCatalog"."bronze"."sensor_bronze" 
[0m13:33:02.855787 [debug] [Thread-1 (]: Timing info for model.silver.sensor_bronze (execute): 13:32:58.393081 => 13:33:02.854972
[0m13:33:02.857123 [debug] [Thread-1 (]: On model.silver.sensor_bronze: Close
[0m13:33:02.860084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c622d0f-7e75-417d-8442-e62e281d254f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86df8bd0>]}
[0m13:33:02.862260 [info ] [Thread-1 (]: 5 of 5 OK created sql view model bronze.sensor_bronze .......................... [[32mOK -1[0m in 4.49s]
[0m13:33:02.863447 [debug] [Thread-1 (]: Finished running node model.silver.sensor_bronze
[0m13:33:02.877788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:02.878443 [debug] [MainThread]: Connection 'model.silver.sensor_bronze' was properly closed.
[0m13:33:02.881690 [info ] [MainThread]: 
[0m13:33:02.883145 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 28.76 seconds (28.76s).
[0m13:33:02.885697 [debug] [MainThread]: Command end result
[0m13:33:02.939793 [info ] [MainThread]: 
[0m13:33:02.940471 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:02.941019 [info ] [MainThread]: 
[0m13:33:02.941537 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:33:02.947507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.392202, "process_user_time": 5.619267, "process_kernel_time": 0.804629, "process_mem_max_rss": "195088", "process_in_blocks": "608", "process_out_blocks": "3015"}
[0m13:33:02.949140 [debug] [MainThread]: Command `dbt run` succeeded at 13:33:02.948592 after 30.39 seconds
[0m13:33:02.955812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90eb4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86082a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fdcd490>]}
[0m13:33:02.956578 [debug] [MainThread]: Flushing usage events
[0m13:33:15.090977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb06ba710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb06afa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb06bbb90>]}


============================== 13:33:15.094023 | b599d143-4fdd-47b1-a355-98ebf12c0a75 ==============================
[0m13:33:15.094023 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:33:15.095137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'send_anonymous_usage_stats': 'True'}
[0m13:33:15.387705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b599d143-4fdd-47b1-a355-98ebf12c0a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf66be50>]}
[0m13:33:15.429588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b599d143-4fdd-47b1-a355-98ebf12c0a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6b9690>]}
[0m13:33:15.430189 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m13:33:15.435841 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m13:33:15.461371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:15.461676 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:15.465559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b599d143-4fdd-47b1-a355-98ebf12c0a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf703e10>]}
[0m13:33:15.473877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b599d143-4fdd-47b1-a355-98ebf12c0a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf463790>]}
[0m13:33:15.474217 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m13:33:15.474531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b599d143-4fdd-47b1-a355-98ebf12c0a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0500250>]}
[0m13:33:15.475851 [info ] [MainThread]: 
[0m13:33:15.476407 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m13:33:15.477293 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m13:33:15.477586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:16.144251 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:33:16.150678 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_gold'
[0m13:33:16.151824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:17.452768 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m13:33:17.455278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m13:33:17.456429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:18.825943 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m13:33:18.829274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m13:33:18.833348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:20.205848 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m13:33:20.210483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b599d143-4fdd-47b1-a355-98ebf12c0a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf55e090>]}
[0m13:33:20.212797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:20.214014 [info ] [MainThread]: 
[0m13:33:20.218547 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m13:33:20.219719 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m13:33:20.221203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.eia_silver)
[0m13:33:20.221927 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m13:33:20.235411 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m13:33:20.237418 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 13:33:20.222418 => 13:33:20.237184
[0m13:33:20.237939 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m13:33:20.268321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:21.459394 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m13:33:21.460505 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:33:21.463909 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:33:22.544150 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m13:33:22.545261 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:33:22.545970 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver/0cf5d6e3-6856-4adf-911e-0f3d00e32ec4
[0m13:33:23.261894 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver/0cf5d6e3-6856-4adf-911e-0f3d00e32ec4', bucket='climate-energy-raw-data', prefix='silver/eia_silver/0cf5d6e3-6856-4adf-911e-0f3d00e32ec4/'
[0m13:33:25.544692 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m13:33:25.572394 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:33:26.027578 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver', bucket='climate-energy-raw-data', prefix='silver/eia_silver/'
[0m13:33:26.704075 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  state,
  sector,
  price,
  date_parse(period, '%Y-%m') AS dt_timestamp,
  CAST(date_parse(period, '%Y-%m') AS date) AS observation_date,
  ingestion_timestamp
FROM "AwsDataCatalog"."bronze"."eia_bronze"
[0m13:33:27.266742 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7d5989f0-d68b-4c27-b310-e741c4f6b162
[0m13:33:34.897158 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 711131b0-a29e-4985-9663-8cc47afb954a
[0m13:33:48.540104 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 70242507-2ef7-46cf-b589-48312ebb79df
[0m13:34:14.196123 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 931fa031-7491-488f-a919-306f7240e1a2
[0m13:35:04.298379 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2dd96d98-b0de-4940-a431-4544c6b59fa0
[0m13:36:42.513961 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 339d060f-aa0c-44d4-8c1c-ac4f7cff705b
[0m13:36:44.139774 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [observation_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/339d060f-aa0c-44d4-8c1c-ac4f7cff705b' before retrying. Athena will not delete data in your account.
[0m13:36:44.143355 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 13:33:20.238256 => 13:36:44.142151
[0m13:36:44.144475 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m13:36:44.149567 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [observation_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/339d060f-aa0c-44d4-8c1c-ac4f7cff705b' before retrying. Athena will not delete data in your account.
[0m13:36:44.187184 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [observation_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/339d060f-aa0c-44d4-8c1c-ac4f7cff705b' before retrying. Athena will not delete data in your account.

[0m13:36:44.195145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b599d143-4fdd-47b1-a355-98ebf12c0a75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bcced0>]}
[0m13:36:44.203901 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model silver.eia_silver ........................ [[31mERROR[0m in 203.97s]
[0m13:36:44.207269 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m13:36:44.210246 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m13:36:44.213265 [info ] [Thread-1 (]: 2 of 5 START sql table model silver.noaa_silver ................................ [RUN]
[0m13:36:44.237333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m13:36:44.239520 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m13:36:44.314251 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m13:36:44.319643 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 13:36:44.272570 => 13:36:44.318417
[0m13:36:44.320306 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m13:36:44.327968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:45.705079 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m13:36:45.707104 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:36:45.708956 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:36:46.845576 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : noaa_silver
[0m13:36:46.846531 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:36:46.847422 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."noaa_silver" is stored in s3://climate-energy-raw-data/silver/noaa_silver/a70c1aa8-b42e-4e60-a8c3-e8e2ea7c1099
[0m13:36:47.469478 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver/a70c1aa8-b42e-4e60-a8c3-e8e2ea7c1099', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/a70c1aa8-b42e-4e60-a8c3-e8e2ea7c1099/'
[0m13:36:49.325404 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."noaa_silver"
[0m13:36:49.329703 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:36:49.847567 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/noaa_silver', bucket='climate-energy-raw-data', prefix='silver/noaa_silver/'
[0m13:36:50.510856 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  station_id,
  datatype as metric,
  value / 10.0 as metric_value,
  from_iso8601_timestamp(date_str) AS dt_timestamp,
  CAST(from_iso8601_timestamp(date_str) AS date) AS observation_date,
  ingestion_timestamp
FROM "AwsDataCatalog"."bronze"."noaa_bronze"
[0m13:36:51.041741 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 612f130f-c95b-4f48-a520-d84abc47518b
[0m13:36:58.778017 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9fdd50d4-cb11-497d-9826-8ef64eb6ca80
[0m13:37:12.785795 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c716280a-b7e7-4612-a3cd-03f5b94384ef
[0m13:37:38.407482 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8226ad9b-2578-40eb-b2c5-b0dd5b5d2ec9
[0m13:38:03.862137 [error] [MainThread]: CANCEL query list_AwsDataCatalog ............................................... [[31mCANCEL[0m]
[0m13:38:03.874916 [error] [MainThread]: CANCEL query model.silver.noaa_silver .......................................... [[31mCANCEL[0m]
[0m13:38:04.868445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:04.870052 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m13:38:04.870641 [debug] [MainThread]: Connection 'model.silver.noaa_silver' was left open.
[0m13:38:04.871044 [debug] [MainThread]: On model.silver.noaa_silver: Close
[0m13:38:04.873534 [info ] [MainThread]: 
[0m13:38:04.874112 [info ] [MainThread]: Finished running 1 table model in 0 hours 4 minutes and 49.40 seconds (289.40s).
[0m13:38:04.875586 [error] [MainThread]: Encountered an error:

[0m13:38:04.886521 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:38:04.896840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 289.84863, "process_user_time": 5.903294, "process_kernel_time": 0.826123, "process_mem_max_rss": "193276", "process_in_blocks": "840", "process_out_blocks": "1065", "command_success": false}
[0m13:38:04.898080 [debug] [MainThread]: Command `dbt run` failed at 13:38:04.897864 after 289.85 seconds
[0m13:38:04.899091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0952750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb58f9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac861e50>]}
[0m13:38:04.900034 [debug] [MainThread]: Flushing usage events
[0m13:39:35.590520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97063690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97063b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97063990>]}


============================== 13:39:35.592891 | 7381cc3f-88c4-4a74-860b-167eb586830b ==============================
[0m13:39:35.592891 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:39:35.593820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'send_anonymous_usage_stats': 'True'}
[0m13:39:35.955241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7381cc3f-88c4-4a74-860b-167eb586830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9622aed0>]}
[0m13:39:36.012747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7381cc3f-88c4-4a74-860b-167eb586830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f82350>]}
[0m13:39:36.015424 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m13:39:36.021646 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m13:39:36.073824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:39:36.074614 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/eia_silver.sql
[0m13:39:36.175347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7381cc3f-88c4-4a74-860b-167eb586830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96013490>]}
[0m13:39:36.183867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7381cc3f-88c4-4a74-860b-167eb586830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ee4710>]}
[0m13:39:36.184241 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m13:39:36.184566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7381cc3f-88c4-4a74-860b-167eb586830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96086710>]}
[0m13:39:36.185984 [info ] [MainThread]: 
[0m13:39:36.186587 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m13:39:36.187538 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m13:39:36.187834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:36.845121 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:39:36.857804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m13:39:36.858712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:38.558615 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m13:39:38.565728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m13:39:38.571600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:39.922151 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m13:39:39.927417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_bronze)
[0m13:39:39.929092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:41.450808 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m13:39:41.456663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7381cc3f-88c4-4a74-860b-167eb586830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9600a950>]}
[0m13:39:41.459211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:41.460420 [info ] [MainThread]: 
[0m13:39:41.464958 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m13:39:41.467085 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m13:39:41.468749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.eia_silver)
[0m13:39:41.469606 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m13:39:41.481733 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m13:39:41.484528 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 13:39:41.470105 => 13:39:41.484197
[0m13:39:41.485114 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m13:39:41.532316 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:39:41.532933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:42.309477 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:39:42.312412 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  state,
  sector,
  price,
  date_parse(period, '%Y-%m') AS dt_timestamp,
  ingestion_timestamp,
  CAST(date_parse(period, '%Y-%m') AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."eia_bronze"
[0m13:39:42.919830 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 23836211-47a0-495a-8c3c-020ed175d185
[0m13:39:47.063955 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":27549,"data_scanned_in_bytes":5305034}
[0m13:39:47.086749 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m13:39:47.089063 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m13:39:47.403377 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1bd206ea-290e-477e-8f4c-2d02d030723d
[0m13:39:49.148559 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:39:49.158478 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m13:39:49.162754 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m13:39:49.163521 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":27549,"data_scanned_in_bytes":5305034}';
[0m13:39:49.404552 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID bd523e8b-1a41-4512-ac4e-b2cc221c26a8
[0m13:39:51.409952 [debug] [Thread-1 (]: SQL status: OK 27549 in 2.0 seconds
[0m13:39:51.424530 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 13:39:41.485423 => 13:39:51.424109
[0m13:39:51.425819 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m13:39:51.427469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7381cc3f-88c4-4a74-860b-167eb586830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95f97c10>]}
[0m13:39:51.428899 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.eia_silver ............................ [[32mOK 27549[0m in 9.96s]
[0m13:39:51.430222 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m13:39:51.431469 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m13:39:51.432657 [info ] [Thread-1 (]: 2 of 5 START sql table model silver.noaa_silver ................................ [RUN]
[0m13:39:51.436612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m13:39:51.437233 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m13:39:51.442075 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m13:39:51.444958 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 13:39:51.437688 => 13:39:51.444650
[0m13:39:51.445621 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m13:39:51.449173 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:39:51.449889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:52.142100 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:39:52.143593 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  station_id,
  datatype as metric,
  value / 10.0 as metric_value,
  from_iso8601_timestamp(date_str) AS dt_timestamp,
  CAST(from_iso8601_timestamp(date_str) AS date) AS observation_date,
  ingestion_timestamp
FROM "AwsDataCatalog"."bronze"."noaa_bronze"
[0m13:39:52.662327 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 12297616-70e1-450a-ae65-1eb9c3856d2d
[0m13:40:00.267313 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 960264c3-1f07-4ede-a936-f1f68b8d0cee
[0m13:40:13.978816 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1919179e-fafd-4425-9ad1-93d5474fe4c6
[0m13:40:39.632263 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c3e7921d-dfa1-4e38-a3d1-2fabc9017016
[0m13:41:29.643940 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID cac29088-6965-4d7e-b2fe-72b3bbbfb28e
[0m13:43:08.010413 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2b75d42a-f5b5-44a0-844f-3cd82dd2e885
[0m13:43:09.374675 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [observation_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/2b75d42a-f5b5-44a0-844f-3cd82dd2e885' before retrying. Athena will not delete data in your account.
[0m13:43:09.376687 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 13:39:51.446005 => 13:43:09.376083
[0m13:43:09.377746 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m13:43:09.384338 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [observation_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/2b75d42a-f5b5-44a0-844f-3cd82dd2e885' before retrying. Athena will not delete data in your account.
[0m13:43:09.395664 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [observation_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/2b75d42a-f5b5-44a0-844f-3cd82dd2e885' before retrying. Athena will not delete data in your account.

[0m13:43:09.397464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7381cc3f-88c4-4a74-860b-167eb586830b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e16ed50>]}
[0m13:43:09.406539 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model silver.noaa_silver ....................... [[31mERROR[0m in 197.96s]
[0m13:43:09.409113 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m13:43:09.409905 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m13:43:09.412040 [info ] [Thread-1 (]: 3 of 5 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m13:43:09.413014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m13:43:09.413360 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m13:43:09.422417 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m13:43:09.424593 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 13:43:09.413567 => 13:43:09.424390
[0m13:43:09.424909 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m13:43:09.434227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:11.182267 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m13:43:11.183188 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:43:11.187310 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:43:12.282202 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m13:43:12.284609 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:43:12.285968 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver/484941df-4e72-4805-bd73-623ad227c9e9
[0m13:43:13.035883 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver/484941df-4e72-4805-bd73-623ad227c9e9', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/484941df-4e72-4805-bd73-623ad227c9e9/'
[0m13:43:15.238889 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m13:43:15.255841 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:43:15.925307 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/'
[0m13:43:16.757173 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temperature_min,
  temperature_min * (9.0 / 5.0) + 32.0 as temperature_min_f,
  precipitation_mm as precipitation,
  LEAST(100, precipitation_mm * 10) as humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  CAST(date_str AS date) AS dt_timestamp,
  CAST(date_str AS date) AS observation_date,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date
FROM "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m13:43:17.304962 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID db174745-de33-424c-af53-f4e97d306003
[0m13:43:23.976164 [error] [MainThread]: CANCEL query model.silver.openmeteo_silver ..................................... [[31mCANCEL[0m]
[0m13:43:24.359225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:24.360757 [debug] [MainThread]: Connection 'model.silver.openmeteo_silver' was left open.
[0m13:43:24.361795 [debug] [MainThread]: On model.silver.openmeteo_silver: Close
[0m13:43:24.363450 [info ] [MainThread]: 
[0m13:43:24.364790 [info ] [MainThread]: Finished running 2 table models in 0 hours 3 minutes and 48.18 seconds (228.18s).
[0m13:43:24.366135 [error] [MainThread]: Encountered an error:

[0m13:43:24.375148 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 384, in execute_nodes
    self._cancel_connections(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 341, in _cancel_connections
    pool.join()
  File "/usr/local/lib/python3.11/multiprocessing/pool.py", line 669, in join
    p.join()
  File "/usr/local/lib/python3.11/threading.py", line 1119, in join
    self._wait_for_tstate_lock()
  File "/usr/local/lib/python3.11/threading.py", line 1139, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:43:24.380403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 228.82271, "process_user_time": 4.776888, "process_kernel_time": 0.778011, "process_mem_max_rss": "179936", "process_out_blocks": "2038", "command_success": false, "process_in_blocks": "0"}
[0m13:43:24.391580 [debug] [MainThread]: Command `dbt run` failed at 13:43:24.390920 after 228.83 seconds
[0m13:43:24.393366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9707d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951b88d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c464d10>]}
[0m13:43:24.395371 [debug] [MainThread]: Flushing usage events
[0m13:43:24.929828 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e3d4c31f-7c8a-47f6-a7fd-3b3ba2ed2958
[0m13:46:25.940096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2957a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2df9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2956810>]}


============================== 13:46:25.942406 | 8e8d06ba-d7bf-46de-a1ed-3b2470222f77 ==============================
[0m13:46:25.942406 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:46:25.943568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:46:26.282526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e8d06ba-d7bf-46de-a1ed-3b2470222f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb19ca450>]}
[0m13:46:26.340146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e8d06ba-d7bf-46de-a1ed-3b2470222f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1891a50>]}
[0m13:46:26.340990 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m13:46:26.347824 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m13:46:26.389574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m13:46:26.390362 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/sensor_silver.sql
[0m13:46:26.391008 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/openmeteo_silver.sql
[0m13:46:26.391653 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/openweather_silver.sql
[0m13:46:26.392238 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/noaa_silver.sql
[0m13:46:26.497421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e8d06ba-d7bf-46de-a1ed-3b2470222f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb18e65d0>]}
[0m13:46:26.507969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e8d06ba-d7bf-46de-a1ed-3b2470222f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1717f10>]}
[0m13:46:26.508697 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m13:46:26.509230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e8d06ba-d7bf-46de-a1ed-3b2470222f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb18c8510>]}
[0m13:46:26.510883 [info ] [MainThread]: 
[0m13:46:26.511488 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m13:46:26.512502 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m13:46:26.512826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:27.329838 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:46:27.334125 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_bronze'
[0m13:46:27.334923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:28.685258 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m13:46:28.687398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m13:46:28.688749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:29.952392 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m13:46:29.955004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m13:46:29.956281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:31.438942 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m13:46:31.444852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e8d06ba-d7bf-46de-a1ed-3b2470222f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9502ed0>]}
[0m13:46:31.446739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:31.447821 [info ] [MainThread]: 
[0m13:46:31.451599 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m13:46:31.452571 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m13:46:31.454046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.eia_silver)
[0m13:46:31.454715 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m13:46:31.465759 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m13:46:31.468760 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 13:46:31.455157 => 13:46:31.468505
[0m13:46:31.469297 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m13:46:31.502324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:32.667167 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m13:46:32.667847 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:46:32.669608 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:46:33.803165 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m13:46:33.811261 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:46:33.815000 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver
[0m13:46:34.913930 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver', bucket='climate-energy-raw-data', prefix='silver/eia_silver/'
[0m13:46:37.004938 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m13:46:37.049627 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:46:37.677327 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:46:37.678741 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  state,
  sector,
  price,
  date_parse(period, '%Y-%m') AS dt_timestamp,
  ingestion_timestamp,
  CAST(date_parse(period, '%Y-%m') AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."eia_bronze"
[0m13:46:38.271159 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c7e8d795-3407-45f5-b1aa-7951173c1fb1
[0m13:46:41.238058 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":27549,"data_scanned_in_bytes":5305034}
[0m13:46:41.254878 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m13:46:41.255923 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m13:46:41.609767 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9201bd42-327d-4139-a5f7-17c78ce795bf
[0m13:46:43.437998 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:46:43.443051 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m13:46:43.444969 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m13:46:43.445397 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":27549,"data_scanned_in_bytes":5305034}';
[0m13:46:43.667053 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0f527c92-899f-44b4-891f-58286156211a
[0m13:46:45.478846 [debug] [Thread-1 (]: SQL status: OK 27549 in 2.0 seconds
[0m13:46:45.504249 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 13:46:31.469682 => 13:46:45.503655
[0m13:46:45.505540 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m13:46:45.507695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e8d06ba-d7bf-46de-a1ed-3b2470222f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8fa47d0>]}
[0m13:46:45.509417 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.eia_silver ............................ [[32mOK 27549[0m in 14.05s]
[0m13:46:45.510440 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m13:46:45.511354 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m13:46:45.512507 [info ] [Thread-1 (]: 2 of 5 START sql table model silver.noaa_silver ................................ [RUN]
[0m13:46:45.517907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m13:46:45.518493 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m13:46:45.526807 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m13:46:45.528662 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 13:46:45.519016 => 13:46:45.528469
[0m13:46:45.529018 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m13:46:45.531822 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:46:45.532422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:47.218100 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:46:47.222904 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  station_id,
  datatype as metric,
  value / 10.0 as metric_value,
  from_iso8601_timestamp(date_str) AS dt_timestamp,
  ingestion_timestamp,
  CAST(from_iso8601_timestamp(date_str) AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."noaa_bronze"
[0m13:46:47.787587 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2ceb6b36-5d58-4796-af24-1a3a727bd57a
[0m13:46:55.409870 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b4a921c4-f574-479c-9e68-3fccc4992d12
[0m13:47:09.030029 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 05408831-83bb-4502-903d-b2924752ffb6
[0m13:47:34.682050 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 885b3197-fb31-4c94-91fe-edc3fd5531f5
[0m13:48:24.807366 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a6aa74ac-3759-4907-8d5f-d1fe713c22ff
[0m13:50:02.816166 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 90e95d42-c696-4e92-987f-f880ad63b962
[0m13:50:04.289130 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: NOT_SUPPORTED: Unsupported Hive type: timestamp(3) with time zone. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/90e95d42-c696-4e92-987f-f880ad63b962' before retrying. Athena will not delete data in your account.
[0m13:50:04.294748 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 13:46:45.529218 => 13:50:04.293533
[0m13:50:04.297546 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m13:50:04.304087 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
NOT_SUPPORTED: Unsupported Hive type: timestamp(3) with time zone. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/90e95d42-c696-4e92-987f-f880ad63b962' before retrying. Athena will not delete data in your account.
[0m13:50:04.327525 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: NOT_SUPPORTED: Unsupported Hive type: timestamp(3) with time zone. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/90e95d42-c696-4e92-987f-f880ad63b962' before retrying. Athena will not delete data in your account.

[0m13:50:04.330295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e8d06ba-d7bf-46de-a1ed-3b2470222f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89482d0>]}
[0m13:50:04.333148 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model silver.noaa_silver ....................... [[31mERROR[0m in 198.82s]
[0m13:50:04.334609 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m13:50:04.335832 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m13:50:04.338684 [info ] [Thread-1 (]: 3 of 5 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m13:50:04.340239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m13:50:04.340974 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m13:50:04.351103 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m13:50:04.353724 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 13:50:04.341342 => 13:50:04.353411
[0m13:50:04.354105 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m13:50:04.360525 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:50:04.361879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:05.764241 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:50:05.768635 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temperature_min,
  temperature_min * (9.0 / 5.0) + 32.0 as temperature_min_f,
  precipitation_mm as precipitation,
  LEAST(100, precipitation_mm * 10) as humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  CAST(date_str AS date) AS dt_timestamp,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date,
  CAST(date_str AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m13:50:06.298398 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 813e63c0-88d3-4c8f-a50c-9e8606e9bf94
[0m13:50:09.457162 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: HIVE_TOO_MANY_OPEN_PARTITIONS: Exceeded limit of 100 open writers for partitions/buckets. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/813e63c0-88d3-4c8f-a50c-9e8606e9bf94' before retrying. Athena will not delete data in your account.
[0m13:50:09.460631 [debug] [Thread-1 (]: COMPILED CODE RESULT: TOO_MANY_OPEN_PARTITIONS
[0m13:50:11.071465 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exists - Ignoring
[0m13:50:11.072887 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exist - Ignoring
[0m13:50:11.073399 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:50:12.275875 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exists - Ignoring
[0m13:50:12.277813 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exist - Ignoring
[0m13:50:13.780992 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exist and will not be deleted, ignoring
[0m13:50:13.789059 [debug] [Thread-1 (]: CREATE NON-PARTIONED STAGING TABLE: "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
[0m13:50:13.792333 [debug] [Thread-1 (]: Skip partitioning: True
[0m13:50:14.821145 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:50:14.828782 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:50:14.829508 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    

    create table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temperature_min,
  temperature_min * (9.0 / 5.0) + 32.0 as temperature_min_f,
  precipitation_mm as precipitation,
  LEAST(100, precipitation_mm * 10) as humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  CAST(date_str AS date) AS dt_timestamp,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date,
  CAST(date_str AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."openmeteo_bronze"
  
[0m13:50:15.065160 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9bd0067a-b601-43ee-b5bf-e12c5b384ee1
[0m13:50:18.016889 [debug] [Thread-1 (]: SQL status: OK 37427 in 3.0 seconds
[0m13:50:18.056844 [debug] [Thread-1 (]: PARTITIONED KEYS: observation_date
[0m13:50:18.058107 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:50:18.058625 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
select distinct observation_date from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" order by observation_date;
[0m13:50:18.291994 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 50604b07-4e58-4cf3-ad6b-e0ef8e578b46
[0m13:50:20.278310 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:50:20.345580 [debug] [Thread-1 (]: TOTAL PARTITIONS TO PROCESS: 395
[0m13:50:20.346266 [debug] [Thread-1 (]: BATCHES TO PROCESS: 4
[0m13:50:21.430667 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver__tmp_not_partitioned
[0m13:50:21.431218 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:50:21.431632 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Columns in relation openmeteo_silver__tmp_not_partitioned: [{'Name': 'location', 'Type': 'string', 'Parameters': {}}, {'Name': 'temperature_c', 'Type': 'double', 'Parameters': {}}, {'Name': 'temperature_f', 'Type': 'double', 'Parameters': {}}, {'Name': 'temperature_min', 'Type': 'double', 'Parameters': {}}, {'Name': 'temperature_min_f', 'Type': 'double', 'Parameters': {}}, {'Name': 'precipitation', 'Type': 'double', 'Parameters': {}}, {'Name': 'humidity', 'Type': 'double', 'Parameters': {}}, {'Name': 'windspeed_mps', 'Type': 'double', 'Parameters': {}}, {'Name': 'windspeed_mph', 'Type': 'double', 'Parameters': {}}, {'Name': 'dt_timestamp', 'Type': 'date', 'Parameters': {}}, {'Name': 'ingestion_date', 'Type': 'date', 'Parameters': {}}, {'Name': 'observation_date', 'Type': 'date', 'Parameters': {}}]
[0m13:50:21.433170 [debug] [Thread-1 (]: BATCH PROCESSING: 1 OF 4
[0m13:50:21.434175 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:50:22.035190 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/'
[0m13:50:22.794955 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:50:22.795791 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    

    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-01-01' or observation_date=DATE'2025-01-02' or observation_date=DATE'2025-01-03' or observation_date=DATE'2025-01-04' or observation_date=DATE'2025-01-05' or observation_date=DATE'2025-01-06' or observation_date=DATE'2025-01-07' or observation_date=DATE'2025-01-08' or observation_date=DATE'2025-01-09' or observation_date=DATE'2025-01-10' or observation_date=DATE'2025-01-11' or observation_date=DATE'2025-01-12' or observation_date=DATE'2025-01-13' or observation_date=DATE'2025-01-14' or observation_date=DATE'2025-01-15' or observation_date=DATE'2025-01-16' or observation_date=DATE'2025-01-17' or observation_date=DATE'2025-01-18' or observation_date=DATE'2025-01-19' or observation_date=DATE'2025-01-20' or observation_date=DATE'2025-01-21' or observation_date=DATE'2025-01-22' or observation_date=DATE'2025-01-23' or observation_date=DATE'2025-01-24' or observation_date=DATE'2025-01-25' or observation_date=DATE'2025-01-26' or observation_date=DATE'2025-01-27' or observation_date=DATE'2025-01-28' or observation_date=DATE'2025-01-29' or observation_date=DATE'2025-01-30' or observation_date=DATE'2025-01-31' or observation_date=DATE'2025-02-01' or observation_date=DATE'2025-02-02' or observation_date=DATE'2025-02-03' or observation_date=DATE'2025-02-04' or observation_date=DATE'2025-02-05' or observation_date=DATE'2025-02-06' or observation_date=DATE'2025-02-07' or observation_date=DATE'2025-02-08' or observation_date=DATE'2025-02-09' or observation_date=DATE'2025-02-10' or observation_date=DATE'2025-02-11' or observation_date=DATE'2025-02-12' or observation_date=DATE'2025-02-13' or observation_date=DATE'2025-02-14' or observation_date=DATE'2025-02-15' or observation_date=DATE'2025-02-16' or observation_date=DATE'2025-02-17' or observation_date=DATE'2025-02-18' or observation_date=DATE'2025-02-19' or observation_date=DATE'2025-02-20' or observation_date=DATE'2025-02-21' or observation_date=DATE'2025-02-22' or observation_date=DATE'2025-02-23' or observation_date=DATE'2025-02-24' or observation_date=DATE'2025-02-25' or observation_date=DATE'2025-02-26' or observation_date=DATE'2025-02-27' or observation_date=DATE'2025-02-28' or observation_date=DATE'2025-03-01' or observation_date=DATE'2025-03-02' or observation_date=DATE'2025-03-03' or observation_date=DATE'2025-03-04' or observation_date=DATE'2025-03-05' or observation_date=DATE'2025-03-06' or observation_date=DATE'2025-03-07' or observation_date=DATE'2025-03-08' or observation_date=DATE'2025-03-09' or observation_date=DATE'2025-03-10' or observation_date=DATE'2025-03-11' or observation_date=DATE'2025-03-12' or observation_date=DATE'2025-03-13' or observation_date=DATE'2025-03-14' or observation_date=DATE'2025-03-15' or observation_date=DATE'2025-03-16' or observation_date=DATE'2025-03-17' or observation_date=DATE'2025-03-18' or observation_date=DATE'2025-03-19' or observation_date=DATE'2025-03-20' or observation_date=DATE'2025-03-21' or observation_date=DATE'2025-03-22' or observation_date=DATE'2025-03-23' or observation_date=DATE'2025-03-24' or observation_date=DATE'2025-03-25' or observation_date=DATE'2025-03-26' or observation_date=DATE'2025-03-27' or observation_date=DATE'2025-03-28' or observation_date=DATE'2025-03-29' or observation_date=DATE'2025-03-30' or observation_date=DATE'2025-03-31' or observation_date=DATE'2025-04-01' or observation_date=DATE'2025-04-02' or observation_date=DATE'2025-04-03' or observation_date=DATE'2025-04-04' or observation_date=DATE'2025-04-05' or observation_date=DATE'2025-04-06' or observation_date=DATE'2025-04-07' or observation_date=DATE'2025-04-08' or observation_date=DATE'2025-04-09' or observation_date=DATE'2025-04-10'
  
[0m13:50:23.046768 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1fc16038-3185-4980-9d21-f95f14d4f25b
[0m13:50:25.022296 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m13:50:25.041512 [debug] [Thread-1 (]: BATCH PROCESSING: 2 OF 4
[0m13:50:25.044203 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:50:25.044659 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    insert into "AwsDataCatalog"."silver"."openmeteo_silver" ("location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date")
                select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-04-11' or observation_date=DATE'2025-04-12' or observation_date=DATE'2025-04-13' or observation_date=DATE'2025-04-14' or observation_date=DATE'2025-04-15' or observation_date=DATE'2025-04-16' or observation_date=DATE'2025-04-17' or observation_date=DATE'2025-04-18' or observation_date=DATE'2025-04-19' or observation_date=DATE'2025-04-20' or observation_date=DATE'2025-04-21' or observation_date=DATE'2025-04-22' or observation_date=DATE'2025-04-23' or observation_date=DATE'2025-04-24' or observation_date=DATE'2025-04-25' or observation_date=DATE'2025-04-26' or observation_date=DATE'2025-04-27' or observation_date=DATE'2025-04-28' or observation_date=DATE'2025-04-29' or observation_date=DATE'2025-04-30' or observation_date=DATE'2025-05-01' or observation_date=DATE'2025-05-02' or observation_date=DATE'2025-05-03' or observation_date=DATE'2025-05-04' or observation_date=DATE'2025-05-05' or observation_date=DATE'2025-05-06' or observation_date=DATE'2025-05-07' or observation_date=DATE'2025-05-08' or observation_date=DATE'2025-05-09' or observation_date=DATE'2025-05-10' or observation_date=DATE'2025-05-11' or observation_date=DATE'2025-05-12' or observation_date=DATE'2025-05-13' or observation_date=DATE'2025-05-14' or observation_date=DATE'2025-05-15' or observation_date=DATE'2025-05-16' or observation_date=DATE'2025-05-17' or observation_date=DATE'2025-05-18' or observation_date=DATE'2025-05-19' or observation_date=DATE'2025-05-20' or observation_date=DATE'2025-05-21' or observation_date=DATE'2025-05-22' or observation_date=DATE'2025-05-23' or observation_date=DATE'2025-05-24' or observation_date=DATE'2025-05-25' or observation_date=DATE'2025-05-26' or observation_date=DATE'2025-05-27' or observation_date=DATE'2025-05-28' or observation_date=DATE'2025-05-29' or observation_date=DATE'2025-05-30' or observation_date=DATE'2025-05-31' or observation_date=DATE'2025-06-01' or observation_date=DATE'2025-06-02' or observation_date=DATE'2025-06-03' or observation_date=DATE'2025-06-04' or observation_date=DATE'2025-06-05' or observation_date=DATE'2025-06-06' or observation_date=DATE'2025-06-07' or observation_date=DATE'2025-06-08' or observation_date=DATE'2025-06-09' or observation_date=DATE'2025-06-10' or observation_date=DATE'2025-06-11' or observation_date=DATE'2025-06-12' or observation_date=DATE'2025-06-13' or observation_date=DATE'2025-06-14' or observation_date=DATE'2025-06-15' or observation_date=DATE'2025-06-16' or observation_date=DATE'2025-06-17' or observation_date=DATE'2025-06-18' or observation_date=DATE'2025-06-19' or observation_date=DATE'2025-06-20' or observation_date=DATE'2025-06-21' or observation_date=DATE'2025-06-22' or observation_date=DATE'2025-06-23' or observation_date=DATE'2025-06-24' or observation_date=DATE'2025-06-25' or observation_date=DATE'2025-06-26' or observation_date=DATE'2025-06-27' or observation_date=DATE'2025-06-28' or observation_date=DATE'2025-06-29' or observation_date=DATE'2025-06-30' or observation_date=DATE'2025-07-01' or observation_date=DATE'2025-07-02' or observation_date=DATE'2025-07-03' or observation_date=DATE'2025-07-04' or observation_date=DATE'2025-07-05' or observation_date=DATE'2025-07-06' or observation_date=DATE'2025-07-07' or observation_date=DATE'2025-07-08' or observation_date=DATE'2025-07-09' or observation_date=DATE'2025-07-10' or observation_date=DATE'2025-07-11' or observation_date=DATE'2025-07-12' or observation_date=DATE'2025-07-13' or observation_date=DATE'2025-07-14' or observation_date=DATE'2025-07-15' or observation_date=DATE'2025-07-16' or observation_date=DATE'2025-07-17' or observation_date=DATE'2025-07-18' or observation_date=DATE'2025-07-19'
  
[0m13:50:25.363610 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ec23da82-e088-4baa-aef6-171e4342fcdb
[0m13:50:27.156139 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m13:50:27.161214 [debug] [Thread-1 (]: BATCH PROCESSING: 3 OF 4
[0m13:50:27.162630 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:50:27.163100 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    insert into "AwsDataCatalog"."silver"."openmeteo_silver" ("location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date")
                select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-07-20' or observation_date=DATE'2025-07-21' or observation_date=DATE'2025-07-22' or observation_date=DATE'2025-07-23' or observation_date=DATE'2025-07-24' or observation_date=DATE'2025-07-25' or observation_date=DATE'2025-07-26' or observation_date=DATE'2025-07-27' or observation_date=DATE'2025-07-28' or observation_date=DATE'2025-07-29' or observation_date=DATE'2025-07-30' or observation_date=DATE'2025-07-31' or observation_date=DATE'2025-08-01' or observation_date=DATE'2025-08-02' or observation_date=DATE'2025-08-03' or observation_date=DATE'2025-08-04' or observation_date=DATE'2025-08-05' or observation_date=DATE'2025-08-06' or observation_date=DATE'2025-08-07' or observation_date=DATE'2025-08-08' or observation_date=DATE'2025-08-09' or observation_date=DATE'2025-08-10' or observation_date=DATE'2025-08-11' or observation_date=DATE'2025-08-12' or observation_date=DATE'2025-08-13' or observation_date=DATE'2025-08-14' or observation_date=DATE'2025-08-15' or observation_date=DATE'2025-08-16' or observation_date=DATE'2025-08-17' or observation_date=DATE'2025-08-18' or observation_date=DATE'2025-08-19' or observation_date=DATE'2025-08-20' or observation_date=DATE'2025-08-21' or observation_date=DATE'2025-08-22' or observation_date=DATE'2025-08-23' or observation_date=DATE'2025-08-24' or observation_date=DATE'2025-08-25' or observation_date=DATE'2025-08-26' or observation_date=DATE'2025-08-27' or observation_date=DATE'2025-08-28' or observation_date=DATE'2025-08-29' or observation_date=DATE'2025-08-30' or observation_date=DATE'2025-08-31' or observation_date=DATE'2025-09-01' or observation_date=DATE'2025-09-02' or observation_date=DATE'2025-09-03' or observation_date=DATE'2025-09-04' or observation_date=DATE'2025-09-05' or observation_date=DATE'2025-09-06' or observation_date=DATE'2025-09-07' or observation_date=DATE'2025-09-08' or observation_date=DATE'2025-09-09' or observation_date=DATE'2025-09-10' or observation_date=DATE'2025-09-11' or observation_date=DATE'2025-09-12' or observation_date=DATE'2025-09-13' or observation_date=DATE'2025-09-14' or observation_date=DATE'2025-09-15' or observation_date=DATE'2025-09-16' or observation_date=DATE'2025-09-17' or observation_date=DATE'2025-09-18' or observation_date=DATE'2025-09-19' or observation_date=DATE'2025-09-20' or observation_date=DATE'2025-09-21' or observation_date=DATE'2025-09-22' or observation_date=DATE'2025-09-23' or observation_date=DATE'2025-09-24' or observation_date=DATE'2025-09-25' or observation_date=DATE'2025-09-26' or observation_date=DATE'2025-09-27' or observation_date=DATE'2025-09-28' or observation_date=DATE'2025-09-29' or observation_date=DATE'2025-09-30' or observation_date=DATE'2025-10-01' or observation_date=DATE'2025-10-02' or observation_date=DATE'2025-10-03' or observation_date=DATE'2025-10-04' or observation_date=DATE'2025-10-05' or observation_date=DATE'2025-10-06' or observation_date=DATE'2025-10-07' or observation_date=DATE'2025-10-08' or observation_date=DATE'2025-10-09' or observation_date=DATE'2025-10-10' or observation_date=DATE'2025-10-11' or observation_date=DATE'2025-10-12' or observation_date=DATE'2025-10-13' or observation_date=DATE'2025-10-14' or observation_date=DATE'2025-10-15' or observation_date=DATE'2025-10-16' or observation_date=DATE'2025-10-17' or observation_date=DATE'2025-10-18' or observation_date=DATE'2025-10-19' or observation_date=DATE'2025-10-20' or observation_date=DATE'2025-10-21' or observation_date=DATE'2025-10-22' or observation_date=DATE'2025-10-23' or observation_date=DATE'2025-10-24' or observation_date=DATE'2025-10-25' or observation_date=DATE'2025-10-26' or observation_date=DATE'2025-10-27'
  
[0m13:50:27.375408 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 34d3c6ab-e531-4f0e-bfe4-9b604f6fa9e0
[0m13:50:29.151679 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m13:50:29.158701 [debug] [Thread-1 (]: BATCH PROCESSING: 4 OF 4
[0m13:50:29.163640 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:50:29.164841 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    insert into "AwsDataCatalog"."silver"."openmeteo_silver" ("location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date")
                select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-10-28' or observation_date=DATE'2025-10-29' or observation_date=DATE'2025-10-30' or observation_date=DATE'2025-10-31' or observation_date=DATE'2025-11-01' or observation_date=DATE'2025-11-02' or observation_date=DATE'2025-11-03' or observation_date=DATE'2025-11-04' or observation_date=DATE'2025-11-05' or observation_date=DATE'2025-11-06' or observation_date=DATE'2025-11-07' or observation_date=DATE'2025-11-08' or observation_date=DATE'2025-11-09' or observation_date=DATE'2025-11-10' or observation_date=DATE'2025-11-11' or observation_date=DATE'2025-11-12' or observation_date=DATE'2025-11-13' or observation_date=DATE'2025-11-14' or observation_date=DATE'2025-11-15' or observation_date=DATE'2025-11-16' or observation_date=DATE'2025-11-17' or observation_date=DATE'2025-11-18' or observation_date=DATE'2025-11-19' or observation_date=DATE'2025-11-20' or observation_date=DATE'2025-11-21' or observation_date=DATE'2025-11-22' or observation_date=DATE'2025-11-23' or observation_date=DATE'2025-11-24' or observation_date=DATE'2025-11-25' or observation_date=DATE'2025-11-26' or observation_date=DATE'2025-11-27' or observation_date=DATE'2025-11-28' or observation_date=DATE'2025-11-29' or observation_date=DATE'2025-11-30' or observation_date=DATE'2025-12-01' or observation_date=DATE'2025-12-02' or observation_date=DATE'2025-12-03' or observation_date=DATE'2025-12-04' or observation_date=DATE'2025-12-05' or observation_date=DATE'2025-12-06' or observation_date=DATE'2025-12-07' or observation_date=DATE'2025-12-08' or observation_date=DATE'2025-12-09' or observation_date=DATE'2025-12-10' or observation_date=DATE'2025-12-11' or observation_date=DATE'2025-12-12' or observation_date=DATE'2025-12-13' or observation_date=DATE'2025-12-14' or observation_date=DATE'2025-12-15' or observation_date=DATE'2025-12-16' or observation_date=DATE'2025-12-17' or observation_date=DATE'2025-12-18' or observation_date=DATE'2025-12-19' or observation_date=DATE'2025-12-20' or observation_date=DATE'2025-12-21' or observation_date=DATE'2025-12-22' or observation_date=DATE'2025-12-23' or observation_date=DATE'2025-12-24' or observation_date=DATE'2025-12-25' or observation_date=DATE'2025-12-26' or observation_date=DATE'2025-12-27' or observation_date=DATE'2025-12-28' or observation_date=DATE'2025-12-29' or observation_date=DATE'2025-12-30' or observation_date=DATE'2025-12-31' or observation_date=DATE'2026-01-01' or observation_date=DATE'2026-01-02' or observation_date=DATE'2026-01-03' or observation_date=DATE'2026-01-04' or observation_date=DATE'2026-01-05' or observation_date=DATE'2026-01-06' or observation_date=DATE'2026-01-07' or observation_date=DATE'2026-01-08' or observation_date=DATE'2026-01-09' or observation_date=DATE'2026-01-10' or observation_date=DATE'2026-01-11' or observation_date=DATE'2026-01-12' or observation_date=DATE'2026-01-13' or observation_date=DATE'2026-01-14' or observation_date=DATE'2026-01-15' or observation_date=DATE'2026-01-16' or observation_date=DATE'2026-01-17' or observation_date=DATE'2026-01-18' or observation_date=DATE'2026-01-19' or observation_date=DATE'2026-01-20' or observation_date=DATE'2026-01-21' or observation_date=DATE'2026-01-22' or observation_date=DATE'2026-01-23' or observation_date=DATE'2026-01-24' or observation_date=DATE'2026-01-25' or observation_date=DATE'2026-01-26' or observation_date=DATE'2026-01-27' or observation_date=DATE'2026-01-28' or observation_date=DATE'2026-01-29' or observation_date=DATE'2026-01-30'
  
[0m13:50:29.485248 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 42a3c2c0-3768-47dc-b30f-7f3831ae0281
[0m13:50:31.478376 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m13:50:32.582087 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver__tmp_not_partitioned
[0m13:50:32.584618 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:50:32.586105 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:50:33.717556 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver__tmp_not_partitioned
[0m13:50:33.719072 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:50:33.720981 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver
[0m13:50:34.609015 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:50:36.020323 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
[0m13:50:36.033190 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:50:36.035726 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m13:50:36.322970 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ae8d2403-0264-44cd-abec-a87c8a2bc5a4
[0m13:50:38.123070 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:50:38.135225 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m13:50:38.141384 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:50:38.142187 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '"AwsDataCatalog"."silver"."openmeteo_silver" with many partitions created';
[0m13:50:38.368159 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c132b437-50b9-4fc2-b8f2-f55510025846
[0m13:50:40.192363 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:50:40.209016 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 13:50:04.354383 => 13:50:40.206054
[0m13:50:40.210463 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m13:50:40.213762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e8d06ba-d7bf-46de-a1ed-3b2470222f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b9c950>]}
[0m13:50:40.216126 [info ] [Thread-1 (]: 3 of 5 OK created sql table model silver.openmeteo_silver ...................... [[32mOK -1[0m in 35.87s]
[0m13:50:40.217653 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m13:50:40.219333 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m13:50:40.222364 [info ] [Thread-1 (]: 4 of 5 START sql table model silver.openweather_silver ......................... [RUN]
[0m13:50:40.233038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m13:50:40.233833 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m13:50:40.247897 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m13:50:40.249639 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 13:50:40.234320 => 13:50:40.249460
[0m13:50:40.249962 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m13:50:40.253504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:41.541068 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m13:50:41.544055 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:50:41.545454 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:50:42.714771 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m13:50:42.716791 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:50:42.717564 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver/7bee7dc5-2059-4b8a-83b5-e196bb56f159
[0m13:50:43.318486 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver/7bee7dc5-2059-4b8a-83b5-e196bb56f159', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/7bee7dc5-2059-4b8a-83b5-e196bb56f159/'
[0m13:50:45.537217 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m13:50:45.551844 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:50:46.162842 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/'
[0m13:50:46.915551 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  from_unixtime(epoch_ts) AS dt_timestamp,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date,
  CAST(from_unixtime(epoch_ts) AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."openweather_bronze"
[0m13:50:47.442976 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 96fa824a-42bf-4f19-a363-bc26f121757a
[0m13:50:50.391673 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":3106,"data_scanned_in_bytes":1006163}
[0m13:50:50.403819 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m13:50:50.404385 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m13:50:50.712618 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4169cb70-0316-4fd0-9437-a9f176202ee8
[0m13:50:51.024272 [error] [MainThread]: CANCEL query list_AwsDataCatalog ............................................... [[31mCANCEL[0m]
[0m13:50:51.025224 [error] [MainThread]: CANCEL query model.silver.openweather_silver ................................... [[31mCANCEL[0m]
[0m13:50:52.501329 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:50:52.508011 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m13:50:52.510850 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m13:50:52.511567 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":3106,"data_scanned_in_bytes":1006163}';
[0m13:50:52.763872 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3a2c4dfc-62f3-4698-902d-cc83ac1989db
[0m13:50:54.626529 [debug] [Thread-1 (]: SQL status: OK 3106 in 2.0 seconds
[0m13:50:54.639277 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 13:50:40.250139 => 13:50:54.638899
[0m13:50:54.640097 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m13:50:54.641826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e8d06ba-d7bf-46de-a1ed-3b2470222f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa928d390>]}
[0m13:50:54.643092 [info ] [Thread-1 (]: 4 of 5 OK created sql table model silver.openweather_silver .................... [[32mOK 3106[0m in 14.42s]
[0m13:50:54.643843 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m13:50:54.645234 [info ] [MainThread]: 
[0m13:50:54.646402 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m13:50:54.646688 [info ] [MainThread]: 
[0m13:50:54.647099 [error] [MainThread]:   NOT_SUPPORTED: Unsupported Hive type: timestamp(3) with time zone. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/90e95d42-c696-4e92-987f-f880ad63b962' before retrying. Athena will not delete data in your account.
[0m13:50:54.647451 [info ] [MainThread]: 
[0m13:50:54.647820 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:50:54.648200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:54.648407 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m13:50:54.648577 [debug] [MainThread]: Connection 'model.silver.openweather_silver' was properly closed.
[0m13:50:54.654276 [info ] [MainThread]: 
[0m13:50:54.654745 [info ] [MainThread]: Finished running 3 table models in 0 hours 4 minutes and 28.14 seconds (268.14s).
[0m13:50:54.658174 [error] [MainThread]: Encountered an error:

[0m13:50:54.663269 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 474, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 435, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 359, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 291, in run_queue
    self.job_queue.join()
  File "/usr/local/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m13:50:54.674874 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 268.769, "process_user_time": 7.309758, "process_kernel_time": 0.895552, "process_mem_max_rss": "201240", "process_out_blocks": "2106", "command_success": false, "process_in_blocks": "0"}
[0m13:50:54.681509 [debug] [MainThread]: Command `dbt run` failed at 13:50:54.680991 after 268.78 seconds
[0m13:50:54.683007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2b16810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb07e0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7cf97d0>]}
[0m13:50:54.683513 [debug] [MainThread]: Flushing usage events
[0m13:51:12.357839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f661d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f64f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f67a90>]}


============================== 13:51:12.362499 | 191bcd46-8335-4be7-bd2c-3c4519577930 ==============================
[0m13:51:12.362499 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:51:12.362956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profile silver --select path:models/silver', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:51:12.619421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa907bdd0>]}
[0m13:51:12.664692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa117ed0>]}
[0m13:51:12.665381 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m13:51:12.671572 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m13:51:12.703150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:51:12.703771 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/noaa_silver.sql
[0m13:51:12.774119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f85250>]}
[0m13:51:12.781725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e58110>]}
[0m13:51:12.782034 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m13:51:12.782320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8dbef10>]}
[0m13:51:12.783610 [info ] [MainThread]: 
[0m13:51:12.784230 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m13:51:12.785585 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m13:51:12.786124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:13.351922 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m13:51:13.355436 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_silver'
[0m13:51:13.356094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:14.896773 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m13:51:14.903106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m13:51:14.908006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:16.182833 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m13:51:16.184108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m13:51:16.185014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:17.549995 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m13:51:17.552159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa907ccd0>]}
[0m13:51:17.553438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:51:17.554248 [info ] [MainThread]: 
[0m13:51:17.558061 [debug] [Thread-1 (]: Began running node model.silver.eia_silver
[0m13:51:17.558775 [info ] [Thread-1 (]: 1 of 5 START sql table model silver.eia_silver ................................. [RUN]
[0m13:51:17.559700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.eia_silver)
[0m13:51:17.560199 [debug] [Thread-1 (]: Began compiling node model.silver.eia_silver
[0m13:51:17.568368 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.eia_silver"
[0m13:51:17.571533 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (compile): 13:51:17.560512 => 13:51:17.571270
[0m13:51:17.571968 [debug] [Thread-1 (]: Began executing node model.silver.eia_silver
[0m13:51:17.609774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:18.735193 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m13:51:18.736045 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:51:18.738580 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:51:19.899243 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : eia_silver
[0m13:51:19.900711 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:51:19.901609 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."eia_silver" is stored in s3://climate-energy-raw-data/silver/eia_silver
[0m13:51:20.715918 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/eia_silver', bucket='climate-energy-raw-data', prefix='silver/eia_silver/'
[0m13:51:23.026089 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."eia_silver"
[0m13:51:23.067661 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:51:23.682123 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:51:23.683789 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */


    create table "AwsDataCatalog"."silver"."eia_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/eia_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  state,
  sector,
  price,
  date_parse(period, '%Y-%m') AS dt_timestamp,
  ingestion_timestamp,
  CAST(date_parse(period, '%Y-%m') AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."eia_bronze"
[0m13:51:24.236528 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7f20f82d-07e5-46c8-81c7-fb2290ec1226
[0m13:51:27.155767 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":27549,"data_scanned_in_bytes":5305034}
[0m13:51:27.170963 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m13:51:27.171542 [debug] [Thread-1 (]: On model.silver.eia_silver: alter table `AwsDataCatalog`.`silver`.`eia_silver` set tblproperties ('classification' = 'parquet')
[0m13:51:27.507992 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c65c27aa-ab76-4d5e-bff2-8f39306e882c
[0m13:51:29.282080 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:51:29.292541 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.eia_silver"
[0m13:51:29.297344 [debug] [Thread-1 (]: Using athena connection "model.silver.eia_silver"
[0m13:51:29.298171 [debug] [Thread-1 (]: On model.silver.eia_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.eia_silver"} */
SELECT '{"rowcount":27549,"data_scanned_in_bytes":5305034}';
[0m13:51:29.530773 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3d95bd15-7e33-47ba-a06f-7e22bdfa31df
[0m13:51:31.419445 [debug] [Thread-1 (]: SQL status: OK 27549 in 2.0 seconds
[0m13:51:31.439177 [debug] [Thread-1 (]: Timing info for model.silver.eia_silver (execute): 13:51:17.572243 => 13:51:31.438189
[0m13:51:31.440550 [debug] [Thread-1 (]: On model.silver.eia_silver: Close
[0m13:51:31.443613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be0a950>]}
[0m13:51:31.446519 [info ] [Thread-1 (]: 1 of 5 OK created sql table model silver.eia_silver ............................ [[32mOK 27549[0m in 13.88s]
[0m13:51:31.447941 [debug] [Thread-1 (]: Finished running node model.silver.eia_silver
[0m13:51:31.450689 [debug] [Thread-1 (]: Began running node model.silver.noaa_silver
[0m13:51:31.457394 [info ] [Thread-1 (]: 2 of 5 START sql table model silver.noaa_silver ................................ [RUN]
[0m13:51:31.461076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.eia_silver, now model.silver.noaa_silver)
[0m13:51:31.461835 [debug] [Thread-1 (]: Began compiling node model.silver.noaa_silver
[0m13:51:31.470474 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.noaa_silver"
[0m13:51:31.473628 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (compile): 13:51:31.462238 => 13:51:31.473155
[0m13:51:31.474482 [debug] [Thread-1 (]: Began executing node model.silver.noaa_silver
[0m13:51:31.480031 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:51:31.480839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:32.201382 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:51:32.202953 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */


    create table "AwsDataCatalog"."silver"."noaa_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/noaa_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  station_id,
  datatype as metric,
  value / 10.0 as metric_value,
  CAST(from_iso8601_timestamp(date_str) AS timestamp) AS dt_timestamp,
  ingestion_timestamp,
  CAST(from_iso8601_timestamp(date_str) AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."noaa_bronze"
[0m13:51:32.702702 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a1fa1c54-dec0-40a1-86f1-f5a31add9cc5
[0m13:51:35.716596 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2087,"data_scanned_in_bytes":457739}
[0m13:51:35.727192 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m13:51:35.727618 [debug] [Thread-1 (]: On model.silver.noaa_silver: alter table `AwsDataCatalog`.`silver`.`noaa_silver` set tblproperties ('classification' = 'parquet')
[0m13:51:36.003891 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 339722fe-fedc-4d66-a41b-0299642dbb99
[0m13:51:37.745376 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:51:37.757765 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.noaa_silver"
[0m13:51:37.760288 [debug] [Thread-1 (]: Using athena connection "model.silver.noaa_silver"
[0m13:51:37.760664 [debug] [Thread-1 (]: On model.silver.noaa_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.noaa_silver"} */
SELECT '{"rowcount":2087,"data_scanned_in_bytes":457739}';
[0m13:51:37.973624 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 07bb48d9-9661-4517-85c3-4dd0e8bb9b7f
[0m13:51:39.732978 [debug] [Thread-1 (]: SQL status: OK 2087 in 2.0 seconds
[0m13:51:39.738760 [debug] [Thread-1 (]: Timing info for model.silver.noaa_silver (execute): 13:51:31.475082 => 13:51:39.738262
[0m13:51:39.739502 [debug] [Thread-1 (]: On model.silver.noaa_silver: Close
[0m13:51:39.740982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa241ae50>]}
[0m13:51:39.742338 [info ] [Thread-1 (]: 2 of 5 OK created sql table model silver.noaa_silver ........................... [[32mOK 2087[0m in 8.28s]
[0m13:51:39.743159 [debug] [Thread-1 (]: Finished running node model.silver.noaa_silver
[0m13:51:39.743884 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m13:51:39.744790 [info ] [Thread-1 (]: 3 of 5 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m13:51:39.747843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.noaa_silver, now model.silver.openmeteo_silver)
[0m13:51:39.748289 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m13:51:39.755933 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m13:51:39.761774 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 13:51:39.748551 => 13:51:39.761535
[0m13:51:39.762963 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m13:51:39.765990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:41.549384 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m13:51:41.550852 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:51:41.552279 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:51:42.630909 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m13:51:42.632003 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:51:42.633068 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver
[0m13:51:43.209388 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:51:45.042271 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m13:51:45.057635 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:51:45.577104 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:51:45.579059 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temperature_min,
  temperature_min * (9.0 / 5.0) + 32.0 as temperature_min_f,
  precipitation_mm as precipitation,
  LEAST(100, precipitation_mm * 10) as humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  CAST(date_str AS date) AS dt_timestamp,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date,
  CAST(date_str AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m13:51:46.169715 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ede9fb93-3be2-43b3-8bcc-84f13afa5d5a
[0m13:51:47.538262 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: HIVE_TOO_MANY_OPEN_PARTITIONS: Exceeded limit of 100 open writers for partitions/buckets. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/ede9fb93-3be2-43b3-8bcc-84f13afa5d5a' before retrying. Athena will not delete data in your account.
[0m13:51:47.539128 [debug] [Thread-1 (]: COMPILED CODE RESULT: TOO_MANY_OPEN_PARTITIONS
[0m13:51:48.640333 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exists - Ignoring
[0m13:51:48.643102 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exist - Ignoring
[0m13:51:48.644348 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:51:49.778266 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exists - Ignoring
[0m13:51:49.780857 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exist - Ignoring
[0m13:51:50.925289 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exist and will not be deleted, ignoring
[0m13:51:50.928467 [debug] [Thread-1 (]: CREATE NON-PARTIONED STAGING TABLE: "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
[0m13:51:50.930570 [debug] [Thread-1 (]: Skip partitioning: True
[0m13:51:51.420798 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:51:51.429282 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:51:51.430501 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    

    create table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temperature_min,
  temperature_min * (9.0 / 5.0) + 32.0 as temperature_min_f,
  precipitation_mm as precipitation,
  LEAST(100, precipitation_mm * 10) as humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  CAST(date_str AS date) AS dt_timestamp,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date,
  CAST(date_str AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."openmeteo_bronze"
  
[0m13:51:51.659841 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1bfa500f-4d79-4e7c-a733-152cb2776d18
[0m13:51:54.649114 [debug] [Thread-1 (]: SQL status: OK 37427 in 3.0 seconds
[0m13:51:54.679137 [debug] [Thread-1 (]: PARTITIONED KEYS: observation_date
[0m13:51:54.680056 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:51:54.680428 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
select distinct observation_date from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" order by observation_date;
[0m13:51:54.942986 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 9d9e3e41-5cdf-4179-a7b8-7388574336bf
[0m13:51:56.947378 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:51:57.014068 [debug] [Thread-1 (]: TOTAL PARTITIONS TO PROCESS: 395
[0m13:51:57.014785 [debug] [Thread-1 (]: BATCHES TO PROCESS: 4
[0m13:51:58.108724 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver__tmp_not_partitioned
[0m13:51:58.109528 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:51:58.109866 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Columns in relation openmeteo_silver__tmp_not_partitioned: [{'Name': 'location', 'Type': 'string', 'Parameters': {}}, {'Name': 'temperature_c', 'Type': 'double', 'Parameters': {}}, {'Name': 'temperature_f', 'Type': 'double', 'Parameters': {}}, {'Name': 'temperature_min', 'Type': 'double', 'Parameters': {}}, {'Name': 'temperature_min_f', 'Type': 'double', 'Parameters': {}}, {'Name': 'precipitation', 'Type': 'double', 'Parameters': {}}, {'Name': 'humidity', 'Type': 'double', 'Parameters': {}}, {'Name': 'windspeed_mps', 'Type': 'double', 'Parameters': {}}, {'Name': 'windspeed_mph', 'Type': 'double', 'Parameters': {}}, {'Name': 'dt_timestamp', 'Type': 'date', 'Parameters': {}}, {'Name': 'ingestion_date', 'Type': 'date', 'Parameters': {}}, {'Name': 'observation_date', 'Type': 'date', 'Parameters': {}}]
[0m13:51:58.111191 [debug] [Thread-1 (]: BATCH PROCESSING: 1 OF 4
[0m13:51:58.112253 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:51:58.800756 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/'
[0m13:51:59.539828 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:51:59.541794 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    

    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-01-01' or observation_date=DATE'2025-01-02' or observation_date=DATE'2025-01-03' or observation_date=DATE'2025-01-04' or observation_date=DATE'2025-01-05' or observation_date=DATE'2025-01-06' or observation_date=DATE'2025-01-07' or observation_date=DATE'2025-01-08' or observation_date=DATE'2025-01-09' or observation_date=DATE'2025-01-10' or observation_date=DATE'2025-01-11' or observation_date=DATE'2025-01-12' or observation_date=DATE'2025-01-13' or observation_date=DATE'2025-01-14' or observation_date=DATE'2025-01-15' or observation_date=DATE'2025-01-16' or observation_date=DATE'2025-01-17' or observation_date=DATE'2025-01-18' or observation_date=DATE'2025-01-19' or observation_date=DATE'2025-01-20' or observation_date=DATE'2025-01-21' or observation_date=DATE'2025-01-22' or observation_date=DATE'2025-01-23' or observation_date=DATE'2025-01-24' or observation_date=DATE'2025-01-25' or observation_date=DATE'2025-01-26' or observation_date=DATE'2025-01-27' or observation_date=DATE'2025-01-28' or observation_date=DATE'2025-01-29' or observation_date=DATE'2025-01-30' or observation_date=DATE'2025-01-31' or observation_date=DATE'2025-02-01' or observation_date=DATE'2025-02-02' or observation_date=DATE'2025-02-03' or observation_date=DATE'2025-02-04' or observation_date=DATE'2025-02-05' or observation_date=DATE'2025-02-06' or observation_date=DATE'2025-02-07' or observation_date=DATE'2025-02-08' or observation_date=DATE'2025-02-09' or observation_date=DATE'2025-02-10' or observation_date=DATE'2025-02-11' or observation_date=DATE'2025-02-12' or observation_date=DATE'2025-02-13' or observation_date=DATE'2025-02-14' or observation_date=DATE'2025-02-15' or observation_date=DATE'2025-02-16' or observation_date=DATE'2025-02-17' or observation_date=DATE'2025-02-18' or observation_date=DATE'2025-02-19' or observation_date=DATE'2025-02-20' or observation_date=DATE'2025-02-21' or observation_date=DATE'2025-02-22' or observation_date=DATE'2025-02-23' or observation_date=DATE'2025-02-24' or observation_date=DATE'2025-02-25' or observation_date=DATE'2025-02-26' or observation_date=DATE'2025-02-27' or observation_date=DATE'2025-02-28' or observation_date=DATE'2025-03-01' or observation_date=DATE'2025-03-02' or observation_date=DATE'2025-03-03' or observation_date=DATE'2025-03-04' or observation_date=DATE'2025-03-05' or observation_date=DATE'2025-03-06' or observation_date=DATE'2025-03-07' or observation_date=DATE'2025-03-08' or observation_date=DATE'2025-03-09' or observation_date=DATE'2025-03-10' or observation_date=DATE'2025-03-11' or observation_date=DATE'2025-03-12' or observation_date=DATE'2025-03-13' or observation_date=DATE'2025-03-14' or observation_date=DATE'2025-03-15' or observation_date=DATE'2025-03-16' or observation_date=DATE'2025-03-17' or observation_date=DATE'2025-03-18' or observation_date=DATE'2025-03-19' or observation_date=DATE'2025-03-20' or observation_date=DATE'2025-03-21' or observation_date=DATE'2025-03-22' or observation_date=DATE'2025-03-23' or observation_date=DATE'2025-03-24' or observation_date=DATE'2025-03-25' or observation_date=DATE'2025-03-26' or observation_date=DATE'2025-03-27' or observation_date=DATE'2025-03-28' or observation_date=DATE'2025-03-29' or observation_date=DATE'2025-03-30' or observation_date=DATE'2025-03-31' or observation_date=DATE'2025-04-01' or observation_date=DATE'2025-04-02' or observation_date=DATE'2025-04-03' or observation_date=DATE'2025-04-04' or observation_date=DATE'2025-04-05' or observation_date=DATE'2025-04-06' or observation_date=DATE'2025-04-07' or observation_date=DATE'2025-04-08' or observation_date=DATE'2025-04-09' or observation_date=DATE'2025-04-10'
  
[0m13:51:59.797631 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 48edf629-15a4-4cca-bf08-5354bb3574ce
[0m13:52:01.825358 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m13:52:01.830041 [debug] [Thread-1 (]: BATCH PROCESSING: 2 OF 4
[0m13:52:01.832469 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:52:01.833693 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    insert into "AwsDataCatalog"."silver"."openmeteo_silver" ("location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date")
                select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-04-11' or observation_date=DATE'2025-04-12' or observation_date=DATE'2025-04-13' or observation_date=DATE'2025-04-14' or observation_date=DATE'2025-04-15' or observation_date=DATE'2025-04-16' or observation_date=DATE'2025-04-17' or observation_date=DATE'2025-04-18' or observation_date=DATE'2025-04-19' or observation_date=DATE'2025-04-20' or observation_date=DATE'2025-04-21' or observation_date=DATE'2025-04-22' or observation_date=DATE'2025-04-23' or observation_date=DATE'2025-04-24' or observation_date=DATE'2025-04-25' or observation_date=DATE'2025-04-26' or observation_date=DATE'2025-04-27' or observation_date=DATE'2025-04-28' or observation_date=DATE'2025-04-29' or observation_date=DATE'2025-04-30' or observation_date=DATE'2025-05-01' or observation_date=DATE'2025-05-02' or observation_date=DATE'2025-05-03' or observation_date=DATE'2025-05-04' or observation_date=DATE'2025-05-05' or observation_date=DATE'2025-05-06' or observation_date=DATE'2025-05-07' or observation_date=DATE'2025-05-08' or observation_date=DATE'2025-05-09' or observation_date=DATE'2025-05-10' or observation_date=DATE'2025-05-11' or observation_date=DATE'2025-05-12' or observation_date=DATE'2025-05-13' or observation_date=DATE'2025-05-14' or observation_date=DATE'2025-05-15' or observation_date=DATE'2025-05-16' or observation_date=DATE'2025-05-17' or observation_date=DATE'2025-05-18' or observation_date=DATE'2025-05-19' or observation_date=DATE'2025-05-20' or observation_date=DATE'2025-05-21' or observation_date=DATE'2025-05-22' or observation_date=DATE'2025-05-23' or observation_date=DATE'2025-05-24' or observation_date=DATE'2025-05-25' or observation_date=DATE'2025-05-26' or observation_date=DATE'2025-05-27' or observation_date=DATE'2025-05-28' or observation_date=DATE'2025-05-29' or observation_date=DATE'2025-05-30' or observation_date=DATE'2025-05-31' or observation_date=DATE'2025-06-01' or observation_date=DATE'2025-06-02' or observation_date=DATE'2025-06-03' or observation_date=DATE'2025-06-04' or observation_date=DATE'2025-06-05' or observation_date=DATE'2025-06-06' or observation_date=DATE'2025-06-07' or observation_date=DATE'2025-06-08' or observation_date=DATE'2025-06-09' or observation_date=DATE'2025-06-10' or observation_date=DATE'2025-06-11' or observation_date=DATE'2025-06-12' or observation_date=DATE'2025-06-13' or observation_date=DATE'2025-06-14' or observation_date=DATE'2025-06-15' or observation_date=DATE'2025-06-16' or observation_date=DATE'2025-06-17' or observation_date=DATE'2025-06-18' or observation_date=DATE'2025-06-19' or observation_date=DATE'2025-06-20' or observation_date=DATE'2025-06-21' or observation_date=DATE'2025-06-22' or observation_date=DATE'2025-06-23' or observation_date=DATE'2025-06-24' or observation_date=DATE'2025-06-25' or observation_date=DATE'2025-06-26' or observation_date=DATE'2025-06-27' or observation_date=DATE'2025-06-28' or observation_date=DATE'2025-06-29' or observation_date=DATE'2025-06-30' or observation_date=DATE'2025-07-01' or observation_date=DATE'2025-07-02' or observation_date=DATE'2025-07-03' or observation_date=DATE'2025-07-04' or observation_date=DATE'2025-07-05' or observation_date=DATE'2025-07-06' or observation_date=DATE'2025-07-07' or observation_date=DATE'2025-07-08' or observation_date=DATE'2025-07-09' or observation_date=DATE'2025-07-10' or observation_date=DATE'2025-07-11' or observation_date=DATE'2025-07-12' or observation_date=DATE'2025-07-13' or observation_date=DATE'2025-07-14' or observation_date=DATE'2025-07-15' or observation_date=DATE'2025-07-16' or observation_date=DATE'2025-07-17' or observation_date=DATE'2025-07-18' or observation_date=DATE'2025-07-19'
  
[0m13:52:02.053550 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 49d192a4-5876-4a49-8618-ae701b3cce29
[0m13:52:03.832596 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m13:52:03.844225 [debug] [Thread-1 (]: BATCH PROCESSING: 3 OF 4
[0m13:52:03.848666 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:52:03.851274 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    insert into "AwsDataCatalog"."silver"."openmeteo_silver" ("location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date")
                select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-07-20' or observation_date=DATE'2025-07-21' or observation_date=DATE'2025-07-22' or observation_date=DATE'2025-07-23' or observation_date=DATE'2025-07-24' or observation_date=DATE'2025-07-25' or observation_date=DATE'2025-07-26' or observation_date=DATE'2025-07-27' or observation_date=DATE'2025-07-28' or observation_date=DATE'2025-07-29' or observation_date=DATE'2025-07-30' or observation_date=DATE'2025-07-31' or observation_date=DATE'2025-08-01' or observation_date=DATE'2025-08-02' or observation_date=DATE'2025-08-03' or observation_date=DATE'2025-08-04' or observation_date=DATE'2025-08-05' or observation_date=DATE'2025-08-06' or observation_date=DATE'2025-08-07' or observation_date=DATE'2025-08-08' or observation_date=DATE'2025-08-09' or observation_date=DATE'2025-08-10' or observation_date=DATE'2025-08-11' or observation_date=DATE'2025-08-12' or observation_date=DATE'2025-08-13' or observation_date=DATE'2025-08-14' or observation_date=DATE'2025-08-15' or observation_date=DATE'2025-08-16' or observation_date=DATE'2025-08-17' or observation_date=DATE'2025-08-18' or observation_date=DATE'2025-08-19' or observation_date=DATE'2025-08-20' or observation_date=DATE'2025-08-21' or observation_date=DATE'2025-08-22' or observation_date=DATE'2025-08-23' or observation_date=DATE'2025-08-24' or observation_date=DATE'2025-08-25' or observation_date=DATE'2025-08-26' or observation_date=DATE'2025-08-27' or observation_date=DATE'2025-08-28' or observation_date=DATE'2025-08-29' or observation_date=DATE'2025-08-30' or observation_date=DATE'2025-08-31' or observation_date=DATE'2025-09-01' or observation_date=DATE'2025-09-02' or observation_date=DATE'2025-09-03' or observation_date=DATE'2025-09-04' or observation_date=DATE'2025-09-05' or observation_date=DATE'2025-09-06' or observation_date=DATE'2025-09-07' or observation_date=DATE'2025-09-08' or observation_date=DATE'2025-09-09' or observation_date=DATE'2025-09-10' or observation_date=DATE'2025-09-11' or observation_date=DATE'2025-09-12' or observation_date=DATE'2025-09-13' or observation_date=DATE'2025-09-14' or observation_date=DATE'2025-09-15' or observation_date=DATE'2025-09-16' or observation_date=DATE'2025-09-17' or observation_date=DATE'2025-09-18' or observation_date=DATE'2025-09-19' or observation_date=DATE'2025-09-20' or observation_date=DATE'2025-09-21' or observation_date=DATE'2025-09-22' or observation_date=DATE'2025-09-23' or observation_date=DATE'2025-09-24' or observation_date=DATE'2025-09-25' or observation_date=DATE'2025-09-26' or observation_date=DATE'2025-09-27' or observation_date=DATE'2025-09-28' or observation_date=DATE'2025-09-29' or observation_date=DATE'2025-09-30' or observation_date=DATE'2025-10-01' or observation_date=DATE'2025-10-02' or observation_date=DATE'2025-10-03' or observation_date=DATE'2025-10-04' or observation_date=DATE'2025-10-05' or observation_date=DATE'2025-10-06' or observation_date=DATE'2025-10-07' or observation_date=DATE'2025-10-08' or observation_date=DATE'2025-10-09' or observation_date=DATE'2025-10-10' or observation_date=DATE'2025-10-11' or observation_date=DATE'2025-10-12' or observation_date=DATE'2025-10-13' or observation_date=DATE'2025-10-14' or observation_date=DATE'2025-10-15' or observation_date=DATE'2025-10-16' or observation_date=DATE'2025-10-17' or observation_date=DATE'2025-10-18' or observation_date=DATE'2025-10-19' or observation_date=DATE'2025-10-20' or observation_date=DATE'2025-10-21' or observation_date=DATE'2025-10-22' or observation_date=DATE'2025-10-23' or observation_date=DATE'2025-10-24' or observation_date=DATE'2025-10-25' or observation_date=DATE'2025-10-26' or observation_date=DATE'2025-10-27'
  
[0m13:52:04.110680 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f3887b31-bf45-4b1e-8d09-a7fedc93d645
[0m13:52:05.961083 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m13:52:05.968834 [debug] [Thread-1 (]: BATCH PROCESSING: 4 OF 4
[0m13:52:05.971587 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:52:05.972563 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    insert into "AwsDataCatalog"."silver"."openmeteo_silver" ("location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date")
                select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-10-28' or observation_date=DATE'2025-10-29' or observation_date=DATE'2025-10-30' or observation_date=DATE'2025-10-31' or observation_date=DATE'2025-11-01' or observation_date=DATE'2025-11-02' or observation_date=DATE'2025-11-03' or observation_date=DATE'2025-11-04' or observation_date=DATE'2025-11-05' or observation_date=DATE'2025-11-06' or observation_date=DATE'2025-11-07' or observation_date=DATE'2025-11-08' or observation_date=DATE'2025-11-09' or observation_date=DATE'2025-11-10' or observation_date=DATE'2025-11-11' or observation_date=DATE'2025-11-12' or observation_date=DATE'2025-11-13' or observation_date=DATE'2025-11-14' or observation_date=DATE'2025-11-15' or observation_date=DATE'2025-11-16' or observation_date=DATE'2025-11-17' or observation_date=DATE'2025-11-18' or observation_date=DATE'2025-11-19' or observation_date=DATE'2025-11-20' or observation_date=DATE'2025-11-21' or observation_date=DATE'2025-11-22' or observation_date=DATE'2025-11-23' or observation_date=DATE'2025-11-24' or observation_date=DATE'2025-11-25' or observation_date=DATE'2025-11-26' or observation_date=DATE'2025-11-27' or observation_date=DATE'2025-11-28' or observation_date=DATE'2025-11-29' or observation_date=DATE'2025-11-30' or observation_date=DATE'2025-12-01' or observation_date=DATE'2025-12-02' or observation_date=DATE'2025-12-03' or observation_date=DATE'2025-12-04' or observation_date=DATE'2025-12-05' or observation_date=DATE'2025-12-06' or observation_date=DATE'2025-12-07' or observation_date=DATE'2025-12-08' or observation_date=DATE'2025-12-09' or observation_date=DATE'2025-12-10' or observation_date=DATE'2025-12-11' or observation_date=DATE'2025-12-12' or observation_date=DATE'2025-12-13' or observation_date=DATE'2025-12-14' or observation_date=DATE'2025-12-15' or observation_date=DATE'2025-12-16' or observation_date=DATE'2025-12-17' or observation_date=DATE'2025-12-18' or observation_date=DATE'2025-12-19' or observation_date=DATE'2025-12-20' or observation_date=DATE'2025-12-21' or observation_date=DATE'2025-12-22' or observation_date=DATE'2025-12-23' or observation_date=DATE'2025-12-24' or observation_date=DATE'2025-12-25' or observation_date=DATE'2025-12-26' or observation_date=DATE'2025-12-27' or observation_date=DATE'2025-12-28' or observation_date=DATE'2025-12-29' or observation_date=DATE'2025-12-30' or observation_date=DATE'2025-12-31' or observation_date=DATE'2026-01-01' or observation_date=DATE'2026-01-02' or observation_date=DATE'2026-01-03' or observation_date=DATE'2026-01-04' or observation_date=DATE'2026-01-05' or observation_date=DATE'2026-01-06' or observation_date=DATE'2026-01-07' or observation_date=DATE'2026-01-08' or observation_date=DATE'2026-01-09' or observation_date=DATE'2026-01-10' or observation_date=DATE'2026-01-11' or observation_date=DATE'2026-01-12' or observation_date=DATE'2026-01-13' or observation_date=DATE'2026-01-14' or observation_date=DATE'2026-01-15' or observation_date=DATE'2026-01-16' or observation_date=DATE'2026-01-17' or observation_date=DATE'2026-01-18' or observation_date=DATE'2026-01-19' or observation_date=DATE'2026-01-20' or observation_date=DATE'2026-01-21' or observation_date=DATE'2026-01-22' or observation_date=DATE'2026-01-23' or observation_date=DATE'2026-01-24' or observation_date=DATE'2026-01-25' or observation_date=DATE'2026-01-26' or observation_date=DATE'2026-01-27' or observation_date=DATE'2026-01-28' or observation_date=DATE'2026-01-29' or observation_date=DATE'2026-01-30'
  
[0m13:52:06.203668 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c4a40ebb-4ef6-456e-875d-e90c0b9e28ad
[0m13:52:07.971188 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m13:52:09.122582 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver__tmp_not_partitioned
[0m13:52:09.123661 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:52:09.125058 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:52:10.226119 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver__tmp_not_partitioned
[0m13:52:10.226986 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:52:10.227514 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver
[0m13:52:10.821940 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:52:12.173898 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
[0m13:52:12.183555 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:52:12.184418 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m13:52:12.458391 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 30ca5590-a9bb-4da1-a137-8c5dd00fb5fe
[0m13:52:14.209674 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:52:14.221446 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m13:52:14.225712 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m13:52:14.226118 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '"AwsDataCatalog"."silver"."openmeteo_silver" with many partitions created';
[0m13:52:14.465563 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3b172527-46c3-4f5a-a1fe-0119f8537781
[0m13:52:16.287651 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:52:16.303502 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 13:51:39.763233 => 13:52:16.302377
[0m13:52:16.305102 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m13:52:16.308978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ba44710>]}
[0m13:52:16.312057 [info ] [Thread-1 (]: 3 of 5 OK created sql table model silver.openmeteo_silver ...................... [[32mOK -1[0m in 36.56s]
[0m13:52:16.314626 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m13:52:16.318010 [debug] [Thread-1 (]: Began running node model.silver.openweather_silver
[0m13:52:16.326355 [info ] [Thread-1 (]: 4 of 5 START sql table model silver.openweather_silver ......................... [RUN]
[0m13:52:16.331658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openmeteo_silver, now model.silver.openweather_silver)
[0m13:52:16.332284 [debug] [Thread-1 (]: Began compiling node model.silver.openweather_silver
[0m13:52:16.344442 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openweather_silver"
[0m13:52:16.346795 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (compile): 13:52:16.332591 => 13:52:16.346545
[0m13:52:16.347280 [debug] [Thread-1 (]: Began executing node model.silver.openweather_silver
[0m13:52:16.351362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:17.528129 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m13:52:17.530815 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:52:17.532560 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:52:18.602757 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openweather_silver
[0m13:52:18.603916 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:52:18.604927 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openweather_silver" is stored in s3://climate-energy-raw-data/silver/openweather_silver
[0m13:52:19.233006 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openweather_silver', bucket='climate-energy-raw-data', prefix='silver/openweather_silver/'
[0m13:52:21.407796 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openweather_silver"
[0m13:52:21.416790 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:52:21.917381 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m13:52:21.921020 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */


    create table "AwsDataCatalog"."silver"."openweather_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openweather_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  feelslike_temp,
  feelslike_temp * (9.0 / 5.0) + 32.0 as feelslike_temp_f,
  humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  visibility,
  weather_status,
  from_unixtime(epoch_ts) AS dt_timestamp,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date,
  CAST(from_unixtime(epoch_ts) AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."openweather_bronze"
[0m13:52:22.533543 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ebb03110-cbaa-4bb4-b46e-fbc7cf38ed7a
[0m13:52:26.975580 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":3106,"data_scanned_in_bytes":1006163}
[0m13:52:26.978158 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m13:52:26.978550 [debug] [Thread-1 (]: On model.silver.openweather_silver: alter table `AwsDataCatalog`.`silver`.`openweather_silver` set tblproperties ('classification' = 'parquet')
[0m13:52:27.287090 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1458ce36-7231-4387-a919-e24c66e18ec3
[0m13:52:29.030541 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:52:29.036886 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openweather_silver"
[0m13:52:29.040218 [debug] [Thread-1 (]: Using athena connection "model.silver.openweather_silver"
[0m13:52:29.042121 [debug] [Thread-1 (]: On model.silver.openweather_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openweather_silver"} */
SELECT '{"rowcount":3106,"data_scanned_in_bytes":1006163}';
[0m13:52:29.277372 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1d881cfb-0a9c-4425-b04f-7f91bfe8302a
[0m13:52:31.072138 [debug] [Thread-1 (]: SQL status: OK 3106 in 2.0 seconds
[0m13:52:31.082155 [debug] [Thread-1 (]: Timing info for model.silver.openweather_silver (execute): 13:52:16.347618 => 13:52:31.081590
[0m13:52:31.083341 [debug] [Thread-1 (]: On model.silver.openweather_silver: Close
[0m13:52:31.085417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f17bd0>]}
[0m13:52:31.090715 [info ] [Thread-1 (]: 4 of 5 OK created sql table model silver.openweather_silver .................... [[32mOK 3106[0m in 14.76s]
[0m13:52:31.094052 [debug] [Thread-1 (]: Finished running node model.silver.openweather_silver
[0m13:52:31.096105 [debug] [Thread-1 (]: Began running node model.silver.sensor_silver
[0m13:52:31.097731 [info ] [Thread-1 (]: 5 of 5 START sql table model silver.sensor_silver .............................. [RUN]
[0m13:52:31.101992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.silver.openweather_silver, now model.silver.sensor_silver)
[0m13:52:31.102813 [debug] [Thread-1 (]: Began compiling node model.silver.sensor_silver
[0m13:52:31.122490 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.sensor_silver"
[0m13:52:31.125050 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (compile): 13:52:31.103440 => 13:52:31.124799
[0m13:52:31.125802 [debug] [Thread-1 (]: Began executing node model.silver.sensor_silver
[0m13:52:31.132961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:32.283270 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m13:52:32.284673 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:52:32.286106 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m13:52:33.431242 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : sensor_silver
[0m13:52:33.432887 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m13:52:33.433967 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."sensor_silver" is stored in s3://climate-energy-raw-data/silver/sensor_silver/c5a9a162-df9b-4b18-8e06-943163a37710
[0m13:52:34.214867 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver/c5a9a162-df9b-4b18-8e06-943163a37710', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/c5a9a162-df9b-4b18-8e06-943163a37710/'
[0m13:52:36.337428 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."sensor_silver"
[0m13:52:36.353133 [debug] [Thread-1 (]: Skip partitioning: False
[0m13:52:37.014313 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/sensor_silver', bucket='climate-energy-raw-data', prefix='silver/sensor_silver/'
[0m13:52:37.800810 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */


    create table "AwsDataCatalog"."silver"."sensor_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/sensor_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  location,
  meter_id,
  power_kw,
  voltage,
  (power_kw * 1000) / voltage AS current,
  sensor_id,
  temp_c AS temperature,
  humidity_pct AS humidity,
  from_unixtime(epoch_ts) AS dt_timestamp,
  ingestion_timestamp,
  CAST(from_unixtime(epoch_ts) AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."sensor_bronze"
[0m13:52:38.316700 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID ae63f2b6-254a-494a-9139-c3f80071904f
[0m13:52:42.407988 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":2749,"data_scanned_in_bytes":867827}
[0m13:52:42.416040 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m13:52:42.417138 [debug] [Thread-1 (]: On model.silver.sensor_silver: alter table `AwsDataCatalog`.`silver`.`sensor_silver` set tblproperties ('classification' = 'parquet')
[0m13:52:42.712512 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7468c9ed-56db-4102-8d93-ef83900f49e9
[0m13:52:44.505482 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m13:52:44.518480 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.sensor_silver"
[0m13:52:44.524246 [debug] [Thread-1 (]: Using athena connection "model.silver.sensor_silver"
[0m13:52:44.526081 [debug] [Thread-1 (]: On model.silver.sensor_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.sensor_silver"} */
SELECT '{"rowcount":2749,"data_scanned_in_bytes":867827}';
[0m13:52:44.760759 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID b21cd201-c07f-4961-be57-0eeb430f5d1d
[0m13:52:46.589719 [debug] [Thread-1 (]: SQL status: OK 2749 in 2.0 seconds
[0m13:52:46.602739 [debug] [Thread-1 (]: Timing info for model.silver.sensor_silver (execute): 13:52:31.126213 => 13:52:46.601412
[0m13:52:46.604201 [debug] [Thread-1 (]: On model.silver.sensor_silver: Close
[0m13:52:46.607665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '191bcd46-8335-4be7-bd2c-3c4519577930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1d8c890>]}
[0m13:52:46.610546 [info ] [Thread-1 (]: 5 of 5 OK created sql table model silver.sensor_silver ......................... [[32mOK 2749[0m in 15.51s]
[0m13:52:46.612067 [debug] [Thread-1 (]: Finished running node model.silver.sensor_silver
[0m13:52:46.628740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:46.629435 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m13:52:46.629818 [debug] [MainThread]: Connection 'model.silver.sensor_silver' was properly closed.
[0m13:52:46.636156 [info ] [MainThread]: 
[0m13:52:46.637361 [info ] [MainThread]: Finished running 5 table models in 0 hours 1 minutes and 33.85 seconds (93.85s).
[0m13:52:46.640564 [debug] [MainThread]: Command end result
[0m13:52:46.667547 [info ] [MainThread]: 
[0m13:52:46.668256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:46.668997 [info ] [MainThread]: 
[0m13:52:46.669546 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:52:46.672812 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 94.34356, "process_user_time": 7.169215, "process_kernel_time": 0.889957, "process_mem_max_rss": "198312", "process_out_blocks": "3077", "process_in_blocks": "0"}
[0m13:52:46.673579 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:46.673464 after 94.34 seconds
[0m13:52:46.674303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaab34090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f7d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab712850>]}
[0m13:52:46.674677 [debug] [MainThread]: Flushing usage events
[0m14:01:45.982101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c662290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c661050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c663a90>]}


============================== 14:01:45.985213 | c650390d-e7fc-4a8e-be95-43e7fc486b8e ==============================
[0m14:01:45.985213 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:01:45.986448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --profile silver --select path:models/silver/openmeteo_silver.sql', 'send_anonymous_usage_stats': 'True'}
[0m14:01:46.274582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c650390d-e7fc-4a8e-be95-43e7fc486b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b760150>]}
[0m14:01:46.317529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c650390d-e7fc-4a8e-be95-43e7fc486b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b8d5690>]}
[0m14:01:46.318393 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:01:46.324542 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m14:01:46.361521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:01:46.361911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:01:46.365600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c650390d-e7fc-4a8e-be95-43e7fc486b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7771d0>]}
[0m14:01:46.375385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c650390d-e7fc-4a8e-be95-43e7fc486b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b67fe10>]}
[0m14:01:46.375737 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m14:01:46.376001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c650390d-e7fc-4a8e-be95-43e7fc486b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b885bd0>]}
[0m14:01:46.377459 [info ] [MainThread]: 
[0m14:01:46.378111 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:01:46.379021 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:01:46.379330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:47.077652 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:01:47.081482 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_bronze'
[0m14:01:47.082153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:48.519101 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m14:01:48.521900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m14:01:48.525741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:49.874410 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m14:01:49.881434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m14:01:49.883499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:51.379501 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m14:01:51.384273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c650390d-e7fc-4a8e-be95-43e7fc486b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b0e450>]}
[0m14:01:51.386449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:51.387646 [info ] [MainThread]: 
[0m14:01:51.393229 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m14:01:51.394294 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m14:01:51.395846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.openmeteo_silver)
[0m14:01:51.396417 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m14:01:51.408757 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m14:01:51.411250 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 14:01:51.397041 => 14:01:51.410908
[0m14:01:51.411870 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m14:01:51.446725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:01:52.650268 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m14:01:52.651151 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:01:52.654909 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:01:53.742041 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m14:01:53.743020 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:01:53.743408 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver
[0m14:01:54.455699 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:01:55.849876 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m14:01:55.888994 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:01:56.571739 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:01:56.574554 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temperature_min,
  temperature_min * (9.0 / 5.0) + 32.0 as temperature_min_f,
  precipitation_mm as precipitation,
  LEAST(100, precipitation_mm * 10) as humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  CAST(date_str AS date) AS dt_timestamp,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date,
  CAST(date_str AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m14:01:57.143266 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8445c0e7-6071-4bda-b1e3-4fcf7d58cfa9
[0m14:01:58.540944 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: HIVE_TOO_MANY_OPEN_PARTITIONS: Exceeded limit of 100 open writers for partitions/buckets. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/8445c0e7-6071-4bda-b1e3-4fcf7d58cfa9' before retrying. Athena will not delete data in your account.
[0m14:01:58.545238 [debug] [Thread-1 (]: COMPILED CODE RESULT: TOO_MANY_OPEN_PARTITIONS
[0m14:01:59.701401 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exists - Ignoring
[0m14:01:59.704912 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exist - Ignoring
[0m14:01:59.706208 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:02:00.770714 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exists - Ignoring
[0m14:02:00.774268 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exist - Ignoring
[0m14:02:01.908852 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" does not exist and will not be deleted, ignoring
[0m14:02:01.912229 [debug] [Thread-1 (]: CREATE NON-PARTIONED STAGING TABLE: "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
[0m14:02:01.923819 [debug] [Thread-1 (]: Skip partitioning: True
[0m14:02:02.449050 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:02:02.460920 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:02:02.461517 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    

    create table "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temperature_min,
  temperature_min * (9.0 / 5.0) + 32.0 as temperature_min_f,
  precipitation_mm as precipitation,
  LEAST(100, precipitation_mm * 10) as humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  CAST(date_str AS date) AS dt_timestamp,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date,
  CAST(date_str AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."openmeteo_bronze"
  
[0m14:02:02.686304 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 56252149-8549-4fdc-b9b7-8de8bc9d8955
[0m14:02:06.856282 [debug] [Thread-1 (]: SQL status: OK 37427 in 4.0 seconds
[0m14:02:06.904965 [debug] [Thread-1 (]: PARTITIONED KEYS: observation_date
[0m14:02:06.906554 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:02:06.906971 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
select distinct observation_date from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" order by observation_date;
[0m14:02:07.121463 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0b426ddf-1bd8-4655-8c40-48fd3a94960d
[0m14:02:09.091463 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:02:09.145122 [debug] [Thread-1 (]: TOTAL PARTITIONS TO PROCESS: 395
[0m14:02:09.145815 [debug] [Thread-1 (]: BATCHES TO PROCESS: 4
[0m14:02:10.232542 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver__tmp_not_partitioned
[0m14:02:10.233947 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:02:10.234456 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Columns in relation openmeteo_silver__tmp_not_partitioned: [{'Name': 'location', 'Type': 'string', 'Parameters': {}}, {'Name': 'temperature_c', 'Type': 'double', 'Parameters': {}}, {'Name': 'temperature_f', 'Type': 'double', 'Parameters': {}}, {'Name': 'temperature_min', 'Type': 'double', 'Parameters': {}}, {'Name': 'temperature_min_f', 'Type': 'double', 'Parameters': {}}, {'Name': 'precipitation', 'Type': 'double', 'Parameters': {}}, {'Name': 'humidity', 'Type': 'double', 'Parameters': {}}, {'Name': 'windspeed_mps', 'Type': 'double', 'Parameters': {}}, {'Name': 'windspeed_mph', 'Type': 'double', 'Parameters': {}}, {'Name': 'dt_timestamp', 'Type': 'date', 'Parameters': {}}, {'Name': 'ingestion_date', 'Type': 'date', 'Parameters': {}}, {'Name': 'observation_date', 'Type': 'date', 'Parameters': {}}]
[0m14:02:10.236680 [debug] [Thread-1 (]: BATCH PROCESSING: 1 OF 4
[0m14:02:10.238531 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:02:10.922326 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/silver/openmeteo_silver', bucket='climate-energy-raw-data', prefix='silver/openmeteo_silver/'
[0m14:02:11.745950 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:02:11.747142 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    

    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-01-01' or observation_date=DATE'2025-01-02' or observation_date=DATE'2025-01-03' or observation_date=DATE'2025-01-04' or observation_date=DATE'2025-01-05' or observation_date=DATE'2025-01-06' or observation_date=DATE'2025-01-07' or observation_date=DATE'2025-01-08' or observation_date=DATE'2025-01-09' or observation_date=DATE'2025-01-10' or observation_date=DATE'2025-01-11' or observation_date=DATE'2025-01-12' or observation_date=DATE'2025-01-13' or observation_date=DATE'2025-01-14' or observation_date=DATE'2025-01-15' or observation_date=DATE'2025-01-16' or observation_date=DATE'2025-01-17' or observation_date=DATE'2025-01-18' or observation_date=DATE'2025-01-19' or observation_date=DATE'2025-01-20' or observation_date=DATE'2025-01-21' or observation_date=DATE'2025-01-22' or observation_date=DATE'2025-01-23' or observation_date=DATE'2025-01-24' or observation_date=DATE'2025-01-25' or observation_date=DATE'2025-01-26' or observation_date=DATE'2025-01-27' or observation_date=DATE'2025-01-28' or observation_date=DATE'2025-01-29' or observation_date=DATE'2025-01-30' or observation_date=DATE'2025-01-31' or observation_date=DATE'2025-02-01' or observation_date=DATE'2025-02-02' or observation_date=DATE'2025-02-03' or observation_date=DATE'2025-02-04' or observation_date=DATE'2025-02-05' or observation_date=DATE'2025-02-06' or observation_date=DATE'2025-02-07' or observation_date=DATE'2025-02-08' or observation_date=DATE'2025-02-09' or observation_date=DATE'2025-02-10' or observation_date=DATE'2025-02-11' or observation_date=DATE'2025-02-12' or observation_date=DATE'2025-02-13' or observation_date=DATE'2025-02-14' or observation_date=DATE'2025-02-15' or observation_date=DATE'2025-02-16' or observation_date=DATE'2025-02-17' or observation_date=DATE'2025-02-18' or observation_date=DATE'2025-02-19' or observation_date=DATE'2025-02-20' or observation_date=DATE'2025-02-21' or observation_date=DATE'2025-02-22' or observation_date=DATE'2025-02-23' or observation_date=DATE'2025-02-24' or observation_date=DATE'2025-02-25' or observation_date=DATE'2025-02-26' or observation_date=DATE'2025-02-27' or observation_date=DATE'2025-02-28' or observation_date=DATE'2025-03-01' or observation_date=DATE'2025-03-02' or observation_date=DATE'2025-03-03' or observation_date=DATE'2025-03-04' or observation_date=DATE'2025-03-05' or observation_date=DATE'2025-03-06' or observation_date=DATE'2025-03-07' or observation_date=DATE'2025-03-08' or observation_date=DATE'2025-03-09' or observation_date=DATE'2025-03-10' or observation_date=DATE'2025-03-11' or observation_date=DATE'2025-03-12' or observation_date=DATE'2025-03-13' or observation_date=DATE'2025-03-14' or observation_date=DATE'2025-03-15' or observation_date=DATE'2025-03-16' or observation_date=DATE'2025-03-17' or observation_date=DATE'2025-03-18' or observation_date=DATE'2025-03-19' or observation_date=DATE'2025-03-20' or observation_date=DATE'2025-03-21' or observation_date=DATE'2025-03-22' or observation_date=DATE'2025-03-23' or observation_date=DATE'2025-03-24' or observation_date=DATE'2025-03-25' or observation_date=DATE'2025-03-26' or observation_date=DATE'2025-03-27' or observation_date=DATE'2025-03-28' or observation_date=DATE'2025-03-29' or observation_date=DATE'2025-03-30' or observation_date=DATE'2025-03-31' or observation_date=DATE'2025-04-01' or observation_date=DATE'2025-04-02' or observation_date=DATE'2025-04-03' or observation_date=DATE'2025-04-04' or observation_date=DATE'2025-04-05' or observation_date=DATE'2025-04-06' or observation_date=DATE'2025-04-07' or observation_date=DATE'2025-04-08' or observation_date=DATE'2025-04-09' or observation_date=DATE'2025-04-10'
  
[0m14:02:11.973863 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 661c73e2-cb93-4233-a8e1-895193390bf3
[0m14:02:13.697933 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m14:02:13.703175 [debug] [Thread-1 (]: BATCH PROCESSING: 2 OF 4
[0m14:02:13.704706 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:02:13.705570 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    insert into "AwsDataCatalog"."silver"."openmeteo_silver" ("location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date")
                select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-04-11' or observation_date=DATE'2025-04-12' or observation_date=DATE'2025-04-13' or observation_date=DATE'2025-04-14' or observation_date=DATE'2025-04-15' or observation_date=DATE'2025-04-16' or observation_date=DATE'2025-04-17' or observation_date=DATE'2025-04-18' or observation_date=DATE'2025-04-19' or observation_date=DATE'2025-04-20' or observation_date=DATE'2025-04-21' or observation_date=DATE'2025-04-22' or observation_date=DATE'2025-04-23' or observation_date=DATE'2025-04-24' or observation_date=DATE'2025-04-25' or observation_date=DATE'2025-04-26' or observation_date=DATE'2025-04-27' or observation_date=DATE'2025-04-28' or observation_date=DATE'2025-04-29' or observation_date=DATE'2025-04-30' or observation_date=DATE'2025-05-01' or observation_date=DATE'2025-05-02' or observation_date=DATE'2025-05-03' or observation_date=DATE'2025-05-04' or observation_date=DATE'2025-05-05' or observation_date=DATE'2025-05-06' or observation_date=DATE'2025-05-07' or observation_date=DATE'2025-05-08' or observation_date=DATE'2025-05-09' or observation_date=DATE'2025-05-10' or observation_date=DATE'2025-05-11' or observation_date=DATE'2025-05-12' or observation_date=DATE'2025-05-13' or observation_date=DATE'2025-05-14' or observation_date=DATE'2025-05-15' or observation_date=DATE'2025-05-16' or observation_date=DATE'2025-05-17' or observation_date=DATE'2025-05-18' or observation_date=DATE'2025-05-19' or observation_date=DATE'2025-05-20' or observation_date=DATE'2025-05-21' or observation_date=DATE'2025-05-22' or observation_date=DATE'2025-05-23' or observation_date=DATE'2025-05-24' or observation_date=DATE'2025-05-25' or observation_date=DATE'2025-05-26' or observation_date=DATE'2025-05-27' or observation_date=DATE'2025-05-28' or observation_date=DATE'2025-05-29' or observation_date=DATE'2025-05-30' or observation_date=DATE'2025-05-31' or observation_date=DATE'2025-06-01' or observation_date=DATE'2025-06-02' or observation_date=DATE'2025-06-03' or observation_date=DATE'2025-06-04' or observation_date=DATE'2025-06-05' or observation_date=DATE'2025-06-06' or observation_date=DATE'2025-06-07' or observation_date=DATE'2025-06-08' or observation_date=DATE'2025-06-09' or observation_date=DATE'2025-06-10' or observation_date=DATE'2025-06-11' or observation_date=DATE'2025-06-12' or observation_date=DATE'2025-06-13' or observation_date=DATE'2025-06-14' or observation_date=DATE'2025-06-15' or observation_date=DATE'2025-06-16' or observation_date=DATE'2025-06-17' or observation_date=DATE'2025-06-18' or observation_date=DATE'2025-06-19' or observation_date=DATE'2025-06-20' or observation_date=DATE'2025-06-21' or observation_date=DATE'2025-06-22' or observation_date=DATE'2025-06-23' or observation_date=DATE'2025-06-24' or observation_date=DATE'2025-06-25' or observation_date=DATE'2025-06-26' or observation_date=DATE'2025-06-27' or observation_date=DATE'2025-06-28' or observation_date=DATE'2025-06-29' or observation_date=DATE'2025-06-30' or observation_date=DATE'2025-07-01' or observation_date=DATE'2025-07-02' or observation_date=DATE'2025-07-03' or observation_date=DATE'2025-07-04' or observation_date=DATE'2025-07-05' or observation_date=DATE'2025-07-06' or observation_date=DATE'2025-07-07' or observation_date=DATE'2025-07-08' or observation_date=DATE'2025-07-09' or observation_date=DATE'2025-07-10' or observation_date=DATE'2025-07-11' or observation_date=DATE'2025-07-12' or observation_date=DATE'2025-07-13' or observation_date=DATE'2025-07-14' or observation_date=DATE'2025-07-15' or observation_date=DATE'2025-07-16' or observation_date=DATE'2025-07-17' or observation_date=DATE'2025-07-18' or observation_date=DATE'2025-07-19'
  
[0m14:02:13.926223 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 4563e438-0eb8-402e-8bd3-dfdd0afed2cf
[0m14:02:15.710185 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m14:02:15.725781 [debug] [Thread-1 (]: BATCH PROCESSING: 3 OF 4
[0m14:02:15.731907 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:02:15.733286 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    insert into "AwsDataCatalog"."silver"."openmeteo_silver" ("location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date")
                select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-07-20' or observation_date=DATE'2025-07-21' or observation_date=DATE'2025-07-22' or observation_date=DATE'2025-07-23' or observation_date=DATE'2025-07-24' or observation_date=DATE'2025-07-25' or observation_date=DATE'2025-07-26' or observation_date=DATE'2025-07-27' or observation_date=DATE'2025-07-28' or observation_date=DATE'2025-07-29' or observation_date=DATE'2025-07-30' or observation_date=DATE'2025-07-31' or observation_date=DATE'2025-08-01' or observation_date=DATE'2025-08-02' or observation_date=DATE'2025-08-03' or observation_date=DATE'2025-08-04' or observation_date=DATE'2025-08-05' or observation_date=DATE'2025-08-06' or observation_date=DATE'2025-08-07' or observation_date=DATE'2025-08-08' or observation_date=DATE'2025-08-09' or observation_date=DATE'2025-08-10' or observation_date=DATE'2025-08-11' or observation_date=DATE'2025-08-12' or observation_date=DATE'2025-08-13' or observation_date=DATE'2025-08-14' or observation_date=DATE'2025-08-15' or observation_date=DATE'2025-08-16' or observation_date=DATE'2025-08-17' or observation_date=DATE'2025-08-18' or observation_date=DATE'2025-08-19' or observation_date=DATE'2025-08-20' or observation_date=DATE'2025-08-21' or observation_date=DATE'2025-08-22' or observation_date=DATE'2025-08-23' or observation_date=DATE'2025-08-24' or observation_date=DATE'2025-08-25' or observation_date=DATE'2025-08-26' or observation_date=DATE'2025-08-27' or observation_date=DATE'2025-08-28' or observation_date=DATE'2025-08-29' or observation_date=DATE'2025-08-30' or observation_date=DATE'2025-08-31' or observation_date=DATE'2025-09-01' or observation_date=DATE'2025-09-02' or observation_date=DATE'2025-09-03' or observation_date=DATE'2025-09-04' or observation_date=DATE'2025-09-05' or observation_date=DATE'2025-09-06' or observation_date=DATE'2025-09-07' or observation_date=DATE'2025-09-08' or observation_date=DATE'2025-09-09' or observation_date=DATE'2025-09-10' or observation_date=DATE'2025-09-11' or observation_date=DATE'2025-09-12' or observation_date=DATE'2025-09-13' or observation_date=DATE'2025-09-14' or observation_date=DATE'2025-09-15' or observation_date=DATE'2025-09-16' or observation_date=DATE'2025-09-17' or observation_date=DATE'2025-09-18' or observation_date=DATE'2025-09-19' or observation_date=DATE'2025-09-20' or observation_date=DATE'2025-09-21' or observation_date=DATE'2025-09-22' or observation_date=DATE'2025-09-23' or observation_date=DATE'2025-09-24' or observation_date=DATE'2025-09-25' or observation_date=DATE'2025-09-26' or observation_date=DATE'2025-09-27' or observation_date=DATE'2025-09-28' or observation_date=DATE'2025-09-29' or observation_date=DATE'2025-09-30' or observation_date=DATE'2025-10-01' or observation_date=DATE'2025-10-02' or observation_date=DATE'2025-10-03' or observation_date=DATE'2025-10-04' or observation_date=DATE'2025-10-05' or observation_date=DATE'2025-10-06' or observation_date=DATE'2025-10-07' or observation_date=DATE'2025-10-08' or observation_date=DATE'2025-10-09' or observation_date=DATE'2025-10-10' or observation_date=DATE'2025-10-11' or observation_date=DATE'2025-10-12' or observation_date=DATE'2025-10-13' or observation_date=DATE'2025-10-14' or observation_date=DATE'2025-10-15' or observation_date=DATE'2025-10-16' or observation_date=DATE'2025-10-17' or observation_date=DATE'2025-10-18' or observation_date=DATE'2025-10-19' or observation_date=DATE'2025-10-20' or observation_date=DATE'2025-10-21' or observation_date=DATE'2025-10-22' or observation_date=DATE'2025-10-23' or observation_date=DATE'2025-10-24' or observation_date=DATE'2025-10-25' or observation_date=DATE'2025-10-26' or observation_date=DATE'2025-10-27'
  
[0m14:02:15.964652 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 8fe5b2e1-7de8-4432-9baa-ac7127b6cfb9
[0m14:02:17.708961 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m14:02:17.711611 [debug] [Thread-1 (]: BATCH PROCESSING: 4 OF 4
[0m14:02:17.712648 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:02:17.713326 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */

    insert into "AwsDataCatalog"."silver"."openmeteo_silver" ("location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date")
                select "location", "temperature_c", "temperature_f", "temperature_min", "temperature_min_f", "precipitation", "humidity", "windspeed_mps", "windspeed_mph", "dt_timestamp", "ingestion_date", "observation_date"
                from "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
                where observation_date=DATE'2025-10-28' or observation_date=DATE'2025-10-29' or observation_date=DATE'2025-10-30' or observation_date=DATE'2025-10-31' or observation_date=DATE'2025-11-01' or observation_date=DATE'2025-11-02' or observation_date=DATE'2025-11-03' or observation_date=DATE'2025-11-04' or observation_date=DATE'2025-11-05' or observation_date=DATE'2025-11-06' or observation_date=DATE'2025-11-07' or observation_date=DATE'2025-11-08' or observation_date=DATE'2025-11-09' or observation_date=DATE'2025-11-10' or observation_date=DATE'2025-11-11' or observation_date=DATE'2025-11-12' or observation_date=DATE'2025-11-13' or observation_date=DATE'2025-11-14' or observation_date=DATE'2025-11-15' or observation_date=DATE'2025-11-16' or observation_date=DATE'2025-11-17' or observation_date=DATE'2025-11-18' or observation_date=DATE'2025-11-19' or observation_date=DATE'2025-11-20' or observation_date=DATE'2025-11-21' or observation_date=DATE'2025-11-22' or observation_date=DATE'2025-11-23' or observation_date=DATE'2025-11-24' or observation_date=DATE'2025-11-25' or observation_date=DATE'2025-11-26' or observation_date=DATE'2025-11-27' or observation_date=DATE'2025-11-28' or observation_date=DATE'2025-11-29' or observation_date=DATE'2025-11-30' or observation_date=DATE'2025-12-01' or observation_date=DATE'2025-12-02' or observation_date=DATE'2025-12-03' or observation_date=DATE'2025-12-04' or observation_date=DATE'2025-12-05' or observation_date=DATE'2025-12-06' or observation_date=DATE'2025-12-07' or observation_date=DATE'2025-12-08' or observation_date=DATE'2025-12-09' or observation_date=DATE'2025-12-10' or observation_date=DATE'2025-12-11' or observation_date=DATE'2025-12-12' or observation_date=DATE'2025-12-13' or observation_date=DATE'2025-12-14' or observation_date=DATE'2025-12-15' or observation_date=DATE'2025-12-16' or observation_date=DATE'2025-12-17' or observation_date=DATE'2025-12-18' or observation_date=DATE'2025-12-19' or observation_date=DATE'2025-12-20' or observation_date=DATE'2025-12-21' or observation_date=DATE'2025-12-22' or observation_date=DATE'2025-12-23' or observation_date=DATE'2025-12-24' or observation_date=DATE'2025-12-25' or observation_date=DATE'2025-12-26' or observation_date=DATE'2025-12-27' or observation_date=DATE'2025-12-28' or observation_date=DATE'2025-12-29' or observation_date=DATE'2025-12-30' or observation_date=DATE'2025-12-31' or observation_date=DATE'2026-01-01' or observation_date=DATE'2026-01-02' or observation_date=DATE'2026-01-03' or observation_date=DATE'2026-01-04' or observation_date=DATE'2026-01-05' or observation_date=DATE'2026-01-06' or observation_date=DATE'2026-01-07' or observation_date=DATE'2026-01-08' or observation_date=DATE'2026-01-09' or observation_date=DATE'2026-01-10' or observation_date=DATE'2026-01-11' or observation_date=DATE'2026-01-12' or observation_date=DATE'2026-01-13' or observation_date=DATE'2026-01-14' or observation_date=DATE'2026-01-15' or observation_date=DATE'2026-01-16' or observation_date=DATE'2026-01-17' or observation_date=DATE'2026-01-18' or observation_date=DATE'2026-01-19' or observation_date=DATE'2026-01-20' or observation_date=DATE'2026-01-21' or observation_date=DATE'2026-01-22' or observation_date=DATE'2026-01-23' or observation_date=DATE'2026-01-24' or observation_date=DATE'2026-01-25' or observation_date=DATE'2026-01-26' or observation_date=DATE'2026-01-27' or observation_date=DATE'2026-01-28' or observation_date=DATE'2026-01-29' or observation_date=DATE'2026-01-30'
  
[0m14:02:17.935335 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 856ab7ff-393e-4396-8240-339f4d5ba1e9
[0m14:02:19.683570 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m14:02:20.894557 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver__tmp_not_partitioned
[0m14:02:20.896173 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:02:20.897441 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:02:22.034905 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver__tmp_not_partitioned
[0m14:02:22.037732 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:02:22.038986 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver
[0m14:02:22.663796 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:02:24.088081 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver__tmp_not_partitioned"
[0m14:02:24.127438 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:02:24.130769 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m14:02:24.424797 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 87828aaa-ea64-4bc4-a9d5-fad9b52c1e71
[0m14:02:26.277749 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:02:26.292222 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m14:02:26.296557 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:02:26.297277 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '"AwsDataCatalog"."silver"."openmeteo_silver" with many partitions created';
[0m14:02:26.527551 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 66d9a162-6abf-412d-85fa-0f3775c2be30
[0m14:02:28.305508 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:02:28.330584 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 14:01:51.412235 => 14:02:28.329767
[0m14:02:28.331773 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m14:02:28.342362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c650390d-e7fc-4a8e-be95-43e7fc486b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a22f090>]}
[0m14:02:28.345575 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.openmeteo_silver ...................... [[32mOK -1[0m in 36.94s]
[0m14:02:28.347071 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m14:02:28.353838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:28.354429 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m14:02:28.354772 [debug] [MainThread]: Connection 'model.silver.openmeteo_silver' was properly closed.
[0m14:02:28.359110 [info ] [MainThread]: 
[0m14:02:28.359871 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 41.98 seconds (41.98s).
[0m14:02:28.361568 [debug] [MainThread]: Command end result
[0m14:02:28.385553 [info ] [MainThread]: 
[0m14:02:28.386886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:28.387406 [info ] [MainThread]: 
[0m14:02:28.389450 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:02:28.392546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 42.44281, "process_user_time": 4.269547, "process_kernel_time": 0.909507, "process_mem_max_rss": "185552", "process_out_blocks": "2058", "process_in_blocks": "0"}
[0m14:02:28.393316 [debug] [MainThread]: Command `dbt run` succeeded at 14:02:28.393210 after 42.44 seconds
[0m14:02:28.393908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ad9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ad8c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ad9ad0>]}
[0m14:02:28.394256 [debug] [MainThread]: Flushing usage events
[0m14:05:17.820834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c35250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c37a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94412c90>]}


============================== 14:05:17.824315 | 9f50ea78-b7a7-4fb6-9414-dd72e2cd9311 ==============================
[0m14:05:17.824315 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:05:17.825433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --profile silver --select path:models/silver/openmeteo_silver.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:18.104120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f50ea78-b7a7-4fb6-9414-dd72e2cd9311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e3dc50>]}
[0m14:05:18.146355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f50ea78-b7a7-4fb6-9414-dd72e2cd9311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e5dd10>]}
[0m14:05:18.146960 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:05:18.152172 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m14:05:18.181860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:18.182371 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/openmeteo_silver.sql
[0m14:05:18.284207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f50ea78-b7a7-4fb6-9414-dd72e2cd9311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c7f550>]}
[0m14:05:18.292967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f50ea78-b7a7-4fb6-9414-dd72e2cd9311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91af2910>]}
[0m14:05:18.293573 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m14:05:18.293911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f50ea78-b7a7-4fb6-9414-dd72e2cd9311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a56b10>]}
[0m14:05:18.295316 [info ] [MainThread]: 
[0m14:05:18.295917 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:05:18.296699 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:05:18.297001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:19.562819 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:05:19.568090 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_gold'
[0m14:05:19.569216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:20.903483 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m14:05:20.905403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m14:05:20.906346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:22.302866 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m14:05:22.306898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m14:05:22.311743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:23.813114 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m14:05:23.818019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f50ea78-b7a7-4fb6-9414-dd72e2cd9311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dce210>]}
[0m14:05:23.820276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:23.821480 [info ] [MainThread]: 
[0m14:05:23.825428 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m14:05:23.826492 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m14:05:23.828028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now model.silver.openmeteo_silver)
[0m14:05:23.828754 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m14:05:23.843751 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m14:05:23.846077 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 14:05:23.829237 => 14:05:23.845751
[0m14:05:23.846716 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m14:05:23.997073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.189263 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m14:05:26.192956 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:05:26.202182 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:05:27.286895 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : openmeteo_silver
[0m14:05:27.288504 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:05:27.289453 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."silver"."openmeteo_silver" is stored in s3://climate-energy-raw-data/silver/openmeteo_silver
[0m14:05:28.191555 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:05:29.726632 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."silver"."openmeteo_silver"
[0m14:05:29.764760 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:05:30.267986 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:05:30.281748 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      partitioned_by=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temperature_min,
  temperature_min * (9.0 / 5.0) + 32.0 as temperature_min_f,
  precipitation_mm as precipitation,
  LEAST(100, precipitation_mm * 10) as humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  CAST(date_str AS date) AS dt_timestamp,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date,
  CAST(date_str AS date) AS observation_date
FROM "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m14:05:30.915149 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID d86604d1-2f41-4cfc-8247-51985311f0ed
[0m14:05:38.559783 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5833b196-934f-4dc6-9607-b2a3562aa06c
[0m14:05:52.286572 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e877211c-7f1d-4dc9-a95b-55bc8044abb4
[0m14:06:17.924407 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 46a8add1-aba5-4f79-81ac-2dafa5cbef73
[0m14:07:08.037818 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 926a3746-a024-4f20-9141-e106d1b09f39
[0m14:08:46.055431 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID f8848fee-39ad-49ab-9613-93f33a23afa9
[0m14:08:47.402830 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [ingestion_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/f8848fee-39ad-49ab-9613-93f33a23afa9' before retrying. Athena will not delete data in your account.
[0m14:08:47.417358 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 14:05:23.846994 => 14:08:47.413361
[0m14:08:47.423442 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m14:08:47.446275 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [ingestion_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/f8848fee-39ad-49ab-9613-93f33a23afa9' before retrying. Athena will not delete data in your account.
[0m14:08:47.484164 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [ingestion_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/f8848fee-39ad-49ab-9613-93f33a23afa9' before retrying. Athena will not delete data in your account.

[0m14:08:47.489586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f50ea78-b7a7-4fb6-9414-dd72e2cd9311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f46610>]}
[0m14:08:47.497093 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model silver.openmeteo_silver .................. [[31mERROR[0m in 203.66s]
[0m14:08:47.500612 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m14:08:47.522126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:47.523478 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m14:08:47.524118 [debug] [MainThread]: Connection 'model.silver.openmeteo_silver' was properly closed.
[0m14:08:47.528692 [info ] [MainThread]: 
[0m14:08:47.529867 [info ] [MainThread]: Finished running 1 table model in 0 hours 3 minutes and 29.23 seconds (209.23s).
[0m14:08:47.531546 [debug] [MainThread]: Command end result
[0m14:08:47.593637 [info ] [MainThread]: 
[0m14:08:47.594443 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:08:47.595082 [info ] [MainThread]: 
[0m14:08:47.595733 [error] [MainThread]:   HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [ingestion_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results/tables/f8848fee-39ad-49ab-9613-93f33a23afa9' before retrying. Athena will not delete data in your account.
[0m14:08:47.596464 [info ] [MainThread]: 
[0m14:08:47.597019 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:08:47.604553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 209.81886, "process_user_time": 3.855192, "process_kernel_time": 0.665831, "process_mem_max_rss": "186656", "process_out_blocks": "2985", "command_success": false, "process_in_blocks": "0"}
[0m14:08:47.606491 [debug] [MainThread]: Command `dbt run` failed at 14:08:47.606296 after 209.82 seconds
[0m14:08:47.608667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c7c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ace9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98065a10>]}
[0m14:08:47.609583 [debug] [MainThread]: Flushing usage events
[0m14:11:03.774533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b00d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56e7c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b03f10>]}


============================== 14:11:03.779896 | a45aa979-bd0c-429b-b371-e6e2d49a2a3f ==============================
[0m14:11:03.779896 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:11:03.781136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --profile silver --select path:models/silver/openmeteo_silver.sql', 'send_anonymous_usage_stats': 'True'}
[0m14:11:04.163904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a45aa979-bd0c-429b-b371-e6e2d49a2a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b65a10>]}
[0m14:11:04.392513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a45aa979-bd0c-429b-b371-e6e2d49a2a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b64a10>]}
[0m14:11:04.418035 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:11:04.553018 [debug] [MainThread]: checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a, vars: {}, profile: silver, target: , version: 1.7.9
[0m14:11:04.857503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:04.860949 [debug] [MainThread]: Partial parsing: updated file: silver://models/silver/openmeteo_silver.sql
[0m14:11:05.167143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a45aa979-bd0c-429b-b371-e6e2d49a2a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa387dc50>]}
[0m14:11:05.201788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a45aa979-bd0c-429b-b371-e6e2d49a2a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa394add0>]}
[0m14:11:05.204473 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m14:11:05.205823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a45aa979-bd0c-429b-b371-e6e2d49a2a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a86ed0>]}
[0m14:11:05.210211 [info ] [MainThread]: 
[0m14:11:05.214211 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:11:05.218376 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:11:05.221615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:06.082189 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:11:06.087386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_bronze)
[0m14:11:06.087941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:07.595231 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m14:11:07.606251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m14:11:07.615695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:09.206164 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m14:11:09.211325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now list_AwsDataCatalog_silver)
[0m14:11:09.212754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:11.074380 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m14:11:11.086798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a45aa979-bd0c-429b-b371-e6e2d49a2a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2196390>]}
[0m14:11:11.089589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:11.092265 [info ] [MainThread]: 
[0m14:11:11.097519 [debug] [Thread-1 (]: Began running node model.silver.openmeteo_silver
[0m14:11:11.098397 [info ] [Thread-1 (]: 1 of 1 START sql table model silver.openmeteo_silver ........................... [RUN]
[0m14:11:11.099745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now model.silver.openmeteo_silver)
[0m14:11:11.100209 [debug] [Thread-1 (]: Began compiling node model.silver.openmeteo_silver
[0m14:11:11.122272 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.openmeteo_silver"
[0m14:11:11.123993 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (compile): 14:11:11.100510 => 14:11:11.123719
[0m14:11:11.124425 [debug] [Thread-1 (]: Began executing node model.silver.openmeteo_silver
[0m14:11:11.177308 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:11:11.177992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:12.084050 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:11:12.085776 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */


    create table "AwsDataCatalog"."silver"."openmeteo_silver"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/silver/openmeteo_silver',
      partitioned_by=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      

SELECT
  city as location,
  temperature as temperature_c,
  temperature * (9.0 / 5.0) + 32.0 as temperature_f,
  temperature_min,
  temperature_min * (9.0 / 5.0) + 32.0 as temperature_min_f,
  precipitation_mm as precipitation,
  LEAST(100, precipitation_mm * 10) as humidity,
  windspeed as windspeed_mps,
  windspeed * 2.23694 as windspeed_mph,
  CAST(date_str AS date) AS dt_timestamp,
  CAST(date_str AS date) AS observation_date,
  CAST(from_iso8601_timestamp(ingestion_timestamp) AS date) AS ingestion_date
FROM "AwsDataCatalog"."bronze"."openmeteo_bronze"
[0m14:11:12.729815 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1b984728-4524-4435-a5b0-b0bad6911a5b
[0m14:11:16.907407 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":37427,"data_scanned_in_bytes":10610644}
[0m14:11:16.940069 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:11:16.941080 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: alter table `AwsDataCatalog`.`silver`.`openmeteo_silver` set tblproperties ('classification' = 'parquet')
[0m14:11:17.251583 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3c89b315-a858-47f1-8677-8a4704a418e5
[0m14:11:19.052803 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:11:19.060410 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.openmeteo_silver"
[0m14:11:19.063949 [debug] [Thread-1 (]: Using athena connection "model.silver.openmeteo_silver"
[0m14:11:19.064643 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "silver", "target_name": "dev", "node_id": "model.silver.openmeteo_silver"} */
SELECT '{"rowcount":37427,"data_scanned_in_bytes":10610644}';
[0m14:11:19.281341 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID e06db1ae-8e4b-4589-8bfa-b868ca758a79
[0m14:11:21.267696 [debug] [Thread-1 (]: SQL status: OK 37427 in 2.0 seconds
[0m14:11:21.280260 [debug] [Thread-1 (]: Timing info for model.silver.openmeteo_silver (execute): 14:11:11.124745 => 14:11:21.279858
[0m14:11:21.281288 [debug] [Thread-1 (]: On model.silver.openmeteo_silver: Close
[0m14:11:21.283252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a45aa979-bd0c-429b-b371-e6e2d49a2a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a13050>]}
[0m14:11:21.284640 [info ] [Thread-1 (]: 1 of 1 OK created sql table model silver.openmeteo_silver ...................... [[32mOK 37427[0m in 10.18s]
[0m14:11:21.286187 [debug] [Thread-1 (]: Finished running node model.silver.openmeteo_silver
[0m14:11:21.292799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:21.293500 [debug] [MainThread]: Connection 'model.silver.openmeteo_silver' was properly closed.
[0m14:11:21.297082 [info ] [MainThread]: 
[0m14:11:21.298015 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.09 seconds (16.09s).
[0m14:11:21.299003 [debug] [MainThread]: Command end result
[0m14:11:21.313928 [info ] [MainThread]: 
[0m14:11:21.314630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:21.315095 [info ] [MainThread]: 
[0m14:11:21.315729 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:11:21.318132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.566952, "process_user_time": 3.673784, "process_kernel_time": 1.042741, "process_mem_max_rss": "169724", "process_out_blocks": "2971", "process_in_blocks": "0"}
[0m14:11:21.318614 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:21.318506 after 17.57 seconds
[0m14:11:21.319097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60b56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ef8c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ef9850>]}
[0m14:11:21.319471 [debug] [MainThread]: Flushing usage events
[0m14:16:49.475196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0265390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0709250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa068a6d0>]}


============================== 14:16:49.477163 | 01453266-0bf9-4ffc-a838-be5d61e44297 ==============================
[0m14:16:49.477163 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:16:49.478574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profile gold --select path:models/gold', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:16:49.783661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01453266-0bf9-4ffc-a838-be5d61e44297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f470410>]}
[0m14:16:49.840246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01453266-0bf9-4ffc-a838-be5d61e44297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f461d90>]}
[0m14:16:49.840873 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:16:49.846324 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m14:16:49.864932 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:16:49.865377 [debug] [MainThread]: previous checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, current checksum: f061cd2e0b0dbfc9b0cd6a60e9bc37104252d65cf50b8f7af1e305ee9b92ae1a
[0m14:16:49.865658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01453266-0bf9-4ffc-a838-be5d61e44297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1b4250>]}
[0m14:16:50.584054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01453266-0bf9-4ffc-a838-be5d61e44297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f224cd0>]}
[0m14:16:50.593254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01453266-0bf9-4ffc-a838-be5d61e44297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb279d0>]}
[0m14:16:50.593596 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m14:16:50.593960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01453266-0bf9-4ffc-a838-be5d61e44297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f081dd0>]}
[0m14:16:50.595662 [info ] [MainThread]: 
[0m14:16:50.596339 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:16:50.597956 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:16:50.598375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:51.229341 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:16:51.236341 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog_bronze'
[0m14:16:51.237430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:52.571878 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m14:16:52.579130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_silver)
[0m14:16:52.582410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:53.840758 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m14:16:53.846208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_gold)
[0m14:16:53.853472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:56.891344 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m14:16:56.900637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01453266-0bf9-4ffc-a838-be5d61e44297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f12af50>]}
[0m14:16:56.902908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:56.903619 [info ] [MainThread]: 
[0m14:16:56.913526 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m14:16:56.915113 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m14:16:56.918560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.weather_data_gold)
[0m14:16:56.919163 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m14:16:56.936132 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m14:16:56.938416 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 14:16:56.919518 => 14:16:56.937883
[0m14:16:56.938835 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m14:16:56.964907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:58.054887 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold
[0m14:16:58.055429 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:16:58.056799 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:16:59.011222 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold
[0m14:16:59.011822 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:16:59.012397 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m14:16:59.557145 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m14:17:01.486371 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m14:17:01.531192 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:17:01.968445 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:17:01.969916 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      


SELECT
    ingestion_date,
  observation_date,
  location,
  temperature_c,
  humidity,
  windspeed_mps,
  'openweather' as source
FROM "AwsDataCatalog"."silver"."openweather_silver"

UNION ALL

SELECT
    ingestion_date,
  observation_date,
  location,
  temperature_c,
  humidity,
  windspeed_mps,
  'openmeteo' as source
FROM "AwsDataCatalog"."silver"."openmeteo_silver"
[0m14:17:02.488034 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 3d32055a-a53b-4c4b-a089-941e7ef981c7
[0m14:17:10.022257 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 1ee1ddbb-10a1-4952-b33f-a020a2e2ae75
[0m14:17:23.553000 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0e55ef80-479c-4b72-9546-bd395759a0a7
[0m14:17:49.088820 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 076af319-10d5-4d9b-864b-1e80971875ed
[0m14:18:38.955511 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c476cd5a-7a65-4abd-9dad-7b5335ed5fa7
[0m14:20:16.948211 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID afb05a0e-4c05-44a3-a5c8-791bb24876f5
[0m14:20:18.304845 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [observation_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/afb05a0e-4c05-44a3-a5c8-791bb24876f5' before retrying. Athena will not delete data in your account.
[0m14:20:18.314176 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 14:16:56.939053 => 14:20:18.312407
[0m14:20:18.335709 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m14:20:18.358361 [error] [Thread-1 (]: [31mUnhandled error while executing [0m
HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [observation_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/afb05a0e-4c05-44a3-a5c8-791bb24876f5' before retrying. Athena will not delete data in your account.
[0m14:20:18.385582 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 377, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 323, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 424, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/run.py", line 292, in execute
    result = MacroGenerator(
             ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 143, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 330, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 50, in macro
  File "/usr/local/lib/python3.11/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1271, in run_query_with_partitions_limit_catching
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1267, in run_query_with_partitions_limit_catching
    cursor = self._run_query(sql, catch_partitions_limit=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1348, in _run_query
    raise e
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/impl.py", line 1345, in _run_query
    cursor.execute(query, catch_partitions_limit=catch_partitions_limit)
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 198, in execute
    return retry(inner)
           ^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/adapters/athena/connections.py", line 180, in inner
    raise OperationalError(query_execution.state_change_reason)
pyathena.error.OperationalError: HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [observation_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/afb05a0e-4c05-44a3-a5c8-791bb24876f5' before retrying. Athena will not delete data in your account.

[0m14:20:18.395666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01453266-0bf9-4ffc-a838-be5d61e44297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d68b50>]}
[0m14:20:18.400451 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model gold.weather_data_gold ................... [[31mERROR[0m in 201.47s]
[0m14:20:18.402531 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m14:20:18.433173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:18.445550 [debug] [MainThread]: Connection 'list_AwsDataCatalog' was properly closed.
[0m14:20:18.447025 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m14:20:18.462355 [info ] [MainThread]: 
[0m14:20:18.466372 [info ] [MainThread]: Finished running 1 table model in 0 hours 3 minutes and 27.86 seconds (207.86s).
[0m14:20:18.481891 [debug] [MainThread]: Command end result
[0m14:20:18.530462 [info ] [MainThread]: 
[0m14:20:18.533270 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:20:18.533664 [info ] [MainThread]: 
[0m14:20:18.535168 [error] [MainThread]:   HIVE_COLUMN_ORDER_MISMATCH: Partition keys must be the last columns in the table and in the same order as the table properties: [observation_date]. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/afb05a0e-4c05-44a3-a5c8-791bb24876f5' before retrying. Athena will not delete data in your account.
[0m14:20:18.536057 [info ] [MainThread]: 
[0m14:20:18.537241 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:20:18.541420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 209.09132, "process_user_time": 5.219543, "process_kernel_time": 1.218711, "process_mem_max_rss": "201660", "process_out_blocks": "2978", "command_success": false, "process_in_blocks": "0"}
[0m14:20:18.543332 [debug] [MainThread]: Command `dbt run` failed at 14:20:18.542843 after 209.09 seconds
[0m14:20:18.547841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa041be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5684d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5685b10>]}
[0m14:20:18.548663 [debug] [MainThread]: Flushing usage events
[0m14:21:55.983516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17229d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa211fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1723b90>]}


============================== 14:21:55.986265 | 8dabdb23-7cfc-47fe-a758-9b52a1a8d89e ==============================
[0m14:21:55.986265 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:21:55.987595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh --profile gold --select path:models/gold/weather_data_gold.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:21:56.349382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dabdb23-7cfc-47fe-a758-9b52a1a8d89e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07697d0>]}
[0m14:21:56.399680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dabdb23-7cfc-47fe-a758-9b52a1a8d89e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa07622d0>]}
[0m14:21:56.400804 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:21:56.409375 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m14:21:56.457446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:21:56.457976 [debug] [MainThread]: Partial parsing: updated file: silver://models/gold/weather_data_gold.sql
[0m14:21:56.640005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dabdb23-7cfc-47fe-a758-9b52a1a8d89e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0730e50>]}
[0m14:21:56.658902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dabdb23-7cfc-47fe-a758-9b52a1a8d89e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa042e7d0>]}
[0m14:21:56.659840 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m14:21:56.660368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dabdb23-7cfc-47fe-a758-9b52a1a8d89e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff7f490>]}
[0m14:21:56.662710 [info ] [MainThread]: 
[0m14:21:56.663998 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:21:56.665893 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:21:56.666541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:57.351915 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:21:57.358730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m14:21:57.360841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:58.620748 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m14:21:58.627937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m14:21:58.632319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:59.888453 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m14:21:59.891546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m14:21:59.893850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:00.973380 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m14:22:00.976751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dabdb23-7cfc-47fe-a758-9b52a1a8d89e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa04a3f90>]}
[0m14:22:00.978631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:00.979387 [info ] [MainThread]: 
[0m14:22:00.982809 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m14:22:00.985584 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m14:22:00.987677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.weather_data_gold)
[0m14:22:00.988510 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m14:22:01.005156 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m14:22:01.008955 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 14:22:00.989050 => 14:22:01.008350
[0m14:22:01.009725 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m14:22:01.178526 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:22:01.181239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:01.723383 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:22:01.725221 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      


SELECT
  ingestion_date,
  location,
  temperature_c,
  humidity,
  windspeed_mps,
  'openweather' as source,
  observation_date
FROM "AwsDataCatalog"."silver"."openweather_silver"

UNION ALL

SELECT
  ingestion_date,
  location,
  temperature_c,
  humidity,
  windspeed_mps,
  'openmeteo' as source,
  observation_date
FROM "AwsDataCatalog"."silver"."openmeteo_silver"
[0m14:22:02.257734 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 7bcc684e-9ff3-41bc-8570-1866db1aa84e
[0m14:22:05.201473 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: CAUGHT EXCEPTION: HIVE_TOO_MANY_OPEN_PARTITIONS: Exceeded limit of 100 open writers for partitions/buckets. You may need to manually clean the data at location 's3://climate-energy-raw-data/athena_results_gold/tables/7bcc684e-9ff3-41bc-8570-1866db1aa84e' before retrying. Athena will not delete data in your account.
[0m14:22:05.202733 [debug] [Thread-1 (]: COMPILED CODE RESULT: TOO_MANY_OPEN_PARTITIONS
[0m14:22:06.277682 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned" does not exists - Ignoring
[0m14:22:06.280718 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned" does not exist - Ignoring
[0m14:22:06.285595 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:22:07.300745 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned" does not exists - Ignoring
[0m14:22:07.304963 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned" does not exist - Ignoring
[0m14:22:08.340951 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Table "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned" does not exist and will not be deleted, ignoring
[0m14:22:08.343390 [debug] [Thread-1 (]: CREATE NON-PARTIONED STAGING TABLE: "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned"
[0m14:22:08.345329 [debug] [Thread-1 (]: Skip partitioning: True
[0m14:22:08.771619 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:22:08.789017 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m14:22:08.789557 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */

    

    create table "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      format='parquet'
    )
    as
      


SELECT
  ingestion_date,
  location,
  temperature_c,
  humidity,
  windspeed_mps,
  'openweather' as source,
  observation_date
FROM "AwsDataCatalog"."silver"."openweather_silver"

UNION ALL

SELECT
  ingestion_date,
  location,
  temperature_c,
  humidity,
  windspeed_mps,
  'openmeteo' as source,
  observation_date
FROM "AwsDataCatalog"."silver"."openmeteo_silver"
  
[0m14:22:09.030589 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID fb74de06-801a-4c68-8b09-01a16e6caaf3
[0m14:22:11.964914 [debug] [Thread-1 (]: SQL status: OK 40533 in 3.0 seconds
[0m14:22:12.058097 [debug] [Thread-1 (]: PARTITIONED KEYS: observation_date
[0m14:22:12.070355 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m14:22:12.072946 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
select distinct observation_date from "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned" order by observation_date;
[0m14:22:12.306449 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 08ca03f9-1673-4b2e-a6eb-2b1b429185f5
[0m14:22:14.206070 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:22:14.258315 [debug] [Thread-1 (]: TOTAL PARTITIONS TO PROCESS: 395
[0m14:22:14.259131 [debug] [Thread-1 (]: BATCHES TO PROCESS: 4
[0m14:22:15.593776 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold__tmp_not_partitioned
[0m14:22:15.595745 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:22:15.596191 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Columns in relation weather_data_gold__tmp_not_partitioned: [{'Name': 'ingestion_date', 'Type': 'date', 'Parameters': {}}, {'Name': 'location', 'Type': 'string', 'Parameters': {}}, {'Name': 'temperature_c', 'Type': 'double', 'Parameters': {}}, {'Name': 'humidity', 'Type': 'double', 'Parameters': {}}, {'Name': 'windspeed_mps', 'Type': 'double', 'Parameters': {}}, {'Name': 'source', 'Type': 'varchar(11)', 'Parameters': {}}, {'Name': 'observation_date', 'Type': 'date', 'Parameters': {}}]
[0m14:22:15.598701 [debug] [Thread-1 (]: BATCH PROCESSING: 1 OF 4
[0m14:22:15.602081 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:22:16.127712 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleting table data: path='s3://climate-energy-raw-data/gold/weather_data', bucket='climate-energy-raw-data', prefix='gold/weather_data/'
[0m14:22:16.727761 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m14:22:16.729491 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */

    

    create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      partitioned_by=ARRAY['observation_date'],
      format='parquet'
    )
    as
      select "ingestion_date", "location", "temperature_c", "humidity", "windspeed_mps", "source", "observation_date"
                from "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned"
                where observation_date=DATE'2025-01-01' or observation_date=DATE'2025-01-02' or observation_date=DATE'2025-01-03' or observation_date=DATE'2025-01-04' or observation_date=DATE'2025-01-05' or observation_date=DATE'2025-01-06' or observation_date=DATE'2025-01-07' or observation_date=DATE'2025-01-08' or observation_date=DATE'2025-01-09' or observation_date=DATE'2025-01-10' or observation_date=DATE'2025-01-11' or observation_date=DATE'2025-01-12' or observation_date=DATE'2025-01-13' or observation_date=DATE'2025-01-14' or observation_date=DATE'2025-01-15' or observation_date=DATE'2025-01-16' or observation_date=DATE'2025-01-17' or observation_date=DATE'2025-01-18' or observation_date=DATE'2025-01-19' or observation_date=DATE'2025-01-20' or observation_date=DATE'2025-01-21' or observation_date=DATE'2025-01-22' or observation_date=DATE'2025-01-23' or observation_date=DATE'2025-01-24' or observation_date=DATE'2025-01-25' or observation_date=DATE'2025-01-26' or observation_date=DATE'2025-01-27' or observation_date=DATE'2025-01-28' or observation_date=DATE'2025-01-29' or observation_date=DATE'2025-01-30' or observation_date=DATE'2025-01-31' or observation_date=DATE'2025-02-01' or observation_date=DATE'2025-02-02' or observation_date=DATE'2025-02-03' or observation_date=DATE'2025-02-04' or observation_date=DATE'2025-02-05' or observation_date=DATE'2025-02-06' or observation_date=DATE'2025-02-07' or observation_date=DATE'2025-02-08' or observation_date=DATE'2025-02-09' or observation_date=DATE'2025-02-10' or observation_date=DATE'2025-02-11' or observation_date=DATE'2025-02-12' or observation_date=DATE'2025-02-13' or observation_date=DATE'2025-02-14' or observation_date=DATE'2025-02-15' or observation_date=DATE'2025-02-16' or observation_date=DATE'2025-02-17' or observation_date=DATE'2025-02-18' or observation_date=DATE'2025-02-19' or observation_date=DATE'2025-02-20' or observation_date=DATE'2025-02-21' or observation_date=DATE'2025-02-22' or observation_date=DATE'2025-02-23' or observation_date=DATE'2025-02-24' or observation_date=DATE'2025-02-25' or observation_date=DATE'2025-02-26' or observation_date=DATE'2025-02-27' or observation_date=DATE'2025-02-28' or observation_date=DATE'2025-03-01' or observation_date=DATE'2025-03-02' or observation_date=DATE'2025-03-03' or observation_date=DATE'2025-03-04' or observation_date=DATE'2025-03-05' or observation_date=DATE'2025-03-06' or observation_date=DATE'2025-03-07' or observation_date=DATE'2025-03-08' or observation_date=DATE'2025-03-09' or observation_date=DATE'2025-03-10' or observation_date=DATE'2025-03-11' or observation_date=DATE'2025-03-12' or observation_date=DATE'2025-03-13' or observation_date=DATE'2025-03-14' or observation_date=DATE'2025-03-15' or observation_date=DATE'2025-03-16' or observation_date=DATE'2025-03-17' or observation_date=DATE'2025-03-18' or observation_date=DATE'2025-03-19' or observation_date=DATE'2025-03-20' or observation_date=DATE'2025-03-21' or observation_date=DATE'2025-03-22' or observation_date=DATE'2025-03-23' or observation_date=DATE'2025-03-24' or observation_date=DATE'2025-03-25' or observation_date=DATE'2025-03-26' or observation_date=DATE'2025-03-27' or observation_date=DATE'2025-03-28' or observation_date=DATE'2025-03-29' or observation_date=DATE'2025-03-30' or observation_date=DATE'2025-03-31' or observation_date=DATE'2025-04-01' or observation_date=DATE'2025-04-02' or observation_date=DATE'2025-04-03' or observation_date=DATE'2025-04-04' or observation_date=DATE'2025-04-05' or observation_date=DATE'2025-04-06' or observation_date=DATE'2025-04-07' or observation_date=DATE'2025-04-08' or observation_date=DATE'2025-04-09' or observation_date=DATE'2025-04-10'
  
[0m14:22:16.942809 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5478f30a-e108-4b18-b1b2-db77853fd6c7
[0m14:22:18.640660 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m14:22:18.651025 [debug] [Thread-1 (]: BATCH PROCESSING: 2 OF 4
[0m14:22:18.653170 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m14:22:18.654293 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */

    insert into "AwsDataCatalog"."gold"."weather_data_gold" ("ingestion_date", "location", "temperature_c", "humidity", "windspeed_mps", "source", "observation_date")
                select "ingestion_date", "location", "temperature_c", "humidity", "windspeed_mps", "source", "observation_date"
                from "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned"
                where observation_date=DATE'2025-04-11' or observation_date=DATE'2025-04-12' or observation_date=DATE'2025-04-13' or observation_date=DATE'2025-04-14' or observation_date=DATE'2025-04-15' or observation_date=DATE'2025-04-16' or observation_date=DATE'2025-04-17' or observation_date=DATE'2025-04-18' or observation_date=DATE'2025-04-19' or observation_date=DATE'2025-04-20' or observation_date=DATE'2025-04-21' or observation_date=DATE'2025-04-22' or observation_date=DATE'2025-04-23' or observation_date=DATE'2025-04-24' or observation_date=DATE'2025-04-25' or observation_date=DATE'2025-04-26' or observation_date=DATE'2025-04-27' or observation_date=DATE'2025-04-28' or observation_date=DATE'2025-04-29' or observation_date=DATE'2025-04-30' or observation_date=DATE'2025-05-01' or observation_date=DATE'2025-05-02' or observation_date=DATE'2025-05-03' or observation_date=DATE'2025-05-04' or observation_date=DATE'2025-05-05' or observation_date=DATE'2025-05-06' or observation_date=DATE'2025-05-07' or observation_date=DATE'2025-05-08' or observation_date=DATE'2025-05-09' or observation_date=DATE'2025-05-10' or observation_date=DATE'2025-05-11' or observation_date=DATE'2025-05-12' or observation_date=DATE'2025-05-13' or observation_date=DATE'2025-05-14' or observation_date=DATE'2025-05-15' or observation_date=DATE'2025-05-16' or observation_date=DATE'2025-05-17' or observation_date=DATE'2025-05-18' or observation_date=DATE'2025-05-19' or observation_date=DATE'2025-05-20' or observation_date=DATE'2025-05-21' or observation_date=DATE'2025-05-22' or observation_date=DATE'2025-05-23' or observation_date=DATE'2025-05-24' or observation_date=DATE'2025-05-25' or observation_date=DATE'2025-05-26' or observation_date=DATE'2025-05-27' or observation_date=DATE'2025-05-28' or observation_date=DATE'2025-05-29' or observation_date=DATE'2025-05-30' or observation_date=DATE'2025-05-31' or observation_date=DATE'2025-06-01' or observation_date=DATE'2025-06-02' or observation_date=DATE'2025-06-03' or observation_date=DATE'2025-06-04' or observation_date=DATE'2025-06-05' or observation_date=DATE'2025-06-06' or observation_date=DATE'2025-06-07' or observation_date=DATE'2025-06-08' or observation_date=DATE'2025-06-09' or observation_date=DATE'2025-06-10' or observation_date=DATE'2025-06-11' or observation_date=DATE'2025-06-12' or observation_date=DATE'2025-06-13' or observation_date=DATE'2025-06-14' or observation_date=DATE'2025-06-15' or observation_date=DATE'2025-06-16' or observation_date=DATE'2025-06-17' or observation_date=DATE'2025-06-18' or observation_date=DATE'2025-06-19' or observation_date=DATE'2025-06-20' or observation_date=DATE'2025-06-21' or observation_date=DATE'2025-06-22' or observation_date=DATE'2025-06-23' or observation_date=DATE'2025-06-24' or observation_date=DATE'2025-06-25' or observation_date=DATE'2025-06-26' or observation_date=DATE'2025-06-27' or observation_date=DATE'2025-06-28' or observation_date=DATE'2025-06-29' or observation_date=DATE'2025-06-30' or observation_date=DATE'2025-07-01' or observation_date=DATE'2025-07-02' or observation_date=DATE'2025-07-03' or observation_date=DATE'2025-07-04' or observation_date=DATE'2025-07-05' or observation_date=DATE'2025-07-06' or observation_date=DATE'2025-07-07' or observation_date=DATE'2025-07-08' or observation_date=DATE'2025-07-09' or observation_date=DATE'2025-07-10' or observation_date=DATE'2025-07-11' or observation_date=DATE'2025-07-12' or observation_date=DATE'2025-07-13' or observation_date=DATE'2025-07-14' or observation_date=DATE'2025-07-15' or observation_date=DATE'2025-07-16' or observation_date=DATE'2025-07-17' or observation_date=DATE'2025-07-18' or observation_date=DATE'2025-07-19'
  
[0m14:22:18.855983 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 5633fefc-2590-418a-823e-1d52b13d5b1f
[0m14:22:20.601602 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m14:22:20.618876 [debug] [Thread-1 (]: BATCH PROCESSING: 3 OF 4
[0m14:22:20.622136 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m14:22:20.622851 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */

    insert into "AwsDataCatalog"."gold"."weather_data_gold" ("ingestion_date", "location", "temperature_c", "humidity", "windspeed_mps", "source", "observation_date")
                select "ingestion_date", "location", "temperature_c", "humidity", "windspeed_mps", "source", "observation_date"
                from "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned"
                where observation_date=DATE'2025-07-20' or observation_date=DATE'2025-07-21' or observation_date=DATE'2025-07-22' or observation_date=DATE'2025-07-23' or observation_date=DATE'2025-07-24' or observation_date=DATE'2025-07-25' or observation_date=DATE'2025-07-26' or observation_date=DATE'2025-07-27' or observation_date=DATE'2025-07-28' or observation_date=DATE'2025-07-29' or observation_date=DATE'2025-07-30' or observation_date=DATE'2025-07-31' or observation_date=DATE'2025-08-01' or observation_date=DATE'2025-08-02' or observation_date=DATE'2025-08-03' or observation_date=DATE'2025-08-04' or observation_date=DATE'2025-08-05' or observation_date=DATE'2025-08-06' or observation_date=DATE'2025-08-07' or observation_date=DATE'2025-08-08' or observation_date=DATE'2025-08-09' or observation_date=DATE'2025-08-10' or observation_date=DATE'2025-08-11' or observation_date=DATE'2025-08-12' or observation_date=DATE'2025-08-13' or observation_date=DATE'2025-08-14' or observation_date=DATE'2025-08-15' or observation_date=DATE'2025-08-16' or observation_date=DATE'2025-08-17' or observation_date=DATE'2025-08-18' or observation_date=DATE'2025-08-19' or observation_date=DATE'2025-08-20' or observation_date=DATE'2025-08-21' or observation_date=DATE'2025-08-22' or observation_date=DATE'2025-08-23' or observation_date=DATE'2025-08-24' or observation_date=DATE'2025-08-25' or observation_date=DATE'2025-08-26' or observation_date=DATE'2025-08-27' or observation_date=DATE'2025-08-28' or observation_date=DATE'2025-08-29' or observation_date=DATE'2025-08-30' or observation_date=DATE'2025-08-31' or observation_date=DATE'2025-09-01' or observation_date=DATE'2025-09-02' or observation_date=DATE'2025-09-03' or observation_date=DATE'2025-09-04' or observation_date=DATE'2025-09-05' or observation_date=DATE'2025-09-06' or observation_date=DATE'2025-09-07' or observation_date=DATE'2025-09-08' or observation_date=DATE'2025-09-09' or observation_date=DATE'2025-09-10' or observation_date=DATE'2025-09-11' or observation_date=DATE'2025-09-12' or observation_date=DATE'2025-09-13' or observation_date=DATE'2025-09-14' or observation_date=DATE'2025-09-15' or observation_date=DATE'2025-09-16' or observation_date=DATE'2025-09-17' or observation_date=DATE'2025-09-18' or observation_date=DATE'2025-09-19' or observation_date=DATE'2025-09-20' or observation_date=DATE'2025-09-21' or observation_date=DATE'2025-09-22' or observation_date=DATE'2025-09-23' or observation_date=DATE'2025-09-24' or observation_date=DATE'2025-09-25' or observation_date=DATE'2025-09-26' or observation_date=DATE'2025-09-27' or observation_date=DATE'2025-09-28' or observation_date=DATE'2025-09-29' or observation_date=DATE'2025-09-30' or observation_date=DATE'2025-10-01' or observation_date=DATE'2025-10-02' or observation_date=DATE'2025-10-03' or observation_date=DATE'2025-10-04' or observation_date=DATE'2025-10-05' or observation_date=DATE'2025-10-06' or observation_date=DATE'2025-10-07' or observation_date=DATE'2025-10-08' or observation_date=DATE'2025-10-09' or observation_date=DATE'2025-10-10' or observation_date=DATE'2025-10-11' or observation_date=DATE'2025-10-12' or observation_date=DATE'2025-10-13' or observation_date=DATE'2025-10-14' or observation_date=DATE'2025-10-15' or observation_date=DATE'2025-10-16' or observation_date=DATE'2025-10-17' or observation_date=DATE'2025-10-18' or observation_date=DATE'2025-10-19' or observation_date=DATE'2025-10-20' or observation_date=DATE'2025-10-21' or observation_date=DATE'2025-10-22' or observation_date=DATE'2025-10-23' or observation_date=DATE'2025-10-24' or observation_date=DATE'2025-10-25' or observation_date=DATE'2025-10-26' or observation_date=DATE'2025-10-27'
  
[0m14:22:20.839704 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID c7b45e53-93b8-4898-a6cc-02fbe84dc91e
[0m14:22:22.497684 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m14:22:22.499331 [debug] [Thread-1 (]: BATCH PROCESSING: 4 OF 4
[0m14:22:22.500071 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m14:22:22.500510 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */

    insert into "AwsDataCatalog"."gold"."weather_data_gold" ("ingestion_date", "location", "temperature_c", "humidity", "windspeed_mps", "source", "observation_date")
                select "ingestion_date", "location", "temperature_c", "humidity", "windspeed_mps", "source", "observation_date"
                from "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned"
                where observation_date=DATE'2025-10-28' or observation_date=DATE'2025-10-29' or observation_date=DATE'2025-10-30' or observation_date=DATE'2025-10-31' or observation_date=DATE'2025-11-01' or observation_date=DATE'2025-11-02' or observation_date=DATE'2025-11-03' or observation_date=DATE'2025-11-04' or observation_date=DATE'2025-11-05' or observation_date=DATE'2025-11-06' or observation_date=DATE'2025-11-07' or observation_date=DATE'2025-11-08' or observation_date=DATE'2025-11-09' or observation_date=DATE'2025-11-10' or observation_date=DATE'2025-11-11' or observation_date=DATE'2025-11-12' or observation_date=DATE'2025-11-13' or observation_date=DATE'2025-11-14' or observation_date=DATE'2025-11-15' or observation_date=DATE'2025-11-16' or observation_date=DATE'2025-11-17' or observation_date=DATE'2025-11-18' or observation_date=DATE'2025-11-19' or observation_date=DATE'2025-11-20' or observation_date=DATE'2025-11-21' or observation_date=DATE'2025-11-22' or observation_date=DATE'2025-11-23' or observation_date=DATE'2025-11-24' or observation_date=DATE'2025-11-25' or observation_date=DATE'2025-11-26' or observation_date=DATE'2025-11-27' or observation_date=DATE'2025-11-28' or observation_date=DATE'2025-11-29' or observation_date=DATE'2025-11-30' or observation_date=DATE'2025-12-01' or observation_date=DATE'2025-12-02' or observation_date=DATE'2025-12-03' or observation_date=DATE'2025-12-04' or observation_date=DATE'2025-12-05' or observation_date=DATE'2025-12-06' or observation_date=DATE'2025-12-07' or observation_date=DATE'2025-12-08' or observation_date=DATE'2025-12-09' or observation_date=DATE'2025-12-10' or observation_date=DATE'2025-12-11' or observation_date=DATE'2025-12-12' or observation_date=DATE'2025-12-13' or observation_date=DATE'2025-12-14' or observation_date=DATE'2025-12-15' or observation_date=DATE'2025-12-16' or observation_date=DATE'2025-12-17' or observation_date=DATE'2025-12-18' or observation_date=DATE'2025-12-19' or observation_date=DATE'2025-12-20' or observation_date=DATE'2025-12-21' or observation_date=DATE'2025-12-22' or observation_date=DATE'2025-12-23' or observation_date=DATE'2025-12-24' or observation_date=DATE'2025-12-25' or observation_date=DATE'2025-12-26' or observation_date=DATE'2025-12-27' or observation_date=DATE'2025-12-28' or observation_date=DATE'2025-12-29' or observation_date=DATE'2025-12-30' or observation_date=DATE'2025-12-31' or observation_date=DATE'2026-01-01' or observation_date=DATE'2026-01-02' or observation_date=DATE'2026-01-03' or observation_date=DATE'2026-01-04' or observation_date=DATE'2026-01-05' or observation_date=DATE'2026-01-06' or observation_date=DATE'2026-01-07' or observation_date=DATE'2026-01-08' or observation_date=DATE'2026-01-09' or observation_date=DATE'2026-01-10' or observation_date=DATE'2026-01-11' or observation_date=DATE'2026-01-12' or observation_date=DATE'2026-01-13' or observation_date=DATE'2026-01-14' or observation_date=DATE'2026-01-15' or observation_date=DATE'2026-01-16' or observation_date=DATE'2026-01-17' or observation_date=DATE'2026-01-18' or observation_date=DATE'2026-01-19' or observation_date=DATE'2026-01-20' or observation_date=DATE'2026-01-21' or observation_date=DATE'2026-01-22' or observation_date=DATE'2026-01-23' or observation_date=DATE'2026-01-24' or observation_date=DATE'2026-01-25' or observation_date=DATE'2026-01-26' or observation_date=DATE'2026-01-27' or observation_date=DATE'2026-01-28' or observation_date=DATE'2026-01-29' or observation_date=DATE'2026-01-30'
  
[0m14:22:22.700256 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID be9e2c70-194e-4469-ae68-0564fcfe31a8
[0m14:22:24.346140 [debug] [Thread-1 (]: SQL status: OK 0 in 2.0 seconds
[0m14:22:25.396377 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold__tmp_not_partitioned
[0m14:22:25.397899 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:22:25.399609 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:22:26.490182 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold__tmp_not_partitioned
[0m14:22:26.491255 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:22:26.492160 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m14:22:26.971467 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:22:28.399305 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold__tmp_not_partitioned"
[0m14:22:28.418172 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m14:22:28.418959 [debug] [Thread-1 (]: On model.silver.weather_data_gold: alter table `AwsDataCatalog`.`gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m14:22:28.683422 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0e4e71ee-b352-4a3c-b3e3-6ee8a6e35ee3
[0m14:22:30.643455 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:22:30.696124 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m14:22:30.743557 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m14:22:30.746420 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '"AwsDataCatalog"."gold"."weather_data_gold" with many partitions created';
[0m14:22:30.973245 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 2dcfe418-4eb0-4388-834f-9b364d1e05f9
[0m14:22:32.779277 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:22:32.875651 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 14:22:01.010089 => 14:22:32.866049
[0m14:22:32.881117 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m14:22:32.919612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dabdb23-7cfc-47fe-a758-9b52a1a8d89e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db58c50>]}
[0m14:22:32.933720 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK -1[0m in 31.91s]
[0m14:22:32.941072 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m14:22:33.026837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:33.029242 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m14:22:33.038875 [info ] [MainThread]: 
[0m14:22:33.045126 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 36.37 seconds (36.37s).
[0m14:22:33.059578 [debug] [MainThread]: Command end result
[0m14:22:33.366342 [info ] [MainThread]: 
[0m14:22:33.380354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:33.387932 [info ] [MainThread]: 
[0m14:22:33.403474 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:22:33.491958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 37.524113, "process_user_time": 6.504417, "process_kernel_time": 0.996181, "process_mem_max_rss": "183688", "process_out_blocks": "3014", "process_in_blocks": "0"}
[0m14:22:33.505535 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:33.498007 after 37.54 seconds
[0m14:22:33.512445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1986a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6974bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6975790>]}
[0m14:22:33.514297 [debug] [MainThread]: Flushing usage events
[0m14:33:02.996067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9071e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a09250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a093d0>]}


============================== 14:33:03.005361 | fd81e8cd-8a1a-4522-9245-8349b402060e ==============================
[0m14:33:03.005361 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:33:03.008121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --profile gold --select path:models/gold/weather_data_gold.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:03.909236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd81e8cd-8a1a-4522-9245-8349b402060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90723d90>]}
[0m14:33:03.980849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd81e8cd-8a1a-4522-9245-8349b402060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9071ef50>]}
[0m14:33:03.981803 [info ] [MainThread]: Registered adapter: athena=1.7.2
[0m14:33:03.988574 [debug] [MainThread]: checksum: 49ce2e6046668951b504ebaa76442a7cb4e259da2f2d03cff132e3bec173c387, vars: {}, profile: gold, target: , version: 1.7.9
[0m14:33:04.057366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:04.058273 [debug] [MainThread]: Partial parsing: updated file: silver://models/gold/weather_data_gold.sql
[0m14:33:04.236303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd81e8cd-8a1a-4522-9245-8349b402060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef277d0>]}
[0m14:33:04.252035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd81e8cd-8a1a-4522-9245-8349b402060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f42ab10>]}
[0m14:33:04.252489 [info ] [MainThread]: Found 11 models, 5 tests, 5 sources, 0 exposures, 0 metrics, 428 macros, 0 groups, 0 semantic models
[0m14:33:04.252846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd81e8cd-8a1a-4522-9245-8349b402060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef7dfd0>]}
[0m14:33:04.254841 [info ] [MainThread]: 
[0m14:33:04.255799 [debug] [MainThread]: Acquiring new athena connection 'master'
[0m14:33:04.258180 [debug] [ThreadPool]: Acquiring new athena connection 'list_AwsDataCatalog'
[0m14:33:04.259079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:05.413452 [debug] [ThreadPool]: On list_AwsDataCatalog: Close
[0m14:33:05.463105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog, now list_AwsDataCatalog_silver)
[0m14:33:05.465026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:06.839596 [debug] [ThreadPool]: On list_AwsDataCatalog_silver: Close
[0m14:33:06.843395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_silver, now list_AwsDataCatalog_bronze)
[0m14:33:06.847057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:08.199132 [debug] [ThreadPool]: On list_AwsDataCatalog_bronze: Close
[0m14:33:08.202434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_bronze, now list_AwsDataCatalog_gold)
[0m14:33:08.203754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:09.231338 [debug] [ThreadPool]: On list_AwsDataCatalog_gold: Close
[0m14:33:09.237056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd81e8cd-8a1a-4522-9245-8349b402060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c34e210>]}
[0m14:33:09.240042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:09.240930 [info ] [MainThread]: 
[0m14:33:09.248820 [debug] [Thread-1 (]: Began running node model.silver.weather_data_gold
[0m14:33:09.249842 [info ] [Thread-1 (]: 1 of 1 START sql table model gold.weather_data_gold ............................ [RUN]
[0m14:33:09.251055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AwsDataCatalog_gold, now model.silver.weather_data_gold)
[0m14:33:09.251442 [debug] [Thread-1 (]: Began compiling node model.silver.weather_data_gold
[0m14:33:09.270337 [debug] [Thread-1 (]: Writing injected SQL for node "model.silver.weather_data_gold"
[0m14:33:09.273780 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (compile): 14:33:09.251801 => 14:33:09.273317
[0m14:33:09.274140 [debug] [Thread-1 (]: Began executing node model.silver.weather_data_gold
[0m14:33:09.307114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:10.586673 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold
[0m14:33:10.588132 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:33:10.592593 [debug] [Thread-1 (]: Dropping relation via Glue and S3 APIs
[0m14:33:11.553524 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table_name : weather_data_gold
[0m14:33:11.555337 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: table type : TableType.TABLE
[0m14:33:11.556308 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: "AwsDataCatalog"."gold"."weather_data_gold" is stored in s3://climate-energy-raw-data/gold/weather_data
[0m14:33:12.055777 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:33:13.296204 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Deleted table from glue catalog: "AwsDataCatalog"."gold"."weather_data_gold"
[0m14:33:13.333711 [debug] [Thread-1 (]: Skip partitioning: False
[0m14:33:13.758633 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: S3 path does not exist
[0m14:33:13.761234 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Running Athena query:
-- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */


    create table "AwsDataCatalog"."gold"."weather_data_gold"
    with (
      table_type='hive',
      is_external=true,external_location='s3://climate-energy-raw-data/gold/weather_data',
      partitioned_by=ARRAY['ingestion_date'],
      format='parquet'
    )
    as
      


SELECT
  location,
  temperature_c,
  humidity,
  windspeed_mps,
  'openweather' as source,
  observation_date,
  ingestion_date
FROM "AwsDataCatalog"."silver"."openweather_silver"

UNION ALL

SELECT
  location,
  temperature_c,
  humidity,
  windspeed_mps,
  'openmeteo' as source,
  observation_date,
  ingestion_date
FROM "AwsDataCatalog"."silver"."openmeteo_silver"
[0m14:33:14.289537 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 09843850-82b8-4c99-bbe3-ee739f144862
[0m14:33:17.254000 [debug] [Thread-1 (]: COMPILED CODE RESULT: {"rowcount":40533,"data_scanned_in_bytes":149959}
[0m14:33:17.297626 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m14:33:17.299489 [debug] [Thread-1 (]: On model.silver.weather_data_gold: alter table `AwsDataCatalog`.`gold`.`weather_data_gold` set tblproperties ('classification' = 'parquet')
[0m14:33:17.587652 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID a87c2156-f7bd-4615-b909-3306925b0350
[0m14:33:19.274608 [debug] [Thread-1 (]: SQL status: OK -1 in 2.0 seconds
[0m14:33:19.281731 [debug] [Thread-1 (]: Writing runtime sql for node "model.silver.weather_data_gold"
[0m14:33:19.285654 [debug] [Thread-1 (]: Using athena connection "model.silver.weather_data_gold"
[0m14:33:19.286034 [debug] [Thread-1 (]: On model.silver.weather_data_gold: -- /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "gold", "target_name": "dev", "node_id": "model.silver.weather_data_gold"} */
SELECT '{"rowcount":40533,"data_scanned_in_bytes":149959}';
[0m14:33:19.487084 [debug] [Thread-1 (]: dbt.adapters.athena.constants adapter: Athena query ID 0ee700a9-3734-4d51-84e9-40850a49a904
[0m14:33:21.207629 [debug] [Thread-1 (]: SQL status: OK 40533 in 2.0 seconds
[0m14:33:21.221265 [debug] [Thread-1 (]: Timing info for model.silver.weather_data_gold (execute): 14:33:09.274349 => 14:33:21.220816
[0m14:33:21.222016 [debug] [Thread-1 (]: On model.silver.weather_data_gold: Close
[0m14:33:21.223488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd81e8cd-8a1a-4522-9245-8349b402060e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef743d0>]}
[0m14:33:21.225019 [info ] [Thread-1 (]: 1 of 1 OK created sql table model gold.weather_data_gold ....................... [[32mOK 40533[0m in 11.97s]
[0m14:33:21.226207 [debug] [Thread-1 (]: Finished running node model.silver.weather_data_gold
[0m14:33:21.232459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:21.233021 [debug] [MainThread]: Connection 'model.silver.weather_data_gold' was properly closed.
[0m14:33:21.236515 [info ] [MainThread]: 
[0m14:33:21.237199 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.98 seconds (16.98s).
[0m14:33:21.239128 [debug] [MainThread]: Command end result
[0m14:33:21.283164 [info ] [MainThread]: 
[0m14:33:21.284252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:21.284683 [info ] [MainThread]: 
[0m14:33:21.286103 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:33:21.294347 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.326244, "process_user_time": 4.528815, "process_kernel_time": 1.947457, "process_mem_max_rss": "185944", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m14:33:21.296264 [debug] [MainThread]: Command `dbt run` succeeded at 14:33:21.295868 after 18.33 seconds
[0m14:33:21.297168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a09290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95975650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95975790>]}
[0m14:33:21.297641 [debug] [MainThread]: Flushing usage events
